(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))a(d);new MutationObserver(d=>{for(const m of d)if(m.type==="childList")for(const _ of m.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&a(_)}).observe(document,{childList:!0,subtree:!0});function t(d){const m={};return d.integrity&&(m.integrity=d.integrity),d.referrerPolicy&&(m.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?m.credentials="include":d.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function a(d){if(d.ep)return;d.ep=!0;const m=t(d);fetch(d.href,m)}})();function wy(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var jb={exports:{}},R_={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i2;function nP(){if(i2)return R_;i2=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(a,d,m){var _=null;if(m!==void 0&&(_=""+m),d.key!==void 0&&(_=""+d.key),"key"in d){m={};for(var c in d)c!=="key"&&(m[c]=d[c])}else m=d;return d=m.ref,{$$typeof:i,type:a,key:_,ref:d!==void 0?d:null,props:m}}return R_.Fragment=e,R_.jsx=t,R_.jsxs=t,R_}var r2;function iP(){return r2||(r2=1,jb.exports=nP()),jb.exports}var Ce=iP(),qb={exports:{}},ai={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a2;function rP(){if(a2)return ai;a2=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),m=Symbol.for("react.consumer"),_=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),k=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),G=Symbol.for("react.activity"),ee=Symbol.iterator;function Y(ke){return ke===null||typeof ke!="object"?null:(ke=ee&&ke[ee]||ke["@@iterator"],typeof ke=="function"?ke:null)}var xe={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},be=Object.assign,Ne={};function tt(ke,xt,Ot){this.props=ke,this.context=xt,this.refs=Ne,this.updater=Ot||xe}tt.prototype.isReactComponent={},tt.prototype.setState=function(ke,xt){if(typeof ke!="object"&&typeof ke!="function"&&ke!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ke,xt,"setState")},tt.prototype.forceUpdate=function(ke){this.updater.enqueueForceUpdate(this,ke,"forceUpdate")};function Je(){}Je.prototype=tt.prototype;function Xe(ke,xt,Ot){this.props=ke,this.context=xt,this.refs=Ne,this.updater=Ot||xe}var Ke=Xe.prototype=new Je;Ke.constructor=Xe,be(Ke,tt.prototype),Ke.isPureReactComponent=!0;var Ge=Array.isArray;function Fe(){}var de={H:null,A:null,T:null,S:null},ce=Object.prototype.hasOwnProperty;function ge(ke,xt,Ot){var Ut=Ot.ref;return{$$typeof:i,type:ke,key:xt,ref:Ut!==void 0?Ut:null,props:Ot}}function Ae(ke,xt){return ge(ke.type,xt,ke.props)}function Re(ke){return typeof ke=="object"&&ke!==null&&ke.$$typeof===i}function je(ke){var xt={"=":"=0",":":"=2"};return"$"+ke.replace(/[=:]/g,function(Ot){return xt[Ot]})}var Pe=/\/+/g;function Mn(ke,xt){return typeof ke=="object"&&ke!==null&&ke.key!=null?je(""+ke.key):xt.toString(36)}function ni(ke){switch(ke.status){case"fulfilled":return ke.value;case"rejected":throw ke.reason;default:switch(typeof ke.status=="string"?ke.then(Fe,Fe):(ke.status="pending",ke.then(function(xt){ke.status==="pending"&&(ke.status="fulfilled",ke.value=xt)},function(xt){ke.status==="pending"&&(ke.status="rejected",ke.reason=xt)})),ke.status){case"fulfilled":return ke.value;case"rejected":throw ke.reason}}throw ke}function mt(ke,xt,Ot,Ut,Jt){var Wt=typeof ke;(Wt==="undefined"||Wt==="boolean")&&(ke=null);var Fn=!1;if(ke===null)Fn=!0;else switch(Wt){case"bigint":case"string":case"number":Fn=!0;break;case"object":switch(ke.$$typeof){case i:case e:Fn=!0;break;case V:return Fn=ke._init,mt(Fn(ke._payload),xt,Ot,Ut,Jt)}}if(Fn)return Jt=Jt(ke),Fn=Ut===""?"."+Mn(ke,0):Ut,Ge(Jt)?(Ot="",Fn!=null&&(Ot=Fn.replace(Pe,"$&/")+"/"),mt(Jt,xt,Ot,"",function(ds){return ds})):Jt!=null&&(Re(Jt)&&(Jt=Ae(Jt,Ot+(Jt.key==null||ke&&ke.key===Jt.key?"":(""+Jt.key).replace(Pe,"$&/")+"/")+Fn)),xt.push(Jt)),1;Fn=0;var oi=Ut===""?".":Ut+":";if(Ge(ke))for(var fi=0;fi<ke.length;fi++)Ut=ke[fi],Wt=oi+Mn(Ut,fi),Fn+=mt(Ut,xt,Ot,Wt,Jt);else if(fi=Y(ke),typeof fi=="function")for(ke=fi.call(ke),fi=0;!(Ut=ke.next()).done;)Ut=Ut.value,Wt=oi+Mn(Ut,fi++),Fn+=mt(Ut,xt,Ot,Wt,Jt);else if(Wt==="object"){if(typeof ke.then=="function")return mt(ni(ke),xt,Ot,Ut,Jt);throw xt=String(ke),Error("Objects are not valid as a React child (found: "+(xt==="[object Object]"?"object with keys {"+Object.keys(ke).join(", ")+"}":xt)+"). If you meant to render a collection of children, use an array instead.")}return Fn}function At(ke,xt,Ot){if(ke==null)return ke;var Ut=[],Jt=0;return mt(ke,Ut,"","",function(Wt){return xt.call(Ot,Wt,Jt++)}),Ut}function bt(ke){if(ke._status===-1){var xt=ke._result;xt=xt(),xt.then(function(Ot){(ke._status===0||ke._status===-1)&&(ke._status=1,ke._result=Ot)},function(Ot){(ke._status===0||ke._status===-1)&&(ke._status=2,ke._result=Ot)}),ke._status===-1&&(ke._status=0,ke._result=xt)}if(ke._status===1)return ke._result.default;throw ke._result}var Zt=typeof reportError=="function"?reportError:function(ke){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var xt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ke=="object"&&ke!==null&&typeof ke.message=="string"?String(ke.message):String(ke),error:ke});if(!window.dispatchEvent(xt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ke);return}console.error(ke)},Vt={map:At,forEach:function(ke,xt,Ot){At(ke,function(){xt.apply(this,arguments)},Ot)},count:function(ke){var xt=0;return At(ke,function(){xt++}),xt},toArray:function(ke){return At(ke,function(xt){return xt})||[]},only:function(ke){if(!Re(ke))throw Error("React.Children.only expected to receive a single React element child.");return ke}};return ai.Activity=G,ai.Children=Vt,ai.Component=tt,ai.Fragment=t,ai.Profiler=d,ai.PureComponent=Xe,ai.StrictMode=a,ai.Suspense=C,ai.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=de,ai.__COMPILER_RUNTIME={__proto__:null,c:function(ke){return de.H.useMemoCache(ke)}},ai.cache=function(ke){return function(){return ke.apply(null,arguments)}},ai.cacheSignal=function(){return null},ai.cloneElement=function(ke,xt,Ot){if(ke==null)throw Error("The argument must be a React element, but you passed "+ke+".");var Ut=be({},ke.props),Jt=ke.key;if(xt!=null)for(Wt in xt.key!==void 0&&(Jt=""+xt.key),xt)!ce.call(xt,Wt)||Wt==="key"||Wt==="__self"||Wt==="__source"||Wt==="ref"&&xt.ref===void 0||(Ut[Wt]=xt[Wt]);var Wt=arguments.length-2;if(Wt===1)Ut.children=Ot;else if(1<Wt){for(var Fn=Array(Wt),oi=0;oi<Wt;oi++)Fn[oi]=arguments[oi+2];Ut.children=Fn}return ge(ke.type,Jt,Ut)},ai.createContext=function(ke){return ke={$$typeof:_,_currentValue:ke,_currentValue2:ke,_threadCount:0,Provider:null,Consumer:null},ke.Provider=ke,ke.Consumer={$$typeof:m,_context:ke},ke},ai.createElement=function(ke,xt,Ot){var Ut,Jt={},Wt=null;if(xt!=null)for(Ut in xt.key!==void 0&&(Wt=""+xt.key),xt)ce.call(xt,Ut)&&Ut!=="key"&&Ut!=="__self"&&Ut!=="__source"&&(Jt[Ut]=xt[Ut]);var Fn=arguments.length-2;if(Fn===1)Jt.children=Ot;else if(1<Fn){for(var oi=Array(Fn),fi=0;fi<Fn;fi++)oi[fi]=arguments[fi+2];Jt.children=oi}if(ke&&ke.defaultProps)for(Ut in Fn=ke.defaultProps,Fn)Jt[Ut]===void 0&&(Jt[Ut]=Fn[Ut]);return ge(ke,Wt,Jt)},ai.createRef=function(){return{current:null}},ai.forwardRef=function(ke){return{$$typeof:c,render:ke}},ai.isValidElement=Re,ai.lazy=function(ke){return{$$typeof:V,_payload:{_status:-1,_result:ke},_init:bt}},ai.memo=function(ke,xt){return{$$typeof:k,type:ke,compare:xt===void 0?null:xt}},ai.startTransition=function(ke){var xt=de.T,Ot={};de.T=Ot;try{var Ut=ke(),Jt=de.S;Jt!==null&&Jt(Ot,Ut),typeof Ut=="object"&&Ut!==null&&typeof Ut.then=="function"&&Ut.then(Fe,Zt)}catch(Wt){Zt(Wt)}finally{xt!==null&&Ot.types!==null&&(xt.types=Ot.types),de.T=xt}},ai.unstable_useCacheRefresh=function(){return de.H.useCacheRefresh()},ai.use=function(ke){return de.H.use(ke)},ai.useActionState=function(ke,xt,Ot){return de.H.useActionState(ke,xt,Ot)},ai.useCallback=function(ke,xt){return de.H.useCallback(ke,xt)},ai.useContext=function(ke){return de.H.useContext(ke)},ai.useDebugValue=function(){},ai.useDeferredValue=function(ke,xt){return de.H.useDeferredValue(ke,xt)},ai.useEffect=function(ke,xt){return de.H.useEffect(ke,xt)},ai.useEffectEvent=function(ke){return de.H.useEffectEvent(ke)},ai.useId=function(){return de.H.useId()},ai.useImperativeHandle=function(ke,xt,Ot){return de.H.useImperativeHandle(ke,xt,Ot)},ai.useInsertionEffect=function(ke,xt){return de.H.useInsertionEffect(ke,xt)},ai.useLayoutEffect=function(ke,xt){return de.H.useLayoutEffect(ke,xt)},ai.useMemo=function(ke,xt){return de.H.useMemo(ke,xt)},ai.useOptimistic=function(ke,xt){return de.H.useOptimistic(ke,xt)},ai.useReducer=function(ke,xt,Ot){return de.H.useReducer(ke,xt,Ot)},ai.useRef=function(ke){return de.H.useRef(ke)},ai.useState=function(ke){return de.H.useState(ke)},ai.useSyncExternalStore=function(ke,xt,Ot){return de.H.useSyncExternalStore(ke,xt,Ot)},ai.useTransition=function(){return de.H.useTransition()},ai.version="19.2.0",ai}var s2;function S1(){return s2||(s2=1,qb.exports=rP()),qb.exports}var Tt=S1();const aP=wy(Tt);var $b={exports:{}},L_={},Gb={exports:{}},Zb={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var o2;function sP(){return o2||(o2=1,(function(i){function e(mt,At){var bt=mt.length;mt.push(At);e:for(;0<bt;){var Zt=bt-1>>>1,Vt=mt[Zt];if(0<d(Vt,At))mt[Zt]=At,mt[bt]=Vt,bt=Zt;else break e}}function t(mt){return mt.length===0?null:mt[0]}function a(mt){if(mt.length===0)return null;var At=mt[0],bt=mt.pop();if(bt!==At){mt[0]=bt;e:for(var Zt=0,Vt=mt.length,ke=Vt>>>1;Zt<ke;){var xt=2*(Zt+1)-1,Ot=mt[xt],Ut=xt+1,Jt=mt[Ut];if(0>d(Ot,bt))Ut<Vt&&0>d(Jt,Ot)?(mt[Zt]=Jt,mt[Ut]=bt,Zt=Ut):(mt[Zt]=Ot,mt[xt]=bt,Zt=xt);else if(Ut<Vt&&0>d(Jt,bt))mt[Zt]=Jt,mt[Ut]=bt,Zt=Ut;else break e}}return At}function d(mt,At){var bt=mt.sortIndex-At.sortIndex;return bt!==0?bt:mt.id-At.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var m=performance;i.unstable_now=function(){return m.now()}}else{var _=Date,c=_.now();i.unstable_now=function(){return _.now()-c}}var C=[],k=[],V=1,G=null,ee=3,Y=!1,xe=!1,be=!1,Ne=!1,tt=typeof setTimeout=="function"?setTimeout:null,Je=typeof clearTimeout=="function"?clearTimeout:null,Xe=typeof setImmediate<"u"?setImmediate:null;function Ke(mt){for(var At=t(k);At!==null;){if(At.callback===null)a(k);else if(At.startTime<=mt)a(k),At.sortIndex=At.expirationTime,e(C,At);else break;At=t(k)}}function Ge(mt){if(be=!1,Ke(mt),!xe)if(t(C)!==null)xe=!0,Fe||(Fe=!0,je());else{var At=t(k);At!==null&&ni(Ge,At.startTime-mt)}}var Fe=!1,de=-1,ce=5,ge=-1;function Ae(){return Ne?!0:!(i.unstable_now()-ge<ce)}function Re(){if(Ne=!1,Fe){var mt=i.unstable_now();ge=mt;var At=!0;try{e:{xe=!1,be&&(be=!1,Je(de),de=-1),Y=!0;var bt=ee;try{t:{for(Ke(mt),G=t(C);G!==null&&!(G.expirationTime>mt&&Ae());){var Zt=G.callback;if(typeof Zt=="function"){G.callback=null,ee=G.priorityLevel;var Vt=Zt(G.expirationTime<=mt);if(mt=i.unstable_now(),typeof Vt=="function"){G.callback=Vt,Ke(mt),At=!0;break t}G===t(C)&&a(C),Ke(mt)}else a(C);G=t(C)}if(G!==null)At=!0;else{var ke=t(k);ke!==null&&ni(Ge,ke.startTime-mt),At=!1}}break e}finally{G=null,ee=bt,Y=!1}At=void 0}}finally{At?je():Fe=!1}}}var je;if(typeof Xe=="function")je=function(){Xe(Re)};else if(typeof MessageChannel<"u"){var Pe=new MessageChannel,Mn=Pe.port2;Pe.port1.onmessage=Re,je=function(){Mn.postMessage(null)}}else je=function(){tt(Re,0)};function ni(mt,At){de=tt(function(){mt(i.unstable_now())},At)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(mt){mt.callback=null},i.unstable_forceFrameRate=function(mt){0>mt||125<mt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ce=0<mt?Math.floor(1e3/mt):5},i.unstable_getCurrentPriorityLevel=function(){return ee},i.unstable_next=function(mt){switch(ee){case 1:case 2:case 3:var At=3;break;default:At=ee}var bt=ee;ee=At;try{return mt()}finally{ee=bt}},i.unstable_requestPaint=function(){Ne=!0},i.unstable_runWithPriority=function(mt,At){switch(mt){case 1:case 2:case 3:case 4:case 5:break;default:mt=3}var bt=ee;ee=mt;try{return At()}finally{ee=bt}},i.unstable_scheduleCallback=function(mt,At,bt){var Zt=i.unstable_now();switch(typeof bt=="object"&&bt!==null?(bt=bt.delay,bt=typeof bt=="number"&&0<bt?Zt+bt:Zt):bt=Zt,mt){case 1:var Vt=-1;break;case 2:Vt=250;break;case 5:Vt=1073741823;break;case 4:Vt=1e4;break;default:Vt=5e3}return Vt=bt+Vt,mt={id:V++,callback:At,priorityLevel:mt,startTime:bt,expirationTime:Vt,sortIndex:-1},bt>Zt?(mt.sortIndex=bt,e(k,mt),t(C)===null&&mt===t(k)&&(be?(Je(de),de=-1):be=!0,ni(Ge,bt-Zt))):(mt.sortIndex=Vt,e(C,mt),xe||Y||(xe=!0,Fe||(Fe=!0,je()))),mt},i.unstable_shouldYield=Ae,i.unstable_wrapCallback=function(mt){var At=ee;return function(){var bt=ee;ee=At;try{return mt.apply(this,arguments)}finally{ee=bt}}}})(Zb)),Zb}var l2;function oP(){return l2||(l2=1,Gb.exports=sP()),Gb.exports}var Hb={exports:{}},El={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u2;function lP(){if(u2)return El;u2=1;var i=S1();function e(C){var k="https://react.dev/errors/"+C;if(1<arguments.length){k+="?args[]="+encodeURIComponent(arguments[1]);for(var V=2;V<arguments.length;V++)k+="&args[]="+encodeURIComponent(arguments[V])}return"Minified React error #"+C+"; visit "+k+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var a={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},d=Symbol.for("react.portal");function m(C,k,V){var G=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:d,key:G==null?null:""+G,children:C,containerInfo:k,implementation:V}}var _=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(C,k){if(C==="font")return"";if(typeof k=="string")return k==="use-credentials"?k:""}return El.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,El.createPortal=function(C,k){var V=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!k||k.nodeType!==1&&k.nodeType!==9&&k.nodeType!==11)throw Error(e(299));return m(C,k,null,V)},El.flushSync=function(C){var k=_.T,V=a.p;try{if(_.T=null,a.p=2,C)return C()}finally{_.T=k,a.p=V,a.d.f()}},El.preconnect=function(C,k){typeof C=="string"&&(k?(k=k.crossOrigin,k=typeof k=="string"?k==="use-credentials"?k:"":void 0):k=null,a.d.C(C,k))},El.prefetchDNS=function(C){typeof C=="string"&&a.d.D(C)},El.preinit=function(C,k){if(typeof C=="string"&&k&&typeof k.as=="string"){var V=k.as,G=c(V,k.crossOrigin),ee=typeof k.integrity=="string"?k.integrity:void 0,Y=typeof k.fetchPriority=="string"?k.fetchPriority:void 0;V==="style"?a.d.S(C,typeof k.precedence=="string"?k.precedence:void 0,{crossOrigin:G,integrity:ee,fetchPriority:Y}):V==="script"&&a.d.X(C,{crossOrigin:G,integrity:ee,fetchPriority:Y,nonce:typeof k.nonce=="string"?k.nonce:void 0})}},El.preinitModule=function(C,k){if(typeof C=="string")if(typeof k=="object"&&k!==null){if(k.as==null||k.as==="script"){var V=c(k.as,k.crossOrigin);a.d.M(C,{crossOrigin:V,integrity:typeof k.integrity=="string"?k.integrity:void 0,nonce:typeof k.nonce=="string"?k.nonce:void 0})}}else k==null&&a.d.M(C)},El.preload=function(C,k){if(typeof C=="string"&&typeof k=="object"&&k!==null&&typeof k.as=="string"){var V=k.as,G=c(V,k.crossOrigin);a.d.L(C,V,{crossOrigin:G,integrity:typeof k.integrity=="string"?k.integrity:void 0,nonce:typeof k.nonce=="string"?k.nonce:void 0,type:typeof k.type=="string"?k.type:void 0,fetchPriority:typeof k.fetchPriority=="string"?k.fetchPriority:void 0,referrerPolicy:typeof k.referrerPolicy=="string"?k.referrerPolicy:void 0,imageSrcSet:typeof k.imageSrcSet=="string"?k.imageSrcSet:void 0,imageSizes:typeof k.imageSizes=="string"?k.imageSizes:void 0,media:typeof k.media=="string"?k.media:void 0})}},El.preloadModule=function(C,k){if(typeof C=="string")if(k){var V=c(k.as,k.crossOrigin);a.d.m(C,{as:typeof k.as=="string"&&k.as!=="script"?k.as:void 0,crossOrigin:V,integrity:typeof k.integrity=="string"?k.integrity:void 0})}else a.d.m(C)},El.requestFormReset=function(C){a.d.r(C)},El.unstable_batchedUpdates=function(C,k){return C(k)},El.useFormState=function(C,k,V){return _.H.useFormState(C,k,V)},El.useFormStatus=function(){return _.H.useHostTransitionStatus()},El.version="19.2.0",El}var c2;function uP(){if(c2)return Hb.exports;c2=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),Hb.exports=lP(),Hb.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h2;function cP(){if(h2)return L_;h2=1;var i=oP(),e=S1(),t=uP();function a(s){var h="https://react.dev/errors/"+s;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)h+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+s+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function d(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function m(s){var h=s,y=s;if(s.alternate)for(;h.return;)h=h.return;else{s=h;do h=s,(h.flags&4098)!==0&&(y=h.return),s=h.return;while(s)}return h.tag===3?y:null}function _(s){if(s.tag===13){var h=s.memoizedState;if(h===null&&(s=s.alternate,s!==null&&(h=s.memoizedState)),h!==null)return h.dehydrated}return null}function c(s){if(s.tag===31){var h=s.memoizedState;if(h===null&&(s=s.alternate,s!==null&&(h=s.memoizedState)),h!==null)return h.dehydrated}return null}function C(s){if(m(s)!==s)throw Error(a(188))}function k(s){var h=s.alternate;if(!h){if(h=m(s),h===null)throw Error(a(188));return h!==s?null:s}for(var y=s,w=h;;){var D=y.return;if(D===null)break;var B=D.alternate;if(B===null){if(w=D.return,w!==null){y=w;continue}break}if(D.child===B.child){for(B=D.child;B;){if(B===y)return C(D),s;if(B===w)return C(D),h;B=B.sibling}throw Error(a(188))}if(y.return!==w.return)y=D,w=B;else{for(var Q=!1,he=D.child;he;){if(he===y){Q=!0,y=D,w=B;break}if(he===w){Q=!0,w=D,y=B;break}he=he.sibling}if(!Q){for(he=B.child;he;){if(he===y){Q=!0,y=B,w=D;break}if(he===w){Q=!0,w=B,y=D;break}he=he.sibling}if(!Q)throw Error(a(189))}}if(y.alternate!==w)throw Error(a(190))}if(y.tag!==3)throw Error(a(188));return y.stateNode.current===y?s:h}function V(s){var h=s.tag;if(h===5||h===26||h===27||h===6)return s;for(s=s.child;s!==null;){if(h=V(s),h!==null)return h;s=s.sibling}return null}var G=Object.assign,ee=Symbol.for("react.element"),Y=Symbol.for("react.transitional.element"),xe=Symbol.for("react.portal"),be=Symbol.for("react.fragment"),Ne=Symbol.for("react.strict_mode"),tt=Symbol.for("react.profiler"),Je=Symbol.for("react.consumer"),Xe=Symbol.for("react.context"),Ke=Symbol.for("react.forward_ref"),Ge=Symbol.for("react.suspense"),Fe=Symbol.for("react.suspense_list"),de=Symbol.for("react.memo"),ce=Symbol.for("react.lazy"),ge=Symbol.for("react.activity"),Ae=Symbol.for("react.memo_cache_sentinel"),Re=Symbol.iterator;function je(s){return s===null||typeof s!="object"?null:(s=Re&&s[Re]||s["@@iterator"],typeof s=="function"?s:null)}var Pe=Symbol.for("react.client.reference");function Mn(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===Pe?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case be:return"Fragment";case tt:return"Profiler";case Ne:return"StrictMode";case Ge:return"Suspense";case Fe:return"SuspenseList";case ge:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case xe:return"Portal";case Xe:return s.displayName||"Context";case Je:return(s._context.displayName||"Context")+".Consumer";case Ke:var h=s.render;return s=s.displayName,s||(s=h.displayName||h.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case de:return h=s.displayName||null,h!==null?h:Mn(s.type)||"Memo";case ce:h=s._payload,s=s._init;try{return Mn(s(h))}catch{}}return null}var ni=Array.isArray,mt=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,At=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,bt={pending:!1,data:null,method:null,action:null},Zt=[],Vt=-1;function ke(s){return{current:s}}function xt(s){0>Vt||(s.current=Zt[Vt],Zt[Vt]=null,Vt--)}function Ot(s,h){Vt++,Zt[Vt]=s.current,s.current=h}var Ut=ke(null),Jt=ke(null),Wt=ke(null),Fn=ke(null);function oi(s,h){switch(Ot(Wt,h),Ot(Jt,s),Ot(Ut,null),h.nodeType){case 9:case 11:s=(s=h.documentElement)&&(s=s.namespaceURI)?gp(s):0;break;default:if(s=h.tagName,h=h.namespaceURI)h=gp(h),s=_p(h,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}xt(Ut),Ot(Ut,s)}function fi(){xt(Ut),xt(Jt),xt(Wt)}function ds(s){s.memoizedState!==null&&Ot(Fn,s);var h=Ut.current,y=_p(h,s.type);h!==y&&(Ot(Jt,s),Ot(Ut,y))}function Ns(s){Jt.current===s&&(xt(Ut),xt(Jt)),Fn.current===s&&(xt(Fn),Qn._currentValue=bt)}var Dr,Fi;function Pi(s){if(Dr===void 0)try{throw Error()}catch(y){var h=y.stack.trim().match(/\n( *(at )?)/);Dr=h&&h[1]||"",Fi=-1<y.stack.indexOf(`
    at`)?" (<anonymous>)":-1<y.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Dr+s+Fi}var Va=!1;function Ta(s,h){if(!s||Va)return"";Va=!0;var y=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var w={DetermineComponentFrameRoot:function(){try{if(h){var Et=function(){throw Error()};if(Object.defineProperty(Et.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Et,[])}catch(yt){var ft=yt}Reflect.construct(s,[],Et)}else{try{Et.call()}catch(yt){ft=yt}s.call(Et.prototype)}}else{try{throw Error()}catch(yt){ft=yt}(Et=s())&&typeof Et.catch=="function"&&Et.catch(function(){})}}catch(yt){if(yt&&ft&&typeof yt.stack=="string")return[yt.stack,ft.stack]}return[null,null]}};w.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var D=Object.getOwnPropertyDescriptor(w.DetermineComponentFrameRoot,"name");D&&D.configurable&&Object.defineProperty(w.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var B=w.DetermineComponentFrameRoot(),Q=B[0],he=B[1];if(Q&&he){var Ue=Q.split(`
`),dt=he.split(`
`);for(D=w=0;w<Ue.length&&!Ue[w].includes("DetermineComponentFrameRoot");)w++;for(;D<dt.length&&!dt[D].includes("DetermineComponentFrameRoot");)D++;if(w===Ue.length||D===dt.length)for(w=Ue.length-1,D=dt.length-1;1<=w&&0<=D&&Ue[w]!==dt[D];)D--;for(;1<=w&&0<=D;w--,D--)if(Ue[w]!==dt[D]){if(w!==1||D!==1)do if(w--,D--,0>D||Ue[w]!==dt[D]){var vt=`
`+Ue[w].replace(" at new "," at ");return s.displayName&&vt.includes("<anonymous>")&&(vt=vt.replace("<anonymous>",s.displayName)),vt}while(1<=w&&0<=D);break}}}finally{Va=!1,Error.prepareStackTrace=y}return(y=s?s.displayName||s.name:"")?Pi(y):""}function Bs(s,h){switch(s.tag){case 26:case 27:case 5:return Pi(s.type);case 16:return Pi("Lazy");case 13:return s.child!==h&&h!==null?Pi("Suspense Fallback"):Pi("Suspense");case 19:return Pi("SuspenseList");case 0:case 15:return Ta(s.type,!1);case 11:return Ta(s.type.render,!1);case 1:return Ta(s.type,!0);case 31:return Pi("Activity");default:return""}}function Sa(s){try{var h="",y=null;do h+=Bs(s,y),y=s,s=s.return;while(s);return h}catch(w){return`
Error generating stack: `+w.message+`
`+w.stack}}var Vi=Object.prototype.hasOwnProperty,pr=i.unstable_scheduleCallback,Ea=i.unstable_cancelCallback,wo=i.unstable_shouldYield,ao=i.unstable_requestPaint,qr=i.unstable_now,fs=i.unstable_getCurrentPriorityLevel,ps=i.unstable_ImmediatePriority,Fs=i.unstable_UserBlockingPriority,ms=i.unstable_NormalPriority,We=i.unstable_LowPriority,se=i.unstable_IdlePriority,le=i.log,fe=i.unstable_setDisableYieldValue,Se=null,De=null;function $e(s){if(typeof le=="function"&&fe(s),De&&typeof De.setStrictMode=="function")try{De.setStrictMode(Se,s)}catch{}}var et=Math.clz32?Math.clz32:Pt,Ze=Math.log,_t=Math.LN2;function Pt(s){return s>>>=0,s===0?32:31-(Ze(s)/_t|0)|0}var wt=256,tn=262144,qe=4194304;function vn(s){var h=s&42;if(h!==0)return h;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Rn(s,h,y){var w=s.pendingLanes;if(w===0)return 0;var D=0,B=s.suspendedLanes,Q=s.pingedLanes;s=s.warmLanes;var he=w&134217727;return he!==0?(w=he&~B,w!==0?D=vn(w):(Q&=he,Q!==0?D=vn(Q):y||(y=he&~s,y!==0&&(D=vn(y))))):(he=w&~B,he!==0?D=vn(he):Q!==0?D=vn(Q):y||(y=w&~s,y!==0&&(D=vn(y)))),D===0?0:h!==0&&h!==D&&(h&B)===0&&(B=D&-D,y=h&-h,B>=y||B===32&&(y&4194048)!==0)?h:D}function nn(s,h){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&h)===0}function Nn(s,h){switch(s){case 1:case 2:case 4:case 8:case 64:return h+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ri(){var s=qe;return qe<<=1,(qe&62914560)===0&&(qe=4194304),s}function Gi(s){for(var h=[],y=0;31>y;y++)h.push(s);return h}function tr(s,h){s.pendingLanes|=h,h!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Ir(s,h,y,w,D,B){var Q=s.pendingLanes;s.pendingLanes=y,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=y,s.entangledLanes&=y,s.errorRecoveryDisabledLanes&=y,s.shellSuspendCounter=0;var he=s.entanglements,Ue=s.expirationTimes,dt=s.hiddenUpdates;for(y=Q&~y;0<y;){var vt=31-et(y),Et=1<<vt;he[vt]=0,Ue[vt]=-1;var ft=dt[vt];if(ft!==null)for(dt[vt]=null,vt=0;vt<ft.length;vt++){var yt=ft[vt];yt!==null&&(yt.lane&=-536870913)}y&=~Et}w!==0&&Vn(s,w,0),B!==0&&D===0&&s.tag!==0&&(s.suspendedLanes|=B&~(Q&~h))}function Vn(s,h,y){s.pendingLanes|=h,s.suspendedLanes&=~h;var w=31-et(h);s.entangledLanes|=h,s.entanglements[w]=s.entanglements[w]|1073741824|y&261930}function Kn(s,h){var y=s.entangledLanes|=h;for(s=s.entanglements;y;){var w=31-et(y),D=1<<w;D&h|s[w]&h&&(s[w]|=h),y&=~D}}function br(s,h){var y=h&-h;return y=(y&42)!==0?1:Rt(y),(y&(s.suspendedLanes|h))!==0?0:y}function Rt(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function en(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function nr(){var s=At.p;return s!==0?s:(s=window.event,s===void 0?32:Oa(s.type))}function ta(s,h){var y=At.p;try{return At.p=s,h()}finally{At.p=y}}var Aa=Math.random().toString(36).slice(2),kt="__reactFiber$"+Aa,yn="__reactProps$"+Aa,In="__reactContainer$"+Aa,ir="__reactEvents$"+Aa,tl="__reactListeners$"+Aa,To="__reactHandles$"+Aa,Bn="__reactResources$"+Aa,Vs="__reactMarker$"+Aa;function Us(s){delete s[kt],delete s[yn],delete s[ir],delete s[tl],delete s[To]}function gs(s){var h=s[kt];if(h)return h;for(var y=s.parentNode;y;){if(h=y[In]||y[kt]){if(y=h.alternate,h.child!==null||y!==null&&y.child!==null)for(s=bp(s);s!==null;){if(y=s[kt])return y;s=bp(s)}return h}s=y,y=s.parentNode}return null}function $r(s){if(s=s[kt]||s[In]){var h=s.tag;if(h===5||h===6||h===13||h===31||h===26||h===27||h===3)return s}return null}function Gr(s){var h=s.tag;if(h===5||h===26||h===27||h===6)return s.stateNode;throw Error(a(33))}function Ei(s){var h=s[Bn];return h||(h=s[Bn]={hoistableStyles:new Map,hoistableScripts:new Map}),h}function Mr(s){s[Vs]=!0}var da=new Set,wi={};function So(s,h){Ua(s,h),Ua(s+"Capture",h)}function Ua(s,h){for(wi[s]=h,s=0;s<h.length;s++)da.add(h[s])}var Eo=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),js={},qs={};function nl(s){return Vi.call(qs,s)?!0:Vi.call(js,s)?!1:Eo.test(s)?qs[s]=!0:(js[s]=!0,!1)}function ii(s,h,y){if(nl(h))if(y===null)s.removeAttribute(h);else{switch(typeof y){case"undefined":case"function":case"symbol":s.removeAttribute(h);return;case"boolean":var w=h.toLowerCase().slice(0,5);if(w!=="data-"&&w!=="aria-"){s.removeAttribute(h);return}}s.setAttribute(h,""+y)}}function hi(s,h,y){if(y===null)s.removeAttribute(h);else{switch(typeof y){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(h);return}s.setAttribute(h,""+y)}}function Zi(s,h,y,w){if(w===null)s.removeAttribute(y);else{switch(typeof w){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(y);return}s.setAttributeNS(h,y,""+w)}}function xr(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function $s(s){var h=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function uu(s,h,y){var w=Object.getOwnPropertyDescriptor(s.constructor.prototype,h);if(!s.hasOwnProperty(h)&&typeof w<"u"&&typeof w.get=="function"&&typeof w.set=="function"){var D=w.get,B=w.set;return Object.defineProperty(s,h,{configurable:!0,get:function(){return D.call(this)},set:function(Q){y=""+Q,B.call(this,Q)}}),Object.defineProperty(s,h,{enumerable:w.enumerable}),{getValue:function(){return y},setValue:function(Q){y=""+Q},stopTracking:function(){s._valueTracker=null,delete s[h]}}}}function on(s){if(!s._valueTracker){var h=$s(s)?"checked":"value";s._valueTracker=uu(s,h,""+s[h])}}function Ui(s){if(!s)return!1;var h=s._valueTracker;if(!h)return!0;var y=h.getValue(),w="";return s&&(w=$s(s)?s.checked?"true":"false":s.value),s=w,s!==y?(h.setValue(s),!0):!1}function Ca(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var so=/[\n"\\]/g;function rr(s){return s.replace(so,function(h){return"\\"+h.charCodeAt(0).toString(16)+" "})}function Ao(s,h,y,w,D,B,Q,he){s.name="",Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"?s.type=Q:s.removeAttribute("type"),h!=null?Q==="number"?(h===0&&s.value===""||s.value!=h)&&(s.value=""+xr(h)):s.value!==""+xr(h)&&(s.value=""+xr(h)):Q!=="submit"&&Q!=="reset"||s.removeAttribute("value"),h!=null?Gs(s,Q,xr(h)):y!=null?Gs(s,Q,xr(y)):w!=null&&s.removeAttribute("value"),D==null&&B!=null&&(s.defaultChecked=!!B),D!=null&&(s.checked=D&&typeof D!="function"&&typeof D!="symbol"),he!=null&&typeof he!="function"&&typeof he!="symbol"&&typeof he!="boolean"?s.name=""+xr(he):s.removeAttribute("name")}function Pl(s,h,y,w,D,B,Q,he){if(B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"&&(s.type=B),h!=null||y!=null){if(!(B!=="submit"&&B!=="reset"||h!=null)){on(s);return}y=y!=null?""+xr(y):"",h=h!=null?""+xr(h):y,he||h===s.value||(s.value=h),s.defaultValue=h}w=w??D,w=typeof w!="function"&&typeof w!="symbol"&&!!w,s.checked=he?s.checked:!!w,s.defaultChecked=!!w,Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"&&(s.name=Q),on(s)}function Gs(s,h,y){h==="number"&&Ca(s.ownerDocument)===s||s.defaultValue===""+y||(s.defaultValue=""+y)}function ar(s,h,y,w){if(s=s.options,h){h={};for(var D=0;D<y.length;D++)h["$"+y[D]]=!0;for(y=0;y<s.length;y++)D=h.hasOwnProperty("$"+s[y].value),s[y].selected!==D&&(s[y].selected=D),D&&w&&(s[y].defaultSelected=!0)}else{for(y=""+xr(y),h=null,D=0;D<s.length;D++){if(s[D].value===y){s[D].selected=!0,w&&(s[D].defaultSelected=!0);return}h!==null||s[D].disabled||(h=s[D])}h!==null&&(h.selected=!0)}}function Qa(s,h,y){if(h!=null&&(h=""+xr(h),h!==s.value&&(s.value=h),y==null)){s.defaultValue!==h&&(s.defaultValue=h);return}s.defaultValue=y!=null?""+xr(y):""}function ja(s,h,y,w){if(h==null){if(w!=null){if(y!=null)throw Error(a(92));if(ni(w)){if(1<w.length)throw Error(a(93));w=w[0]}y=w}y==null&&(y=""),h=y}y=xr(h),s.defaultValue=y,w=s.textContent,w===y&&w!==""&&w!==null&&(s.value=w),on(s)}function Hi(s,h){if(h){var y=s.firstChild;if(y&&y===s.lastChild&&y.nodeType===3){y.nodeValue=h;return}}s.textContent=h}var Un=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ja(s,h,y){var w=h.indexOf("--")===0;y==null||typeof y=="boolean"||y===""?w?s.setProperty(h,""):h==="float"?s.cssFloat="":s[h]="":w?s.setProperty(h,y):typeof y!="number"||y===0||Un.has(h)?h==="float"?s.cssFloat=y:s[h]=(""+y).trim():s[h]=y+"px"}function _s(s,h,y){if(h!=null&&typeof h!="object")throw Error(a(62));if(s=s.style,y!=null){for(var w in y)!y.hasOwnProperty(w)||h!=null&&h.hasOwnProperty(w)||(w.indexOf("--")===0?s.setProperty(w,""):w==="float"?s.cssFloat="":s[w]="");for(var D in h)w=h[D],h.hasOwnProperty(D)&&y[D]!==w&&Ja(s,D,w)}else for(var B in h)h.hasOwnProperty(B)&&Ja(s,B,h[B])}function qa(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zs=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ln=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ys(s){return Ln.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Ia(){}var Rl=null;function Wi(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var mr=null,hn=null;function pi(s){var h=$r(s);if(h&&(s=h.stateNode)){var y=s[yn]||null;e:switch(s=h.stateNode,h.type){case"input":if(Ao(s,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name),h=y.name,y.type==="radio"&&h!=null){for(y=s;y.parentNode;)y=y.parentNode;for(y=y.querySelectorAll('input[name="'+rr(""+h)+'"][type="radio"]'),h=0;h<y.length;h++){var w=y[h];if(w!==s&&w.form===s.form){var D=w[yn]||null;if(!D)throw Error(a(90));Ao(w,D.value,D.defaultValue,D.defaultValue,D.checked,D.defaultChecked,D.type,D.name)}}for(h=0;h<y.length;h++)w=y[h],w.form===s.form&&Ui(w)}break e;case"textarea":Qa(s,y.value,y.defaultValue);break e;case"select":h=y.value,h!=null&&ar(s,!!y.multiple,h,!1)}}}var xn=!1;function il(s,h,y){if(xn)return s(h,y);xn=!0;try{var w=s(h);return w}finally{if(xn=!1,(mr!==null||hn!==null)&&(Ad(),mr&&(h=mr,s=hn,hn=mr=null,pi(h),s)))for(h=0;h<s.length;h++)pi(s[h])}}function sr(s,h){var y=s.stateNode;if(y===null)return null;var w=y[yn]||null;if(w===null)return null;y=w[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(s=s.type,w=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!w;break e;default:s=!1}if(s)return null;if(y&&typeof y!="function")throw Error(a(231,h,typeof y));return y}var cr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wr=!1;if(cr)try{var bn={};Object.defineProperty(bn,"passive",{get:function(){wr=!0}}),window.addEventListener("test",bn,bn),window.removeEventListener("test",bn,bn)}catch{wr=!1}var fa=null,fn=null,sn=null;function na(){if(sn)return sn;var s,h=fn,y=h.length,w,D="value"in fa?fa.value:fa.textContent,B=D.length;for(s=0;s<y&&h[s]===D[s];s++);var Q=y-s;for(w=1;w<=Q&&h[y-w]===D[B-w];w++);return sn=D.slice(s,1<w?1-w:void 0)}function qn(s){var h=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&h===13&&(s=13)):s=h,s===10&&(s=13),32<=s||s===13?s:0}function zr(){return!0}function Yr(){return!1}function or(s){function h(y,w,D,B,Q){this._reactName=y,this._targetInst=D,this.type=w,this.nativeEvent=B,this.target=Q,this.currentTarget=null;for(var he in s)s.hasOwnProperty(he)&&(y=s[he],this[he]=y?y(B):B[he]);return this.isDefaultPrevented=(B.defaultPrevented!=null?B.defaultPrevented:B.returnValue===!1)?zr:Yr,this.isPropagationStopped=Yr,this}return G(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var y=this.nativeEvent;y&&(y.preventDefault?y.preventDefault():typeof y.returnValue!="unknown"&&(y.returnValue=!1),this.isDefaultPrevented=zr)},stopPropagation:function(){var y=this.nativeEvent;y&&(y.stopPropagation?y.stopPropagation():typeof y.cancelBubble!="unknown"&&(y.cancelBubble=!0),this.isPropagationStopped=zr)},persist:function(){},isPersistent:zr}),h}var vs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},oo=or(vs),bs=G({},vs,{view:0,detail:0}),Wn=or(bs),Co,ia,Ma,Pa=G({},bs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lo,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ma&&(Ma&&s.type==="mousemove"?(Co=s.screenX-Ma.screenX,ia=s.screenY-Ma.screenY):ia=Co=0,Ma=s),Co)},movementY:function(s){return"movementY"in s?s.movementY:ia}}),Or=or(Pa),xs=G({},Pa,{dataTransfer:0}),$l=or(xs),Io=G({},bs,{relatedTarget:0}),Xi=or(Io),Vu=G({},vs,{animationName:0,elapsedTime:0,pseudoElement:0}),rl=or(Vu),Gl=G({},vs,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Hs=or(Gl),Ll=G({},vs,{data:0}),lr=or(Ll),es={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ws={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kl={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function al(s){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(s):(s=kl[s])?!!h[s]:!1}function lo(){return al}var Ai=G({},bs,{key:function(s){if(s.key){var h=es[s.key]||s.key;if(h!=="Unidentified")return h}return s.type==="keypress"?(s=qn(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?ws[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lo,charCode:function(s){return s.type==="keypress"?qn(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?qn(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Uu=or(Ai),cu=G({},Pa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Dl=or(cu),P=G({},bs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lo}),Z=or(P),ne=G({},vs,{propertyName:0,elapsedTime:0,pseudoElement:0}),ye=or(ne),at=G({},Pa,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ht=or(at),Xt=G({},vs,{newState:0,oldState:0}),kn=or(Xt),Xn=[9,13,27,32],Ti=cr&&"CompositionEvent"in window,Ki=null;cr&&"documentMode"in document&&(Ki=document.documentMode);var $a=cr&&"TextEvent"in window&&!Ki,Ga=cr&&(!Ti||Ki&&8<Ki&&11>=Ki),Ws=" ",Ts=!1;function hu(s,h){switch(s){case"keyup":return Xn.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xs(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var du=!1;function Ks(s,h){switch(s){case"compositionend":return Xs(h);case"keypress":return h.which!==32?null:(Ts=!0,Ws);case"textInput":return s=h.data,s===Ws&&Ts?null:s;default:return null}}function ju(s,h){if(du)return s==="compositionend"||!Ti&&hu(s,h)?(s=na(),sn=fn=fa=null,du=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return Ga&&h.locale!=="ko"?null:h.data;default:return null}}var Hd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function uo(s){var h=s&&s.nodeName&&s.nodeName.toLowerCase();return h==="input"?!!Hd[s.type]:h==="textarea"}function Jh(s,h,y,w){mr?hn?hn.push(w):hn=[w]:mr=w,h=mp(h,"onChange"),0<h.length&&(y=new oo("onChange","change",null,y,w),s.push({event:y,listeners:h}))}var Ys=null,qu=null;function $u(s){Mm(s,0)}function Mo(s){var h=Gr(s);if(Ui(h))return s}function fu(s,h){if(s==="change")return h}var hh=!1;if(cr){var Ss;if(cr){var Gu="oninput"in document;if(!Gu){var Zu=document.createElement("div");Zu.setAttribute("oninput","return;"),Gu=typeof Zu.oninput=="function"}Ss=Gu}else Ss=!1;hh=Ss&&(!document.documentMode||9<document.documentMode)}function Lc(){Ys&&(Ys.detachEvent("onpropertychange",Wd),qu=Ys=null)}function Wd(s){if(s.propertyName==="value"&&Mo(qu)){var h=[];Jh(h,qu,s,Wi(s)),il($u,h)}}function sl(s,h,y){s==="focusin"?(Lc(),Ys=h,qu=y,Ys.attachEvent("onpropertychange",Wd)):s==="focusout"&&Lc()}function Xd(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Mo(qu)}function Zl(s,h){if(s==="click")return Mo(h)}function ed(s,h){if(s==="input"||s==="change")return Mo(h)}function ol(s,h){return s===h&&(s!==0||1/s===1/h)||s!==s&&h!==h}var ra=typeof Object.is=="function"?Object.is:ol;function Es(s,h){if(ra(s,h))return!0;if(typeof s!="object"||s===null||typeof h!="object"||h===null)return!1;var y=Object.keys(s),w=Object.keys(h);if(y.length!==w.length)return!1;for(w=0;w<y.length;w++){var D=y[w];if(!Vi.call(h,D)||!ra(s[D],h[D]))return!1}return!0}function li(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function pu(s,h){var y=li(s);s=0;for(var w;y;){if(y.nodeType===3){if(w=s+y.textContent.length,s<=h&&w>=h)return{node:y,offset:h-s};s=w}e:{for(;y;){if(y.nextSibling){y=y.nextSibling;break e}y=y.parentNode}y=void 0}y=li(y)}}function Hu(s,h){return s&&h?s===h?!0:s&&s.nodeType===3?!1:h&&h.nodeType===3?Hu(s,h.parentNode):"contains"in s?s.contains(h):s.compareDocumentPosition?!!(s.compareDocumentPosition(h)&16):!1:!1}function Wu(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var h=Ca(s.document);h instanceof s.HTMLIFrameElement;){try{var y=typeof h.contentWindow.location.href=="string"}catch{y=!1}if(y)s=h.contentWindow;else break;h=Ca(s.document)}return h}function ll(s){var h=s&&s.nodeName&&s.nodeName.toLowerCase();return h&&(h==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||h==="textarea"||s.contentEditable==="true")}var ul=cr&&"documentMode"in document&&11>=document.documentMode,cl=null,dh=null,kc=null,Xu=!1;function Kd(s,h,y){var w=y.window===y?y.document:y.nodeType===9?y:y.ownerDocument;Xu||cl==null||cl!==Ca(w)||(w=cl,"selectionStart"in w&&ll(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),kc&&Es(kc,w)||(kc=w,w=mp(dh,"onSelect"),0<w.length&&(h=new oo("onSelect","select",null,h,y),s.push({event:h,listeners:w}),h.target=cl)))}function zl(s,h){var y={};return y[s.toLowerCase()]=h.toLowerCase(),y["Webkit"+s]="webkit"+h,y["Moz"+s]="moz"+h,y}var Ku={animationend:zl("Animation","AnimationEnd"),animationiteration:zl("Animation","AnimationIteration"),animationstart:zl("Animation","AnimationStart"),transitionrun:zl("Transition","TransitionRun"),transitionstart:zl("Transition","TransitionStart"),transitioncancel:zl("Transition","TransitionCancel"),transitionend:zl("Transition","TransitionEnd")},Dc={},zc={};cr&&(zc=document.createElement("div").style,"AnimationEvent"in window||(delete Ku.animationend.animation,delete Ku.animationiteration.animation,delete Ku.animationstart.animation),"TransitionEvent"in window||delete Ku.transitionend.transition);function aa(s){if(Dc[s])return Dc[s];if(!Ku[s])return s;var h=Ku[s],y;for(y in h)if(h.hasOwnProperty(y)&&y in zc)return Dc[s]=h[y];return s}var Hl=aa("animationend"),fh=aa("animationiteration"),Po=aa("animationstart"),Oc=aa("transitionrun"),mu=aa("transitionstart"),co=aa("transitioncancel"),gu=aa("transitionend"),td=new Map,hl="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");hl.push("scrollEnd");function pa(s,h){td.set(s,h),So(h,[s])}var Wl=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var h=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(h))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},ts=[],ma=0,_u=0;function Yu(){for(var s=ma,h=_u=ma=0;h<s;){var y=ts[h];ts[h++]=null;var w=ts[h];ts[h++]=null;var D=ts[h];ts[h++]=null;var B=ts[h];if(ts[h++]=null,w!==null&&D!==null){var Q=w.pending;Q===null?D.next=D:(D.next=Q.next,Q.next=D),w.pending=D}B!==0&&Xl(y,D,B)}}function Qs(s,h,y,w){ts[ma++]=s,ts[ma++]=h,ts[ma++]=y,ts[ma++]=w,_u|=w,s.lanes|=w,s=s.alternate,s!==null&&(s.lanes|=w)}function dl(s,h,y,w){return Qs(s,h,y,w),$n(s)}function Ro(s,h){return Qs(s,null,null,h),$n(s)}function Xl(s,h,y){s.lanes|=y;var w=s.alternate;w!==null&&(w.lanes|=y);for(var D=!1,B=s.return;B!==null;)B.childLanes|=y,w=B.alternate,w!==null&&(w.childLanes|=y),B.tag===22&&(s=B.stateNode,s===null||s._visibility&1||(D=!0)),s=B,B=B.return;return s.tag===3?(B=s.stateNode,D&&h!==null&&(D=31-et(y),s=B.hiddenUpdates,w=s[D],w===null?s[D]=[h]:w.push(h),h.lane=y|536870912),B):null}function $n(s){if(50<up)throw up=0,l_=null,Error(a(185));for(var h=s.return;h!==null;)s=h,h=s.return;return s.tag===3?s.stateNode:null}var Lo={};function Gf(s,h,y,w){this.tag=s,this.key=y,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ns(s,h,y,w){return new Gf(s,h,y,w)}function ko(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Do(s,h){var y=s.alternate;return y===null?(y=ns(s.tag,h,s.key,s.mode),y.elementType=s.elementType,y.type=s.type,y.stateNode=s.stateNode,y.alternate=s,s.alternate=y):(y.pendingProps=h,y.type=s.type,y.flags=0,y.subtreeFlags=0,y.deletions=null),y.flags=s.flags&65011712,y.childLanes=s.childLanes,y.lanes=s.lanes,y.child=s.child,y.memoizedProps=s.memoizedProps,y.memoizedState=s.memoizedState,y.updateQueue=s.updateQueue,h=s.dependencies,y.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},y.sibling=s.sibling,y.index=s.index,y.ref=s.ref,y.refCleanup=s.refCleanup,y}function nd(s,h){s.flags&=65011714;var y=s.alternate;return y===null?(s.childLanes=0,s.lanes=h,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=y.childLanes,s.lanes=y.lanes,s.child=y.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=y.memoizedProps,s.memoizedState=y.memoizedState,s.updateQueue=y.updateQueue,s.type=y.type,h=y.dependencies,s.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),s}function Qu(s,h,y,w,D,B){var Q=0;if(w=s,typeof s=="function")ko(s)&&(Q=1);else if(typeof s=="string")Q=Gt(s,y,Ut.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case ge:return s=ns(31,y,h,D),s.elementType=ge,s.lanes=B,s;case be:return yu(y.children,D,B,h);case Ne:Q=8,D|=24;break;case tt:return s=ns(12,y,h,D|2),s.elementType=tt,s.lanes=B,s;case Ge:return s=ns(13,y,h,D),s.elementType=Ge,s.lanes=B,s;case Fe:return s=ns(19,y,h,D),s.elementType=Fe,s.lanes=B,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case Xe:Q=10;break e;case Je:Q=9;break e;case Ke:Q=11;break e;case de:Q=14;break e;case ce:Q=16,w=null;break e}Q=29,y=Error(a(130,s===null?"null":typeof s,"")),w=null}return h=ns(Q,y,h,D),h.elementType=s,h.type=w,h.lanes=B,h}function yu(s,h,y,w){return s=ns(7,s,w,h),s.lanes=y,s}function Ju(s,h,y){return s=ns(6,s,null,h),s.lanes=y,s}function ec(s){var h=ns(18,null,null,0);return h.stateNode=s,h}function vu(s,h,y){return h=ns(4,s.children!==null?s.children:[],s.key,h),h.lanes=y,h.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},h}var f=new WeakMap;function x(s,h){if(typeof s=="object"&&s!==null){var y=f.get(s);return y!==void 0?y:(h={value:s,source:h,stack:Sa(h)},f.set(s,h),h)}return{value:s,source:h,stack:Sa(h)}}var R=[],U=0,K=null,ue=0,Oe=[],nt=0,ut=null,Mt=1,Kt="";function pn(s,h){R[U++]=ue,R[U++]=K,K=s,ue=h}function Yn(s,h,y){Oe[nt++]=Mt,Oe[nt++]=Kt,Oe[nt++]=ut,ut=s;var w=Mt;s=Kt;var D=32-et(w)-1;w&=~(1<<D),y+=1;var B=32-et(h)+D;if(30<B){var Q=D-D%5;B=(w&(1<<Q)-1).toString(32),w>>=Q,D-=Q,Mt=1<<32-et(h)+D|y<<D|w,Kt=B+s}else Mt=1<<B|y<<D|w,Kt=s}function ga(s){s.return!==null&&(pn(s,1),Yn(s,1,0))}function Zr(s){for(;s===K;)K=R[--U],R[U]=null,ue=R[--U],R[U]=null;for(;s===ut;)ut=Oe[--nt],Oe[nt]=null,Kt=Oe[--nt],Oe[nt]=null,Mt=Oe[--nt],Oe[nt]=null}function Za(s,h){Oe[nt++]=Mt,Oe[nt++]=Kt,Oe[nt++]=ut,Mt=h.id,Kt=h.overflow,ut=s}var Si=null,Li=null,ui=!1,ki=null,Hr=!1,is=Error(a(519));function zo(s){var h=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw xu(x(h,s)),is}function bu(s){var h=s.stateNode,y=s.type,w=s.memoizedProps;switch(h[kt]=s,h[yn]=w,y){case"dialog":yi("cancel",h),yi("close",h);break;case"iframe":case"object":case"embed":yi("load",h);break;case"video":case"audio":for(y=0;y<Yc.length;y++)yi(Yc[y],h);break;case"source":yi("error",h);break;case"img":case"image":case"link":yi("error",h),yi("load",h);break;case"details":yi("toggle",h);break;case"input":yi("invalid",h),Pl(h,w.value,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name,!0);break;case"select":yi("invalid",h);break;case"textarea":yi("invalid",h),ja(h,w.value,w.defaultValue,w.children)}y=w.children,typeof y!="string"&&typeof y!="number"&&typeof y!="bigint"||h.textContent===""+y||w.suppressHydrationWarning===!0||S_(h.textContent,y)?(w.popover!=null&&(yi("beforetoggle",h),yi("toggle",h)),w.onScroll!=null&&yi("scroll",h),w.onScrollEnd!=null&&yi("scrollend",h),w.onClick!=null&&(h.onclick=Ia),h=!0):h=!1,h||zo(s,!0)}function Nr(s){for(Si=s.return;Si;)switch(Si.tag){case 5:case 31:case 13:Hr=!1;return;case 27:case 3:Hr=!0;return;default:Si=Si.return}}function rs(s){if(s!==Si)return!1;if(!ui)return Nr(s),ui=!0,!1;var h=s.tag,y;if((y=h!==3&&h!==27)&&((y=h===5)&&(y=s.type,y=!(y!=="form"&&y!=="button")||A_(s.type,s.memoizedProps)),y=!y),y&&Li&&zo(s),Nr(s),h===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(a(317));Li=Bm(s)}else if(h===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(a(317));Li=Bm(s)}else h===27?(h=Li,bc(s.type)?(s=Nm,Nm=null,Li=s):Li=h):Li=Si?xl(s.stateNode.nextSibling):null;return!0}function fl(){Li=Si=null,ui=!1}function Oo(){var s=ki;return s!==null&&(Zo===null?Zo=s:Zo.push.apply(Zo,s),ki=null),s}function xu(s){ki===null?ki=[s]:ki.push(s)}var tc=ke(null),Ol=null,pl=null;function wu(s,h,y){Ot(tc,h._currentValue),h._currentValue=y}function Kl(s){s._currentValue=tc.current,xt(tc)}function No(s,h,y){for(;s!==null;){var w=s.alternate;if((s.childLanes&h)!==h?(s.childLanes|=h,w!==null&&(w.childLanes|=h)):w!==null&&(w.childLanes&h)!==h&&(w.childLanes|=h),s===y)break;s=s.return}}function nc(s,h,y,w){var D=s.child;for(D!==null&&(D.return=s);D!==null;){var B=D.dependencies;if(B!==null){var Q=D.child;B=B.firstContext;e:for(;B!==null;){var he=B;B=D;for(var Ue=0;Ue<h.length;Ue++)if(he.context===h[Ue]){B.lanes|=y,he=B.alternate,he!==null&&(he.lanes|=y),No(B.return,y,s),w||(Q=null);break e}B=he.next}}else if(D.tag===18){if(Q=D.return,Q===null)throw Error(a(341));Q.lanes|=y,B=Q.alternate,B!==null&&(B.lanes|=y),No(Q,y,s),Q=null}else Q=D.child;if(Q!==null)Q.return=D;else for(Q=D;Q!==null;){if(Q===s){Q=null;break}if(D=Q.sibling,D!==null){D.return=Q.return,Q=D;break}Q=Q.return}D=Q}}function Ra(s,h,y,w){s=null;for(var D=h,B=!1;D!==null;){if(!B){if((D.flags&524288)!==0)B=!0;else if((D.flags&262144)!==0)break}if(D.tag===10){var Q=D.alternate;if(Q===null)throw Error(a(387));if(Q=Q.memoizedProps,Q!==null){var he=D.type;ra(D.pendingProps.value,Q.value)||(s!==null?s.push(he):s=[he])}}else if(D===Fn.current){if(Q=D.alternate,Q===null)throw Error(a(387));Q.memoizedState.memoizedState!==D.memoizedState.memoizedState&&(s!==null?s.push(Qn):s=[Qn])}D=D.return}s!==null&&nc(h,s,y,w),h.flags|=262144}function Tu(s){for(s=s.firstContext;s!==null;){if(!ra(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Su(s){Ol=s,pl=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Ha(s){return Nc(Ol,s)}function id(s,h){return Ol===null&&Su(s),Nc(s,h)}function Nc(s,h){var y=h._currentValue;if(h={context:h,memoizedValue:y,next:null},pl===null){if(s===null)throw Error(a(308));pl=h,s.dependencies={lanes:0,firstContext:h},s.flags|=524288}else pl=pl.next=h;return y}var Zf=typeof AbortController<"u"?AbortController:function(){var s=[],h=this.signal={aborted:!1,addEventListener:function(y,w){s.push(w)}};this.abort=function(){h.aborted=!0,s.forEach(function(y){return y()})}},ph=i.unstable_scheduleCallback,rm=i.unstable_NormalPriority,Ci={$$typeof:Xe,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Bo(){return{controller:new Zf,data:new Map,refCount:0}}function Yl(s){s.refCount--,s.refCount===0&&ph(rm,function(){s.controller.abort()})}var Js=null,ic=0,mh=0,Ql=null;function Rg(s,h){if(Js===null){var y=Js=[];ic=0,mh=vc(),Ql={status:"pending",value:void 0,then:function(w){y.push(w)}}}return ic++,h.then(am,am),h}function am(){if(--ic===0&&Js!==null){Ql!==null&&(Ql.status="fulfilled");var s=Js;Js=null,mh=0,Ql=null;for(var h=0;h<s.length;h++)(0,s[h])()}}function rd(s,h){var y=[],w={status:"pending",value:null,reason:null,then:function(D){y.push(D)}};return s.then(function(){w.status="fulfilled",w.value=h;for(var D=0;D<y.length;D++)(0,y[D])(h)},function(D){for(w.status="rejected",w.reason=D,D=0;D<y.length;D++)(0,y[D])(void 0)}),w}var gh=mt.S;mt.S=function(s,h){Ed=qr(),typeof h=="object"&&h!==null&&typeof h.then=="function"&&Rg(s,h),gh!==null&&gh(s,h)};var as=ke(null);function Yt(){var s=as.current;return s!==null?s:Sr.pooledCache}function _h(s,h){h===null?Ot(as,as.current):Ot(as,h.pool)}function ad(){var s=Yt();return s===null?null:{parent:Ci._currentValue,pool:s}}var rc=Error(a(460)),ac=Error(a(474)),Jl=Error(a(542)),Bc={then:function(){}};function ri(s){return s=s.status,s==="fulfilled"||s==="rejected"}function sd(s,h,y){switch(y=s[y],y===void 0?s.push(h):y!==h&&(h.then(Ia,Ia),h=y),h.status){case"fulfilled":return h.value;case"rejected":throw s=h.reason,Hf(s),s;default:if(typeof h.status=="string")h.then(Ia,Ia);else{if(s=Sr,s!==null&&100<s.shellSuspendCounter)throw Error(a(482));s=h,s.status="pending",s.then(function(w){if(h.status==="pending"){var D=h;D.status="fulfilled",D.value=w}},function(w){if(h.status==="pending"){var D=h;D.status="rejected",D.reason=w}})}switch(h.status){case"fulfilled":return h.value;case"rejected":throw s=h.reason,Hf(s),s}throw eu=h,rc}}function Fc(s){try{var h=s._init;return h(s._payload)}catch(y){throw y!==null&&typeof y=="object"&&typeof y.then=="function"?(eu=y,rc):y}}var eu=null;function sm(){if(eu===null)throw Error(a(459));var s=eu;return eu=null,s}function Hf(s){if(s===rc||s===Jl)throw Error(a(483))}var sc=null,Vc=0;function od(s){var h=Vc;return Vc+=1,sc===null&&(sc=[]),sd(sc,s,h)}function yh(s,h){h=h.props.ref,s.ref=h!==void 0?h:null}function vh(s,h){throw h.$$typeof===ee?Error(a(525)):(s=Object.prototype.toString.call(h),Error(a(31,s==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":s)))}function Wf(s){function h(it,Qe){if(s){var pt=it.deletions;pt===null?(it.deletions=[Qe],it.flags|=16):pt.push(Qe)}}function y(it,Qe){if(!s)return null;for(;Qe!==null;)h(it,Qe),Qe=Qe.sibling;return null}function w(it){for(var Qe=new Map;it!==null;)it.key!==null?Qe.set(it.key,it):Qe.set(it.index,it),it=it.sibling;return Qe}function D(it,Qe){return it=Do(it,Qe),it.index=0,it.sibling=null,it}function B(it,Qe,pt){return it.index=pt,s?(pt=it.alternate,pt!==null?(pt=pt.index,pt<Qe?(it.flags|=67108866,Qe):pt):(it.flags|=67108866,Qe)):(it.flags|=1048576,Qe)}function Q(it){return s&&it.alternate===null&&(it.flags|=67108866),it}function he(it,Qe,pt,Lt){return Qe===null||Qe.tag!==6?(Qe=Ju(pt,it.mode,Lt),Qe.return=it,Qe):(Qe=D(Qe,pt),Qe.return=it,Qe)}function Ue(it,Qe,pt,Lt){var Dn=pt.type;return Dn===be?vt(it,Qe,pt.props.children,Lt,pt.key):Qe!==null&&(Qe.elementType===Dn||typeof Dn=="object"&&Dn!==null&&Dn.$$typeof===ce&&Fc(Dn)===Qe.type)?(Qe=D(Qe,pt.props),yh(Qe,pt),Qe.return=it,Qe):(Qe=Qu(pt.type,pt.key,pt.props,null,it.mode,Lt),yh(Qe,pt),Qe.return=it,Qe)}function dt(it,Qe,pt,Lt){return Qe===null||Qe.tag!==4||Qe.stateNode.containerInfo!==pt.containerInfo||Qe.stateNode.implementation!==pt.implementation?(Qe=vu(pt,it.mode,Lt),Qe.return=it,Qe):(Qe=D(Qe,pt.children||[]),Qe.return=it,Qe)}function vt(it,Qe,pt,Lt,Dn){return Qe===null||Qe.tag!==7?(Qe=yu(pt,it.mode,Lt,Dn),Qe.return=it,Qe):(Qe=D(Qe,pt),Qe.return=it,Qe)}function Et(it,Qe,pt){if(typeof Qe=="string"&&Qe!==""||typeof Qe=="number"||typeof Qe=="bigint")return Qe=Ju(""+Qe,it.mode,pt),Qe.return=it,Qe;if(typeof Qe=="object"&&Qe!==null){switch(Qe.$$typeof){case Y:return pt=Qu(Qe.type,Qe.key,Qe.props,null,it.mode,pt),yh(pt,Qe),pt.return=it,pt;case xe:return Qe=vu(Qe,it.mode,pt),Qe.return=it,Qe;case ce:return Qe=Fc(Qe),Et(it,Qe,pt)}if(ni(Qe)||je(Qe))return Qe=yu(Qe,it.mode,pt,null),Qe.return=it,Qe;if(typeof Qe.then=="function")return Et(it,od(Qe),pt);if(Qe.$$typeof===Xe)return Et(it,id(it,Qe),pt);vh(it,Qe)}return null}function ft(it,Qe,pt,Lt){var Dn=Qe!==null?Qe.key:null;if(typeof pt=="string"&&pt!==""||typeof pt=="number"||typeof pt=="bigint")return Dn!==null?null:he(it,Qe,""+pt,Lt);if(typeof pt=="object"&&pt!==null){switch(pt.$$typeof){case Y:return pt.key===Dn?Ue(it,Qe,pt,Lt):null;case xe:return pt.key===Dn?dt(it,Qe,pt,Lt):null;case ce:return pt=Fc(pt),ft(it,Qe,pt,Lt)}if(ni(pt)||je(pt))return Dn!==null?null:vt(it,Qe,pt,Lt,null);if(typeof pt.then=="function")return ft(it,Qe,od(pt),Lt);if(pt.$$typeof===Xe)return ft(it,Qe,id(it,pt),Lt);vh(it,pt)}return null}function yt(it,Qe,pt,Lt,Dn){if(typeof Lt=="string"&&Lt!==""||typeof Lt=="number"||typeof Lt=="bigint")return it=it.get(pt)||null,he(Qe,it,""+Lt,Dn);if(typeof Lt=="object"&&Lt!==null){switch(Lt.$$typeof){case Y:return it=it.get(Lt.key===null?pt:Lt.key)||null,Ue(Qe,it,Lt,Dn);case xe:return it=it.get(Lt.key===null?pt:Lt.key)||null,dt(Qe,it,Lt,Dn);case ce:return Lt=Fc(Lt),yt(it,Qe,pt,Lt,Dn)}if(ni(Lt)||je(Lt))return it=it.get(pt)||null,vt(Qe,it,Lt,Dn,null);if(typeof Lt.then=="function")return yt(it,Qe,pt,od(Lt),Dn);if(Lt.$$typeof===Xe)return yt(it,Qe,pt,id(Qe,Lt),Dn);vh(Qe,Lt)}return null}function cn(it,Qe,pt,Lt){for(var Dn=null,dr=null,Cn=Qe,mi=Qe=0,zi=null;Cn!==null&&mi<pt.length;mi++){Cn.index>mi?(zi=Cn,Cn=null):zi=Cn.sibling;var fr=ft(it,Cn,pt[mi],Lt);if(fr===null){Cn===null&&(Cn=zi);break}s&&Cn&&fr.alternate===null&&h(it,Cn),Qe=B(fr,Qe,mi),dr===null?Dn=fr:dr.sibling=fr,dr=fr,Cn=zi}if(mi===pt.length)return y(it,Cn),ui&&pn(it,mi),Dn;if(Cn===null){for(;mi<pt.length;mi++)Cn=Et(it,pt[mi],Lt),Cn!==null&&(Qe=B(Cn,Qe,mi),dr===null?Dn=Cn:dr.sibling=Cn,dr=Cn);return ui&&pn(it,mi),Dn}for(Cn=w(Cn);mi<pt.length;mi++)zi=yt(Cn,it,mi,pt[mi],Lt),zi!==null&&(s&&zi.alternate!==null&&Cn.delete(zi.key===null?mi:zi.key),Qe=B(zi,Qe,mi),dr===null?Dn=zi:dr.sibling=zi,dr=zi);return s&&Cn.forEach(function(xf){return h(it,xf)}),ui&&pn(it,mi),Dn}function En(it,Qe,pt,Lt){if(pt==null)throw Error(a(151));for(var Dn=null,dr=null,Cn=Qe,mi=Qe=0,zi=null,fr=pt.next();Cn!==null&&!fr.done;mi++,fr=pt.next()){Cn.index>mi?(zi=Cn,Cn=null):zi=Cn.sibling;var xf=ft(it,Cn,fr.value,Lt);if(xf===null){Cn===null&&(Cn=zi);break}s&&Cn&&xf.alternate===null&&h(it,Cn),Qe=B(xf,Qe,mi),dr===null?Dn=xf:dr.sibling=xf,dr=xf,Cn=zi}if(fr.done)return y(it,Cn),ui&&pn(it,mi),Dn;if(Cn===null){for(;!fr.done;mi++,fr=pt.next())fr=Et(it,fr.value,Lt),fr!==null&&(Qe=B(fr,Qe,mi),dr===null?Dn=fr:dr.sibling=fr,dr=fr);return ui&&pn(it,mi),Dn}for(Cn=w(Cn);!fr.done;mi++,fr=pt.next())fr=yt(Cn,it,mi,fr.value,Lt),fr!==null&&(s&&fr.alternate!==null&&Cn.delete(fr.key===null?mi:fr.key),Qe=B(fr,Qe,mi),dr===null?Dn=fr:dr.sibling=fr,dr=fr);return s&&Cn.forEach(function(tP){return h(it,tP)}),ui&&pn(it,mi),Dn}function jr(it,Qe,pt,Lt){if(typeof pt=="object"&&pt!==null&&pt.type===be&&pt.key===null&&(pt=pt.props.children),typeof pt=="object"&&pt!==null){switch(pt.$$typeof){case Y:e:{for(var Dn=pt.key;Qe!==null;){if(Qe.key===Dn){if(Dn=pt.type,Dn===be){if(Qe.tag===7){y(it,Qe.sibling),Lt=D(Qe,pt.props.children),Lt.return=it,it=Lt;break e}}else if(Qe.elementType===Dn||typeof Dn=="object"&&Dn!==null&&Dn.$$typeof===ce&&Fc(Dn)===Qe.type){y(it,Qe.sibling),Lt=D(Qe,pt.props),yh(Lt,pt),Lt.return=it,it=Lt;break e}y(it,Qe);break}else h(it,Qe);Qe=Qe.sibling}pt.type===be?(Lt=yu(pt.props.children,it.mode,Lt,pt.key),Lt.return=it,it=Lt):(Lt=Qu(pt.type,pt.key,pt.props,null,it.mode,Lt),yh(Lt,pt),Lt.return=it,it=Lt)}return Q(it);case xe:e:{for(Dn=pt.key;Qe!==null;){if(Qe.key===Dn)if(Qe.tag===4&&Qe.stateNode.containerInfo===pt.containerInfo&&Qe.stateNode.implementation===pt.implementation){y(it,Qe.sibling),Lt=D(Qe,pt.children||[]),Lt.return=it,it=Lt;break e}else{y(it,Qe);break}else h(it,Qe);Qe=Qe.sibling}Lt=vu(pt,it.mode,Lt),Lt.return=it,it=Lt}return Q(it);case ce:return pt=Fc(pt),jr(it,Qe,pt,Lt)}if(ni(pt))return cn(it,Qe,pt,Lt);if(je(pt)){if(Dn=je(pt),typeof Dn!="function")throw Error(a(150));return pt=Dn.call(pt),En(it,Qe,pt,Lt)}if(typeof pt.then=="function")return jr(it,Qe,od(pt),Lt);if(pt.$$typeof===Xe)return jr(it,Qe,id(it,pt),Lt);vh(it,pt)}return typeof pt=="string"&&pt!==""||typeof pt=="number"||typeof pt=="bigint"?(pt=""+pt,Qe!==null&&Qe.tag===6?(y(it,Qe.sibling),Lt=D(Qe,pt),Lt.return=it,it=Lt):(y(it,Qe),Lt=Ju(pt,it.mode,Lt),Lt.return=it,it=Lt),Q(it)):y(it,Qe)}return function(it,Qe,pt,Lt){try{Vc=0;var Dn=jr(it,Qe,pt,Lt);return sc=null,Dn}catch(Cn){if(Cn===rc||Cn===Jl)throw Cn;var dr=ns(29,Cn,null,it.mode);return dr.lanes=Lt,dr.return=it,dr}finally{}}}var oc=Wf(!0),ml=Wf(!1),Di=!1;function lc(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ld(s,h){s=s.updateQueue,h.updateQueue===s&&(h.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Eu(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function tu(s,h,y){var w=s.updateQueue;if(w===null)return null;if(w=w.shared,($i&2)!==0){var D=w.pending;return D===null?h.next=h:(h.next=D.next,D.next=h),w.pending=h,h=$n(s),Xl(s,null,y),h}return Qs(s,w,h,y),$n(s)}function Uc(s,h,y){if(h=h.updateQueue,h!==null&&(h=h.shared,(y&4194048)!==0)){var w=h.lanes;w&=s.pendingLanes,y|=w,h.lanes=y,Kn(s,y)}}function Yd(s,h){var y=s.updateQueue,w=s.alternate;if(w!==null&&(w=w.updateQueue,y===w)){var D=null,B=null;if(y=y.firstBaseUpdate,y!==null){do{var Q={lane:y.lane,tag:y.tag,payload:y.payload,callback:null,next:null};B===null?D=B=Q:B=B.next=Q,y=y.next}while(y!==null);B===null?D=B=h:B=B.next=h}else D=B=h;y={baseState:w.baseState,firstBaseUpdate:D,lastBaseUpdate:B,shared:w.shared,callbacks:w.callbacks},s.updateQueue=y;return}s=y.lastBaseUpdate,s===null?y.firstBaseUpdate=h:s.next=h,y.lastBaseUpdate=h}var gl=!1;function uc(){if(gl){var s=Ql;if(s!==null)throw s}}function an(s,h,y,w){gl=!1;var D=s.updateQueue;Di=!1;var B=D.firstBaseUpdate,Q=D.lastBaseUpdate,he=D.shared.pending;if(he!==null){D.shared.pending=null;var Ue=he,dt=Ue.next;Ue.next=null,Q===null?B=dt:Q.next=dt,Q=Ue;var vt=s.alternate;vt!==null&&(vt=vt.updateQueue,he=vt.lastBaseUpdate,he!==Q&&(he===null?vt.firstBaseUpdate=dt:he.next=dt,vt.lastBaseUpdate=Ue))}if(B!==null){var Et=D.baseState;Q=0,vt=dt=Ue=null,he=B;do{var ft=he.lane&-536870913,yt=ft!==he.lane;if(yt?(xi&ft)===ft:(w&ft)===ft){ft!==0&&ft===mh&&(gl=!0),vt!==null&&(vt=vt.next={lane:0,tag:he.tag,payload:he.payload,callback:null,next:null});e:{var cn=s,En=he;ft=h;var jr=y;switch(En.tag){case 1:if(cn=En.payload,typeof cn=="function"){Et=cn.call(jr,Et,ft);break e}Et=cn;break e;case 3:cn.flags=cn.flags&-65537|128;case 0:if(cn=En.payload,ft=typeof cn=="function"?cn.call(jr,Et,ft):cn,ft==null)break e;Et=G({},Et,ft);break e;case 2:Di=!0}}ft=he.callback,ft!==null&&(s.flags|=64,yt&&(s.flags|=8192),yt=D.callbacks,yt===null?D.callbacks=[ft]:yt.push(ft))}else yt={lane:ft,tag:he.tag,payload:he.payload,callback:he.callback,next:null},vt===null?(dt=vt=yt,Ue=Et):vt=vt.next=yt,Q|=ft;if(he=he.next,he===null){if(he=D.shared.pending,he===null)break;yt=he,he=yt.next,yt.next=null,D.lastBaseUpdate=yt,D.shared.pending=null}}while(!0);vt===null&&(Ue=Et),D.baseState=Ue,D.firstBaseUpdate=dt,D.lastBaseUpdate=vt,B===null&&(D.shared.lanes=0),Hc|=Q,s.lanes=Q,s.memoizedState=Et}}function Tn(s,h){if(typeof s!="function")throw Error(a(191,s));s.call(h)}function ud(s,h){var y=s.callbacks;if(y!==null)for(s.callbacks=null,s=0;s<y.length;s++)Tn(y[s],h)}var Fo=ke(null),jc=ke(0);function As(s,h){s=Zc,Ot(jc,s),Ot(Fo,h),Zc=s|h.baseLanes}function Qd(){Ot(jc,Zc),Ot(Fo,Fo.current)}function ho(){Zc=jc.current,xt(Fo),xt(jc)}var Vo=ke(null),Cs=null;function gi(s){var h=s.alternate;Ot(Wr,Wr.current&1),Ot(Vo,s),Cs===null&&(h===null||Fo.current!==null||h.memoizedState!==null)&&(Cs=s)}function Br(s){Ot(Wr,Wr.current),Ot(Vo,s),Cs===null&&(Cs=s)}function cd(s){s.tag===22?(Ot(Wr,Wr.current),Ot(Vo,s),Cs===null&&(Cs=s)):Uo()}function Uo(){Ot(Wr,Wr.current),Ot(Vo,Vo.current)}function Wa(s){xt(Vo),Cs===s&&(Cs=null),xt(Wr)}var Wr=ke(0);function Au(s){for(var h=s;h!==null;){if(h.tag===13){var y=h.memoizedState;if(y!==null&&(y=y.dehydrated,y===null||yp(y)||Om(y)))return h}else if(h.tag===19&&(h.memoizedProps.revealOrder==="forwards"||h.memoizedProps.revealOrder==="backwards"||h.memoizedProps.revealOrder==="unstable_legacy-backwards"||h.memoizedProps.revealOrder==="together")){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===s)break;for(;h.sibling===null;){if(h.return===null||h.return===s)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var eo=0,Gn=null,ji=null,Tr=null,bh=!1,cc=!1,nu=!1,xh=0,T=0,n=null,u=0;function g(){throw Error(a(321))}function b(s,h){if(h===null)return!1;for(var y=0;y<h.length&&y<s.length;y++)if(!ra(s[y],h[y]))return!1;return!0}function S(s,h,y,w,D,B){return eo=B,Gn=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,mt.H=s===null||s.memoizedState===null?kg:Dg,nu=!1,B=y(w,D),nu=!1,cc&&(B=O(h,y,w,D)),I(s),B}function I(s){mt.H=fd;var h=ji!==null&&ji.next!==null;if(eo=0,Tr=ji=Gn=null,bh=!1,T=0,n=null,h)throw Error(a(300));s===null||ka||(s=s.dependencies,s!==null&&Tu(s)&&(ka=!0))}function O(s,h,y,w){Gn=s;var D=0;do{if(cc&&(n=null),T=0,cc=!1,25<=D)throw Error(a(301));if(D+=1,Tr=ji=null,s.updateQueue!=null){var B=s.updateQueue;B.lastEffect=null,B.events=null,B.stores=null,B.memoCache!=null&&(B.memoCache.index=0)}mt.H=zg,B=h(y,w)}while(cc);return B}function N(){var s=mt.H,h=s.useState()[0];return h=typeof h.then=="function"?_e(h):h,s=s.useState()[0],(ji!==null?ji.memoizedState:null)!==s&&(Gn.flags|=1024),h}function j(){var s=xh!==0;return xh=0,s}function $(s,h,y){h.updateQueue=s.updateQueue,h.flags&=-2053,s.lanes&=~y}function X(s){if(bh){for(s=s.memoizedState;s!==null;){var h=s.queue;h!==null&&(h.pending=null),s=s.next}bh=!1}eo=0,Tr=ji=Gn=null,cc=!1,T=xh=0,n=null}function H(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tr===null?Gn.memoizedState=Tr=s:Tr=Tr.next=s,Tr}function J(){if(ji===null){var s=Gn.alternate;s=s!==null?s.memoizedState:null}else s=ji.next;var h=Tr===null?Gn.memoizedState:Tr.next;if(h!==null)Tr=h,ji=s;else{if(s===null)throw Gn.alternate===null?Error(a(467)):Error(a(310));ji=s,s={memoizedState:ji.memoizedState,baseState:ji.baseState,baseQueue:ji.baseQueue,queue:ji.queue,next:null},Tr===null?Gn.memoizedState=Tr=s:Tr=Tr.next=s}return Tr}function ae(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function _e(s){var h=T;return T+=1,n===null&&(n=[]),s=sd(n,s,h),h=Gn,(Tr===null?h.memoizedState:Tr.next)===null&&(h=h.alternate,mt.H=h===null||h.memoizedState===null?kg:Dg),s}function me(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return _e(s);if(s.$$typeof===Xe)return Ha(s)}throw Error(a(438,String(s)))}function ve(s){var h=null,y=Gn.updateQueue;if(y!==null&&(h=y.memoCache),h==null){var w=Gn.alternate;w!==null&&(w=w.updateQueue,w!==null&&(w=w.memoCache,w!=null&&(h={data:w.data.map(function(D){return D.slice()}),index:0})))}if(h==null&&(h={data:[],index:0}),y===null&&(y=ae(),Gn.updateQueue=y),y.memoCache=h,y=h.data[h.index],y===void 0)for(y=h.data[h.index]=Array(s),w=0;w<s;w++)y[w]=Ae;return h.index++,y}function we(s,h){return typeof h=="function"?h(s):h}function Me(s){var h=J();return Ee(h,ji,s)}function Ee(s,h,y){var w=s.queue;if(w===null)throw Error(a(311));w.lastRenderedReducer=y;var D=s.baseQueue,B=w.pending;if(B!==null){if(D!==null){var Q=D.next;D.next=B.next,B.next=Q}h.baseQueue=D=B,w.pending=null}if(B=s.baseState,D===null)s.memoizedState=B;else{h=D.next;var he=Q=null,Ue=null,dt=h,vt=!1;do{var Et=dt.lane&-536870913;if(Et!==dt.lane?(xi&Et)===Et:(eo&Et)===Et){var ft=dt.revertLane;if(ft===0)Ue!==null&&(Ue=Ue.next={lane:0,revertLane:0,gesture:null,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null}),Et===mh&&(vt=!0);else if((eo&ft)===ft){dt=dt.next,ft===mh&&(vt=!0);continue}else Et={lane:0,revertLane:dt.revertLane,gesture:null,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null},Ue===null?(he=Ue=Et,Q=B):Ue=Ue.next=Et,Gn.lanes|=ft,Hc|=ft;Et=dt.action,nu&&y(B,Et),B=dt.hasEagerState?dt.eagerState:y(B,Et)}else ft={lane:Et,revertLane:dt.revertLane,gesture:dt.gesture,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null},Ue===null?(he=Ue=ft,Q=B):Ue=Ue.next=ft,Gn.lanes|=Et,Hc|=Et;dt=dt.next}while(dt!==null&&dt!==h);if(Ue===null?Q=B:Ue.next=he,!ra(B,s.memoizedState)&&(ka=!0,vt&&(y=Ql,y!==null)))throw y;s.memoizedState=B,s.baseState=Q,s.baseQueue=Ue,w.lastRenderedState=B}return D===null&&(w.lanes=0),[s.memoizedState,w.dispatch]}function ze(s){var h=J(),y=h.queue;if(y===null)throw Error(a(311));y.lastRenderedReducer=s;var w=y.dispatch,D=y.pending,B=h.memoizedState;if(D!==null){y.pending=null;var Q=D=D.next;do B=s(B,Q.action),Q=Q.next;while(Q!==D);ra(B,h.memoizedState)||(ka=!0),h.memoizedState=B,h.baseQueue===null&&(h.baseState=B),y.lastRenderedState=B}return[B,w]}function Ve(s,h,y){var w=Gn,D=J(),B=ui;if(B){if(y===void 0)throw Error(a(407));y=y()}else y=h();var Q=!ra((ji||D).memoizedState,y);if(Q&&(D.memoizedState=y,ka=!0),D=D.queue,iu(ct.bind(null,w,D,s),[s]),D.getSnapshot!==h||Q||Tr!==null&&Tr.memoizedState.tag&1){if(w.flags|=2048,Vr(9,{destroy:void 0},Ye.bind(null,w,D,y,h),null),Sr===null)throw Error(a(349));B||(eo&127)!==0||Ie(w,h,y)}return y}function Ie(s,h,y){s.flags|=16384,s={getSnapshot:h,value:y},h=Gn.updateQueue,h===null?(h=ae(),Gn.updateQueue=h,h.stores=[s]):(y=h.stores,y===null?h.stores=[s]:y.push(s))}function Ye(s,h,y,w){h.value=y,h.getSnapshot=w,rt(h)&&st(s)}function ct(s,h,y){return y(function(){rt(h)&&st(s)})}function rt(s){var h=s.getSnapshot;s=s.value;try{var y=h();return!ra(s,y)}catch{return!0}}function st(s){var h=Ro(s,2);h!==null&&go(h,s,2)}function lt(s){var h=H();if(typeof s=="function"){var y=s;if(s=y(),nu){$e(!0);try{y()}finally{$e(!1)}}}return h.memoizedState=h.baseState=s,h.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:we,lastRenderedState:s},h}function Nt(s,h,y,w){return s.baseState=y,Ee(s,ji,typeof w=="function"?w:we)}function Ft(s,h,y,w,D){if(vl(s))throw Error(a(485));if(s=h.action,s!==null){var B={payload:D,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Q){B.listeners.push(Q)}};mt.T!==null?y(!0):B.isTransition=!1,w(B),y=h.pending,y===null?(B.next=h.pending=B,Ct(h,B)):(B.next=y.next,h.pending=y.next=B)}}function Ct(s,h){var y=h.action,w=h.payload,D=s.state;if(h.isTransition){var B=mt.T,Q={};mt.T=Q;try{var he=y(D,w),Ue=mt.S;Ue!==null&&Ue(Q,he),ln(s,h,he)}catch(dt){bi(s,h,dt)}finally{B!==null&&Q.types!==null&&(B.types=Q.types),mt.T=B}}else try{B=y(D,w),ln(s,h,B)}catch(dt){bi(s,h,dt)}}function ln(s,h,y){y!==null&&typeof y=="object"&&typeof y.then=="function"?y.then(function(w){Zn(s,h,w)},function(w){return bi(s,h,w)}):Zn(s,h,y)}function Zn(s,h,y){h.status="fulfilled",h.value=y,Yi(h),s.state=y,h=s.pending,h!==null&&(y=h.next,y===h?s.pending=null:(y=y.next,h.next=y,Ct(s,y)))}function bi(s,h,y){var w=s.pending;if(s.pending=null,w!==null){w=w.next;do h.status="rejected",h.reason=y,Yi(h),h=h.next;while(h!==w)}s.action=null}function Yi(s){s=s.listeners;for(var h=0;h<s.length;h++)(0,s[h])()}function qi(s,h){return h}function Pr(s,h){if(ui){var y=Sr.formState;if(y!==null){e:{var w=Gn;if(ui){if(Li){t:{for(var D=Li,B=Hr;D.nodeType!==8;){if(!B){D=null;break t}if(D=xl(D.nextSibling),D===null){D=null;break t}}B=D.data,D=B==="F!"||B==="F"?D:null}if(D){Li=xl(D.nextSibling),w=D.data==="F!";break e}}zo(w)}w=!1}w&&(h=y[0])}}return y=H(),y.memoizedState=y.baseState=h,w={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qi,lastRenderedState:h},y.queue=w,y=dd.bind(null,Gn,w),w.dispatch=y,w=lt(!1),B=su.bind(null,Gn,!1,w.queue),w=H(),D={state:h,dispatch:null,action:s,pending:null},w.queue=D,y=Ft.bind(null,Gn,D,B,y),D.dispatch=y,w.memoizedState=s,[h,y,!1]}function Fr(s){var h=J();return jn(h,ji,s)}function jn(s,h,y){if(h=Ee(s,h,qi)[0],s=Me(we)[0],typeof h=="object"&&h!==null&&typeof h.then=="function")try{var w=_e(h)}catch(Q){throw Q===rc?Jl:Q}else w=h;h=J();var D=h.queue,B=D.dispatch;return y!==h.memoizedState&&(Gn.flags|=2048,Vr(9,{destroy:void 0},ur.bind(null,D,y),null)),[w,B,s]}function ur(s,h){s.action=h}function sa(s){var h=J(),y=ji;if(y!==null)return jn(h,y,s);J(),h=h.memoizedState,y=J();var w=y.queue.dispatch;return y.memoizedState=s,[h,w,!1]}function Vr(s,h,y,w){return s={tag:s,create:y,deps:w,inst:h,next:null},h=Gn.updateQueue,h===null&&(h=ae(),Gn.updateQueue=h),y=h.lastEffect,y===null?h.lastEffect=s.next=s:(w=y.next,y.next=s,s.next=w,h.lastEffect=s),s}function La(){return J().memoizedState}function Xa(s,h,y,w){var D=H();Gn.flags|=s,D.memoizedState=Vr(1|h,{destroy:void 0},y,w===void 0?null:w)}function fo(s,h,y,w){var D=J();w=w===void 0?null:w;var B=D.memoizedState.inst;ji!==null&&w!==null&&b(w,ji.memoizedState.deps)?D.memoizedState=Vr(h,B,y,w):(Gn.flags|=s,D.memoizedState=Vr(1|h,B,y,w))}function Cu(s,h){Xa(8390656,8,s,h)}function iu(s,h){fo(2048,8,s,h)}function wh(s){Gn.flags|=4;var h=Gn.updateQueue;if(h===null)h=ae(),Gn.updateQueue=h,h.events=[s];else{var y=h.events;y===null?h.events=[s]:y.push(s)}}function qc(s){var h=J().memoizedState;return wh({ref:h,nextImpl:s}),function(){if(($i&2)!==0)throw Error(a(440));return h.impl.apply(void 0,arguments)}}function hc(s,h){return fo(4,2,s,h)}function dc(s,h){return fo(4,4,s,h)}function to(s,h){if(typeof h=="function"){s=s();var y=h(s);return function(){typeof y=="function"?y():h(null)}}if(h!=null)return s=s(),h.current=s,function(){h.current=null}}function _l(s,h,y){y=y!=null?y.concat([s]):null,fo(4,4,to.bind(null,h,s),y)}function ss(){}function Iu(s,h){var y=J();h=h===void 0?null:h;var w=y.memoizedState;return h!==null&&b(h,w[1])?w[0]:(y.memoizedState=[s,h],s)}function oa(s,h){var y=J();h=h===void 0?null:h;var w=y.memoizedState;if(h!==null&&b(h,w[1]))return w[0];if(w=s(),nu){$e(!0);try{s()}finally{$e(!1)}}return y.memoizedState=[w,h],w}function la(s,h,y){return y===void 0||(eo&1073741824)!==0&&(xi&261930)===0?s.memoizedState=h:(s.memoizedState=y,s=u_(),Gn.lanes|=s,Hc|=s,y)}function jo(s,h,y,w){return ra(y,h)?y:Fo.current!==null?(s=la(s,y,w),ra(s,h)||(ka=!0),s):(eo&42)===0||(eo&1073741824)!==0&&(xi&261930)===0?(ka=!0,s.memoizedState=y):(s=u_(),Gn.lanes|=s,Hc|=s,h)}function ua(s,h,y,w,D){var B=At.p;At.p=B!==0&&8>B?B:8;var Q=mt.T,he={};mt.T=he,su(s,!1,h,y);try{var Ue=D(),dt=mt.S;if(dt!==null&&dt(he,Ue),Ue!==null&&typeof Ue=="object"&&typeof Ue.then=="function"){var vt=rd(Ue,w);pc(s,h,vt,Bl(s))}else pc(s,h,w,Bl(s))}catch(Et){pc(s,h,{then:function(){},status:"rejected",reason:Et},Bl())}finally{At.p=B,Q!==null&&he.types!==null&&(Q.types=he.types),mt.T=Q}}function hd(){}function fc(s,h,y,w){if(s.tag!==5)throw Error(a(476));var D=ru(s).queue;ua(s,D,h,bt,y===null?hd:function(){return yl(s),y(w)})}function ru(s){var h=s.memoizedState;if(h!==null)return h;h={memoizedState:bt,baseState:bt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:we,lastRenderedState:bt},next:null};var y={};return h.next={memoizedState:y,baseState:y,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:we,lastRenderedState:y},next:null},s.memoizedState=h,s=s.alternate,s!==null&&(s.memoizedState=h),h}function yl(s){var h=ru(s);h.next===null&&(h=s.alternate.memoizedState),pc(s,h.next.queue,{},Bl())}function au(){return Ha(Qn)}function Xf(){return J().memoizedState}function po(){return J().memoizedState}function om(s){for(var h=s.return;h!==null;){switch(h.tag){case 24:case 3:var y=Bl();s=Eu(y);var w=tu(h,s,y);w!==null&&(go(w,h,y),Uc(w,h,y)),h={cache:Bo()},s.payload=h;return}h=h.return}}function Kf(s,h,y){var w=Bl();y={lane:w,revertLane:0,gesture:null,action:y,hasEagerState:!1,eagerState:null,next:null},vl(s)?Lg(h,y):(y=dl(s,h,y,w),y!==null&&(go(y,s,w),jy(y,h,w)))}function dd(s,h,y){var w=Bl();pc(s,h,y,w)}function pc(s,h,y,w){var D={lane:w,revertLane:0,gesture:null,action:y,hasEagerState:!1,eagerState:null,next:null};if(vl(s))Lg(h,D);else{var B=s.alternate;if(s.lanes===0&&(B===null||B.lanes===0)&&(B=h.lastRenderedReducer,B!==null))try{var Q=h.lastRenderedState,he=B(Q,y);if(D.hasEagerState=!0,D.eagerState=he,ra(he,Q))return Qs(s,h,D,0),Sr===null&&Yu(),!1}catch{}finally{}if(y=dl(s,h,D,w),y!==null)return go(y,s,w),jy(y,h,w),!0}return!1}function su(s,h,y,w){if(w={lane:2,revertLane:vc(),gesture:null,action:w,hasEagerState:!1,eagerState:null,next:null},vl(s)){if(h)throw Error(a(479))}else h=dl(s,y,w,2),h!==null&&go(h,s,2)}function vl(s){var h=s.alternate;return s===Gn||h!==null&&h===Gn}function Lg(s,h){cc=bh=!0;var y=s.pending;y===null?h.next=h:(h.next=y.next,y.next=h),s.pending=h}function jy(s,h,y){if((y&4194048)!==0){var w=h.lanes;w&=s.pendingLanes,y|=w,h.lanes=y,Kn(s,y)}}var fd={readContext:Ha,use:me,useCallback:g,useContext:g,useEffect:g,useImperativeHandle:g,useLayoutEffect:g,useInsertionEffect:g,useMemo:g,useReducer:g,useRef:g,useState:g,useDebugValue:g,useDeferredValue:g,useTransition:g,useSyncExternalStore:g,useId:g,useHostTransitionStatus:g,useFormState:g,useActionState:g,useOptimistic:g,useMemoCache:g,useCacheRefresh:g};fd.useEffectEvent=g;var kg={readContext:Ha,use:me,useCallback:function(s,h){return H().memoizedState=[s,h===void 0?null:h],s},useContext:Ha,useEffect:Cu,useImperativeHandle:function(s,h,y){y=y!=null?y.concat([s]):null,Xa(4194308,4,to.bind(null,h,s),y)},useLayoutEffect:function(s,h){return Xa(4194308,4,s,h)},useInsertionEffect:function(s,h){Xa(4,2,s,h)},useMemo:function(s,h){var y=H();h=h===void 0?null:h;var w=s();if(nu){$e(!0);try{s()}finally{$e(!1)}}return y.memoizedState=[w,h],w},useReducer:function(s,h,y){var w=H();if(y!==void 0){var D=y(h);if(nu){$e(!0);try{y(h)}finally{$e(!1)}}}else D=h;return w.memoizedState=w.baseState=D,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:D},w.queue=s,s=s.dispatch=Kf.bind(null,Gn,s),[w.memoizedState,s]},useRef:function(s){var h=H();return s={current:s},h.memoizedState=s},useState:function(s){s=lt(s);var h=s.queue,y=dd.bind(null,Gn,h);return h.dispatch=y,[s.memoizedState,y]},useDebugValue:ss,useDeferredValue:function(s,h){var y=H();return la(y,s,h)},useTransition:function(){var s=lt(!1);return s=ua.bind(null,Gn,s.queue,!0,!1),H().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,h,y){var w=Gn,D=H();if(ui){if(y===void 0)throw Error(a(407));y=y()}else{if(y=h(),Sr===null)throw Error(a(349));(xi&127)!==0||Ie(w,h,y)}D.memoizedState=y;var B={value:y,getSnapshot:h};return D.queue=B,Cu(ct.bind(null,w,B,s),[s]),w.flags|=2048,Vr(9,{destroy:void 0},Ye.bind(null,w,B,y,h),null),y},useId:function(){var s=H(),h=Sr.identifierPrefix;if(ui){var y=Kt,w=Mt;y=(w&~(1<<32-et(w)-1)).toString(32)+y,h="_"+h+"R_"+y,y=xh++,0<y&&(h+="H"+y.toString(32)),h+="_"}else y=u++,h="_"+h+"r_"+y.toString(32)+"_";return s.memoizedState=h},useHostTransitionStatus:au,useFormState:Pr,useActionState:Pr,useOptimistic:function(s){var h=H();h.memoizedState=h.baseState=s;var y={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return h.queue=y,h=su.bind(null,Gn,!0,y),y.dispatch=h,[s,h]},useMemoCache:ve,useCacheRefresh:function(){return H().memoizedState=om.bind(null,Gn)},useEffectEvent:function(s){var h=H(),y={impl:s};return h.memoizedState=y,function(){if(($i&2)!==0)throw Error(a(440));return y.impl.apply(void 0,arguments)}}},Dg={readContext:Ha,use:me,useCallback:Iu,useContext:Ha,useEffect:iu,useImperativeHandle:_l,useInsertionEffect:hc,useLayoutEffect:dc,useMemo:oa,useReducer:Me,useRef:La,useState:function(){return Me(we)},useDebugValue:ss,useDeferredValue:function(s,h){var y=J();return jo(y,ji.memoizedState,s,h)},useTransition:function(){var s=Me(we)[0],h=J().memoizedState;return[typeof s=="boolean"?s:_e(s),h]},useSyncExternalStore:Ve,useId:Xf,useHostTransitionStatus:au,useFormState:Fr,useActionState:Fr,useOptimistic:function(s,h){var y=J();return Nt(y,ji,s,h)},useMemoCache:ve,useCacheRefresh:po};Dg.useEffectEvent=qc;var zg={readContext:Ha,use:me,useCallback:Iu,useContext:Ha,useEffect:iu,useImperativeHandle:_l,useInsertionEffect:hc,useLayoutEffect:dc,useMemo:oa,useReducer:ze,useRef:La,useState:function(){return ze(we)},useDebugValue:ss,useDeferredValue:function(s,h){var y=J();return ji===null?la(y,s,h):jo(y,ji.memoizedState,s,h)},useTransition:function(){var s=ze(we)[0],h=J().memoizedState;return[typeof s=="boolean"?s:_e(s),h]},useSyncExternalStore:Ve,useId:Xf,useHostTransitionStatus:au,useFormState:sa,useActionState:sa,useOptimistic:function(s,h){var y=J();return ji!==null?Nt(y,ji,s,h):(y.baseState=s,[s,y.queue.dispatch])},useMemoCache:ve,useCacheRefresh:po};zg.useEffectEvent=qc;function Og(s,h,y,w){h=s.memoizedState,y=y(w,h),y=y==null?h:G({},h,y),s.memoizedState=y,s.lanes===0&&(s.updateQueue.baseState=y)}var Yf={enqueueSetState:function(s,h,y){s=s._reactInternals;var w=Bl(),D=Eu(w);D.payload=h,y!=null&&(D.callback=y),h=tu(s,D,w),h!==null&&(go(h,s,w),Uc(h,s,w))},enqueueReplaceState:function(s,h,y){s=s._reactInternals;var w=Bl(),D=Eu(w);D.tag=1,D.payload=h,y!=null&&(D.callback=y),h=tu(s,D,w),h!==null&&(go(h,s,w),Uc(h,s,w))},enqueueForceUpdate:function(s,h){s=s._reactInternals;var y=Bl(),w=Eu(y);w.tag=2,h!=null&&(w.callback=h),h=tu(s,w,y),h!==null&&(go(h,s,y),Uc(h,s,y))}};function qy(s,h,y,w,D,B,Q){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(w,B,Q):h.prototype&&h.prototype.isPureReactComponent?!Es(y,w)||!Es(D,B):!0}function lm(s,h,y,w){s=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(y,w),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(y,w),h.state!==s&&Yf.enqueueReplaceState(h,h.state,null)}function Th(s,h){var y=h;if("ref"in h){y={};for(var w in h)w!=="ref"&&(y[w]=h[w])}if(s=s.defaultProps){y===h&&(y=G({},y));for(var D in s)y[D]===void 0&&(y[D]=s[D])}return y}function Ng(s){Wl(s)}function pd(s){console.error(s)}function $y(s){Wl(s)}function Sh(s,h){try{var y=s.onUncaughtError;y(h.value,{componentStack:h.stack})}catch(w){setTimeout(function(){throw w})}}function Qf(s,h,y){try{var w=s.onCaughtError;w(y.value,{componentStack:y.stack,errorBoundary:h.tag===1?h.stateNode:null})}catch(D){setTimeout(function(){throw D})}}function Jd(s,h,y){return y=Eu(y),y.tag=3,y.payload={element:null},y.callback=function(){Sh(s,h)},y}function Bg(s){return s=Eu(s),s.tag=3,s}function Fg(s,h,y,w){var D=y.type.getDerivedStateFromError;if(typeof D=="function"){var B=w.value;s.payload=function(){return D(B)},s.callback=function(){Qf(h,y,w)}}var Q=y.stateNode;Q!==null&&typeof Q.componentDidCatch=="function"&&(s.callback=function(){Qf(h,y,w),typeof D!="function"&&(Ch===null?Ch=new Set([this]):Ch.add(this));var he=w.stack;this.componentDidCatch(w.value,{componentStack:he!==null?he:""})})}function Mb(s,h,y,w,D){if(y.flags|=32768,w!==null&&typeof w=="object"&&typeof w.then=="function"){if(h=y.alternate,h!==null&&Ra(h,y,D,!0),y=Vo.current,y!==null){switch(y.tag){case 31:case 13:return Cs===null?hp():y.alternate===null&&_a===0&&(_a=3),y.flags&=-257,y.flags|=65536,y.lanes=D,w===Bc?y.flags|=16384:(h=y.updateQueue,h===null?y.updateQueue=new Set([w]):h.add(w),fp(s,w,D)),!1;case 22:return y.flags|=65536,w===Bc?y.flags|=16384:(h=y.updateQueue,h===null?(h={transitions:null,markerInstances:null,retryQueue:new Set([w])},y.updateQueue=h):(y=h.retryQueue,y===null?h.retryQueue=new Set([w]):y.add(w)),fp(s,w,D)),!1}throw Error(a(435,y.tag))}return fp(s,w,D),hp(),!1}if(ui)return h=Vo.current,h!==null?((h.flags&65536)===0&&(h.flags|=256),h.flags|=65536,h.lanes=D,w!==is&&(s=Error(a(422),{cause:w}),xu(x(s,y)))):(w!==is&&(h=Error(a(423),{cause:w}),xu(x(h,y))),s=s.current.alternate,s.flags|=65536,D&=-D,s.lanes|=D,w=x(w,y),D=Jd(s.stateNode,w,D),Yd(s,D),_a!==4&&(_a=2)),!1;var B=Error(a(520),{cause:w});if(B=x(B,y),Sd===null?Sd=[B]:Sd.push(B),_a!==4&&(_a=2),h===null)return!0;w=x(w,y),y=h;do{switch(y.tag){case 3:return y.flags|=65536,s=D&-D,y.lanes|=s,s=Jd(y.stateNode,w,s),Yd(y,s),!1;case 1:if(h=y.type,B=y.stateNode,(y.flags&128)===0&&(typeof h.getDerivedStateFromError=="function"||B!==null&&typeof B.componentDidCatch=="function"&&(Ch===null||!Ch.has(B))))return y.flags|=65536,D&=-D,y.lanes|=D,D=Bg(D),Fg(D,s,y,w),Yd(y,D),!1}y=y.return}while(y!==null);return!1}var Vg=Error(a(461)),ka=!1;function Is(s,h,y,w){h.child=s===null?ml(h,null,y,w):oc(h,s.child,y,w)}function Ug(s,h,y,w,D){y=y.render;var B=h.ref;if("ref"in w){var Q={};for(var he in w)he!=="ref"&&(Q[he]=w[he])}else Q=w;return Su(h),w=S(s,h,y,Q,B,D),he=j(),s!==null&&!ka?($(s,h,D),qo(s,h,D)):(ui&&he&&ga(h),h.flags|=1,Is(s,h,w,D),h.child)}function Gy(s,h,y,w,D){if(s===null){var B=y.type;return typeof B=="function"&&!ko(B)&&B.defaultProps===void 0&&y.compare===null?(h.tag=15,h.type=B,um(s,h,B,w,D)):(s=Qu(y.type,null,w,h,h.mode,D),s.ref=h.ref,s.return=h,h.child=s)}if(B=s.child,!gd(s,D)){var Q=B.memoizedProps;if(y=y.compare,y=y!==null?y:Es,y(Q,w)&&s.ref===h.ref)return qo(s,h,D)}return h.flags|=1,s=Do(B,w),s.ref=h.ref,s.return=h,h.child=s}function um(s,h,y,w,D){if(s!==null){var B=s.memoizedProps;if(Es(B,w)&&s.ref===h.ref)if(ka=!1,h.pendingProps=w=B,gd(s,D))(s.flags&131072)!==0&&(ka=!0);else return h.lanes=s.lanes,qo(s,h,D)}return hm(s,h,y,w,D)}function jg(s,h,y,w){var D=w.children,B=s!==null?s.memoizedState:null;if(s===null&&h.stateNode===null&&(h.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),w.mode==="hidden"){if((h.flags&128)!==0){if(B=B!==null?B.baseLanes|y:y,s!==null){for(w=h.child=s.child,D=0;w!==null;)D=D|w.lanes|w.childLanes,w=w.sibling;w=D&~B}else w=0,h.child=null;return ef(s,h,B,y,w)}if((y&536870912)!==0)h.memoizedState={baseLanes:0,cachePool:null},s!==null&&_h(h,B!==null?B.cachePool:null),B!==null?As(h,B):Qd(),cd(h);else return w=h.lanes=536870912,ef(s,h,B!==null?B.baseLanes|y:y,y,w)}else B!==null?(_h(h,B.cachePool),As(h,B),Uo(),h.memoizedState=null):(s!==null&&_h(h,null),Qd(),Uo());return Is(s,h,D,y),h.child}function md(s,h){return s!==null&&s.tag===22||h.stateNode!==null||(h.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.sibling}function ef(s,h,y,w,D){var B=Yt();return B=B===null?null:{parent:Ci._currentValue,pool:B},h.memoizedState={baseLanes:y,cachePool:B},s!==null&&_h(h,null),Qd(),cd(h),s!==null&&Ra(s,h,w,!0),h.childLanes=D,null}function Ms(s,h){return h=fm({mode:h.mode,children:h.children},s.mode),h.ref=s.ref,s.child=h,h.return=s,h}function qg(s,h,y){return oc(h,s.child,null,y),s=Ms(h,h.pendingProps),s.flags|=2,Wa(h),h.memoizedState=null,s}function $g(s,h,y){var w=h.pendingProps,D=(h.flags&128)!==0;if(h.flags&=-129,s===null){if(ui){if(w.mode==="hidden")return s=Ms(h,w),h.lanes=536870912,md(null,s);if(Br(h),(s=Li)?(s=zm(s,Hr),s=s!==null&&s.data==="&"?s:null,s!==null&&(h.memoizedState={dehydrated:s,treeContext:ut!==null?{id:Mt,overflow:Kt}:null,retryLane:536870912,hydrationErrors:null},y=ec(s),y.return=h,h.child=y,Si=h,Li=null)):s=null,s===null)throw zo(h);return h.lanes=536870912,null}return Ms(h,w)}var B=s.memoizedState;if(B!==null){var Q=B.dehydrated;if(Br(h),D)if(h.flags&256)h.flags&=-257,h=qg(s,h,y);else if(h.memoizedState!==null)h.child=s.child,h.flags|=128,h=null;else throw Error(a(558));else if(ka||Ra(s,h,y,!1),D=(y&s.childLanes)!==0,ka||D){if(w=Sr,w!==null&&(Q=br(w,y),Q!==0&&Q!==B.retryLane))throw B.retryLane=Q,Ro(s,Q),go(w,s,Q),Vg;hp(),h=qg(s,h,y)}else s=B.treeContext,Li=xl(Q.nextSibling),Si=h,ui=!0,ki=null,Hr=!1,s!==null&&Za(h,s),h=Ms(h,w),h.flags|=4096;return h}return s=Do(s.child,{mode:w.mode,children:w.children}),s.ref=h.ref,h.child=s,s.return=h,s}function cm(s,h){var y=h.ref;if(y===null)s!==null&&s.ref!==null&&(h.flags|=4194816);else{if(typeof y!="function"&&typeof y!="object")throw Error(a(284));(s===null||s.ref!==y)&&(h.flags|=4194816)}}function hm(s,h,y,w,D){return Su(h),y=S(s,h,y,w,void 0,D),w=j(),s!==null&&!ka?($(s,h,D),qo(s,h,D)):(ui&&w&&ga(h),h.flags|=1,Is(s,h,y,D),h.child)}function Zy(s,h,y,w,D,B){return Su(h),h.updateQueue=null,y=O(h,w,y,D),I(s),w=j(),s!==null&&!ka?($(s,h,B),qo(s,h,B)):(ui&&w&&ga(h),h.flags|=1,Is(s,h,y,B),h.child)}function Hy(s,h,y,w,D){if(Su(h),h.stateNode===null){var B=Lo,Q=y.contextType;typeof Q=="object"&&Q!==null&&(B=Ha(Q)),B=new y(w,B),h.memoizedState=B.state!==null&&B.state!==void 0?B.state:null,B.updater=Yf,h.stateNode=B,B._reactInternals=h,B=h.stateNode,B.props=w,B.state=h.memoizedState,B.refs={},lc(h),Q=y.contextType,B.context=typeof Q=="object"&&Q!==null?Ha(Q):Lo,B.state=h.memoizedState,Q=y.getDerivedStateFromProps,typeof Q=="function"&&(Og(h,y,Q,w),B.state=h.memoizedState),typeof y.getDerivedStateFromProps=="function"||typeof B.getSnapshotBeforeUpdate=="function"||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(Q=B.state,typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount(),Q!==B.state&&Yf.enqueueReplaceState(B,B.state,null),an(h,w,B,D),uc(),B.state=h.memoizedState),typeof B.componentDidMount=="function"&&(h.flags|=4194308),w=!0}else if(s===null){B=h.stateNode;var he=h.memoizedProps,Ue=Th(y,he);B.props=Ue;var dt=B.context,vt=y.contextType;Q=Lo,typeof vt=="object"&&vt!==null&&(Q=Ha(vt));var Et=y.getDerivedStateFromProps;vt=typeof Et=="function"||typeof B.getSnapshotBeforeUpdate=="function",he=h.pendingProps!==he,vt||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(he||dt!==Q)&&lm(h,B,w,Q),Di=!1;var ft=h.memoizedState;B.state=ft,an(h,w,B,D),uc(),dt=h.memoizedState,he||ft!==dt||Di?(typeof Et=="function"&&(Og(h,y,Et,w),dt=h.memoizedState),(Ue=Di||qy(h,y,Ue,w,ft,dt,Q))?(vt||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount()),typeof B.componentDidMount=="function"&&(h.flags|=4194308)):(typeof B.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=w,h.memoizedState=dt),B.props=w,B.state=dt,B.context=Q,w=Ue):(typeof B.componentDidMount=="function"&&(h.flags|=4194308),w=!1)}else{B=h.stateNode,ld(s,h),Q=h.memoizedProps,vt=Th(y,Q),B.props=vt,Et=h.pendingProps,ft=B.context,dt=y.contextType,Ue=Lo,typeof dt=="object"&&dt!==null&&(Ue=Ha(dt)),he=y.getDerivedStateFromProps,(dt=typeof he=="function"||typeof B.getSnapshotBeforeUpdate=="function")||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(Q!==Et||ft!==Ue)&&lm(h,B,w,Ue),Di=!1,ft=h.memoizedState,B.state=ft,an(h,w,B,D),uc();var yt=h.memoizedState;Q!==Et||ft!==yt||Di||s!==null&&s.dependencies!==null&&Tu(s.dependencies)?(typeof he=="function"&&(Og(h,y,he,w),yt=h.memoizedState),(vt=Di||qy(h,y,vt,w,ft,yt,Ue)||s!==null&&s.dependencies!==null&&Tu(s.dependencies))?(dt||typeof B.UNSAFE_componentWillUpdate!="function"&&typeof B.componentWillUpdate!="function"||(typeof B.componentWillUpdate=="function"&&B.componentWillUpdate(w,yt,Ue),typeof B.UNSAFE_componentWillUpdate=="function"&&B.UNSAFE_componentWillUpdate(w,yt,Ue)),typeof B.componentDidUpdate=="function"&&(h.flags|=4),typeof B.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof B.componentDidUpdate!="function"||Q===s.memoizedProps&&ft===s.memoizedState||(h.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||Q===s.memoizedProps&&ft===s.memoizedState||(h.flags|=1024),h.memoizedProps=w,h.memoizedState=yt),B.props=w,B.state=yt,B.context=Ue,w=vt):(typeof B.componentDidUpdate!="function"||Q===s.memoizedProps&&ft===s.memoizedState||(h.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||Q===s.memoizedProps&&ft===s.memoizedState||(h.flags|=1024),w=!1)}return B=w,cm(s,h),w=(h.flags&128)!==0,B||w?(B=h.stateNode,y=w&&typeof y.getDerivedStateFromError!="function"?null:B.render(),h.flags|=1,s!==null&&w?(h.child=oc(h,s.child,null,D),h.child=oc(h,null,y,D)):Is(s,h,y,D),h.memoizedState=B.state,s=h.child):s=qo(s,h,D),s}function Gg(s,h,y,w){return fl(),h.flags|=256,Is(s,h,y,w),h.child}var Zg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Jf(s){return{baseLanes:s,cachePool:ad()}}function dm(s,h,y){return s=s!==null?s.childLanes&~y:0,h&&(s|=no),s}function Hg(s,h,y){var w=h.pendingProps,D=!1,B=(h.flags&128)!==0,Q;if((Q=B)||(Q=s!==null&&s.memoizedState===null?!1:(Wr.current&2)!==0),Q&&(D=!0,h.flags&=-129),Q=(h.flags&32)!==0,h.flags&=-33,s===null){if(ui){if(D?gi(h):Uo(),(s=Li)?(s=zm(s,Hr),s=s!==null&&s.data!=="&"?s:null,s!==null&&(h.memoizedState={dehydrated:s,treeContext:ut!==null?{id:Mt,overflow:Kt}:null,retryLane:536870912,hydrationErrors:null},y=ec(s),y.return=h,h.child=y,Si=h,Li=null)):s=null,s===null)throw zo(h);return Om(s)?h.lanes=32:h.lanes=536870912,null}var he=w.children;return w=w.fallback,D?(Uo(),D=h.mode,he=fm({mode:"hidden",children:he},D),w=yu(w,D,y,null),he.return=h,w.return=h,he.sibling=w,h.child=he,w=h.child,w.memoizedState=Jf(y),w.childLanes=dm(s,Q,y),h.memoizedState=Zg,md(null,w)):(gi(h),Wg(h,he))}var Ue=s.memoizedState;if(Ue!==null&&(he=Ue.dehydrated,he!==null)){if(B)h.flags&256?(gi(h),h.flags&=-257,h=Xg(s,h,y)):h.memoizedState!==null?(Uo(),h.child=s.child,h.flags|=128,h=null):(Uo(),he=w.fallback,D=h.mode,w=fm({mode:"visible",children:w.children},D),he=yu(he,D,y,null),he.flags|=2,w.return=h,he.return=h,w.sibling=he,h.child=w,oc(h,s.child,null,y),w=h.child,w.memoizedState=Jf(y),w.childLanes=dm(s,Q,y),h.memoizedState=Zg,h=md(null,w));else if(gi(h),Om(he)){if(Q=he.nextSibling&&he.nextSibling.dataset,Q)var dt=Q.dgst;Q=dt,w=Error(a(419)),w.stack="",w.digest=Q,xu({value:w,source:null,stack:null}),h=Xg(s,h,y)}else if(ka||Ra(s,h,y,!1),Q=(y&s.childLanes)!==0,ka||Q){if(Q=Sr,Q!==null&&(w=br(Q,y),w!==0&&w!==Ue.retryLane))throw Ue.retryLane=w,Ro(s,w),go(Q,s,w),Vg;yp(he)||hp(),h=Xg(s,h,y)}else yp(he)?(h.flags|=192,h.child=s.child,h=null):(s=Ue.treeContext,Li=xl(he.nextSibling),Si=h,ui=!0,ki=null,Hr=!1,s!==null&&Za(h,s),h=Wg(h,w.children),h.flags|=4096);return h}return D?(Uo(),he=w.fallback,D=h.mode,Ue=s.child,dt=Ue.sibling,w=Do(Ue,{mode:"hidden",children:w.children}),w.subtreeFlags=Ue.subtreeFlags&65011712,dt!==null?he=Do(dt,he):(he=yu(he,D,y,null),he.flags|=2),he.return=h,w.return=h,w.sibling=he,h.child=w,md(null,w),w=h.child,he=s.child.memoizedState,he===null?he=Jf(y):(D=he.cachePool,D!==null?(Ue=Ci._currentValue,D=D.parent!==Ue?{parent:Ue,pool:Ue}:D):D=ad(),he={baseLanes:he.baseLanes|y,cachePool:D}),w.memoizedState=he,w.childLanes=dm(s,Q,y),h.memoizedState=Zg,md(s.child,w)):(gi(h),y=s.child,s=y.sibling,y=Do(y,{mode:"visible",children:w.children}),y.return=h,y.sibling=null,s!==null&&(Q=h.deletions,Q===null?(h.deletions=[s],h.flags|=16):Q.push(s)),h.child=y,h.memoizedState=null,y)}function Wg(s,h){return h=fm({mode:"visible",children:h},s.mode),h.return=s,s.child=h}function fm(s,h){return s=ns(22,s,null,h),s.lanes=0,s}function Xg(s,h,y){return oc(h,s.child,null,y),s=Wg(h,h.pendingProps.children),s.flags|=2,h.memoizedState=null,s}function pm(s,h,y){s.lanes|=h;var w=s.alternate;w!==null&&(w.lanes|=h),No(s.return,h,y)}function ep(s,h,y,w,D,B){var Q=s.memoizedState;Q===null?s.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:w,tail:y,tailMode:D,treeForkCount:B}:(Q.isBackwards=h,Q.rendering=null,Q.renderingStartTime=0,Q.last=w,Q.tail=y,Q.tailMode=D,Q.treeForkCount=B)}function Kg(s,h,y){var w=h.pendingProps,D=w.revealOrder,B=w.tail;w=w.children;var Q=Wr.current,he=(Q&2)!==0;if(he?(Q=Q&1|2,h.flags|=128):Q&=1,Ot(Wr,Q),Is(s,h,w,y),w=ui?ue:0,!he&&s!==null&&(s.flags&128)!==0)e:for(s=h.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&pm(s,y,h);else if(s.tag===19)pm(s,y,h);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===h)break e;for(;s.sibling===null;){if(s.return===null||s.return===h)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(D){case"forwards":for(y=h.child,D=null;y!==null;)s=y.alternate,s!==null&&Au(s)===null&&(D=y),y=y.sibling;y=D,y===null?(D=h.child,h.child=null):(D=y.sibling,y.sibling=null),ep(h,!1,D,y,B,w);break;case"backwards":case"unstable_legacy-backwards":for(y=null,D=h.child,h.child=null;D!==null;){if(s=D.alternate,s!==null&&Au(s)===null){h.child=D;break}s=D.sibling,D.sibling=y,y=D,D=s}ep(h,!0,y,null,B,w);break;case"together":ep(h,!1,null,null,void 0,w);break;default:h.memoizedState=null}return h.child}function qo(s,h,y){if(s!==null&&(h.dependencies=s.dependencies),Hc|=h.lanes,(y&h.childLanes)===0)if(s!==null){if(Ra(s,h,y,!1),(y&h.childLanes)===0)return null}else return null;if(s!==null&&h.child!==s.child)throw Error(a(153));if(h.child!==null){for(s=h.child,y=Do(s,s.pendingProps),h.child=y,y.return=h;s.sibling!==null;)s=s.sibling,y=y.sibling=Do(s,s.pendingProps),y.return=h;y.sibling=null}return h.child}function gd(s,h){return(s.lanes&h)!==0?!0:(s=s.dependencies,!!(s!==null&&Tu(s)))}function Pb(s,h,y){switch(h.tag){case 3:oi(h,h.stateNode.containerInfo),wu(h,Ci,s.memoizedState.cache),fl();break;case 27:case 5:ds(h);break;case 4:oi(h,h.stateNode.containerInfo);break;case 10:wu(h,h.type,h.memoizedProps.value);break;case 31:if(h.memoizedState!==null)return h.flags|=128,Br(h),null;break;case 13:var w=h.memoizedState;if(w!==null)return w.dehydrated!==null?(gi(h),h.flags|=128,null):(y&h.child.childLanes)!==0?Hg(s,h,y):(gi(h),s=qo(s,h,y),s!==null?s.sibling:null);gi(h);break;case 19:var D=(s.flags&128)!==0;if(w=(y&h.childLanes)!==0,w||(Ra(s,h,y,!1),w=(y&h.childLanes)!==0),D){if(w)return Kg(s,h,y);h.flags|=128}if(D=h.memoizedState,D!==null&&(D.rendering=null,D.tail=null,D.lastEffect=null),Ot(Wr,Wr.current),w)break;return null;case 22:return h.lanes=0,jg(s,h,y,h.pendingProps);case 24:wu(h,Ci,s.memoizedState.cache)}return qo(s,h,y)}function Wy(s,h,y){if(s!==null)if(s.memoizedProps!==h.pendingProps)ka=!0;else{if(!gd(s,y)&&(h.flags&128)===0)return ka=!1,Pb(s,h,y);ka=(s.flags&131072)!==0}else ka=!1,ui&&(h.flags&1048576)!==0&&Yn(h,ue,h.index);switch(h.lanes=0,h.tag){case 16:e:{var w=h.pendingProps;if(s=Fc(h.elementType),h.type=s,typeof s=="function")ko(s)?(w=Th(s,w),h.tag=1,h=Hy(null,h,s,w,y)):(h.tag=0,h=hm(null,h,s,w,y));else{if(s!=null){var D=s.$$typeof;if(D===Ke){h.tag=11,h=Ug(null,h,s,w,y);break e}else if(D===de){h.tag=14,h=Gy(null,h,s,w,y);break e}}throw h=Mn(s)||s,Error(a(306,h,""))}}return h;case 0:return hm(s,h,h.type,h.pendingProps,y);case 1:return w=h.type,D=Th(w,h.pendingProps),Hy(s,h,w,D,y);case 3:e:{if(oi(h,h.stateNode.containerInfo),s===null)throw Error(a(387));w=h.pendingProps;var B=h.memoizedState;D=B.element,ld(s,h),an(h,w,null,y);var Q=h.memoizedState;if(w=Q.cache,wu(h,Ci,w),w!==B.cache&&nc(h,[Ci],y,!0),uc(),w=Q.element,B.isDehydrated)if(B={element:w,isDehydrated:!1,cache:Q.cache},h.updateQueue.baseState=B,h.memoizedState=B,h.flags&256){h=Gg(s,h,w,y);break e}else if(w!==D){D=x(Error(a(424)),h),xu(D),h=Gg(s,h,w,y);break e}else{switch(s=h.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Li=xl(s.firstChild),Si=h,ui=!0,ki=null,Hr=!0,y=ml(h,null,w,y),h.child=y;y;)y.flags=y.flags&-3|4096,y=y.sibling}else{if(fl(),w===D){h=qo(s,h,y);break e}Is(s,h,w,y)}h=h.child}return h;case 26:return cm(s,h),s===null?(y=te(h.type,null,h.pendingProps,null))?h.memoizedState=y:ui||(y=h.type,s=h.pendingProps,w=Md(Wt.current).createElement(y),w[kt]=h,w[yn]=s,io(w,y,s),Mr(w),h.stateNode=w):h.memoizedState=te(h.type,s.memoizedProps,h.pendingProps,s.memoizedState),null;case 27:return ds(h),s===null&&ui&&(w=h.stateNode=_f(h.type,h.pendingProps,Wt.current),Si=h,Hr=!0,D=Li,bc(h.type)?(Nm=D,Li=xl(w.firstChild)):Li=D),Is(s,h,h.pendingProps.children,y),cm(s,h),s===null&&(h.flags|=4194304),h.child;case 5:return s===null&&ui&&((D=w=Li)&&(w=Vb(w,h.type,h.pendingProps,Hr),w!==null?(h.stateNode=w,Si=h,Li=xl(w.firstChild),Hr=!1,D=!0):D=!1),D||zo(h)),ds(h),D=h.type,B=h.pendingProps,Q=s!==null?s.memoizedProps:null,w=B.children,A_(D,B)?w=null:Q!==null&&A_(D,Q)&&(h.flags|=32),h.memoizedState!==null&&(D=S(s,h,N,null,null,y),Qn._currentValue=D),cm(s,h),Is(s,h,w,y),h.child;case 6:return s===null&&ui&&((s=y=Li)&&(y=Iv(y,h.pendingProps,Hr),y!==null?(h.stateNode=y,Si=h,Li=null,s=!0):s=!1),s||zo(h)),null;case 13:return Hg(s,h,y);case 4:return oi(h,h.stateNode.containerInfo),w=h.pendingProps,s===null?h.child=oc(h,null,w,y):Is(s,h,w,y),h.child;case 11:return Ug(s,h,h.type,h.pendingProps,y);case 7:return Is(s,h,h.pendingProps,y),h.child;case 8:return Is(s,h,h.pendingProps.children,y),h.child;case 12:return Is(s,h,h.pendingProps.children,y),h.child;case 10:return w=h.pendingProps,wu(h,h.type,w.value),Is(s,h,w.children,y),h.child;case 9:return D=h.type._context,w=h.pendingProps.children,Su(h),D=Ha(D),w=w(D),h.flags|=1,Is(s,h,w,y),h.child;case 14:return Gy(s,h,h.type,h.pendingProps,y);case 15:return um(s,h,h.type,h.pendingProps,y);case 19:return Kg(s,h,y);case 31:return $g(s,h,y);case 22:return jg(s,h,y,h.pendingProps);case 24:return Su(h),w=Ha(Ci),s===null?(D=Yt(),D===null&&(D=Sr,B=Bo(),D.pooledCache=B,B.refCount++,B!==null&&(D.pooledCacheLanes|=y),D=B),h.memoizedState={parent:w,cache:D},lc(h),wu(h,Ci,D)):((s.lanes&y)!==0&&(ld(s,h),an(h,null,null,y),uc()),D=s.memoizedState,B=h.memoizedState,D.parent!==w?(D={parent:w,cache:w},h.memoizedState=D,h.lanes===0&&(h.memoizedState=h.updateQueue.baseState=D),wu(h,Ci,w)):(w=B.cache,wu(h,Ci,w),w!==D.cache&&nc(h,[Ci],y,!0))),Is(s,h,h.pendingProps.children,y),h.child;case 29:throw h.pendingProps}throw Error(a(156,h.tag))}function $c(s){s.flags|=4}function Yg(s,h,y,w,D){if((h=(s.mode&32)!==0)&&(h=!1),h){if(s.flags|=16777216,(D&335544128)===D)if(s.stateNode.complete)s.flags|=8192;else if(h_())s.flags|=8192;else throw eu=Bc,ac}else s.flags&=-16777217}function Xy(s,h){if(h.type!=="stylesheet"||(h.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!dn(h))if(h_())s.flags|=8192;else throw eu=Bc,ac}function mm(s,h){h!==null&&(s.flags|=4),s.flags&16384&&(h=s.tag!==22?Ri():536870912,s.lanes|=h,Xr|=h)}function tp(s,h){if(!ui)switch(s.tailMode){case"hidden":h=s.tail;for(var y=null;h!==null;)h.alternate!==null&&(y=h),h=h.sibling;y===null?s.tail=null:y.sibling=null;break;case"collapsed":y=s.tail;for(var w=null;y!==null;)y.alternate!==null&&(w=y),y=y.sibling;w===null?h||s.tail===null?s.tail=null:s.tail.sibling=null:w.sibling=null}}function Rr(s){var h=s.alternate!==null&&s.alternate.child===s.child,y=0,w=0;if(h)for(var D=s.child;D!==null;)y|=D.lanes|D.childLanes,w|=D.subtreeFlags&65011712,w|=D.flags&65011712,D.return=s,D=D.sibling;else for(D=s.child;D!==null;)y|=D.lanes|D.childLanes,w|=D.subtreeFlags,w|=D.flags,D.return=s,D=D.sibling;return s.subtreeFlags|=w,s.childLanes=y,h}function Rb(s,h,y){var w=h.pendingProps;switch(Zr(h),h.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Rr(h),null;case 1:return Rr(h),null;case 3:return y=h.stateNode,w=null,s!==null&&(w=s.memoizedState.cache),h.memoizedState.cache!==w&&(h.flags|=2048),Kl(Ci),fi(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(s===null||s.child===null)&&(rs(h)?$c(h):s===null||s.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,Oo())),Rr(h),null;case 26:var D=h.type,B=h.memoizedState;return s===null?($c(h),B!==null?(Rr(h),Xy(h,B)):(Rr(h),Yg(h,D,null,w,y))):B?B!==s.memoizedState?($c(h),Rr(h),Xy(h,B)):(Rr(h),h.flags&=-16777217):(s=s.memoizedProps,s!==w&&$c(h),Rr(h),Yg(h,D,s,w,y)),null;case 27:if(Ns(h),y=Wt.current,D=h.type,s!==null&&h.stateNode!=null)s.memoizedProps!==w&&$c(h);else{if(!w){if(h.stateNode===null)throw Error(a(166));return Rr(h),null}s=Ut.current,rs(h)?bu(h):(s=_f(D,w,y),h.stateNode=s,$c(h))}return Rr(h),null;case 5:if(Ns(h),D=h.type,s!==null&&h.stateNode!=null)s.memoizedProps!==w&&$c(h);else{if(!w){if(h.stateNode===null)throw Error(a(166));return Rr(h),null}if(B=Ut.current,rs(h))bu(h);else{var Q=Md(Wt.current);switch(B){case 1:B=Q.createElementNS("http://www.w3.org/2000/svg",D);break;case 2:B=Q.createElementNS("http://www.w3.org/1998/Math/MathML",D);break;default:switch(D){case"svg":B=Q.createElementNS("http://www.w3.org/2000/svg",D);break;case"math":B=Q.createElementNS("http://www.w3.org/1998/Math/MathML",D);break;case"script":B=Q.createElement("div"),B.innerHTML="<script><\/script>",B=B.removeChild(B.firstChild);break;case"select":B=typeof w.is=="string"?Q.createElement("select",{is:w.is}):Q.createElement("select"),w.multiple?B.multiple=!0:w.size&&(B.size=w.size);break;default:B=typeof w.is=="string"?Q.createElement(D,{is:w.is}):Q.createElement(D)}}B[kt]=h,B[yn]=w;e:for(Q=h.child;Q!==null;){if(Q.tag===5||Q.tag===6)B.appendChild(Q.stateNode);else if(Q.tag!==4&&Q.tag!==27&&Q.child!==null){Q.child.return=Q,Q=Q.child;continue}if(Q===h)break e;for(;Q.sibling===null;){if(Q.return===null||Q.return===h)break e;Q=Q.return}Q.sibling.return=Q.return,Q=Q.sibling}h.stateNode=B;e:switch(io(B,D,w),D){case"button":case"input":case"select":case"textarea":w=!!w.autoFocus;break e;case"img":w=!0;break e;default:w=!1}w&&$c(h)}}return Rr(h),Yg(h,h.type,s===null?null:s.memoizedProps,h.pendingProps,y),null;case 6:if(s&&h.stateNode!=null)s.memoizedProps!==w&&$c(h);else{if(typeof w!="string"&&h.stateNode===null)throw Error(a(166));if(s=Wt.current,rs(h)){if(s=h.stateNode,y=h.memoizedProps,w=null,D=Si,D!==null)switch(D.tag){case 27:case 5:w=D.memoizedProps}s[kt]=h,s=!!(s.nodeValue===y||w!==null&&w.suppressHydrationWarning===!0||S_(s.nodeValue,y)),s||zo(h,!0)}else s=Md(s).createTextNode(w),s[kt]=h,h.stateNode=s}return Rr(h),null;case 31:if(y=h.memoizedState,s===null||s.memoizedState!==null){if(w=rs(h),y!==null){if(s===null){if(!w)throw Error(a(318));if(s=h.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(a(557));s[kt]=h}else fl(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Rr(h),s=!1}else y=Oo(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=y),s=!0;if(!s)return h.flags&256?(Wa(h),h):(Wa(h),null);if((h.flags&128)!==0)throw Error(a(558))}return Rr(h),null;case 13:if(w=h.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(D=rs(h),w!==null&&w.dehydrated!==null){if(s===null){if(!D)throw Error(a(318));if(D=h.memoizedState,D=D!==null?D.dehydrated:null,!D)throw Error(a(317));D[kt]=h}else fl(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Rr(h),D=!1}else D=Oo(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=D),D=!0;if(!D)return h.flags&256?(Wa(h),h):(Wa(h),null)}return Wa(h),(h.flags&128)!==0?(h.lanes=y,h):(y=w!==null,s=s!==null&&s.memoizedState!==null,y&&(w=h.child,D=null,w.alternate!==null&&w.alternate.memoizedState!==null&&w.alternate.memoizedState.cachePool!==null&&(D=w.alternate.memoizedState.cachePool.pool),B=null,w.memoizedState!==null&&w.memoizedState.cachePool!==null&&(B=w.memoizedState.cachePool.pool),B!==D&&(w.flags|=2048)),y!==s&&y&&(h.child.flags|=8192),mm(h,h.updateQueue),Rr(h),null);case 4:return fi(),s===null&&Id(h.stateNode.containerInfo),Rr(h),null;case 10:return Kl(h.type),Rr(h),null;case 19:if(xt(Wr),w=h.memoizedState,w===null)return Rr(h),null;if(D=(h.flags&128)!==0,B=w.rendering,B===null)if(D)tp(w,!1);else{if(_a!==0||s!==null&&(s.flags&128)!==0)for(s=h.child;s!==null;){if(B=Au(s),B!==null){for(h.flags|=128,tp(w,!1),s=B.updateQueue,h.updateQueue=s,mm(h,s),h.subtreeFlags=0,s=y,y=h.child;y!==null;)nd(y,s),y=y.sibling;return Ot(Wr,Wr.current&1|2),ui&&pn(h,w.treeForkCount),h.child}s=s.sibling}w.tail!==null&&qr()>lp&&(h.flags|=128,D=!0,tp(w,!1),h.lanes=4194304)}else{if(!D)if(s=Au(B),s!==null){if(h.flags|=128,D=!0,s=s.updateQueue,h.updateQueue=s,mm(h,s),tp(w,!0),w.tail===null&&w.tailMode==="hidden"&&!B.alternate&&!ui)return Rr(h),null}else 2*qr()-w.renderingStartTime>lp&&y!==536870912&&(h.flags|=128,D=!0,tp(w,!1),h.lanes=4194304);w.isBackwards?(B.sibling=h.child,h.child=B):(s=w.last,s!==null?s.sibling=B:h.child=B,w.last=B)}return w.tail!==null?(s=w.tail,w.rendering=s,w.tail=s.sibling,w.renderingStartTime=qr(),s.sibling=null,y=Wr.current,Ot(Wr,D?y&1|2:y&1),ui&&pn(h,w.treeForkCount),s):(Rr(h),null);case 22:case 23:return Wa(h),ho(),w=h.memoizedState!==null,s!==null?s.memoizedState!==null!==w&&(h.flags|=8192):w&&(h.flags|=8192),w?(y&536870912)!==0&&(h.flags&128)===0&&(Rr(h),h.subtreeFlags&6&&(h.flags|=8192)):Rr(h),y=h.updateQueue,y!==null&&mm(h,y.retryQueue),y=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(y=s.memoizedState.cachePool.pool),w=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(w=h.memoizedState.cachePool.pool),w!==y&&(h.flags|=2048),s!==null&&xt(as),null;case 24:return y=null,s!==null&&(y=s.memoizedState.cache),h.memoizedState.cache!==y&&(h.flags|=2048),Kl(Ci),Rr(h),null;case 25:return null;case 30:return null}throw Error(a(156,h.tag))}function Ky(s,h){switch(Zr(h),h.tag){case 1:return s=h.flags,s&65536?(h.flags=s&-65537|128,h):null;case 3:return Kl(Ci),fi(),s=h.flags,(s&65536)!==0&&(s&128)===0?(h.flags=s&-65537|128,h):null;case 26:case 27:case 5:return Ns(h),null;case 31:if(h.memoizedState!==null){if(Wa(h),h.alternate===null)throw Error(a(340));fl()}return s=h.flags,s&65536?(h.flags=s&-65537|128,h):null;case 13:if(Wa(h),s=h.memoizedState,s!==null&&s.dehydrated!==null){if(h.alternate===null)throw Error(a(340));fl()}return s=h.flags,s&65536?(h.flags=s&-65537|128,h):null;case 19:return xt(Wr),null;case 4:return fi(),null;case 10:return Kl(h.type),null;case 22:case 23:return Wa(h),ho(),s!==null&&xt(as),s=h.flags,s&65536?(h.flags=s&-65537|128,h):null;case 24:return Kl(Ci),null;case 25:return null;default:return null}}function tf(s,h){switch(Zr(h),h.tag){case 3:Kl(Ci),fi();break;case 26:case 27:case 5:Ns(h);break;case 4:fi();break;case 31:h.memoizedState!==null&&Wa(h);break;case 13:Wa(h);break;case 19:xt(Wr);break;case 10:Kl(h.type);break;case 22:case 23:Wa(h),ho(),s!==null&&xt(as);break;case 24:Kl(Ci)}}function np(s,h){try{var y=h.updateQueue,w=y!==null?y.lastEffect:null;if(w!==null){var D=w.next;y=D;do{if((y.tag&s)===s){w=void 0;var B=y.create,Q=y.inst;w=B(),Q.destroy=w}y=y.next}while(y!==D)}}catch(he){Qi(h,h.return,he)}}function hr(s,h,y){try{var w=h.updateQueue,D=w!==null?w.lastEffect:null;if(D!==null){var B=D.next;w=B;do{if((w.tag&s)===s){var Q=w.inst,he=Q.destroy;if(he!==void 0){Q.destroy=void 0,D=h;var Ue=y,dt=he;try{dt()}catch(vt){Qi(D,Ue,vt)}}}w=w.next}while(w!==B)}}catch(vt){Qi(h,h.return,vt)}}function _d(s){var h=s.updateQueue;if(h!==null){var y=s.stateNode;try{ud(h,y)}catch(w){Qi(s,s.return,w)}}}function Qg(s,h,y){y.props=Th(s.type,s.memoizedProps),y.state=s.memoizedState;try{y.componentWillUnmount()}catch(w){Qi(s,h,w)}}function Eh(s,h){try{var y=s.ref;if(y!==null){switch(s.tag){case 26:case 27:case 5:var w=s.stateNode;break;case 30:w=s.stateNode;break;default:w=s.stateNode}typeof y=="function"?s.refCleanup=y(w):y.current=w}}catch(D){Qi(s,h,D)}}function Nl(s,h){var y=s.ref,w=s.refCleanup;if(y!==null)if(typeof w=="function")try{w()}catch(D){Qi(s,h,D)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof y=="function")try{y(null)}catch(D){Qi(s,h,D)}else y.current=null}function nf(s){var h=s.type,y=s.memoizedProps,w=s.stateNode;try{e:switch(h){case"button":case"input":case"select":case"textarea":y.autoFocus&&w.focus();break e;case"img":y.src?w.src=y.src:y.srcSet&&(w.srcset=y.srcSet)}}catch(D){Qi(s,s.return,D)}}function gm(s,h,y){try{var w=s.stateNode;Bb(w,s.type,y,h),w[yn]=h}catch(D){Qi(s,s.return,D)}}function Jg(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&bc(s.type)||s.tag===4}function yd(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Jg(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&bc(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function ip(s,h,y){var w=s.tag;if(w===5||w===6)s=s.stateNode,h?(y.nodeType===9?y.body:y.nodeName==="HTML"?y.ownerDocument.body:y).insertBefore(s,h):(h=y.nodeType===9?y.body:y.nodeName==="HTML"?y.ownerDocument.body:y,h.appendChild(s),y=y._reactRootContainer,y!=null||h.onclick!==null||(h.onclick=Ia));else if(w!==4&&(w===27&&bc(s.type)&&(y=s.stateNode,h=null),s=s.child,s!==null))for(ip(s,h,y),s=s.sibling;s!==null;)ip(s,h,y),s=s.sibling}function Gc(s,h,y){var w=s.tag;if(w===5||w===6)s=s.stateNode,h?y.insertBefore(s,h):y.appendChild(s);else if(w!==4&&(w===27&&bc(s.type)&&(y=s.stateNode),s=s.child,s!==null))for(Gc(s,h,y),s=s.sibling;s!==null;)Gc(s,h,y),s=s.sibling}function rp(s){var h=s.stateNode,y=s.memoizedProps;try{for(var w=s.type,D=h.attributes;D.length;)h.removeAttributeNode(D[0]);io(h,w,y),h[kt]=s,h[yn]=y}catch(B){Qi(s,s.return,B)}}var bl=!1,Qr=!1,e_=!1,t_=typeof WeakSet=="function"?WeakSet:Set,Jr=null;function Lb(s,h){if(s=s.containerInfo,gf=va,s=Wu(s),ll(s)){if("selectionStart"in s)var y={start:s.selectionStart,end:s.selectionEnd};else e:{y=(y=s.ownerDocument)&&y.defaultView||window;var w=y.getSelection&&y.getSelection();if(w&&w.rangeCount!==0){y=w.anchorNode;var D=w.anchorOffset,B=w.focusNode;w=w.focusOffset;try{y.nodeType,B.nodeType}catch{y=null;break e}var Q=0,he=-1,Ue=-1,dt=0,vt=0,Et=s,ft=null;t:for(;;){for(var yt;Et!==y||D!==0&&Et.nodeType!==3||(he=Q+D),Et!==B||w!==0&&Et.nodeType!==3||(Ue=Q+w),Et.nodeType===3&&(Q+=Et.nodeValue.length),(yt=Et.firstChild)!==null;)ft=Et,Et=yt;for(;;){if(Et===s)break t;if(ft===y&&++dt===D&&(he=Q),ft===B&&++vt===w&&(Ue=Q),(yt=Et.nextSibling)!==null)break;Et=ft,ft=Et.parentNode}Et=yt}y=he===-1||Ue===-1?null:{start:he,end:Ue}}else y=null}y=y||{start:0,end:0}}else y=null;for(Lm={focusedElem:s,selectionRange:y},va=!1,Jr=h;Jr!==null;)if(h=Jr,s=h.child,(h.subtreeFlags&1028)!==0&&s!==null)s.return=h,Jr=s;else for(;Jr!==null;){switch(h=Jr,B=h.alternate,s=h.flags,h.tag){case 0:if((s&4)!==0&&(s=h.updateQueue,s=s!==null?s.events:null,s!==null))for(y=0;y<s.length;y++)D=s[y],D.ref.impl=D.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&B!==null){s=void 0,y=h,D=B.memoizedProps,B=B.memoizedState,w=y.stateNode;try{var cn=Th(y.type,D);s=w.getSnapshotBeforeUpdate(cn,B),w.__reactInternalSnapshotBeforeUpdate=s}catch(En){Qi(y,y.return,En)}}break;case 3:if((s&1024)!==0){if(s=h.stateNode.containerInfo,y=s.nodeType,y===9)Dm(s);else if(y===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Dm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(a(163))}if(s=h.sibling,s!==null){s.return=h.return,Jr=s;break}Jr=h.return}}function n_(s,h,y){var w=y.flags;switch(y.tag){case 0:case 11:case 15:gc(s,y),w&4&&np(5,y);break;case 1:if(gc(s,y),w&4)if(s=y.stateNode,h===null)try{s.componentDidMount()}catch(Q){Qi(y,y.return,Q)}else{var D=Th(y.type,h.memoizedProps);h=h.memoizedState;try{s.componentDidUpdate(D,h,s.__reactInternalSnapshotBeforeUpdate)}catch(Q){Qi(y,y.return,Q)}}w&64&&_d(y),w&512&&Eh(y,y.return);break;case 3:if(gc(s,y),w&64&&(s=y.updateQueue,s!==null)){if(h=null,y.child!==null)switch(y.child.tag){case 27:case 5:h=y.child.stateNode;break;case 1:h=y.child.stateNode}try{ud(s,h)}catch(Q){Qi(y,y.return,Q)}}break;case 27:h===null&&w&4&&rp(y);case 26:case 5:gc(s,y),h===null&&w&4&&nf(y),w&512&&Eh(y,y.return);break;case 12:gc(s,y);break;case 31:gc(s,y),w&4&&Qy(s,y);break;case 13:gc(s,y),w&4&&Jy(s,y),w&64&&(s=y.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(y=y_.bind(null,y),vp(s,y))));break;case 22:if(w=y.memoizedState!==null||bl,!w){h=h!==null&&h.memoizedState!==null||Qr,D=bl;var B=Qr;bl=w,(Qr=h)&&!B?Pu(s,y,(y.subtreeFlags&8772)!==0):gc(s,y),bl=D,Qr=B}break;case 30:break;default:gc(s,y)}}function rf(s){var h=s.alternate;h!==null&&(s.alternate=null,rf(h)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(h=s.stateNode,h!==null&&Us(h)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Ur=null,$o=!1;function mc(s,h,y){for(y=y.child;y!==null;)Yy(s,h,y),y=y.sibling}function Yy(s,h,y){if(De&&typeof De.onCommitFiberUnmount=="function")try{De.onCommitFiberUnmount(Se,y)}catch{}switch(y.tag){case 26:Qr||Nl(y,h),mc(s,h,y),y.memoizedState?y.memoizedState.count--:y.stateNode&&(y=y.stateNode,y.parentNode.removeChild(y));break;case 27:Qr||Nl(y,h);var w=Ur,D=$o;bc(y.type)&&(Ur=y.stateNode,$o=!1),mc(s,h,y),Rd(y.stateNode),Ur=w,$o=D;break;case 5:Qr||Nl(y,h);case 6:if(w=Ur,D=$o,Ur=null,mc(s,h,y),Ur=w,$o=D,Ur!==null)if($o)try{(Ur.nodeType===9?Ur.body:Ur.nodeName==="HTML"?Ur.ownerDocument.body:Ur).removeChild(y.stateNode)}catch(B){Qi(y,h,B)}else try{Ur.removeChild(y.stateNode)}catch(B){Qi(y,h,B)}break;case 18:Ur!==null&&($o?(s=Ur,Cv(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,y.stateNode),Sl(s)):Cv(Ur,y.stateNode));break;case 4:w=Ur,D=$o,Ur=y.stateNode.containerInfo,$o=!0,mc(s,h,y),Ur=w,$o=D;break;case 0:case 11:case 14:case 15:hr(2,y,h),Qr||hr(4,y,h),mc(s,h,y);break;case 1:Qr||(Nl(y,h),w=y.stateNode,typeof w.componentWillUnmount=="function"&&Qg(y,h,w)),mc(s,h,y);break;case 21:mc(s,h,y);break;case 22:Qr=(w=Qr)||y.memoizedState!==null,mc(s,h,y),Qr=w;break;default:mc(s,h,y)}}function Qy(s,h){if(h.memoizedState===null&&(s=h.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Sl(s)}catch(y){Qi(h,h.return,y)}}}function Jy(s,h){if(h.memoizedState===null&&(s=h.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Sl(s)}catch(y){Qi(h,h.return,y)}}function kb(s){switch(s.tag){case 31:case 13:case 19:var h=s.stateNode;return h===null&&(h=s.stateNode=new t_),h;case 22:return s=s.stateNode,h=s._retryCache,h===null&&(h=s._retryCache=new t_),h;default:throw Error(a(435,s.tag))}}function _m(s,h){var y=kb(s);h.forEach(function(w){if(!y.has(w)){y.add(w);var D=ff.bind(null,s,w);w.then(D,D)}})}function os(s,h){var y=h.deletions;if(y!==null)for(var w=0;w<y.length;w++){var D=y[w],B=s,Q=h,he=Q;e:for(;he!==null;){switch(he.tag){case 27:if(bc(he.type)){Ur=he.stateNode,$o=!1;break e}break;case 5:Ur=he.stateNode,$o=!1;break e;case 3:case 4:Ur=he.stateNode.containerInfo,$o=!0;break e}he=he.return}if(Ur===null)throw Error(a(160));Yy(B,Q,D),Ur=null,$o=!1,B=D.alternate,B!==null&&(B.return=null),D.return=null}if(h.subtreeFlags&13886)for(h=h.child;h!==null;)ev(h,s),h=h.sibling}var Mu=null;function ev(s,h){var y=s.alternate,w=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:os(h,s),Go(s),w&4&&(hr(3,s,s.return),np(3,s),hr(5,s,s.return));break;case 1:os(h,s),Go(s),w&512&&(Qr||y===null||Nl(y,y.return)),w&64&&bl&&(s=s.updateQueue,s!==null&&(w=s.callbacks,w!==null&&(y=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=y===null?w:y.concat(w))));break;case 26:var D=Mu;if(os(h,s),Go(s),w&512&&(Qr||y===null||Nl(y,y.return)),w&4){var B=y!==null?y.memoizedState:null;if(w=s.memoizedState,y===null)if(w===null)if(s.stateNode===null){e:{w=s.type,y=s.memoizedProps,D=D.ownerDocument||D;t:switch(w){case"title":B=D.getElementsByTagName("title")[0],(!B||B[Vs]||B[kt]||B.namespaceURI==="http://www.w3.org/2000/svg"||B.hasAttribute("itemprop"))&&(B=D.createElement(w),D.head.insertBefore(B,D.querySelector("head > title"))),io(B,w,y),B[kt]=s,Mr(B),w=B;break e;case"link":var Q=$t("link","href",D).get(w+(y.href||""));if(Q){for(var he=0;he<Q.length;he++)if(B=Q[he],B.getAttribute("href")===(y.href==null||y.href===""?null:y.href)&&B.getAttribute("rel")===(y.rel==null?null:y.rel)&&B.getAttribute("title")===(y.title==null?null:y.title)&&B.getAttribute("crossorigin")===(y.crossOrigin==null?null:y.crossOrigin)){Q.splice(he,1);break t}}B=D.createElement(w),io(B,w,y),D.head.appendChild(B);break;case"meta":if(Q=$t("meta","content",D).get(w+(y.content||""))){for(he=0;he<Q.length;he++)if(B=Q[he],B.getAttribute("content")===(y.content==null?null:""+y.content)&&B.getAttribute("name")===(y.name==null?null:y.name)&&B.getAttribute("property")===(y.property==null?null:y.property)&&B.getAttribute("http-equiv")===(y.httpEquiv==null?null:y.httpEquiv)&&B.getAttribute("charset")===(y.charSet==null?null:y.charSet)){Q.splice(he,1);break t}}B=D.createElement(w),io(B,w,y),D.head.appendChild(B);break;default:throw Error(a(468,w))}B[kt]=s,Mr(B),w=B}s.stateNode=w}else Bt(D,s.type,s.stateNode);else s.stateNode=Le(D,w,s.memoizedProps);else B!==w?(B===null?y.stateNode!==null&&(y=y.stateNode,y.parentNode.removeChild(y)):B.count--,w===null?Bt(D,s.type,s.stateNode):Le(D,w,s.memoizedProps)):w===null&&s.stateNode!==null&&gm(s,s.memoizedProps,y.memoizedProps)}break;case 27:os(h,s),Go(s),w&512&&(Qr||y===null||Nl(y,y.return)),y!==null&&w&4&&gm(s,s.memoizedProps,y.memoizedProps);break;case 5:if(os(h,s),Go(s),w&512&&(Qr||y===null||Nl(y,y.return)),s.flags&32){D=s.stateNode;try{Hi(D,"")}catch(cn){Qi(s,s.return,cn)}}w&4&&s.stateNode!=null&&(D=s.memoizedProps,gm(s,D,y!==null?y.memoizedProps:D)),w&1024&&(e_=!0);break;case 6:if(os(h,s),Go(s),w&4){if(s.stateNode===null)throw Error(a(162));w=s.memoizedProps,y=s.stateNode;try{y.nodeValue=w}catch(cn){Qi(s,s.return,cn)}}break;case 3:if(It=null,D=Mu,Mu=Vm(h.containerInfo),os(h,s),Mu=D,Go(s),w&4&&y!==null&&y.memoizedState.isDehydrated)try{Sl(h.containerInfo)}catch(cn){Qi(s,s.return,cn)}e_&&(e_=!1,tv(s));break;case 4:w=Mu,Mu=Vm(s.stateNode.containerInfo),os(h,s),Go(s),Mu=w;break;case 12:os(h,s),Go(s);break;case 31:os(h,s),Go(s),w&4&&(w=s.updateQueue,w!==null&&(s.updateQueue=null,_m(s,w)));break;case 13:os(h,s),Go(s),s.child.flags&8192&&s.memoizedState!==null!=(y!==null&&y.memoizedState!==null)&&(lf=qr()),w&4&&(w=s.updateQueue,w!==null&&(s.updateQueue=null,_m(s,w)));break;case 22:D=s.memoizedState!==null;var Ue=y!==null&&y.memoizedState!==null,dt=bl,vt=Qr;if(bl=dt||D,Qr=vt||Ue,os(h,s),Qr=vt,bl=dt,Go(s),w&8192)e:for(h=s.stateNode,h._visibility=D?h._visibility&-2:h._visibility|1,D&&(y===null||Ue||bl||Qr||vd(s)),y=null,h=s;;){if(h.tag===5||h.tag===26){if(y===null){Ue=y=h;try{if(B=Ue.stateNode,D)Q=B.style,typeof Q.setProperty=="function"?Q.setProperty("display","none","important"):Q.display="none";else{he=Ue.stateNode;var Et=Ue.memoizedProps.style,ft=Et!=null&&Et.hasOwnProperty("display")?Et.display:null;he.style.display=ft==null||typeof ft=="boolean"?"":(""+ft).trim()}}catch(cn){Qi(Ue,Ue.return,cn)}}}else if(h.tag===6){if(y===null){Ue=h;try{Ue.stateNode.nodeValue=D?"":Ue.memoizedProps}catch(cn){Qi(Ue,Ue.return,cn)}}}else if(h.tag===18){if(y===null){Ue=h;try{var yt=Ue.stateNode;D?I_(yt,!0):I_(Ue.stateNode,!1)}catch(cn){Qi(Ue,Ue.return,cn)}}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===s)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===s)break e;for(;h.sibling===null;){if(h.return===null||h.return===s)break e;y===h&&(y=null),h=h.return}y===h&&(y=null),h.sibling.return=h.return,h=h.sibling}w&4&&(w=s.updateQueue,w!==null&&(y=w.retryQueue,y!==null&&(w.retryQueue=null,_m(s,y))));break;case 19:os(h,s),Go(s),w&4&&(w=s.updateQueue,w!==null&&(s.updateQueue=null,_m(s,w)));break;case 30:break;case 21:break;default:os(h,s),Go(s)}}function Go(s){var h=s.flags;if(h&2){try{for(var y,w=s.return;w!==null;){if(Jg(w)){y=w;break}w=w.return}if(y==null)throw Error(a(160));switch(y.tag){case 27:var D=y.stateNode,B=yd(s);Gc(s,B,D);break;case 5:var Q=y.stateNode;y.flags&32&&(Hi(Q,""),y.flags&=-33);var he=yd(s);Gc(s,he,Q);break;case 3:case 4:var Ue=y.stateNode.containerInfo,dt=yd(s);ip(s,dt,Ue);break;default:throw Error(a(161))}}catch(vt){Qi(s,s.return,vt)}s.flags&=-3}h&4096&&(s.flags&=-4097)}function tv(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var h=s;tv(h),h.tag===5&&h.flags&1024&&h.stateNode.reset(),s=s.sibling}}function gc(s,h){if(h.subtreeFlags&8772)for(h=h.child;h!==null;)n_(s,h.alternate,h),h=h.sibling}function vd(s){for(s=s.child;s!==null;){var h=s;switch(h.tag){case 0:case 11:case 14:case 15:hr(4,h,h.return),vd(h);break;case 1:Nl(h,h.return);var y=h.stateNode;typeof y.componentWillUnmount=="function"&&Qg(h,h.return,y),vd(h);break;case 27:Rd(h.stateNode);case 26:case 5:Nl(h,h.return),vd(h);break;case 22:h.memoizedState===null&&vd(h);break;case 30:vd(h);break;default:vd(h)}s=s.sibling}}function Pu(s,h,y){for(y=y&&(h.subtreeFlags&8772)!==0,h=h.child;h!==null;){var w=h.alternate,D=s,B=h,Q=B.flags;switch(B.tag){case 0:case 11:case 15:Pu(D,B,y),np(4,B);break;case 1:if(Pu(D,B,y),w=B,D=w.stateNode,typeof D.componentDidMount=="function")try{D.componentDidMount()}catch(dt){Qi(w,w.return,dt)}if(w=B,D=w.updateQueue,D!==null){var he=w.stateNode;try{var Ue=D.shared.hiddenCallbacks;if(Ue!==null)for(D.shared.hiddenCallbacks=null,D=0;D<Ue.length;D++)Tn(Ue[D],he)}catch(dt){Qi(w,w.return,dt)}}y&&Q&64&&_d(B),Eh(B,B.return);break;case 27:rp(B);case 26:case 5:Pu(D,B,y),y&&w===null&&Q&4&&nf(B),Eh(B,B.return);break;case 12:Pu(D,B,y);break;case 31:Pu(D,B,y),y&&Q&4&&Qy(D,B);break;case 13:Pu(D,B,y),y&&Q&4&&Jy(D,B);break;case 22:B.memoizedState===null&&Pu(D,B,y),Eh(B,B.return);break;case 30:break;default:Pu(D,B,y)}h=h.sibling}}function bd(s,h){var y=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(y=s.memoizedState.cachePool.pool),s=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(s=h.memoizedState.cachePool.pool),s!==y&&(s!=null&&s.refCount++,y!=null&&Yl(y))}function ap(s,h){s=null,h.alternate!==null&&(s=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==s&&(h.refCount++,s!=null&&Yl(s))}function Ru(s,h,y,w){if(h.subtreeFlags&10256)for(h=h.child;h!==null;)nv(s,h,y,w),h=h.sibling}function nv(s,h,y,w){var D=h.flags;switch(h.tag){case 0:case 11:case 15:Ru(s,h,y,w),D&2048&&np(9,h);break;case 1:Ru(s,h,y,w);break;case 3:Ru(s,h,y,w),D&2048&&(s=null,h.alternate!==null&&(s=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==s&&(h.refCount++,s!=null&&Yl(s)));break;case 12:if(D&2048){Ru(s,h,y,w),s=h.stateNode;try{var B=h.memoizedProps,Q=B.id,he=B.onPostCommit;typeof he=="function"&&he(Q,h.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(Ue){Qi(h,h.return,Ue)}}else Ru(s,h,y,w);break;case 31:Ru(s,h,y,w);break;case 13:Ru(s,h,y,w);break;case 23:break;case 22:B=h.stateNode,Q=h.alternate,h.memoizedState!==null?B._visibility&2?Ru(s,h,y,w):af(s,h):B._visibility&2?Ru(s,h,y,w):(B._visibility|=2,xd(s,h,y,w,(h.subtreeFlags&10256)!==0||!1)),D&2048&&bd(Q,h);break;case 24:Ru(s,h,y,w),D&2048&&ap(h.alternate,h);break;default:Ru(s,h,y,w)}}function xd(s,h,y,w,D){for(D=D&&((h.subtreeFlags&10256)!==0||!1),h=h.child;h!==null;){var B=s,Q=h,he=y,Ue=w,dt=Q.flags;switch(Q.tag){case 0:case 11:case 15:xd(B,Q,he,Ue,D),np(8,Q);break;case 23:break;case 22:var vt=Q.stateNode;Q.memoizedState!==null?vt._visibility&2?xd(B,Q,he,Ue,D):af(B,Q):(vt._visibility|=2,xd(B,Q,he,Ue,D)),D&&dt&2048&&bd(Q.alternate,Q);break;case 24:xd(B,Q,he,Ue,D),D&&dt&2048&&ap(Q.alternate,Q);break;default:xd(B,Q,he,Ue,D)}h=h.sibling}}function af(s,h){if(h.subtreeFlags&10256)for(h=h.child;h!==null;){var y=s,w=h,D=w.flags;switch(w.tag){case 22:af(y,w),D&2048&&bd(w.alternate,w);break;case 24:af(y,w),D&2048&&ap(w.alternate,w);break;default:af(y,w)}h=h.sibling}}var sp=8192;function sf(s,h,y){if(s.subtreeFlags&sp)for(s=s.child;s!==null;)of(s,h,y),s=s.sibling}function of(s,h,y){switch(s.tag){case 26:sf(s,h,y),s.flags&sp&&s.memoizedState!==null&&qt(y,Mu,s.memoizedState,s.memoizedProps);break;case 5:sf(s,h,y);break;case 3:case 4:var w=Mu;Mu=Vm(s.stateNode.containerInfo),sf(s,h,y),Mu=w;break;case 22:s.memoizedState===null&&(w=s.alternate,w!==null&&w.memoizedState!==null?(w=sp,sp=16777216,sf(s,h,y),sp=w):sf(s,h,y));break;default:sf(s,h,y)}}function i_(s){var h=s.alternate;if(h!==null&&(s=h.child,s!==null)){h.child=null;do h=s.sibling,s.sibling=null,s=h;while(s!==null)}}function op(s){var h=s.deletions;if((s.flags&16)!==0){if(h!==null)for(var y=0;y<h.length;y++){var w=h[y];Jr=w,rv(w,s)}i_(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)iv(s),s=s.sibling}function iv(s){switch(s.tag){case 0:case 11:case 15:op(s),s.flags&2048&&hr(9,s,s.return);break;case 3:op(s);break;case 12:op(s);break;case 22:var h=s.stateNode;s.memoizedState!==null&&h._visibility&2&&(s.return===null||s.return.tag!==13)?(h._visibility&=-3,ym(s)):op(s);break;default:op(s)}}function ym(s){var h=s.deletions;if((s.flags&16)!==0){if(h!==null)for(var y=0;y<h.length;y++){var w=h[y];Jr=w,rv(w,s)}i_(s)}for(s=s.child;s!==null;){switch(h=s,h.tag){case 0:case 11:case 15:hr(8,h,h.return),ym(h);break;case 22:y=h.stateNode,y._visibility&2&&(y._visibility&=-3,ym(h));break;default:ym(h)}s=s.sibling}}function rv(s,h){for(;Jr!==null;){var y=Jr;switch(y.tag){case 0:case 11:case 15:hr(8,y,h);break;case 23:case 22:if(y.memoizedState!==null&&y.memoizedState.cachePool!==null){var w=y.memoizedState.cachePool.pool;w!=null&&w.refCount++}break;case 24:Yl(y.memoizedState.cache)}if(w=y.child,w!==null)w.return=y,Jr=w;else e:for(y=s;Jr!==null;){w=Jr;var D=w.sibling,B=w.return;if(rf(w),w===y){Jr=null;break e}if(D!==null){D.return=B,Jr=D;break e}Jr=B}}}var Db={getCacheForType:function(s){var h=Ha(Ci),y=h.data.get(s);return y===void 0&&(y=s(),h.data.set(s,y)),y},cacheSignal:function(){return Ha(Ci).controller.signal}},av=typeof WeakMap=="function"?WeakMap:Map,$i=0,Sr=null,_i=null,xi=0,gr=0,mo=null,Ah=!1,wd=!1,r_=!1,Zc=0,_a=0,Hc=0,Td=0,a_=0,no=0,Xr=0,Sd=null,Zo=null,vm=!1,lf=0,Ed=0,lp=1/0,bm=null,Ch=null,ls=0,Ih=null,uf=null,Wc=0,s_=0,o_=null,sv=null,up=0,l_=null;function Bl(){return($i&2)!==0&&xi!==0?xi&-xi:mt.T!==null?vc():nr()}function u_(){if(no===0)if((xi&536870912)===0||ui){var s=tn;tn<<=1,(tn&3932160)===0&&(tn=262144),no=s}else no=536870912;return s=Vo.current,s!==null&&(s.flags|=32),no}function go(s,h,y){(s===Sr&&(gr===2||gr===9)||s.cancelPendingCommit!==null)&&(hf(s,0),Fl(s,xi,no,!1)),tr(s,y),(($i&2)===0||s!==Sr)&&(s===Sr&&(($i&2)===0&&(Td|=y),_a===4&&Fl(s,xi,no,!1)),yc(s))}function c_(s,h,y){if(($i&6)!==0)throw Error(a(327));var w=!y&&(h&127)===0&&(h&s.expiredLanes)===0||nn(s,h),D=w?p_(s,h):xm(s,h,!0),B=w;do{if(D===0){wd&&!w&&Fl(s,h,0,!1);break}else{if(y=s.current.alternate,B&&!cp(y)){D=xm(s,h,!1),B=!1;continue}if(D===2){if(B=h,s.errorRecoveryDisabledLanes&B)var Q=0;else Q=s.pendingLanes&-536870913,Q=Q!==0?Q:Q&536870912?536870912:0;if(Q!==0){h=Q;e:{var he=s;D=Sd;var Ue=he.current.memoizedState.isDehydrated;if(Ue&&(hf(he,Q).flags|=256),Q=xm(he,Q,!1),Q!==2){if(r_&&!Ue){he.errorRecoveryDisabledLanes|=B,Td|=B,D=4;break e}B=Zo,Zo=D,B!==null&&(Zo===null?Zo=B:Zo.push.apply(Zo,B))}D=Q}if(B=!1,D!==2)continue}}if(D===1){hf(s,0),Fl(s,h,0,!0);break}e:{switch(w=s,B=D,B){case 0:case 1:throw Error(a(345));case 4:if((h&4194048)!==h)break;case 6:Fl(w,h,no,!Ah);break e;case 2:Zo=null;break;case 3:case 5:break;default:throw Error(a(329))}if((h&62914560)===h&&(D=lf+300-qr(),10<D)){if(Fl(w,h,no,!Ah),Rn(w,0,!0)!==0)break e;Wc=h,w.timeoutHandle=Pd(Xc.bind(null,w,y,Zo,bm,vm,h,no,Td,Xr,Ah,B,"Throttled",-0,0),D);break e}Xc(w,y,Zo,bm,vm,h,no,Td,Xr,Ah,B,null,-0,0)}}break}while(!0);yc(s)}function Xc(s,h,y,w,D,B,Q,he,Ue,dt,vt,Et,ft,yt){if(s.timeoutHandle=-1,Et=h.subtreeFlags,Et&8192||(Et&16785408)===16785408){Et={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ia},of(h,B,Et);var cn=(B&62914560)===B?lf-qr():(B&4194048)===B?Ed-qr():0;if(cn=St(Et,cn),cn!==null){Wc=B,s.cancelPendingCommit=cn(hv.bind(null,s,h,B,y,w,D,Q,he,Ue,vt,Et,null,ft,yt)),Fl(s,B,Q,!dt);return}}hv(s,h,B,y,w,D,Q,he,Ue)}function cp(s){for(var h=s;;){var y=h.tag;if((y===0||y===11||y===15)&&h.flags&16384&&(y=h.updateQueue,y!==null&&(y=y.stores,y!==null)))for(var w=0;w<y.length;w++){var D=y[w],B=D.getSnapshot;D=D.value;try{if(!ra(B(),D))return!1}catch{return!1}}if(y=h.child,h.subtreeFlags&16384&&y!==null)y.return=h,h=y;else{if(h===s)break;for(;h.sibling===null;){if(h.return===null||h.return===s)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function Fl(s,h,y,w){h&=~a_,h&=~Td,s.suspendedLanes|=h,s.pingedLanes&=~h,w&&(s.warmLanes|=h),w=s.expirationTimes;for(var D=h;0<D;){var B=31-et(D),Q=1<<B;w[B]=-1,D&=~Q}y!==0&&Vn(s,y,h)}function Ad(){return($i&6)===0?(pf(0),!1):!0}function cf(){if(_i!==null){if(gr===0)var s=_i.return;else s=_i,pl=Ol=null,X(s),sc=null,Vc=0,s=_i;for(;s!==null;)tf(s.alternate,s),s=s.return;_i=null}}function hf(s,h){var y=s.timeoutHandle;y!==-1&&(s.timeoutHandle=-1,Ps(y)),y=s.cancelPendingCommit,y!==null&&(s.cancelPendingCommit=null,y()),Wc=0,cf(),Sr=s,_i=y=Do(s.current,null),xi=h,gr=0,mo=null,Ah=!1,wd=nn(s,h),r_=!1,Xr=no=a_=Td=Hc=_a=0,Zo=Sd=null,vm=!1,(h&8)!==0&&(h|=h&32);var w=s.entangledLanes;if(w!==0)for(s=s.entanglements,w&=h;0<w;){var D=31-et(w),B=1<<D;h|=s[D],w&=~B}return Zc=h,Yu(),y}function ov(s,h){Gn=null,mt.H=fd,h===rc||h===Jl?(h=sm(),gr=3):h===ac?(h=sm(),gr=4):gr=h===Vg?8:h!==null&&typeof h=="object"&&typeof h.then=="function"?6:1,mo=h,_i===null&&(_a=1,Sh(s,x(h,s.current)))}function h_(){var s=Vo.current;return s===null?!0:(xi&4194048)===xi?Cs===null:(xi&62914560)===xi||(xi&536870912)!==0?s===Cs:!1}function d_(){var s=mt.H;return mt.H=fd,s===null?fd:s}function lv(){var s=mt.A;return mt.A=Db,s}function hp(){_a=4,Ah||(xi&4194048)!==xi&&Vo.current!==null||(wd=!0),(Hc&134217727)===0&&(Td&134217727)===0||Sr===null||Fl(Sr,xi,no,!1)}function xm(s,h,y){var w=$i;$i|=2;var D=d_(),B=lv();(Sr!==s||xi!==h)&&(bm=null,hf(s,h)),h=!1;var Q=_a;e:do try{if(gr!==0&&_i!==null){var he=_i,Ue=mo;switch(gr){case 8:cf(),Q=6;break e;case 3:case 2:case 9:case 6:Vo.current===null&&(h=!0);var dt=gr;if(gr=0,mo=null,df(s,he,Ue,dt),y&&wd){Q=0;break e}break;default:dt=gr,gr=0,mo=null,df(s,he,Ue,dt)}}f_(),Q=_a;break}catch(vt){ov(s,vt)}while(!0);return h&&s.shellSuspendCounter++,pl=Ol=null,$i=w,mt.H=D,mt.A=B,_i===null&&(Sr=null,xi=0,Yu()),Q}function f_(){for(;_i!==null;)m_(_i)}function p_(s,h){var y=$i;$i|=2;var w=d_(),D=lv();Sr!==s||xi!==h?(bm=null,lp=qr()+500,hf(s,h)):wd=nn(s,h);e:do try{if(gr!==0&&_i!==null){h=_i;var B=mo;t:switch(gr){case 1:gr=0,mo=null,df(s,h,B,1);break;case 2:case 9:if(ri(B)){gr=0,mo=null,uv(h);break}h=function(){gr!==2&&gr!==9||Sr!==s||(gr=7),yc(s)},B.then(h,h);break e;case 3:gr=7;break e;case 4:gr=5;break e;case 7:ri(B)?(gr=0,mo=null,uv(h)):(gr=0,mo=null,df(s,h,B,7));break;case 5:var Q=null;switch(_i.tag){case 26:Q=_i.memoizedState;case 5:case 27:var he=_i;if(Q?dn(Q):he.stateNode.complete){gr=0,mo=null;var Ue=he.sibling;if(Ue!==null)_i=Ue;else{var dt=he.return;dt!==null?(_i=dt,wm(dt)):_i=null}break t}}gr=0,mo=null,df(s,h,B,5);break;case 6:gr=0,mo=null,df(s,h,B,6);break;case 8:cf(),_a=6;break e;default:throw Error(a(462))}}zb();break}catch(vt){ov(s,vt)}while(!0);return pl=Ol=null,mt.H=w,mt.A=D,$i=y,_i!==null?0:(Sr=null,xi=0,Yu(),_a)}function zb(){for(;_i!==null&&!wo();)m_(_i)}function m_(s){var h=Wy(s.alternate,s,Zc);s.memoizedProps=s.pendingProps,h===null?wm(s):_i=h}function uv(s){var h=s,y=h.alternate;switch(h.tag){case 15:case 0:h=Zy(y,h,h.pendingProps,h.type,void 0,xi);break;case 11:h=Zy(y,h,h.pendingProps,h.type.render,h.ref,xi);break;case 5:X(h);default:tf(y,h),h=_i=nd(h,Zc),h=Wy(y,h,Zc)}s.memoizedProps=s.pendingProps,h===null?wm(s):_i=h}function df(s,h,y,w){pl=Ol=null,X(h),sc=null,Vc=0;var D=h.return;try{if(Mb(s,D,h,y,xi)){_a=1,Sh(s,x(y,s.current)),_i=null;return}}catch(B){if(D!==null)throw _i=D,B;_a=1,Sh(s,x(y,s.current)),_i=null;return}h.flags&32768?(ui||w===1?s=!0:wd||(xi&536870912)!==0?s=!1:(Ah=s=!0,(w===2||w===9||w===3||w===6)&&(w=Vo.current,w!==null&&w.tag===13&&(w.flags|=16384))),cv(h,s)):wm(h)}function wm(s){var h=s;do{if((h.flags&32768)!==0){cv(h,Ah);return}s=h.return;var y=Rb(h.alternate,h,Zc);if(y!==null){_i=y;return}if(h=h.sibling,h!==null){_i=h;return}_i=h=s}while(h!==null);_a===0&&(_a=5)}function cv(s,h){do{var y=Ky(s.alternate,s);if(y!==null){y.flags&=32767,_i=y;return}if(y=s.return,y!==null&&(y.flags|=32768,y.subtreeFlags=0,y.deletions=null),!h&&(s=s.sibling,s!==null)){_i=s;return}_i=s=y}while(s!==null);_a=6,_i=null}function hv(s,h,y,w,D,B,Q,he,Ue){s.cancelPendingCommit=null;do dp();while(ls!==0);if(($i&6)!==0)throw Error(a(327));if(h!==null){if(h===s.current)throw Error(a(177));if(B=h.lanes|h.childLanes,B|=_u,Ir(s,y,B,Q,he,Ue),s===Sr&&(_i=Sr=null,xi=0),uf=h,Ih=s,Wc=y,s_=B,o_=D,sv=w,(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,fv(ms,function(){return Tm(),null})):(s.callbackNode=null,s.callbackPriority=0),w=(h.flags&13878)!==0,(h.subtreeFlags&13878)!==0||w){w=mt.T,mt.T=null,D=At.p,At.p=2,Q=$i,$i|=4;try{Lb(s,h,y)}finally{$i=Q,At.p=D,mt.T=w}}ls=1,g_(),__(),_c()}}function g_(){if(ls===1){ls=0;var s=Ih,h=uf,y=(h.flags&13878)!==0;if((h.subtreeFlags&13878)!==0||y){y=mt.T,mt.T=null;var w=At.p;At.p=2;var D=$i;$i|=4;try{ev(h,s);var B=Lm,Q=Wu(s.containerInfo),he=B.focusedElem,Ue=B.selectionRange;if(Q!==he&&he&&he.ownerDocument&&Hu(he.ownerDocument.documentElement,he)){if(Ue!==null&&ll(he)){var dt=Ue.start,vt=Ue.end;if(vt===void 0&&(vt=dt),"selectionStart"in he)he.selectionStart=dt,he.selectionEnd=Math.min(vt,he.value.length);else{var Et=he.ownerDocument||document,ft=Et&&Et.defaultView||window;if(ft.getSelection){var yt=ft.getSelection(),cn=he.textContent.length,En=Math.min(Ue.start,cn),jr=Ue.end===void 0?En:Math.min(Ue.end,cn);!yt.extend&&En>jr&&(Q=jr,jr=En,En=Q);var it=pu(he,En),Qe=pu(he,jr);if(it&&Qe&&(yt.rangeCount!==1||yt.anchorNode!==it.node||yt.anchorOffset!==it.offset||yt.focusNode!==Qe.node||yt.focusOffset!==Qe.offset)){var pt=Et.createRange();pt.setStart(it.node,it.offset),yt.removeAllRanges(),En>jr?(yt.addRange(pt),yt.extend(Qe.node,Qe.offset)):(pt.setEnd(Qe.node,Qe.offset),yt.addRange(pt))}}}}for(Et=[],yt=he;yt=yt.parentNode;)yt.nodeType===1&&Et.push({element:yt,left:yt.scrollLeft,top:yt.scrollTop});for(typeof he.focus=="function"&&he.focus(),he=0;he<Et.length;he++){var Lt=Et[he];Lt.element.scrollLeft=Lt.left,Lt.element.scrollTop=Lt.top}}va=!!gf,Lm=gf=null}finally{$i=D,At.p=w,mt.T=y}}s.current=h,ls=2}}function __(){if(ls===2){ls=0;var s=Ih,h=uf,y=(h.flags&8772)!==0;if((h.subtreeFlags&8772)!==0||y){y=mt.T,mt.T=null;var w=At.p;At.p=2;var D=$i;$i|=4;try{n_(s,h.alternate,h)}finally{$i=D,At.p=w,mt.T=y}}ls=3}}function _c(){if(ls===4||ls===3){ls=0,ao();var s=Ih,h=uf,y=Wc,w=sv;(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?ls=5:(ls=0,uf=Ih=null,Kc(s,s.pendingLanes));var D=s.pendingLanes;if(D===0&&(Ch=null),en(y),h=h.stateNode,De&&typeof De.onCommitFiberRoot=="function")try{De.onCommitFiberRoot(Se,h,void 0,(h.current.flags&128)===128)}catch{}if(w!==null){h=mt.T,D=At.p,At.p=2,mt.T=null;try{for(var B=s.onRecoverableError,Q=0;Q<w.length;Q++){var he=w[Q];B(he.value,{componentStack:he.stack})}}finally{mt.T=h,At.p=D}}(Wc&3)!==0&&dp(),yc(s),D=s.pendingLanes,(y&261930)!==0&&(D&42)!==0?s===l_?up++:(up=0,l_=s):up=0,pf(0)}}function Kc(s,h){(s.pooledCacheLanes&=h)===0&&(h=s.pooledCache,h!=null&&(s.pooledCache=null,Yl(h)))}function dp(){return g_(),__(),_c(),Tm()}function Tm(){if(ls!==5)return!1;var s=Ih,h=s_;s_=0;var y=en(Wc),w=mt.T,D=At.p;try{At.p=32>y?32:y,mt.T=null,y=o_,o_=null;var B=Ih,Q=Wc;if(ls=0,uf=Ih=null,Wc=0,($i&6)!==0)throw Error(a(331));var he=$i;if($i|=4,iv(B.current),nv(B,B.current,Q,y),$i=he,pf(0,!1),De&&typeof De.onPostCommitFiberRoot=="function")try{De.onPostCommitFiberRoot(Se,B)}catch{}return!0}finally{At.p=D,mt.T=w,Kc(s,h)}}function dv(s,h,y){h=x(y,h),h=Jd(s.stateNode,h,2),s=tu(s,h,2),s!==null&&(tr(s,2),yc(s))}function Qi(s,h,y){if(s.tag===3)dv(s,s,y);else for(;h!==null;){if(h.tag===3){dv(h,s,y);break}else if(h.tag===1){var w=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(Ch===null||!Ch.has(w))){s=x(y,s),y=Bg(2),w=tu(h,y,2),w!==null&&(Fg(y,w,h,s),tr(w,2),yc(w));break}}h=h.return}}function fp(s,h,y){var w=s.pingCache;if(w===null){w=s.pingCache=new av;var D=new Set;w.set(h,D)}else D=w.get(h),D===void 0&&(D=new Set,w.set(h,D));D.has(y)||(r_=!0,D.add(y),s=Ob.bind(null,s,h,y),h.then(s,s))}function Ob(s,h,y){var w=s.pingCache;w!==null&&w.delete(h),s.pingedLanes|=s.suspendedLanes&y,s.warmLanes&=~y,Sr===s&&(xi&y)===y&&(_a===4||_a===3&&(xi&62914560)===xi&&300>qr()-lf?($i&2)===0&&hf(s,0):a_|=y,Xr===xi&&(Xr=0)),yc(s)}function Sm(s,h){h===0&&(h=Ri()),s=Ro(s,h),s!==null&&(tr(s,h),yc(s))}function y_(s){var h=s.memoizedState,y=0;h!==null&&(y=h.retryLane),Sm(s,y)}function ff(s,h){var y=0;switch(s.tag){case 31:case 13:var w=s.stateNode,D=s.memoizedState;D!==null&&(y=D.retryLane);break;case 19:w=s.stateNode;break;case 22:w=s.stateNode._retryCache;break;default:throw Error(a(314))}w!==null&&w.delete(h),Sm(s,y)}function fv(s,h){return pr(s,h)}var pp=null,Mh=null,Em=!1,Cd=!1,Am=!1,Ph=0;function yc(s){s!==Mh&&s.next===null&&(Mh===null?pp=Mh=s:Mh=Mh.next=s),Cd=!0,Em||(Em=!0,v_())}function pf(s,h){if(!Am&&Cd){Am=!0;do for(var y=!1,w=pp;w!==null;){if(s!==0){var D=w.pendingLanes;if(D===0)var B=0;else{var Q=w.suspendedLanes,he=w.pingedLanes;B=(1<<31-et(42|s)+1)-1,B&=D&~(Q&~he),B=B&201326741?B&201326741|1:B?B|2:0}B!==0&&(y=!0,_v(w,B))}else B=xi,B=Rn(w,w===Sr?B:0,w.cancelPendingCommit!==null||w.timeoutHandle!==-1),(B&3)===0||nn(w,B)||(y=!0,_v(w,B));w=w.next}while(y);Am=!1}}function Nb(){pv()}function pv(){Cd=Em=!1;var s=0;Ph!==0&&Fb()&&(s=Ph);for(var h=qr(),y=null,w=pp;w!==null;){var D=w.next,B=mv(w,h);B===0?(w.next=null,y===null?pp=D:y.next=D,D===null&&(Mh=y)):(y=w,(s!==0||(B&3)!==0)&&(Cd=!0)),w=D}ls!==0&&ls!==5||pf(s),Ph!==0&&(Ph=0)}function mv(s,h){for(var y=s.suspendedLanes,w=s.pingedLanes,D=s.expirationTimes,B=s.pendingLanes&-62914561;0<B;){var Q=31-et(B),he=1<<Q,Ue=D[Q];Ue===-1?((he&y)===0||(he&w)!==0)&&(D[Q]=Nn(he,h)):Ue<=h&&(s.expiredLanes|=he),B&=~he}if(h=Sr,y=xi,y=Rn(s,s===h?y:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),w=s.callbackNode,y===0||s===h&&(gr===2||gr===9)||s.cancelPendingCommit!==null)return w!==null&&w!==null&&Ea(w),s.callbackNode=null,s.callbackPriority=0;if((y&3)===0||nn(s,y)){if(h=y&-y,h===s.callbackPriority)return h;switch(w!==null&&Ea(w),en(y)){case 2:case 8:y=Fs;break;case 32:y=ms;break;case 268435456:y=se;break;default:y=ms}return w=gv.bind(null,s),y=pr(y,w),s.callbackPriority=h,s.callbackNode=y,h}return w!==null&&w!==null&&Ea(w),s.callbackPriority=2,s.callbackNode=null,2}function gv(s,h){if(ls!==0&&ls!==5)return s.callbackNode=null,s.callbackPriority=0,null;var y=s.callbackNode;if(dp()&&s.callbackNode!==y)return null;var w=xi;return w=Rn(s,s===Sr?w:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),w===0?null:(c_(s,w,h),mv(s,qr()),s.callbackNode!=null&&s.callbackNode===y?gv.bind(null,s):null)}function _v(s,h){if(dp())return null;c_(s,h,!0)}function v_(){Ev(function(){($i&6)!==0?pr(ps,Nb):pv()})}function vc(){if(Ph===0){var s=mh;s===0&&(s=wt,wt<<=1,(wt&261888)===0&&(wt=256)),Ph=s}return Ph}function b_(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:ys(""+s)}function x_(s,h){var y=h.ownerDocument.createElement("input");return y.name=h.name,y.value=h.value,s.id&&y.setAttribute("form",s.id),h.parentNode.insertBefore(y,h),s=new FormData(s),y.parentNode.removeChild(y),s}function yv(s,h,y,w,D){if(h==="submit"&&y&&y.stateNode===D){var B=b_((D[yn]||null).action),Q=w.submitter;Q&&(h=(h=Q[yn]||null)?b_(h.formAction):Q.getAttribute("formAction"),h!==null&&(B=h,Q=null));var he=new oo("action","action",null,w,D);s.push({event:he,listeners:[{instance:null,listener:function(){if(w.defaultPrevented){if(Ph!==0){var Ue=Q?x_(D,Q):new FormData(D);fc(y,{pending:!0,data:Ue,method:D.method,action:B},null,Ue)}}else typeof B=="function"&&(he.preventDefault(),Ue=Q?x_(D,Q):new FormData(D),fc(y,{pending:!0,data:Ue,method:D.method,action:B},B,Ue))},currentTarget:D}]})}}for(var Cm=0;Cm<hl.length;Cm++){var Im=hl[Cm],w_=Im.toLowerCase(),vv=Im[0].toUpperCase()+Im.slice(1);pa(w_,"on"+vv)}pa(Hl,"onAnimationEnd"),pa(fh,"onAnimationIteration"),pa(Po,"onAnimationStart"),pa("dblclick","onDoubleClick"),pa("focusin","onFocus"),pa("focusout","onBlur"),pa(Oc,"onTransitionRun"),pa(mu,"onTransitionStart"),pa(co,"onTransitionCancel"),pa(gu,"onTransitionEnd"),Ua("onMouseEnter",["mouseout","mouseover"]),Ua("onMouseLeave",["mouseout","mouseover"]),Ua("onPointerEnter",["pointerout","pointerover"]),Ua("onPointerLeave",["pointerout","pointerover"]),So("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),So("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),So("onBeforeInput",["compositionend","keypress","textInput","paste"]),So("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),So("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),So("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Yc));function Mm(s,h){h=(h&4)!==0;for(var y=0;y<s.length;y++){var w=s[y],D=w.event;w=w.listeners;e:{var B=void 0;if(h)for(var Q=w.length-1;0<=Q;Q--){var he=w[Q],Ue=he.instance,dt=he.currentTarget;if(he=he.listener,Ue!==B&&D.isPropagationStopped())break e;B=he,D.currentTarget=dt;try{B(D)}catch(vt){Wl(vt)}D.currentTarget=null,B=Ue}else for(Q=0;Q<w.length;Q++){if(he=w[Q],Ue=he.instance,dt=he.currentTarget,he=he.listener,Ue!==B&&D.isPropagationStopped())break e;B=he,D.currentTarget=dt;try{B(D)}catch(vt){Wl(vt)}D.currentTarget=null,B=Ue}}}}function yi(s,h){var y=h[ir];y===void 0&&(y=h[ir]=new Set);var w=s+"__bubble";y.has(w)||(Rh(h,s,2,!1),y.add(w))}function Ho(s,h,y){var w=0;h&&(w|=4),Rh(y,s,w,h)}var Qc="_reactListening"+Math.random().toString(36).slice(2);function Id(s){if(!s[Qc]){s[Qc]=!0,da.forEach(function(y){y!=="selectionchange"&&(bv.has(y)||Ho(y,!1,s),Ho(y,!0,s))});var h=s.nodeType===9?s:s.ownerDocument;h===null||h[Qc]||(h[Qc]=!0,Ho("selectionchange",!1,h))}}function Rh(s,h,y,w){switch(Oa(h)){case 2:var D=cs;break;case 8:D=yo;break;default:D=Wo}y=D.bind(null,h,y,s),D=void 0,!wr||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(D=!0),w?D!==void 0?s.addEventListener(h,y,{capture:!0,passive:D}):s.addEventListener(h,y,!0):D!==void 0?s.addEventListener(h,y,{passive:D}):s.addEventListener(h,y,!1)}function Pm(s,h,y,w,D){var B=w;if((h&1)===0&&(h&2)===0&&w!==null)e:for(;;){if(w===null)return;var Q=w.tag;if(Q===3||Q===4){var he=w.stateNode.containerInfo;if(he===D)break;if(Q===4)for(Q=w.return;Q!==null;){var Ue=Q.tag;if((Ue===3||Ue===4)&&Q.stateNode.containerInfo===D)return;Q=Q.return}for(;he!==null;){if(Q=gs(he),Q===null)return;if(Ue=Q.tag,Ue===5||Ue===6||Ue===26||Ue===27){w=B=Q;continue e}he=he.parentNode}}w=w.return}il(function(){var dt=B,vt=Wi(y),Et=[];e:{var ft=td.get(s);if(ft!==void 0){var yt=oo,cn=s;switch(s){case"keypress":if(qn(y)===0)break e;case"keydown":case"keyup":yt=Uu;break;case"focusin":cn="focus",yt=Xi;break;case"focusout":cn="blur",yt=Xi;break;case"beforeblur":case"afterblur":yt=Xi;break;case"click":if(y.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":yt=Or;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":yt=$l;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":yt=Z;break;case Hl:case fh:case Po:yt=rl;break;case gu:yt=ye;break;case"scroll":case"scrollend":yt=Wn;break;case"wheel":yt=ht;break;case"copy":case"cut":case"paste":yt=Hs;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":yt=Dl;break;case"toggle":case"beforetoggle":yt=kn}var En=(h&4)!==0,jr=!En&&(s==="scroll"||s==="scrollend"),it=En?ft!==null?ft+"Capture":null:ft;En=[];for(var Qe=dt,pt;Qe!==null;){var Lt=Qe;if(pt=Lt.stateNode,Lt=Lt.tag,Lt!==5&&Lt!==26&&Lt!==27||pt===null||it===null||(Lt=sr(Qe,it),Lt!=null&&En.push(mf(Qe,Lt,pt))),jr)break;Qe=Qe.return}0<En.length&&(ft=new yt(ft,cn,null,y,vt),Et.push({event:ft,listeners:En}))}}if((h&7)===0){e:{if(ft=s==="mouseover"||s==="pointerover",yt=s==="mouseout"||s==="pointerout",ft&&y!==Rl&&(cn=y.relatedTarget||y.fromElement)&&(gs(cn)||cn[In]))break e;if((yt||ft)&&(ft=vt.window===vt?vt:(ft=vt.ownerDocument)?ft.defaultView||ft.parentWindow:window,yt?(cn=y.relatedTarget||y.toElement,yt=dt,cn=cn?gs(cn):null,cn!==null&&(jr=m(cn),En=cn.tag,cn!==jr||En!==5&&En!==27&&En!==6)&&(cn=null)):(yt=null,cn=dt),yt!==cn)){if(En=Or,Lt="onMouseLeave",it="onMouseEnter",Qe="mouse",(s==="pointerout"||s==="pointerover")&&(En=Dl,Lt="onPointerLeave",it="onPointerEnter",Qe="pointer"),jr=yt==null?ft:Gr(yt),pt=cn==null?ft:Gr(cn),ft=new En(Lt,Qe+"leave",yt,y,vt),ft.target=jr,ft.relatedTarget=pt,Lt=null,gs(vt)===dt&&(En=new En(it,Qe+"enter",cn,y,vt),En.target=pt,En.relatedTarget=jr,Lt=En),jr=Lt,yt&&cn)t:{for(En=xv,it=yt,Qe=cn,pt=0,Lt=it;Lt;Lt=En(Lt))pt++;Lt=0;for(var Dn=Qe;Dn;Dn=En(Dn))Lt++;for(;0<pt-Lt;)it=En(it),pt--;for(;0<Lt-pt;)Qe=En(Qe),Lt--;for(;pt--;){if(it===Qe||Qe!==null&&it===Qe.alternate){En=it;break t}it=En(it),Qe=En(Qe)}En=null}else En=null;yt!==null&&wv(Et,ft,yt,En,!1),cn!==null&&jr!==null&&wv(Et,jr,cn,En,!0)}}e:{if(ft=dt?Gr(dt):window,yt=ft.nodeName&&ft.nodeName.toLowerCase(),yt==="select"||yt==="input"&&ft.type==="file")var dr=fu;else if(uo(ft))if(hh)dr=ed;else{dr=Xd;var Cn=sl}else yt=ft.nodeName,!yt||yt.toLowerCase()!=="input"||ft.type!=="checkbox"&&ft.type!=="radio"?dt&&qa(dt.elementType)&&(dr=fu):dr=Zl;if(dr&&(dr=dr(s,dt))){Jh(Et,dr,y,vt);break e}Cn&&Cn(s,ft,dt),s==="focusout"&&dt&&ft.type==="number"&&dt.memoizedProps.value!=null&&Gs(ft,"number",ft.value)}switch(Cn=dt?Gr(dt):window,s){case"focusin":(uo(Cn)||Cn.contentEditable==="true")&&(cl=Cn,dh=dt,kc=null);break;case"focusout":kc=dh=cl=null;break;case"mousedown":Xu=!0;break;case"contextmenu":case"mouseup":case"dragend":Xu=!1,Kd(Et,y,vt);break;case"selectionchange":if(ul)break;case"keydown":case"keyup":Kd(Et,y,vt)}var mi;if(Ti)e:{switch(s){case"compositionstart":var zi="onCompositionStart";break e;case"compositionend":zi="onCompositionEnd";break e;case"compositionupdate":zi="onCompositionUpdate";break e}zi=void 0}else du?hu(s,y)&&(zi="onCompositionEnd"):s==="keydown"&&y.keyCode===229&&(zi="onCompositionStart");zi&&(Ga&&y.locale!=="ko"&&(du||zi!=="onCompositionStart"?zi==="onCompositionEnd"&&du&&(mi=na()):(fa=vt,fn="value"in fa?fa.value:fa.textContent,du=!0)),Cn=mp(dt,zi),0<Cn.length&&(zi=new lr(zi,s,null,y,vt),Et.push({event:zi,listeners:Cn}),mi?zi.data=mi:(mi=Xs(y),mi!==null&&(zi.data=mi)))),(mi=$a?Ks(s,y):ju(s,y))&&(zi=mp(dt,"onBeforeInput"),0<zi.length&&(Cn=new lr("onBeforeInput","beforeinput",null,y,vt),Et.push({event:Cn,listeners:zi}),Cn.data=mi)),yv(Et,s,dt,y,vt)}Mm(Et,h)})}function mf(s,h,y){return{instance:s,listener:h,currentTarget:y}}function mp(s,h){for(var y=h+"Capture",w=[];s!==null;){var D=s,B=D.stateNode;if(D=D.tag,D!==5&&D!==26&&D!==27||B===null||(D=sr(s,y),D!=null&&w.unshift(mf(s,D,B)),D=sr(s,h),D!=null&&w.push(mf(s,D,B))),s.tag===3)return w;s=s.return}return[]}function xv(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function wv(s,h,y,w,D){for(var B=h._reactName,Q=[];y!==null&&y!==w;){var he=y,Ue=he.alternate,dt=he.stateNode;if(he=he.tag,Ue!==null&&Ue===w)break;he!==5&&he!==26&&he!==27||dt===null||(Ue=dt,D?(dt=sr(y,B),dt!=null&&Q.unshift(mf(y,dt,Ue))):D||(dt=sr(y,B),dt!=null&&Q.push(mf(y,dt,Ue)))),y=y.return}Q.length!==0&&s.push({event:h,listeners:Q})}var Tv=/\r\n?/g,Lh=/\u0000|\uFFFD/g;function T_(s){return(typeof s=="string"?s:""+s).replace(Tv,`
`).replace(Lh,"")}function S_(s,h){return h=T_(h),T_(s)===h}function _r(s,h,y,w,D,B){switch(y){case"children":typeof w=="string"?h==="body"||h==="textarea"&&w===""||Hi(s,w):(typeof w=="number"||typeof w=="bigint")&&h!=="body"&&Hi(s,""+w);break;case"className":hi(s,"class",w);break;case"tabIndex":hi(s,"tabindex",w);break;case"dir":case"role":case"viewBox":case"width":case"height":hi(s,y,w);break;case"style":_s(s,w,B);break;case"data":if(h!=="object"){hi(s,"data",w);break}case"src":case"href":if(w===""&&(h!=="a"||y!=="href")){s.removeAttribute(y);break}if(w==null||typeof w=="function"||typeof w=="symbol"||typeof w=="boolean"){s.removeAttribute(y);break}w=ys(""+w),s.setAttribute(y,w);break;case"action":case"formAction":if(typeof w=="function"){s.setAttribute(y,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof B=="function"&&(y==="formAction"?(h!=="input"&&_r(s,h,"name",D.name,D,null),_r(s,h,"formEncType",D.formEncType,D,null),_r(s,h,"formMethod",D.formMethod,D,null),_r(s,h,"formTarget",D.formTarget,D,null)):(_r(s,h,"encType",D.encType,D,null),_r(s,h,"method",D.method,D,null),_r(s,h,"target",D.target,D,null)));if(w==null||typeof w=="symbol"||typeof w=="boolean"){s.removeAttribute(y);break}w=ys(""+w),s.setAttribute(y,w);break;case"onClick":w!=null&&(s.onclick=Ia);break;case"onScroll":w!=null&&yi("scroll",s);break;case"onScrollEnd":w!=null&&yi("scrollend",s);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(a(61));if(y=w.__html,y!=null){if(D.children!=null)throw Error(a(60));s.innerHTML=y}}break;case"multiple":s.multiple=w&&typeof w!="function"&&typeof w!="symbol";break;case"muted":s.muted=w&&typeof w!="function"&&typeof w!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(w==null||typeof w=="function"||typeof w=="boolean"||typeof w=="symbol"){s.removeAttribute("xlink:href");break}y=ys(""+w),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",y);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":w!=null&&typeof w!="function"&&typeof w!="symbol"?s.setAttribute(y,""+w):s.removeAttribute(y);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":w&&typeof w!="function"&&typeof w!="symbol"?s.setAttribute(y,""):s.removeAttribute(y);break;case"capture":case"download":w===!0?s.setAttribute(y,""):w!==!1&&w!=null&&typeof w!="function"&&typeof w!="symbol"?s.setAttribute(y,w):s.removeAttribute(y);break;case"cols":case"rows":case"size":case"span":w!=null&&typeof w!="function"&&typeof w!="symbol"&&!isNaN(w)&&1<=w?s.setAttribute(y,w):s.removeAttribute(y);break;case"rowSpan":case"start":w==null||typeof w=="function"||typeof w=="symbol"||isNaN(w)?s.removeAttribute(y):s.setAttribute(y,w);break;case"popover":yi("beforetoggle",s),yi("toggle",s),ii(s,"popover",w);break;case"xlinkActuate":Zi(s,"http://www.w3.org/1999/xlink","xlink:actuate",w);break;case"xlinkArcrole":Zi(s,"http://www.w3.org/1999/xlink","xlink:arcrole",w);break;case"xlinkRole":Zi(s,"http://www.w3.org/1999/xlink","xlink:role",w);break;case"xlinkShow":Zi(s,"http://www.w3.org/1999/xlink","xlink:show",w);break;case"xlinkTitle":Zi(s,"http://www.w3.org/1999/xlink","xlink:title",w);break;case"xlinkType":Zi(s,"http://www.w3.org/1999/xlink","xlink:type",w);break;case"xmlBase":Zi(s,"http://www.w3.org/XML/1998/namespace","xml:base",w);break;case"xmlLang":Zi(s,"http://www.w3.org/XML/1998/namespace","xml:lang",w);break;case"xmlSpace":Zi(s,"http://www.w3.org/XML/1998/namespace","xml:space",w);break;case"is":ii(s,"is",w);break;case"innerText":case"textContent":break;default:(!(2<y.length)||y[0]!=="o"&&y[0]!=="O"||y[1]!=="n"&&y[1]!=="N")&&(y=Zs.get(y)||y,ii(s,y,w))}}function Rm(s,h,y,w,D,B){switch(y){case"style":_s(s,w,B);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(a(61));if(y=w.__html,y!=null){if(D.children!=null)throw Error(a(60));s.innerHTML=y}}break;case"children":typeof w=="string"?Hi(s,w):(typeof w=="number"||typeof w=="bigint")&&Hi(s,""+w);break;case"onScroll":w!=null&&yi("scroll",s);break;case"onScrollEnd":w!=null&&yi("scrollend",s);break;case"onClick":w!=null&&(s.onclick=Ia);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!wi.hasOwnProperty(y))e:{if(y[0]==="o"&&y[1]==="n"&&(D=y.endsWith("Capture"),h=y.slice(2,D?y.length-7:void 0),B=s[yn]||null,B=B!=null?B[y]:null,typeof B=="function"&&s.removeEventListener(h,B,D),typeof w=="function")){typeof B!="function"&&B!==null&&(y in s?s[y]=null:s.hasAttribute(y)&&s.removeAttribute(y)),s.addEventListener(h,w,D);break e}y in s?s[y]=w:w===!0?s.setAttribute(y,""):ii(s,y,w)}}}function io(s,h,y){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":yi("error",s),yi("load",s);var w=!1,D=!1,B;for(B in y)if(y.hasOwnProperty(B)){var Q=y[B];if(Q!=null)switch(B){case"src":w=!0;break;case"srcSet":D=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,h));default:_r(s,h,B,Q,y,null)}}D&&_r(s,h,"srcSet",y.srcSet,y,null),w&&_r(s,h,"src",y.src,y,null);return;case"input":yi("invalid",s);var he=B=Q=D=null,Ue=null,dt=null;for(w in y)if(y.hasOwnProperty(w)){var vt=y[w];if(vt!=null)switch(w){case"name":D=vt;break;case"type":Q=vt;break;case"checked":Ue=vt;break;case"defaultChecked":dt=vt;break;case"value":B=vt;break;case"defaultValue":he=vt;break;case"children":case"dangerouslySetInnerHTML":if(vt!=null)throw Error(a(137,h));break;default:_r(s,h,w,vt,y,null)}}Pl(s,B,he,Ue,dt,Q,D,!1);return;case"select":yi("invalid",s),w=Q=B=null;for(D in y)if(y.hasOwnProperty(D)&&(he=y[D],he!=null))switch(D){case"value":B=he;break;case"defaultValue":Q=he;break;case"multiple":w=he;default:_r(s,h,D,he,y,null)}h=B,y=Q,s.multiple=!!w,h!=null?ar(s,!!w,h,!1):y!=null&&ar(s,!!w,y,!0);return;case"textarea":yi("invalid",s),B=D=w=null;for(Q in y)if(y.hasOwnProperty(Q)&&(he=y[Q],he!=null))switch(Q){case"value":w=he;break;case"defaultValue":D=he;break;case"children":B=he;break;case"dangerouslySetInnerHTML":if(he!=null)throw Error(a(91));break;default:_r(s,h,Q,he,y,null)}ja(s,w,D,B);return;case"option":for(Ue in y)if(y.hasOwnProperty(Ue)&&(w=y[Ue],w!=null))switch(Ue){case"selected":s.selected=w&&typeof w!="function"&&typeof w!="symbol";break;default:_r(s,h,Ue,w,y,null)}return;case"dialog":yi("beforetoggle",s),yi("toggle",s),yi("cancel",s),yi("close",s);break;case"iframe":case"object":yi("load",s);break;case"video":case"audio":for(w=0;w<Yc.length;w++)yi(Yc[w],s);break;case"image":yi("error",s),yi("load",s);break;case"details":yi("toggle",s);break;case"embed":case"source":case"link":yi("error",s),yi("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(dt in y)if(y.hasOwnProperty(dt)&&(w=y[dt],w!=null))switch(dt){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,h));default:_r(s,h,dt,w,y,null)}return;default:if(qa(h)){for(vt in y)y.hasOwnProperty(vt)&&(w=y[vt],w!==void 0&&Rm(s,h,vt,w,y,void 0));return}}for(he in y)y.hasOwnProperty(he)&&(w=y[he],w!=null&&_r(s,h,he,w,y,null))}function Bb(s,h,y,w){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var D=null,B=null,Q=null,he=null,Ue=null,dt=null,vt=null;for(yt in y){var Et=y[yt];if(y.hasOwnProperty(yt)&&Et!=null)switch(yt){case"checked":break;case"value":break;case"defaultValue":Ue=Et;default:w.hasOwnProperty(yt)||_r(s,h,yt,null,w,Et)}}for(var ft in w){var yt=w[ft];if(Et=y[ft],w.hasOwnProperty(ft)&&(yt!=null||Et!=null))switch(ft){case"type":B=yt;break;case"name":D=yt;break;case"checked":dt=yt;break;case"defaultChecked":vt=yt;break;case"value":Q=yt;break;case"defaultValue":he=yt;break;case"children":case"dangerouslySetInnerHTML":if(yt!=null)throw Error(a(137,h));break;default:yt!==Et&&_r(s,h,ft,yt,w,Et)}}Ao(s,Q,he,Ue,dt,vt,B,D);return;case"select":yt=Q=he=ft=null;for(B in y)if(Ue=y[B],y.hasOwnProperty(B)&&Ue!=null)switch(B){case"value":break;case"multiple":yt=Ue;default:w.hasOwnProperty(B)||_r(s,h,B,null,w,Ue)}for(D in w)if(B=w[D],Ue=y[D],w.hasOwnProperty(D)&&(B!=null||Ue!=null))switch(D){case"value":ft=B;break;case"defaultValue":he=B;break;case"multiple":Q=B;default:B!==Ue&&_r(s,h,D,B,w,Ue)}h=he,y=Q,w=yt,ft!=null?ar(s,!!y,ft,!1):!!w!=!!y&&(h!=null?ar(s,!!y,h,!0):ar(s,!!y,y?[]:"",!1));return;case"textarea":yt=ft=null;for(he in y)if(D=y[he],y.hasOwnProperty(he)&&D!=null&&!w.hasOwnProperty(he))switch(he){case"value":break;case"children":break;default:_r(s,h,he,null,w,D)}for(Q in w)if(D=w[Q],B=y[Q],w.hasOwnProperty(Q)&&(D!=null||B!=null))switch(Q){case"value":ft=D;break;case"defaultValue":yt=D;break;case"children":break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(a(91));break;default:D!==B&&_r(s,h,Q,D,w,B)}Qa(s,ft,yt);return;case"option":for(var cn in y)if(ft=y[cn],y.hasOwnProperty(cn)&&ft!=null&&!w.hasOwnProperty(cn))switch(cn){case"selected":s.selected=!1;break;default:_r(s,h,cn,null,w,ft)}for(Ue in w)if(ft=w[Ue],yt=y[Ue],w.hasOwnProperty(Ue)&&ft!==yt&&(ft!=null||yt!=null))switch(Ue){case"selected":s.selected=ft&&typeof ft!="function"&&typeof ft!="symbol";break;default:_r(s,h,Ue,ft,w,yt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var En in y)ft=y[En],y.hasOwnProperty(En)&&ft!=null&&!w.hasOwnProperty(En)&&_r(s,h,En,null,w,ft);for(dt in w)if(ft=w[dt],yt=y[dt],w.hasOwnProperty(dt)&&ft!==yt&&(ft!=null||yt!=null))switch(dt){case"children":case"dangerouslySetInnerHTML":if(ft!=null)throw Error(a(137,h));break;default:_r(s,h,dt,ft,w,yt)}return;default:if(qa(h)){for(var jr in y)ft=y[jr],y.hasOwnProperty(jr)&&ft!==void 0&&!w.hasOwnProperty(jr)&&Rm(s,h,jr,void 0,w,ft);for(vt in w)ft=w[vt],yt=y[vt],!w.hasOwnProperty(vt)||ft===yt||ft===void 0&&yt===void 0||Rm(s,h,vt,ft,w,yt);return}}for(var it in y)ft=y[it],y.hasOwnProperty(it)&&ft!=null&&!w.hasOwnProperty(it)&&_r(s,h,it,null,w,ft);for(Et in w)ft=w[Et],yt=y[Et],!w.hasOwnProperty(Et)||ft===yt||ft==null&&yt==null||_r(s,h,Et,ft,w,yt)}function E_(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Sv(){if(typeof performance.getEntriesByType=="function"){for(var s=0,h=0,y=performance.getEntriesByType("resource"),w=0;w<y.length;w++){var D=y[w],B=D.transferSize,Q=D.initiatorType,he=D.duration;if(B&&he&&E_(Q)){for(Q=0,he=D.responseEnd,w+=1;w<y.length;w++){var Ue=y[w],dt=Ue.startTime;if(dt>he)break;var vt=Ue.transferSize,Et=Ue.initiatorType;vt&&E_(Et)&&(Ue=Ue.responseEnd,Q+=vt*(Ue<he?1:(he-dt)/(Ue-dt)))}if(--w,h+=8*(B+Q)/(D.duration/1e3),s++,10<s)break}}if(0<s)return h/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var gf=null,Lm=null;function Md(s){return s.nodeType===9?s:s.ownerDocument}function gp(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function _p(s,h){if(s===0)switch(h){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&h==="foreignObject"?0:s}function A_(s,h){return s==="textarea"||s==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.children=="bigint"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var C_=null;function Fb(){var s=window.event;return s&&s.type==="popstate"?s===C_?!1:(C_=s,!0):(C_=null,!1)}var Pd=typeof setTimeout=="function"?setTimeout:void 0,Ps=typeof clearTimeout=="function"?clearTimeout:void 0,km=typeof Promise=="function"?Promise:void 0,Ev=typeof queueMicrotask=="function"?queueMicrotask:typeof km<"u"?function(s){return km.resolve(null).then(s).catch(Av)}:Pd;function Av(s){setTimeout(function(){throw s})}function bc(s){return s==="head"}function Cv(s,h){var y=h,w=0;do{var D=y.nextSibling;if(s.removeChild(y),D&&D.nodeType===8)if(y=D.data,y==="/$"||y==="/&"){if(w===0){s.removeChild(D),Sl(h);return}w--}else if(y==="$"||y==="$?"||y==="$~"||y==="$!"||y==="&")w++;else if(y==="html")Rd(s.ownerDocument.documentElement);else if(y==="head"){y=s.ownerDocument.head,Rd(y);for(var B=y.firstChild;B;){var Q=B.nextSibling,he=B.nodeName;B[Vs]||he==="SCRIPT"||he==="STYLE"||he==="LINK"&&B.rel.toLowerCase()==="stylesheet"||y.removeChild(B),B=Q}}else y==="body"&&Rd(s.ownerDocument.body);y=D}while(y);Sl(h)}function I_(s,h){var y=s;s=0;do{var w=y.nextSibling;if(y.nodeType===1?h?(y._stashedDisplay=y.style.display,y.style.display="none"):(y.style.display=y._stashedDisplay||"",y.getAttribute("style")===""&&y.removeAttribute("style")):y.nodeType===3&&(h?(y._stashedText=y.nodeValue,y.nodeValue=""):y.nodeValue=y._stashedText||""),w&&w.nodeType===8)if(y=w.data,y==="/$"){if(s===0)break;s--}else y!=="$"&&y!=="$?"&&y!=="$~"&&y!=="$!"||s++;y=w}while(y)}function Dm(s){var h=s.firstChild;for(h&&h.nodeType===10&&(h=h.nextSibling);h;){var y=h;switch(h=h.nextSibling,y.nodeName){case"HTML":case"HEAD":case"BODY":Dm(y),Us(y);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(y.rel.toLowerCase()==="stylesheet")continue}s.removeChild(y)}}function Vb(s,h,y,w){for(;s.nodeType===1;){var D=y;if(s.nodeName.toLowerCase()!==h.toLowerCase()){if(!w&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(w){if(!s[Vs])switch(h){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(B=s.getAttribute("rel"),B==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(B!==D.rel||s.getAttribute("href")!==(D.href==null||D.href===""?null:D.href)||s.getAttribute("crossorigin")!==(D.crossOrigin==null?null:D.crossOrigin)||s.getAttribute("title")!==(D.title==null?null:D.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(B=s.getAttribute("src"),(B!==(D.src==null?null:D.src)||s.getAttribute("type")!==(D.type==null?null:D.type)||s.getAttribute("crossorigin")!==(D.crossOrigin==null?null:D.crossOrigin))&&B&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(h==="input"&&s.type==="hidden"){var B=D.name==null?null:""+D.name;if(D.type==="hidden"&&s.getAttribute("name")===B)return s}else return s;if(s=xl(s.nextSibling),s===null)break}return null}function Iv(s,h,y){if(h==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!y||(s=xl(s.nextSibling),s===null))return null;return s}function zm(s,h){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!h||(s=xl(s.nextSibling),s===null))return null;return s}function yp(s){return s.data==="$?"||s.data==="$~"}function Om(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function vp(s,h){var y=s.ownerDocument;if(s.data==="$~")s._reactRetry=h;else if(s.data!=="$?"||y.readyState!=="loading")h();else{var w=function(){h(),y.removeEventListener("DOMContentLoaded",w)};y.addEventListener("DOMContentLoaded",w),s._reactRetry=w}}function xl(s){for(;s!=null;s=s.nextSibling){var h=s.nodeType;if(h===1||h===3)break;if(h===8){if(h=s.data,h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"||h==="F!"||h==="F")break;if(h==="/$"||h==="/&")return null}}return s}var Nm=null;function Bm(s){s=s.nextSibling;for(var h=0;s;){if(s.nodeType===8){var y=s.data;if(y==="/$"||y==="/&"){if(h===0)return xl(s.nextSibling);h--}else y!=="$"&&y!=="$!"&&y!=="$?"&&y!=="$~"&&y!=="&"||h++}s=s.nextSibling}return null}function bp(s){s=s.previousSibling;for(var h=0;s;){if(s.nodeType===8){var y=s.data;if(y==="$"||y==="$!"||y==="$?"||y==="$~"||y==="&"){if(h===0)return s;h--}else y!=="/$"&&y!=="/&"||h++}s=s.previousSibling}return null}function _f(s,h,y){switch(h=Md(y),s){case"html":if(s=h.documentElement,!s)throw Error(a(452));return s;case"head":if(s=h.head,!s)throw Error(a(453));return s;case"body":if(s=h.body,!s)throw Error(a(454));return s;default:throw Error(a(451))}}function Rd(s){for(var h=s.attributes;h.length;)s.removeAttributeNode(h[0]);Us(s)}var wl=new Map,Fm=new Set;function Vm(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var l=At.d;At.d={f:r,r:o,D:E,C:A,L:M,m:z,X:q,S:F,M:W};function r(){var s=l.f(),h=Ad();return s||h}function o(s){var h=$r(s);h!==null&&h.tag===5&&h.type==="form"?yl(h):l.r(s)}var p=typeof document>"u"?null:document;function v(s,h,y){var w=p;if(w&&typeof h=="string"&&h){var D=rr(h);D='link[rel="'+s+'"][href="'+D+'"]',typeof y=="string"&&(D+='[crossorigin="'+y+'"]'),Fm.has(D)||(Fm.add(D),s={rel:s,crossOrigin:y,href:h},w.querySelector(D)===null&&(h=w.createElement("link"),io(h,"link",s),Mr(h),w.head.appendChild(h)))}}function E(s){l.D(s),v("dns-prefetch",s,null)}function A(s,h){l.C(s,h),v("preconnect",s,h)}function M(s,h,y){l.L(s,h,y);var w=p;if(w&&s&&h){var D='link[rel="preload"][as="'+rr(h)+'"]';h==="image"&&y&&y.imageSrcSet?(D+='[imagesrcset="'+rr(y.imageSrcSet)+'"]',typeof y.imageSizes=="string"&&(D+='[imagesizes="'+rr(y.imageSizes)+'"]')):D+='[href="'+rr(s)+'"]';var B=D;switch(h){case"style":B=ie(s);break;case"script":B=Te(s)}wl.has(B)||(s=G({rel:"preload",href:h==="image"&&y&&y.imageSrcSet?void 0:s,as:h},y),wl.set(B,s),w.querySelector(D)!==null||h==="style"&&w.querySelector(re(B))||h==="script"&&w.querySelector(He(B))||(h=w.createElement("link"),io(h,"link",s),Mr(h),w.head.appendChild(h)))}}function z(s,h){l.m(s,h);var y=p;if(y&&s){var w=h&&typeof h.as=="string"?h.as:"script",D='link[rel="modulepreload"][as="'+rr(w)+'"][href="'+rr(s)+'"]',B=D;switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":B=Te(s)}if(!wl.has(B)&&(s=G({rel:"modulepreload",href:s},h),wl.set(B,s),y.querySelector(D)===null)){switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(y.querySelector(He(B)))return}w=y.createElement("link"),io(w,"link",s),Mr(w),y.head.appendChild(w)}}}function F(s,h,y){l.S(s,h,y);var w=p;if(w&&s){var D=Ei(w).hoistableStyles,B=ie(s);h=h||"default";var Q=D.get(B);if(!Q){var he={loading:0,preload:null};if(Q=w.querySelector(re(B)))he.loading=5;else{s=G({rel:"stylesheet",href:s,"data-precedence":h},y),(y=wl.get(B))&&ot(s,y);var Ue=Q=w.createElement("link");Mr(Ue),io(Ue,"link",s),Ue._p=new Promise(function(dt,vt){Ue.onload=dt,Ue.onerror=vt}),Ue.addEventListener("load",function(){he.loading|=1}),Ue.addEventListener("error",function(){he.loading|=2}),he.loading|=4,Be(Q,h,w)}Q={type:"stylesheet",instance:Q,count:1,state:he},D.set(B,Q)}}}function q(s,h){l.X(s,h);var y=p;if(y&&s){var w=Ei(y).hoistableScripts,D=Te(s),B=w.get(D);B||(B=y.querySelector(He(D)),B||(s=G({src:s,async:!0},h),(h=wl.get(D))&&gt(s,h),B=y.createElement("script"),Mr(B),io(B,"link",s),y.head.appendChild(B)),B={type:"script",instance:B,count:1,state:null},w.set(D,B))}}function W(s,h){l.M(s,h);var y=p;if(y&&s){var w=Ei(y).hoistableScripts,D=Te(s),B=w.get(D);B||(B=y.querySelector(He(D)),B||(s=G({src:s,async:!0,type:"module"},h),(h=wl.get(D))&&gt(s,h),B=y.createElement("script"),Mr(B),io(B,"link",s),y.head.appendChild(B)),B={type:"script",instance:B,count:1,state:null},w.set(D,B))}}function te(s,h,y,w){var D=(D=Wt.current)?Vm(D):null;if(!D)throw Error(a(446));switch(s){case"meta":case"title":return null;case"style":return typeof y.precedence=="string"&&typeof y.href=="string"?(h=ie(y.href),y=Ei(D).hoistableStyles,w=y.get(h),w||(w={type:"style",instance:null,count:0,state:null},y.set(h,w)),w):{type:"void",instance:null,count:0,state:null};case"link":if(y.rel==="stylesheet"&&typeof y.href=="string"&&typeof y.precedence=="string"){s=ie(y.href);var B=Ei(D).hoistableStyles,Q=B.get(s);if(Q||(D=D.ownerDocument||D,Q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},B.set(s,Q),(B=D.querySelector(re(s)))&&!B._p&&(Q.instance=B,Q.state.loading=5),wl.has(s)||(y={rel:"preload",as:"style",href:y.href,crossOrigin:y.crossOrigin,integrity:y.integrity,media:y.media,hrefLang:y.hrefLang,referrerPolicy:y.referrerPolicy},wl.set(s,y),B||pe(D,s,y,Q.state))),h&&w===null)throw Error(a(528,""));return Q}if(h&&w!==null)throw Error(a(529,""));return null;case"script":return h=y.async,y=y.src,typeof y=="string"&&h&&typeof h!="function"&&typeof h!="symbol"?(h=Te(y),y=Ei(D).hoistableScripts,w=y.get(h),w||(w={type:"script",instance:null,count:0,state:null},y.set(h,w)),w):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,s))}}function ie(s){return'href="'+rr(s)+'"'}function re(s){return'link[rel="stylesheet"]['+s+"]"}function oe(s){return G({},s,{"data-precedence":s.precedence,precedence:null})}function pe(s,h,y,w){s.querySelector('link[rel="preload"][as="style"]['+h+"]")?w.loading=1:(h=s.createElement("link"),w.preload=h,h.addEventListener("load",function(){return w.loading|=1}),h.addEventListener("error",function(){return w.loading|=2}),io(h,"link",y),Mr(h),s.head.appendChild(h))}function Te(s){return'[src="'+rr(s)+'"]'}function He(s){return"script[async]"+s}function Le(s,h,y){if(h.count++,h.instance===null)switch(h.type){case"style":var w=s.querySelector('style[data-href~="'+rr(y.href)+'"]');if(w)return h.instance=w,Mr(w),w;var D=G({},y,{"data-href":y.href,"data-precedence":y.precedence,href:null,precedence:null});return w=(s.ownerDocument||s).createElement("style"),Mr(w),io(w,"style",D),Be(w,y.precedence,s),h.instance=w;case"stylesheet":D=ie(y.href);var B=s.querySelector(re(D));if(B)return h.state.loading|=4,h.instance=B,Mr(B),B;w=oe(y),(D=wl.get(D))&&ot(w,D),B=(s.ownerDocument||s).createElement("link"),Mr(B);var Q=B;return Q._p=new Promise(function(he,Ue){Q.onload=he,Q.onerror=Ue}),io(B,"link",w),h.state.loading|=4,Be(B,y.precedence,s),h.instance=B;case"script":return B=Te(y.src),(D=s.querySelector(He(B)))?(h.instance=D,Mr(D),D):(w=y,(D=wl.get(B))&&(w=G({},y),gt(w,D)),s=s.ownerDocument||s,D=s.createElement("script"),Mr(D),io(D,"link",w),s.head.appendChild(D),h.instance=D);case"void":return null;default:throw Error(a(443,h.type))}else h.type==="stylesheet"&&(h.state.loading&4)===0&&(w=h.instance,h.state.loading|=4,Be(w,y.precedence,s));return h.instance}function Be(s,h,y){for(var w=y.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),D=w.length?w[w.length-1]:null,B=D,Q=0;Q<w.length;Q++){var he=w[Q];if(he.dataset.precedence===h)B=he;else if(B!==D)break}B?B.parentNode.insertBefore(s,B.nextSibling):(h=y.nodeType===9?y.head:y,h.insertBefore(s,h.firstChild))}function ot(s,h){s.crossOrigin==null&&(s.crossOrigin=h.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=h.referrerPolicy),s.title==null&&(s.title=h.title)}function gt(s,h){s.crossOrigin==null&&(s.crossOrigin=h.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=h.referrerPolicy),s.integrity==null&&(s.integrity=h.integrity)}var It=null;function $t(s,h,y){if(It===null){var w=new Map,D=It=new Map;D.set(y,w)}else D=It,w=D.get(y),w||(w=new Map,D.set(y,w));if(w.has(s))return w;for(w.set(s,null),y=y.getElementsByTagName(s),D=0;D<y.length;D++){var B=y[D];if(!(B[Vs]||B[kt]||s==="link"&&B.getAttribute("rel")==="stylesheet")&&B.namespaceURI!=="http://www.w3.org/2000/svg"){var Q=B.getAttribute(h)||"";Q=s+Q;var he=w.get(Q);he?he.push(B):w.set(Q,[B])}}return w}function Bt(s,h,y){s=s.ownerDocument||s,s.head.insertBefore(y,h==="title"?s.querySelector("head > title"):null)}function Gt(s,h,y){if(y===1||h.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof h.precedence!="string"||typeof h.href!="string"||h.href==="")break;return!0;case"link":if(typeof h.rel!="string"||typeof h.href!="string"||h.href===""||h.onLoad||h.onError)break;switch(h.rel){case"stylesheet":return s=h.disabled,typeof h.precedence=="string"&&s==null;default:return!0}case"script":if(h.async&&typeof h.async!="function"&&typeof h.async!="symbol"&&!h.onLoad&&!h.onError&&h.src&&typeof h.src=="string")return!0}return!1}function dn(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function qt(s,h,y,w){if(y.type==="stylesheet"&&(typeof w.media!="string"||matchMedia(w.media).matches!==!1)&&(y.state.loading&4)===0){if(y.instance===null){var D=ie(w.href),B=h.querySelector(re(D));if(B){h=B._p,h!==null&&typeof h=="object"&&typeof h.then=="function"&&(s.count++,s=Sn.bind(s),h.then(s,s)),y.state.loading|=4,y.instance=B,Mr(B);return}B=h.ownerDocument||h,w=oe(w),(D=wl.get(D))&&ot(w,D),B=B.createElement("link"),Mr(B);var Q=B;Q._p=new Promise(function(he,Ue){Q.onload=he,Q.onerror=Ue}),io(B,"link",w),y.instance=B}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(y,h),(h=y.state.preload)&&(y.state.loading&3)===0&&(s.count++,y=Sn.bind(s),h.addEventListener("load",y),h.addEventListener("error",y))}}var jt=0;function St(s,h){return s.stylesheets&&s.count===0&&mn(s,s.stylesheets),0<s.count||0<s.imgCount?function(y){var w=setTimeout(function(){if(s.stylesheets&&mn(s,s.stylesheets),s.unsuspend){var B=s.unsuspend;s.unsuspend=null,B()}},6e4+h);0<s.imgBytes&&jt===0&&(jt=62500*Sv());var D=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&mn(s,s.stylesheets),s.unsuspend)){var B=s.unsuspend;s.unsuspend=null,B()}},(s.imgBytes>jt?50:800)+h);return s.unsuspend=y,function(){s.unsuspend=null,clearTimeout(w),clearTimeout(D)}}:null}function Sn(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)mn(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Pn=null;function mn(s,h){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Pn=new Map,h.forEach(un,s),Pn=null,Sn.call(s))}function un(s,h){if(!(h.state.loading&4)){var y=Pn.get(s);if(y)var w=y.get(null);else{y=new Map,Pn.set(s,y);for(var D=s.querySelectorAll("link[data-precedence],style[data-precedence]"),B=0;B<D.length;B++){var Q=D[B];(Q.nodeName==="LINK"||Q.getAttribute("media")!=="not all")&&(y.set(Q.dataset.precedence,Q),w=Q)}w&&y.set(null,w)}D=h.instance,Q=D.getAttribute("data-precedence"),B=y.get(Q)||w,B===w&&y.set(null,D),y.set(Q,D),this.count++,w=Sn.bind(this),D.addEventListener("load",w),D.addEventListener("error",w),B?B.parentNode.insertBefore(D,B.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(D,s.firstChild)),h.state.loading|=4}}var Qn={$$typeof:Xe,Provider:null,Consumer:null,_currentValue:bt,_currentValue2:bt,_threadCount:0};function Kr(s,h,y,w,D,B,Q,he,Ue){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Gi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gi(0),this.hiddenUpdates=Gi(null),this.identifierPrefix=w,this.onUncaughtError=D,this.onCaughtError=B,this.onRecoverableError=Q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Ue,this.incompleteTransitions=new Map}function ya(s,h,y,w,D,B,Q,he,Ue,dt,vt,Et){return s=new Kr(s,h,y,Q,Ue,dt,vt,Et,he),h=1,B===!0&&(h|=24),B=ns(3,null,null,h),s.current=B,B.stateNode=s,h=Bo(),h.refCount++,s.pooledCache=h,h.refCount++,B.memoizedState={element:w,isDehydrated:y,cache:h},lc(B),s}function us(s){return s?(s=Lo,s):Lo}function Tl(s,h,y,w,D,B){D=us(D),w.context===null?w.context=D:w.pendingContext=D,w=Eu(h),w.payload={element:y},B=B===void 0?null:B,B!==null&&(w.callback=B),y=tu(s,w,h),y!==null&&(go(y,s,h),Uc(y,s,h))}function _o(s,h){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var y=s.retryLane;s.retryLane=y!==0&&y<h?y:h}}function Da(s,h){_o(s,h),(s=s.alternate)&&_o(s,h)}function Lr(s){if(s.tag===13||s.tag===31){var h=Ro(s,67108864);h!==null&&go(h,s,67108864),Da(s,67108864)}}function za(s){if(s.tag===13||s.tag===31){var h=Bl();h=Rt(h);var y=Ro(s,h);y!==null&&go(y,s,h),Da(s,h)}}var va=!0;function cs(s,h,y,w){var D=mt.T;mt.T=null;var B=At.p;try{At.p=2,Wo(s,h,y,w)}finally{At.p=B,mt.T=D}}function yo(s,h,y,w){var D=mt.T;mt.T=null;var B=At.p;try{At.p=8,Wo(s,h,y,w)}finally{At.p=B,mt.T=D}}function Wo(s,h,y,w){if(va){var D=ba(w);if(D===null)Pm(s,h,w,Rs,y),Dh(s,w);else if(vf(D,s,h,y,w))w.stopPropagation();else if(Dh(s,w),h&4&&-1<yf.indexOf(s)){for(;D!==null;){var B=$r(D);if(B!==null)switch(B.tag){case 3:if(B=B.stateNode,B.current.memoizedState.isDehydrated){var Q=vn(B.pendingLanes);if(Q!==0){var he=B;for(he.pendingLanes|=2,he.entangledLanes|=2;Q;){var Ue=1<<31-et(Q);he.entanglements[1]|=Ue,Q&=~Ue}yc(B),($i&6)===0&&(lp=qr()+500,pf(0))}}break;case 31:case 13:he=Ro(B,2),he!==null&&go(he,B,2),Ad(),Da(B,2)}if(B=ba(w),B===null&&Pm(s,h,w,Rs,y),B===D)break;D=B}D!==null&&w.stopPropagation()}else Pm(s,h,w,null,y)}}function ba(s){return s=Wi(s),ca(s)}var Rs=null;function ca(s){if(Rs=null,s=gs(s),s!==null){var h=m(s);if(h===null)s=null;else{var y=h.tag;if(y===13){if(s=_(h),s!==null)return s;s=null}else if(y===31){if(s=c(h),s!==null)return s;s=null}else if(y===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;s=null}else h!==s&&(s=null)}}return Rs=s,null}function Oa(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(fs()){case ps:return 2;case Fs:return 8;case ms:case We:return 32;case se:return 268435456;default:return 32}default:return 32}}var xa=!1,yr=null,Ii=null,Ls=null,xc=new Map,Xo=new Map,kh=[],yf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Dh(s,h){switch(s){case"focusin":case"focusout":yr=null;break;case"dragenter":case"dragleave":Ii=null;break;case"mouseover":case"mouseout":Ls=null;break;case"pointerover":case"pointerout":xc.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xo.delete(h.pointerId)}}function wc(s,h,y,w,D,B){return s===null||s.nativeEvent!==B?(s={blockedOn:h,domEventName:y,eventSystemFlags:w,nativeEvent:B,targetContainers:[D]},h!==null&&(h=$r(h),h!==null&&Lr(h)),s):(s.eventSystemFlags|=w,h=s.targetContainers,D!==null&&h.indexOf(D)===-1&&h.push(D),s)}function vf(s,h,y,w,D){switch(h){case"focusin":return yr=wc(yr,s,h,y,w,D),!0;case"dragenter":return Ii=wc(Ii,s,h,y,w,D),!0;case"mouseover":return Ls=wc(Ls,s,h,y,w,D),!0;case"pointerover":var B=D.pointerId;return xc.set(B,wc(xc.get(B)||null,s,h,y,w,D)),!0;case"gotpointercapture":return B=D.pointerId,Xo.set(B,wc(Xo.get(B)||null,s,h,y,w,D)),!0}return!1}function Ld(s){var h=gs(s.target);if(h!==null){var y=m(h);if(y!==null){if(h=y.tag,h===13){if(h=_(y),h!==null){s.blockedOn=h,ta(s.priority,function(){za(y)});return}}else if(h===31){if(h=c(y),h!==null){s.blockedOn=h,ta(s.priority,function(){za(y)});return}}else if(h===3&&y.stateNode.current.memoizedState.isDehydrated){s.blockedOn=y.tag===3?y.stateNode.containerInfo:null;return}}}s.blockedOn=null}function xp(s){if(s.blockedOn!==null)return!1;for(var h=s.targetContainers;0<h.length;){var y=ba(s.nativeEvent);if(y===null){y=s.nativeEvent;var w=new y.constructor(y.type,y);Rl=w,y.target.dispatchEvent(w),Rl=null}else return h=$r(y),h!==null&&Lr(h),s.blockedOn=y,!1;h.shift()}return!0}function M_(s,h,y){xp(s)&&y.delete(h)}function Mv(){xa=!1,yr!==null&&xp(yr)&&(yr=null),Ii!==null&&xp(Ii)&&(Ii=null),Ls!==null&&xp(Ls)&&(Ls=null),xc.forEach(M_),Xo.forEach(M_)}function wp(s,h){s.blockedOn===h&&(s.blockedOn=null,xa||(xa=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Mv)))}var bf=null;function Um(s){bf!==s&&(bf=s,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){bf===s&&(bf=null);for(var h=0;h<s.length;h+=3){var y=s[h],w=s[h+1],D=s[h+2];if(typeof w!="function"){if(ca(w||y)===null)continue;break}var B=$r(y);B!==null&&(s.splice(h,3),h-=3,fc(B,{pending:!0,data:D,method:y.method,action:w},w,D))}}))}function Sl(s){function h(Ue){return wp(Ue,s)}yr!==null&&wp(yr,s),Ii!==null&&wp(Ii,s),Ls!==null&&wp(Ls,s),xc.forEach(h),Xo.forEach(h);for(var y=0;y<kh.length;y++){var w=kh[y];w.blockedOn===s&&(w.blockedOn=null)}for(;0<kh.length&&(y=kh[0],y.blockedOn===null);)Ld(y),y.blockedOn===null&&kh.shift();if(y=(s.ownerDocument||s).$$reactFormReplay,y!=null)for(w=0;w<y.length;w+=3){var D=y[w],B=y[w+1],Q=D[yn]||null;if(typeof B=="function")Q||Um(y);else if(Q){var he=null;if(B&&B.hasAttribute("formAction")){if(D=B,Q=B[yn]||null)he=Q.formAction;else if(ca(D)!==null)continue}else he=Q.action;typeof he=="function"?y[w+1]=he:(y.splice(w,3),w-=3),Um(y)}}}function P_(){function s(B){B.canIntercept&&B.info==="react-transition"&&B.intercept({handler:function(){return new Promise(function(Q){return D=Q})},focusReset:"manual",scroll:"manual"})}function h(){D!==null&&(D(),D=null),w||setTimeout(y,20)}function y(){if(!w&&!navigation.transition){var B=navigation.currentEntry;B&&B.url!=null&&navigation.navigate(B.url,{state:B.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var w=!1,D=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",h),navigation.addEventListener("navigateerror",h),setTimeout(y,100),function(){w=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",h),navigation.removeEventListener("navigateerror",h),D!==null&&(D(),D=null)}}}function jm(s){this._internalRoot=s}qm.prototype.render=jm.prototype.render=function(s){var h=this._internalRoot;if(h===null)throw Error(a(409));var y=h.current,w=Bl();Tl(y,w,s,h,null,null)},qm.prototype.unmount=jm.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var h=s.containerInfo;Tl(s.current,2,null,s,null,null),Ad(),h[In]=null}};function qm(s){this._internalRoot=s}qm.prototype.unstable_scheduleHydration=function(s){if(s){var h=nr();s={blockedOn:null,target:s,priority:h};for(var y=0;y<kh.length&&h!==0&&h<kh[y].priority;y++);kh.splice(y,0,s),y===0&&Ld(s)}};var Pv=e.version;if(Pv!=="19.2.0")throw Error(a(527,Pv,"19.2.0"));At.findDOMNode=function(s){var h=s._reactInternals;if(h===void 0)throw typeof s.render=="function"?Error(a(188)):(s=Object.keys(s).join(","),Error(a(268,s)));return s=k(h),s=s!==null?V(s):null,s=s===null?null:s.stateNode,s};var Ub={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:mt,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $m=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$m.isDisabled&&$m.supportsFiber)try{Se=$m.inject(Ub),De=$m}catch{}}return L_.createRoot=function(s,h){if(!d(s))throw Error(a(299));var y=!1,w="",D=Ng,B=pd,Q=$y;return h!=null&&(h.unstable_strictMode===!0&&(y=!0),h.identifierPrefix!==void 0&&(w=h.identifierPrefix),h.onUncaughtError!==void 0&&(D=h.onUncaughtError),h.onCaughtError!==void 0&&(B=h.onCaughtError),h.onRecoverableError!==void 0&&(Q=h.onRecoverableError)),h=ya(s,1,!1,null,null,y,w,null,D,B,Q,P_),s[In]=h.current,Id(s),new jm(h)},L_.hydrateRoot=function(s,h,y){if(!d(s))throw Error(a(299));var w=!1,D="",B=Ng,Q=pd,he=$y,Ue=null;return y!=null&&(y.unstable_strictMode===!0&&(w=!0),y.identifierPrefix!==void 0&&(D=y.identifierPrefix),y.onUncaughtError!==void 0&&(B=y.onUncaughtError),y.onCaughtError!==void 0&&(Q=y.onCaughtError),y.onRecoverableError!==void 0&&(he=y.onRecoverableError),y.formState!==void 0&&(Ue=y.formState)),h=ya(s,1,!0,h,y??null,w,D,Ue,B,Q,he,P_),h.context=us(null),y=h.current,w=Bl(),w=Rt(w),D=Eu(w),D.callback=null,tu(y,D,w),y=w,h.current.lanes=y,tr(h,y),yc(h),s[In]=h.current,Id(s),new qm(h)},L_.version="19.2.0",L_}var d2;function hP(){if(d2)return $b.exports;d2=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),$b.exports=cP(),$b.exports}var dP=hP();const fP=wy(dP);/**
 * react-router v7.9.4
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var f2="popstate";function pP(i={}){function e(a,d){let{pathname:m,search:_,hash:c}=a.location;return Ix("",{pathname:m,search:_,hash:c},d.state&&d.state.usr||null,d.state&&d.state.key||"default")}function t(a,d){return typeof d=="string"?d:ny(d)}return gP(e,t,null,i)}function Ba(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function Xh(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function mP(){return Math.random().toString(36).substring(2,10)}function p2(i,e){return{usr:i.state,key:i.key,idx:e}}function Ix(i,e,t=null,a){return{pathname:typeof i=="string"?i:i.pathname,search:"",hash:"",...typeof e=="string"?yg(e):e,state:t,key:e&&e.key||a||mP()}}function ny({pathname:i="/",search:e="",hash:t=""}){return e&&e!=="?"&&(i+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(i+=t.charAt(0)==="#"?t:"#"+t),i}function yg(i){let e={};if(i){let t=i.indexOf("#");t>=0&&(e.hash=i.substring(t),i=i.substring(0,t));let a=i.indexOf("?");a>=0&&(e.search=i.substring(a),i=i.substring(0,a)),i&&(e.pathname=i)}return e}function gP(i,e,t,a={}){let{window:d=document.defaultView,v5Compat:m=!1}=a,_=d.history,c="POP",C=null,k=V();k==null&&(k=0,_.replaceState({..._.state,idx:k},""));function V(){return(_.state||{idx:null}).idx}function G(){c="POP";let Ne=V(),tt=Ne==null?null:Ne-k;k=Ne,C&&C({action:c,location:be.location,delta:tt})}function ee(Ne,tt){c="PUSH";let Je=Ix(be.location,Ne,tt);k=V()+1;let Xe=p2(Je,k),Ke=be.createHref(Je);try{_.pushState(Xe,"",Ke)}catch(Ge){if(Ge instanceof DOMException&&Ge.name==="DataCloneError")throw Ge;d.location.assign(Ke)}m&&C&&C({action:c,location:be.location,delta:1})}function Y(Ne,tt){c="REPLACE";let Je=Ix(be.location,Ne,tt);k=V();let Xe=p2(Je,k),Ke=be.createHref(Je);_.replaceState(Xe,"",Ke),m&&C&&C({action:c,location:be.location,delta:0})}function xe(Ne){return _P(Ne)}let be={get action(){return c},get location(){return i(d,_)},listen(Ne){if(C)throw new Error("A history only accepts one active listener");return d.addEventListener(f2,G),C=Ne,()=>{d.removeEventListener(f2,G),C=null}},createHref(Ne){return e(d,Ne)},createURL:xe,encodeLocation(Ne){let tt=xe(Ne);return{pathname:tt.pathname,search:tt.search,hash:tt.hash}},push:ee,replace:Y,go(Ne){return _.go(Ne)}};return be}function _P(i,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Ba(t,"No window.location.(origin|href) available to create URL");let a=typeof i=="string"?i:ny(i);return a=a.replace(/ $/,"%20"),!e&&a.startsWith("//")&&(a=t+a),new URL(a,t)}function _E(i,e,t="/"){return yP(i,e,t,!1)}function yP(i,e,t,a){let d=typeof e=="string"?yg(e):e,m=Fd(d.pathname||"/",t);if(m==null)return null;let _=yE(i);vP(_);let c=null;for(let C=0;c==null&&C<_.length;++C){let k=PP(m);c=IP(_[C],k,a)}return c}function yE(i,e=[],t=[],a="",d=!1){let m=(_,c,C=d,k)=>{let V={relativePath:k===void 0?_.path||"":k,caseSensitive:_.caseSensitive===!0,childrenIndex:c,route:_};if(V.relativePath.startsWith("/")){if(!V.relativePath.startsWith(a)&&C)return;Ba(V.relativePath.startsWith(a),`Absolute route path "${V.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),V.relativePath=V.relativePath.slice(a.length)}let G=zd([a,V.relativePath]),ee=t.concat(V);_.children&&_.children.length>0&&(Ba(_.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${G}".`),yE(_.children,e,ee,G,C)),!(_.path==null&&!_.index)&&e.push({path:G,score:AP(G,_.index),routesMeta:ee})};return i.forEach((_,c)=>{var C;if(_.path===""||!((C=_.path)!=null&&C.includes("?")))m(_,c);else for(let k of vE(_.path))m(_,c,!0,k)}),e}function vE(i){let e=i.split("/");if(e.length===0)return[];let[t,...a]=e,d=t.endsWith("?"),m=t.replace(/\?$/,"");if(a.length===0)return d?[m,""]:[m];let _=vE(a.join("/")),c=[];return c.push(..._.map(C=>C===""?m:[m,C].join("/"))),d&&c.push(..._),c.map(C=>i.startsWith("/")&&C===""?"/":C)}function vP(i){i.sort((e,t)=>e.score!==t.score?t.score-e.score:CP(e.routesMeta.map(a=>a.childrenIndex),t.routesMeta.map(a=>a.childrenIndex)))}var bP=/^:[\w-]+$/,xP=3,wP=2,TP=1,SP=10,EP=-2,m2=i=>i==="*";function AP(i,e){let t=i.split("/"),a=t.length;return t.some(m2)&&(a+=EP),e&&(a+=wP),t.filter(d=>!m2(d)).reduce((d,m)=>d+(bP.test(m)?xP:m===""?TP:SP),a)}function CP(i,e){return i.length===e.length&&i.slice(0,-1).every((a,d)=>a===e[d])?i[i.length-1]-e[e.length-1]:0}function IP(i,e,t=!1){let{routesMeta:a}=i,d={},m="/",_=[];for(let c=0;c<a.length;++c){let C=a[c],k=c===a.length-1,V=m==="/"?e:e.slice(m.length)||"/",G=d0({path:C.relativePath,caseSensitive:C.caseSensitive,end:k},V),ee=C.route;if(!G&&k&&t&&!a[a.length-1].route.index&&(G=d0({path:C.relativePath,caseSensitive:C.caseSensitive,end:!1},V)),!G)return null;Object.assign(d,G.params),_.push({params:d,pathname:zd([m,G.pathname]),pathnameBase:DP(zd([m,G.pathnameBase])),route:ee}),G.pathnameBase!=="/"&&(m=zd([m,G.pathnameBase]))}return _}function d0(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[t,a]=MP(i.path,i.caseSensitive,i.end),d=e.match(t);if(!d)return null;let m=d[0],_=m.replace(/(.)\/+$/,"$1"),c=d.slice(1);return{params:a.reduce((k,{paramName:V,isOptional:G},ee)=>{if(V==="*"){let xe=c[ee]||"";_=m.slice(0,m.length-xe.length).replace(/(.)\/+$/,"$1")}const Y=c[ee];return G&&!Y?k[V]=void 0:k[V]=(Y||"").replace(/%2F/g,"/"),k},{}),pathname:m,pathnameBase:_,pattern:i}}function MP(i,e=!1,t=!0){Xh(i==="*"||!i.endsWith("*")||i.endsWith("/*"),`Route path "${i}" will be treated as if it were "${i.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${i.replace(/\*$/,"/*")}".`);let a=[],d="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(_,c,C)=>(a.push({paramName:c,isOptional:C!=null}),C?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return i.endsWith("*")?(a.push({paramName:"*"}),d+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?d+="\\/*$":i!==""&&i!=="/"&&(d+="(?:(?=\\/|$))"),[new RegExp(d,e?void 0:"i"),a]}function PP(i){try{return i.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Xh(!1,`The URL path "${i}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),i}}function Fd(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,a=i.charAt(t);return a&&a!=="/"?null:i.slice(t)||"/"}function RP(i,e="/"){let{pathname:t,search:a="",hash:d=""}=typeof i=="string"?yg(i):i;return{pathname:t?t.startsWith("/")?t:LP(t,e):e,search:zP(a),hash:OP(d)}}function LP(i,e){let t=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(d=>{d===".."?t.length>1&&t.pop():d!=="."&&t.push(d)}),t.length>1?t.join("/"):"/"}function Wb(i,e,t,a){return`Cannot include a '${i}' character in a manually specified \`to.${e}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function kP(i){return i.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function bE(i){let e=kP(i);return e.map((t,a)=>a===e.length-1?t.pathname:t.pathnameBase)}function xE(i,e,t,a=!1){let d;typeof i=="string"?d=yg(i):(d={...i},Ba(!d.pathname||!d.pathname.includes("?"),Wb("?","pathname","search",d)),Ba(!d.pathname||!d.pathname.includes("#"),Wb("#","pathname","hash",d)),Ba(!d.search||!d.search.includes("#"),Wb("#","search","hash",d)));let m=i===""||d.pathname==="",_=m?"/":d.pathname,c;if(_==null)c=t;else{let G=e.length-1;if(!a&&_.startsWith("..")){let ee=_.split("/");for(;ee[0]==="..";)ee.shift(),G-=1;d.pathname=ee.join("/")}c=G>=0?e[G]:"/"}let C=RP(d,c),k=_&&_!=="/"&&_.endsWith("/"),V=(m||_===".")&&t.endsWith("/");return!C.pathname.endsWith("/")&&(k||V)&&(C.pathname+="/"),C}var zd=i=>i.join("/").replace(/\/\/+/g,"/"),DP=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),zP=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,OP=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function NP(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}var wE=["POST","PUT","PATCH","DELETE"];new Set(wE);var BP=["GET",...wE];new Set(BP);var vg=Tt.createContext(null);vg.displayName="DataRouter";var $0=Tt.createContext(null);$0.displayName="DataRouterState";Tt.createContext(!1);var TE=Tt.createContext({isTransitioning:!1});TE.displayName="ViewTransition";var FP=Tt.createContext(new Map);FP.displayName="Fetchers";var VP=Tt.createContext(null);VP.displayName="Await";var Qh=Tt.createContext(null);Qh.displayName="Navigation";var Ty=Tt.createContext(null);Ty.displayName="Location";var Zd=Tt.createContext({outlet:null,matches:[],isDataRoute:!1});Zd.displayName="Route";var E1=Tt.createContext(null);E1.displayName="RouteError";function UP(i,{relative:e}={}){Ba(Sy(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:a}=Tt.useContext(Qh),{hash:d,pathname:m,search:_}=Ey(i,{relative:e}),c=m;return t!=="/"&&(c=m==="/"?t:zd([t,m])),a.createHref({pathname:c,search:_,hash:d})}function Sy(){return Tt.useContext(Ty)!=null}function Yp(){return Ba(Sy(),"useLocation() may be used only in the context of a <Router> component."),Tt.useContext(Ty).location}var SE="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function EE(i){Tt.useContext(Qh).static||Tt.useLayoutEffect(i)}function jP(){let{isDataRoute:i}=Tt.useContext(Zd);return i?tR():qP()}function qP(){Ba(Sy(),"useNavigate() may be used only in the context of a <Router> component.");let i=Tt.useContext(vg),{basename:e,navigator:t}=Tt.useContext(Qh),{matches:a}=Tt.useContext(Zd),{pathname:d}=Yp(),m=JSON.stringify(bE(a)),_=Tt.useRef(!1);return EE(()=>{_.current=!0}),Tt.useCallback((C,k={})=>{if(Xh(_.current,SE),!_.current)return;if(typeof C=="number"){t.go(C);return}let V=xE(C,JSON.parse(m),d,k.relative==="path");i==null&&e!=="/"&&(V.pathname=V.pathname==="/"?e:zd([e,V.pathname])),(k.replace?t.replace:t.push)(V,k.state,k)},[e,t,m,d,i])}Tt.createContext(null);function Ey(i,{relative:e}={}){let{matches:t}=Tt.useContext(Zd),{pathname:a}=Yp(),d=JSON.stringify(bE(t));return Tt.useMemo(()=>xE(i,JSON.parse(d),a,e==="path"),[i,d,a,e])}function $P(i,e){return AE(i,e)}function AE(i,e,t,a,d){var Je;Ba(Sy(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:m}=Tt.useContext(Qh),{matches:_}=Tt.useContext(Zd),c=_[_.length-1],C=c?c.params:{},k=c?c.pathname:"/",V=c?c.pathnameBase:"/",G=c&&c.route;{let Xe=G&&G.path||"";CE(k,!G||Xe.endsWith("*")||Xe.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${k}" (under <Route path="${Xe}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Xe}"> to <Route path="${Xe==="/"?"*":`${Xe}/*`}">.`)}let ee=Yp(),Y;if(e){let Xe=typeof e=="string"?yg(e):e;Ba(V==="/"||((Je=Xe.pathname)==null?void 0:Je.startsWith(V)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${V}" but pathname "${Xe.pathname}" was given in the \`location\` prop.`),Y=Xe}else Y=ee;let xe=Y.pathname||"/",be=xe;if(V!=="/"){let Xe=V.replace(/^\//,"").split("/");be="/"+xe.replace(/^\//,"").split("/").slice(Xe.length).join("/")}let Ne=_E(i,{pathname:be});Xh(G||Ne!=null,`No routes matched location "${Y.pathname}${Y.search}${Y.hash}" `),Xh(Ne==null||Ne[Ne.length-1].route.element!==void 0||Ne[Ne.length-1].route.Component!==void 0||Ne[Ne.length-1].route.lazy!==void 0,`Matched leaf route at location "${Y.pathname}${Y.search}${Y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let tt=XP(Ne&&Ne.map(Xe=>Object.assign({},Xe,{params:Object.assign({},C,Xe.params),pathname:zd([V,m.encodeLocation?m.encodeLocation(Xe.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Xe.pathname]),pathnameBase:Xe.pathnameBase==="/"?V:zd([V,m.encodeLocation?m.encodeLocation(Xe.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Xe.pathnameBase])})),_,t,a,d);return e&&tt?Tt.createElement(Ty.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...Y},navigationType:"POP"}},tt):tt}function GP(){let i=eR(),e=NP(i)?`${i.status} ${i.statusText}`:i instanceof Error?i.message:JSON.stringify(i),t=i instanceof Error?i.stack:null,a="rgba(200,200,200, 0.5)",d={padding:"0.5rem",backgroundColor:a},m={padding:"2px 4px",backgroundColor:a},_=null;return console.error("Error handled by React Router default ErrorBoundary:",i),_=Tt.createElement(Tt.Fragment,null,Tt.createElement("p",null," Hey developer "),Tt.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Tt.createElement("code",{style:m},"ErrorBoundary")," or"," ",Tt.createElement("code",{style:m},"errorElement")," prop on your route.")),Tt.createElement(Tt.Fragment,null,Tt.createElement("h2",null,"Unexpected Application Error!"),Tt.createElement("h3",{style:{fontStyle:"italic"}},e),t?Tt.createElement("pre",{style:d},t):null,_)}var ZP=Tt.createElement(GP,null),HP=class extends Tt.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,e){return e.location!==i.location||e.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:e.error,location:e.location,revalidation:i.revalidation||e.revalidation}}componentDidCatch(i,e){this.props.unstable_onError?this.props.unstable_onError(i,e):console.error("React Router caught the following error during render",i)}render(){return this.state.error!==void 0?Tt.createElement(Zd.Provider,{value:this.props.routeContext},Tt.createElement(E1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function WP({routeContext:i,match:e,children:t}){let a=Tt.useContext(vg);return a&&a.static&&a.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=e.route.id),Tt.createElement(Zd.Provider,{value:i},t)}function XP(i,e=[],t=null,a=null,d=null){if(i==null){if(!t)return null;if(t.errors)i=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)i=t.matches;else return null}let m=i,_=t==null?void 0:t.errors;if(_!=null){let k=m.findIndex(V=>V.route.id&&(_==null?void 0:_[V.route.id])!==void 0);Ba(k>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(_).join(",")}`),m=m.slice(0,Math.min(m.length,k+1))}let c=!1,C=-1;if(t)for(let k=0;k<m.length;k++){let V=m[k];if((V.route.HydrateFallback||V.route.hydrateFallbackElement)&&(C=k),V.route.id){let{loaderData:G,errors:ee}=t,Y=V.route.loader&&!G.hasOwnProperty(V.route.id)&&(!ee||ee[V.route.id]===void 0);if(V.route.lazy||Y){c=!0,C>=0?m=m.slice(0,C+1):m=[m[0]];break}}}return m.reduceRight((k,V,G)=>{let ee,Y=!1,xe=null,be=null;t&&(ee=_&&V.route.id?_[V.route.id]:void 0,xe=V.route.errorElement||ZP,c&&(C<0&&G===0?(CE("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),Y=!0,be=null):C===G&&(Y=!0,be=V.route.hydrateFallbackElement||null)));let Ne=e.concat(m.slice(0,G+1)),tt=()=>{let Je;return ee?Je=xe:Y?Je=be:V.route.Component?Je=Tt.createElement(V.route.Component,null):V.route.element?Je=V.route.element:Je=k,Tt.createElement(WP,{match:V,routeContext:{outlet:k,matches:Ne,isDataRoute:t!=null},children:Je})};return t&&(V.route.ErrorBoundary||V.route.errorElement||G===0)?Tt.createElement(HP,{location:t.location,revalidation:t.revalidation,component:xe,error:ee,children:tt(),routeContext:{outlet:null,matches:Ne,isDataRoute:!0},unstable_onError:a}):tt()},null)}function A1(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function KP(i){let e=Tt.useContext(vg);return Ba(e,A1(i)),e}function YP(i){let e=Tt.useContext($0);return Ba(e,A1(i)),e}function QP(i){let e=Tt.useContext(Zd);return Ba(e,A1(i)),e}function C1(i){let e=QP(i),t=e.matches[e.matches.length-1];return Ba(t.route.id,`${i} can only be used on routes that contain a unique "id"`),t.route.id}function JP(){return C1("useRouteId")}function eR(){var a;let i=Tt.useContext(E1),e=YP("useRouteError"),t=C1("useRouteError");return i!==void 0?i:(a=e.errors)==null?void 0:a[t]}function tR(){let{router:i}=KP("useNavigate"),e=C1("useNavigate"),t=Tt.useRef(!1);return EE(()=>{t.current=!0}),Tt.useCallback(async(d,m={})=>{Xh(t.current,SE),t.current&&(typeof d=="number"?i.navigate(d):await i.navigate(d,{fromRouteId:e,...m}))},[i,e])}var g2={};function CE(i,e,t){!e&&!g2[i]&&(g2[i]=!0,Xh(!1,t))}Tt.memo(nR);function nR({routes:i,future:e,state:t,unstable_onError:a}){return AE(i,void 0,t,a,e)}function Ep(i){Ba(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function iR({basename:i="/",children:e=null,location:t,navigationType:a="POP",navigator:d,static:m=!1}){Ba(!Sy(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let _=i.replace(/^\/*/,"/"),c=Tt.useMemo(()=>({basename:_,navigator:d,static:m,future:{}}),[_,d,m]);typeof t=="string"&&(t=yg(t));let{pathname:C="/",search:k="",hash:V="",state:G=null,key:ee="default"}=t,Y=Tt.useMemo(()=>{let xe=Fd(C,_);return xe==null?null:{location:{pathname:xe,search:k,hash:V,state:G,key:ee},navigationType:a}},[_,C,k,V,G,ee,a]);return Xh(Y!=null,`<Router basename="${_}"> is not able to match the URL "${C}${k}${V}" because it does not start with the basename, so the <Router> won't render anything.`),Y==null?null:Tt.createElement(Qh.Provider,{value:c},Tt.createElement(Ty.Provider,{children:e,value:Y}))}function rR({children:i,location:e}){return $P(Mx(i),e)}function Mx(i,e=[]){let t=[];return Tt.Children.forEach(i,(a,d)=>{if(!Tt.isValidElement(a))return;let m=[...e,d];if(a.type===Tt.Fragment){t.push.apply(t,Mx(a.props.children,m));return}Ba(a.type===Ep,`[${typeof a.type=="string"?a.type:a.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ba(!a.props.index||!a.props.children,"An index route cannot have child routes.");let _={id:a.props.id||m.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,middleware:a.props.middleware,loader:a.props.loader,action:a.props.action,hydrateFallbackElement:a.props.hydrateFallbackElement,HydrateFallback:a.props.HydrateFallback,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.hasErrorBoundary===!0||a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(_.children=Mx(a.props.children,m)),t.push(_)}),t}var Zv="get",Hv="application/x-www-form-urlencoded";function G0(i){return i!=null&&typeof i.tagName=="string"}function aR(i){return G0(i)&&i.tagName.toLowerCase()==="button"}function sR(i){return G0(i)&&i.tagName.toLowerCase()==="form"}function oR(i){return G0(i)&&i.tagName.toLowerCase()==="input"}function lR(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function uR(i,e){return i.button===0&&(!e||e==="_self")&&!lR(i)}var Rv=null;function cR(){if(Rv===null)try{new FormData(document.createElement("form"),0),Rv=!1}catch{Rv=!0}return Rv}var hR=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Xb(i){return i!=null&&!hR.has(i)?(Xh(!1,`"${i}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Hv}"`),null):i}function dR(i,e){let t,a,d,m,_;if(sR(i)){let c=i.getAttribute("action");a=c?Fd(c,e):null,t=i.getAttribute("method")||Zv,d=Xb(i.getAttribute("enctype"))||Hv,m=new FormData(i)}else if(aR(i)||oR(i)&&(i.type==="submit"||i.type==="image")){let c=i.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let C=i.getAttribute("formaction")||c.getAttribute("action");if(a=C?Fd(C,e):null,t=i.getAttribute("formmethod")||c.getAttribute("method")||Zv,d=Xb(i.getAttribute("formenctype"))||Xb(c.getAttribute("enctype"))||Hv,m=new FormData(c,i),!cR()){let{name:k,type:V,value:G}=i;if(V==="image"){let ee=k?`${k}.`:"";m.append(`${ee}x`,"0"),m.append(`${ee}y`,"0")}else k&&m.append(k,G)}}else{if(G0(i))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Zv,a=null,d=Hv,_=i}return m&&d==="text/plain"&&(_=m,m=void 0),{action:a,method:t.toLowerCase(),encType:d,formData:m,body:_}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function I1(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function fR(i,e,t){let a=typeof i=="string"?new URL(i,typeof window>"u"?"server://singlefetch/":window.location.origin):i;return a.pathname==="/"?a.pathname=`_root.${t}`:e&&Fd(a.pathname,e)==="/"?a.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${t}`,a}async function pR(i,e){if(i.id in e)return e[i.id];try{let t=await import(i.module);return e[i.id]=t,t}catch(t){return console.error(`Error loading route module \`${i.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function mR(i){return i==null?!1:i.href==null?i.rel==="preload"&&typeof i.imageSrcSet=="string"&&typeof i.imageSizes=="string":typeof i.rel=="string"&&typeof i.href=="string"}async function gR(i,e,t){let a=await Promise.all(i.map(async d=>{let m=e.routes[d.route.id];if(m){let _=await pR(m,t);return _.links?_.links():[]}return[]}));return bR(a.flat(1).filter(mR).filter(d=>d.rel==="stylesheet"||d.rel==="preload").map(d=>d.rel==="stylesheet"?{...d,rel:"prefetch",as:"style"}:{...d,rel:"prefetch"}))}function _2(i,e,t,a,d,m){let _=(C,k)=>t[k]?C.route.id!==t[k].route.id:!0,c=(C,k)=>{var V;return t[k].pathname!==C.pathname||((V=t[k].route.path)==null?void 0:V.endsWith("*"))&&t[k].params["*"]!==C.params["*"]};return m==="assets"?e.filter((C,k)=>_(C,k)||c(C,k)):m==="data"?e.filter((C,k)=>{var G;let V=a.routes[C.route.id];if(!V||!V.hasLoader)return!1;if(_(C,k)||c(C,k))return!0;if(C.route.shouldRevalidate){let ee=C.route.shouldRevalidate({currentUrl:new URL(d.pathname+d.search+d.hash,window.origin),currentParams:((G=t[0])==null?void 0:G.params)||{},nextUrl:new URL(i,window.origin),nextParams:C.params,defaultShouldRevalidate:!0});if(typeof ee=="boolean")return ee}return!0}):[]}function _R(i,e,{includeHydrateFallback:t}={}){return yR(i.map(a=>{let d=e.routes[a.route.id];if(!d)return[];let m=[d.module];return d.clientActionModule&&(m=m.concat(d.clientActionModule)),d.clientLoaderModule&&(m=m.concat(d.clientLoaderModule)),t&&d.hydrateFallbackModule&&(m=m.concat(d.hydrateFallbackModule)),d.imports&&(m=m.concat(d.imports)),m}).flat(1))}function yR(i){return[...new Set(i)]}function vR(i){let e={},t=Object.keys(i).sort();for(let a of t)e[a]=i[a];return e}function bR(i,e){let t=new Set;return new Set(e),i.reduce((a,d)=>{let m=JSON.stringify(vR(d));return t.has(m)||(t.add(m),a.push({key:m,link:d})),a},[])}function IE(){let i=Tt.useContext(vg);return I1(i,"You must render this element inside a <DataRouterContext.Provider> element"),i}function xR(){let i=Tt.useContext($0);return I1(i,"You must render this element inside a <DataRouterStateContext.Provider> element"),i}var M1=Tt.createContext(void 0);M1.displayName="FrameworkContext";function ME(){let i=Tt.useContext(M1);return I1(i,"You must render this element inside a <HydratedRouter> element"),i}function wR(i,e){let t=Tt.useContext(M1),[a,d]=Tt.useState(!1),[m,_]=Tt.useState(!1),{onFocus:c,onBlur:C,onMouseEnter:k,onMouseLeave:V,onTouchStart:G}=e,ee=Tt.useRef(null);Tt.useEffect(()=>{if(i==="render"&&_(!0),i==="viewport"){let be=tt=>{tt.forEach(Je=>{_(Je.isIntersecting)})},Ne=new IntersectionObserver(be,{threshold:.5});return ee.current&&Ne.observe(ee.current),()=>{Ne.disconnect()}}},[i]),Tt.useEffect(()=>{if(a){let be=setTimeout(()=>{_(!0)},100);return()=>{clearTimeout(be)}}},[a]);let Y=()=>{d(!0)},xe=()=>{d(!1),_(!1)};return t?i!=="intent"?[m,ee,{}]:[m,ee,{onFocus:k_(c,Y),onBlur:k_(C,xe),onMouseEnter:k_(k,Y),onMouseLeave:k_(V,xe),onTouchStart:k_(G,Y)}]:[!1,ee,{}]}function k_(i,e){return t=>{i&&i(t),t.defaultPrevented||e(t)}}function TR({page:i,...e}){let{router:t}=IE(),a=Tt.useMemo(()=>_E(t.routes,i,t.basename),[t.routes,i,t.basename]);return a?Tt.createElement(ER,{page:i,matches:a,...e}):null}function SR(i){let{manifest:e,routeModules:t}=ME(),[a,d]=Tt.useState([]);return Tt.useEffect(()=>{let m=!1;return gR(i,e,t).then(_=>{m||d(_)}),()=>{m=!0}},[i,e,t]),a}function ER({page:i,matches:e,...t}){let a=Yp(),{manifest:d,routeModules:m}=ME(),{basename:_}=IE(),{loaderData:c,matches:C}=xR(),k=Tt.useMemo(()=>_2(i,e,C,d,a,"data"),[i,e,C,d,a]),V=Tt.useMemo(()=>_2(i,e,C,d,a,"assets"),[i,e,C,d,a]),G=Tt.useMemo(()=>{if(i===a.pathname+a.search+a.hash)return[];let xe=new Set,be=!1;if(e.forEach(tt=>{var Xe;let Je=d.routes[tt.route.id];!Je||!Je.hasLoader||(!k.some(Ke=>Ke.route.id===tt.route.id)&&tt.route.id in c&&((Xe=m[tt.route.id])!=null&&Xe.shouldRevalidate)||Je.hasClientLoader?be=!0:xe.add(tt.route.id))}),xe.size===0)return[];let Ne=fR(i,_,"data");return be&&xe.size>0&&Ne.searchParams.set("_routes",e.filter(tt=>xe.has(tt.route.id)).map(tt=>tt.route.id).join(",")),[Ne.pathname+Ne.search]},[_,c,a,d,k,e,i,m]),ee=Tt.useMemo(()=>_R(V,d),[V,d]),Y=SR(V);return Tt.createElement(Tt.Fragment,null,G.map(xe=>Tt.createElement("link",{key:xe,rel:"prefetch",as:"fetch",href:xe,...t})),ee.map(xe=>Tt.createElement("link",{key:xe,rel:"modulepreload",href:xe,...t})),Y.map(({key:xe,link:be})=>Tt.createElement("link",{key:xe,nonce:t.nonce,...be})))}function AR(...i){return e=>{i.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var PE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{PE&&(window.__reactRouterVersion="7.9.4")}catch{}function CR({basename:i,children:e,window:t}){let a=Tt.useRef();a.current==null&&(a.current=pP({window:t,v5Compat:!0}));let d=a.current,[m,_]=Tt.useState({action:d.action,location:d.location}),c=Tt.useCallback(C=>{Tt.startTransition(()=>_(C))},[_]);return Tt.useLayoutEffect(()=>d.listen(c),[d,c]),Tt.createElement(iR,{basename:i,children:e,location:m.location,navigationType:m.action,navigator:d})}var RE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,LE=Tt.forwardRef(function({onClick:e,discover:t="render",prefetch:a="none",relative:d,reloadDocument:m,replace:_,state:c,target:C,to:k,preventScrollReset:V,viewTransition:G,...ee},Y){let{basename:xe}=Tt.useContext(Qh),be=typeof k=="string"&&RE.test(k),Ne,tt=!1;if(typeof k=="string"&&be&&(Ne=k,PE))try{let ge=new URL(window.location.href),Ae=k.startsWith("//")?new URL(ge.protocol+k):new URL(k),Re=Fd(Ae.pathname,xe);Ae.origin===ge.origin&&Re!=null?k=Re+Ae.search+Ae.hash:tt=!0}catch{Xh(!1,`<Link to="${k}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let Je=UP(k,{relative:d}),[Xe,Ke,Ge]=wR(a,ee),Fe=RR(k,{replace:_,state:c,target:C,preventScrollReset:V,relative:d,viewTransition:G});function de(ge){e&&e(ge),ge.defaultPrevented||Fe(ge)}let ce=Tt.createElement("a",{...ee,...Ge,href:Ne||Je,onClick:tt||m?e:de,ref:AR(Y,Ke),target:C,"data-discover":!be&&t==="render"?"true":void 0});return Xe&&!be?Tt.createElement(Tt.Fragment,null,ce,Tt.createElement(TR,{page:Je})):ce});LE.displayName="Link";var IR=Tt.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:a="",end:d=!1,style:m,to:_,viewTransition:c,children:C,...k},V){let G=Ey(_,{relative:k.relative}),ee=Yp(),Y=Tt.useContext($0),{navigator:xe,basename:be}=Tt.useContext(Qh),Ne=Y!=null&&OR(G)&&c===!0,tt=xe.encodeLocation?xe.encodeLocation(G).pathname:G.pathname,Je=ee.pathname,Xe=Y&&Y.navigation&&Y.navigation.location?Y.navigation.location.pathname:null;t||(Je=Je.toLowerCase(),Xe=Xe?Xe.toLowerCase():null,tt=tt.toLowerCase()),Xe&&be&&(Xe=Fd(Xe,be)||Xe);const Ke=tt!=="/"&&tt.endsWith("/")?tt.length-1:tt.length;let Ge=Je===tt||!d&&Je.startsWith(tt)&&Je.charAt(Ke)==="/",Fe=Xe!=null&&(Xe===tt||!d&&Xe.startsWith(tt)&&Xe.charAt(tt.length)==="/"),de={isActive:Ge,isPending:Fe,isTransitioning:Ne},ce=Ge?e:void 0,ge;typeof a=="function"?ge=a(de):ge=[a,Ge?"active":null,Fe?"pending":null,Ne?"transitioning":null].filter(Boolean).join(" ");let Ae=typeof m=="function"?m(de):m;return Tt.createElement(LE,{...k,"aria-current":ce,className:ge,ref:V,style:Ae,to:_,viewTransition:c},typeof C=="function"?C(de):C)});IR.displayName="NavLink";var MR=Tt.forwardRef(({discover:i="render",fetcherKey:e,navigate:t,reloadDocument:a,replace:d,state:m,method:_=Zv,action:c,onSubmit:C,relative:k,preventScrollReset:V,viewTransition:G,...ee},Y)=>{let xe=DR(),be=zR(c,{relative:k}),Ne=_.toLowerCase()==="get"?"get":"post",tt=typeof c=="string"&&RE.test(c),Je=Xe=>{if(C&&C(Xe),Xe.defaultPrevented)return;Xe.preventDefault();let Ke=Xe.nativeEvent.submitter,Ge=(Ke==null?void 0:Ke.getAttribute("formmethod"))||_;xe(Ke||Xe.currentTarget,{fetcherKey:e,method:Ge,navigate:t,replace:d,state:m,relative:k,preventScrollReset:V,viewTransition:G})};return Tt.createElement("form",{ref:Y,method:Ne,action:be,onSubmit:a?C:Je,...ee,"data-discover":!tt&&i==="render"?"true":void 0})});MR.displayName="Form";function PR(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function kE(i){let e=Tt.useContext(vg);return Ba(e,PR(i)),e}function RR(i,{target:e,replace:t,state:a,preventScrollReset:d,relative:m,viewTransition:_}={}){let c=jP(),C=Yp(),k=Ey(i,{relative:m});return Tt.useCallback(V=>{if(uR(V,e)){V.preventDefault();let G=t!==void 0?t:ny(C)===ny(k);c(i,{replace:G,state:a,preventScrollReset:d,relative:m,viewTransition:_})}},[C,c,k,t,a,e,i,d,m,_])}var LR=0,kR=()=>`__${String(++LR)}__`;function DR(){let{router:i}=kE("useSubmit"),{basename:e}=Tt.useContext(Qh),t=JP();return Tt.useCallback(async(a,d={})=>{let{action:m,method:_,encType:c,formData:C,body:k}=dR(a,e);if(d.navigate===!1){let V=d.fetcherKey||kR();await i.fetch(V,t,d.action||m,{preventScrollReset:d.preventScrollReset,formData:C,body:k,formMethod:d.method||_,formEncType:d.encType||c,flushSync:d.flushSync})}else await i.navigate(d.action||m,{preventScrollReset:d.preventScrollReset,formData:C,body:k,formMethod:d.method||_,formEncType:d.encType||c,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,e,t])}function zR(i,{relative:e}={}){let{basename:t}=Tt.useContext(Qh),a=Tt.useContext(Zd);Ba(a,"useFormAction must be used inside a RouteContext");let[d]=a.matches.slice(-1),m={...Ey(i||".",{relative:e})},_=Yp();if(i==null){m.search=_.search;let c=new URLSearchParams(m.search),C=c.getAll("index");if(C.some(V=>V==="")){c.delete("index"),C.filter(G=>G).forEach(G=>c.append("index",G));let V=c.toString();m.search=V?`?${V}`:""}}return(!i||i===".")&&d.route.index&&(m.search=m.search?m.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(m.pathname=m.pathname==="/"?t:zd([t,m.pathname])),ny(m)}function OR(i,{relative:e}={}){let t=Tt.useContext(TE);Ba(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=kE("useViewTransitionState"),d=Ey(i,{relative:e});if(!t.isTransitioning)return!1;let m=Fd(t.currentLocation.pathname,a)||t.currentLocation.pathname,_=Fd(t.nextLocation.pathname,a)||t.nextLocation.pathname;return d0(d.pathname,_)!=null||d0(d.pathname,m)!=null}const DE=()=>{const[i,e]=Tt.useState(!1),t=()=>e(!i);return Ce.jsxs(Ce.Fragment,{children:[Ce.jsx("div",{className:"scroll-indicator"}),Ce.jsx("nav",{children:Ce.jsxs("div",{className:"nav-container",children:[Ce.jsxs("a",{href:"./#home",className:"logo",children:["Red",Ce.jsx("span",{className:"highlight",children:" Report "})]}),Ce.jsx("div",{className:"hamburger",onClick:t,children:Ce.jsx("span",{className:"hamburger-icon",children:""})}),Ce.jsxs("ul",{className:`nav-links${i?" open":""}`,children:[Ce.jsx("li",{children:Ce.jsx("a",{href:"./#home",children:"Home"})}),Ce.jsx("li",{children:Ce.jsx("a",{href:"./#mission",children:"Mission"})}),Ce.jsx("li",{children:Ce.jsx("a",{href:"./#timeline",children:"Timeline"})}),Ce.jsx("li",{children:Ce.jsx("a",{href:"/report",className:"report-btn",children:"REPORT"})}),Ce.jsx("li",{children:Ce.jsx("a",{href:"/map",className:"map-btn",children:"MAP"})})]})]})})]})},NR=()=>Ce.jsxs("section",{id:"home",className:"hero",children:[Ce.jsxs("div",{className:"floating-elements",children:[Ce.jsx("div",{className:"floating-dot"}),Ce.jsx("div",{className:"floating-dot"}),Ce.jsx("div",{className:"floating-dot"}),Ce.jsx("div",{className:"floating-dot"})]}),Ce.jsxs("div",{className:"hero-container",children:[Ce.jsxs("div",{className:"hero-content",children:[Ce.jsxs("h1",{children:[Ce.jsx("span",{className:"highlight",children:"Student voices"}),Ce.jsx("br",{}),"SAFER CAMPUS"]}),Ce.jsx("p",{children:"Anonymous reporting tool built by and for students in the Notre Dame Tricampus community. Empowering students to share experiences without fear while creating meaningful change."}),Ce.jsx("a",{href:"#mission",className:"cta-button",children:"Learn more"})]}),Ce.jsx("div",{className:"hero-visual",children:Ce.jsx("div",{className:"campus-circle",children:Ce.jsx("img",{src:"/abstract.svg",alt:"Logo",className:"campus-image"})})})]})]}),BR=()=>Ce.jsxs("section",{id:"mission",className:"content-section",children:[Ce.jsxs("div",{className:"section-header",children:[Ce.jsxs("h2",{children:["Our ",Ce.jsx("span",{className:"highlight",children:"Mission"})]}),Ce.jsxs("p",{children:["Existing reporting systems are intimidating to the point nothing ever gets reported. ",Ce.jsx("span",{className:"highlight",children:"RedReport"})," makes everything entirely anonymous focusing on your safety."]})]}),Ce.jsxs("div",{className:"mission-grid",children:[Ce.jsxs("div",{className:"mission-card",children:[Ce.jsx("h3",{children:"Anonymous & Safe"}),Ce.jsx("p",{children:"Report experiences without fear of retaliation. We never collect any personal identifiers, our goal is to assist you when you are still not comfortable with a full report."})]}),Ce.jsxs("div",{className:"mission-card",children:[Ce.jsx("h3",{children:"Campus Wide Access to Data"}),Ce.jsx("p",{children:"We allow anyone on campus see current campus trends. No filter, we show the reality; the good, the bad, and the ugly."})]}),Ce.jsxs("div",{className:"mission-card",children:[Ce.jsx("h3",{children:"Working to prevent"}),Ce.jsx("p",{children:"We use our data to take action and prevent future cases. We wish our product didn't need to exist, so that's the goal we are working towards."})]})]}),Ce.jsxs("div",{className:"stats-grid",children:[Ce.jsxs("div",{className:"stat-card",children:[Ce.jsx("span",{className:"stat-number",children:"100%"}),Ce.jsx("span",{className:"stat-label",children:"Anonymous"})]}),Ce.jsxs("div",{className:"stat-card",children:[Ce.jsx("span",{className:"stat-number",children:"24/7"}),Ce.jsx("span",{className:"stat-label",children:"Available"})]}),Ce.jsxs("div",{className:"stat-card",children:[Ce.jsx("span",{className:"stat-number",children:"3"}),Ce.jsx("span",{className:"stat-label",children:"Campuses"})]}),Ce.jsxs("div",{className:"stat-card",children:[Ce.jsx("span",{className:"stat-number",children:""}),Ce.jsx("span",{className:"stat-label",children:"Impact"})]})]})]}),FR=()=>Ce.jsxs("section",{id:"timeline",className:"content-section",children:[Ce.jsxs("div",{className:"section-header",children:[Ce.jsxs("h2",{children:["Our ",Ce.jsx("span",{className:"highlight",children:"Timeline"})]}),Ce.jsx("p",{children:"See how RedReport is evolving to better serve the Notre Dame Tricampus community"})]}),Ce.jsxs("div",{className:"timeline",children:[Ce.jsxs("div",{className:"timeline-item",children:[Ce.jsx("div",{className:"timeline-dot"}),Ce.jsxs("div",{className:"timeline-content",children:[Ce.jsx("h3",{children:"Phase 1: Idea phase"}),Ce.jsx("p",{children:"Redreport started coming to life in notes rough prototypes and small user tests."})]})]}),Ce.jsxs("div",{className:"timeline-item",children:[Ce.jsx("div",{className:"timeline-dot"}),Ce.jsxs("div",{className:"timeline-content",children:[Ce.jsx("h3",{children:"Phase 2: Research and Proposal"}),Ce.jsxs("p",{children:["Wrote several reports backed by in depth research receiving recognition"," ",Ce.jsx("a",{href:"https://library-research-award.library.nd.edu/2025.html",children:"Hesburgh Libraries"}),"."]})]})]}),Ce.jsxs("div",{className:"timeline-item",children:[Ce.jsx("div",{className:"timeline-dot"}),Ce.jsxs("div",{className:"timeline-content current",children:[Ce.jsx("h3",{className:"highlight",children:"Phase 3: Launch"}),Ce.jsx("p",{className:"highlight",children:"Forming a small team to start making actual change across campus. Continously updating our system to get stuff done."})]})]}),Ce.jsxs("div",{className:"timeline-item",children:[Ce.jsx("div",{className:"timeline-dot"}),Ce.jsxs("div",{className:"timeline-content",children:[Ce.jsx("h3",{children:"Phase 4: Expansion"}),Ce.jsx("p",{children:"Grow team, and develop ties with campus administration to amplify Redreport's impact."})]})]})]})]}),y2=()=>(Tt.useEffect(()=>{const i=()=>{const m=window.pageYOffset,_=document.body.scrollHeight-window.innerHeight,c=m/_*100,C=document.querySelector(".scroll-indicator");C&&(C.style.width=c+"%")},e=()=>{document.querySelectorAll('a[href^="#"]').forEach(m=>{m.addEventListener("click",function(_){_.preventDefault();const c=document.querySelector(this.getAttribute("href"));c&&c.scrollIntoView({behavior:"smooth",block:"start"})})})},t=()=>{const m=new IntersectionObserver(_=>{_.forEach(c=>{c.isIntersecting&&c.target.classList.add("visible")})},{threshold:.1});document.querySelectorAll(".content-section").forEach(_=>{m.observe(_)})},a=()=>{const m=document.querySelector("nav");m&&window.addEventListener("scroll",()=>{window.scrollY>100?(m.style.background="rgba(254, 248, 243, 0.98)",m.style.boxShadow="0 2px 20px rgba(216, 47, 37, 0.1)"):(m.style.background="rgba(254, 248, 243, 0.95)",m.style.boxShadow="none")})};return e(),t(),a(),window.addEventListener("scroll",i),i(),(()=>{document.querySelectorAll(".stat-card").forEach(m=>{m.addEventListener("mouseenter",()=>{m.style.transform="scale(1.05) rotate(2deg)"}),m.addEventListener("mouseleave",()=>{m.style.transform="scale(1) rotate(0deg)"})}),document.querySelectorAll(".mission-card").forEach((m,_)=>{m.style.animationDelay=`${_*.2}s`,m.addEventListener("mouseenter",()=>{m.style.borderLeft="8px solid #D82F25"}),m.addEventListener("mouseleave",()=>{m.style.borderLeft="4px solid #D82F25"})})})(),()=>{window.removeEventListener("scroll",i)}},[]),Ce.jsxs("div",{className:"landing-page",children:[Ce.jsx(DE,{}),Ce.jsx(NR,{}),Ce.jsx(BR,{}),Ce.jsx(FR,{})]})),VR=()=>{};var v2={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zE=function(i){const e=[];let t=0;for(let a=0;a<i.length;a++){let d=i.charCodeAt(a);d<128?e[t++]=d:d<2048?(e[t++]=d>>6|192,e[t++]=d&63|128):(d&64512)===55296&&a+1<i.length&&(i.charCodeAt(a+1)&64512)===56320?(d=65536+((d&1023)<<10)+(i.charCodeAt(++a)&1023),e[t++]=d>>18|240,e[t++]=d>>12&63|128,e[t++]=d>>6&63|128,e[t++]=d&63|128):(e[t++]=d>>12|224,e[t++]=d>>6&63|128,e[t++]=d&63|128)}return e},UR=function(i){const e=[];let t=0,a=0;for(;t<i.length;){const d=i[t++];if(d<128)e[a++]=String.fromCharCode(d);else if(d>191&&d<224){const m=i[t++];e[a++]=String.fromCharCode((d&31)<<6|m&63)}else if(d>239&&d<365){const m=i[t++],_=i[t++],c=i[t++],C=((d&7)<<18|(m&63)<<12|(_&63)<<6|c&63)-65536;e[a++]=String.fromCharCode(55296+(C>>10)),e[a++]=String.fromCharCode(56320+(C&1023))}else{const m=i[t++],_=i[t++];e[a++]=String.fromCharCode((d&15)<<12|(m&63)<<6|_&63)}}return e.join("")},OE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,a=[];for(let d=0;d<i.length;d+=3){const m=i[d],_=d+1<i.length,c=_?i[d+1]:0,C=d+2<i.length,k=C?i[d+2]:0,V=m>>2,G=(m&3)<<4|c>>4;let ee=(c&15)<<2|k>>6,Y=k&63;C||(Y=64,_||(ee=64)),a.push(t[V],t[G],t[ee],t[Y])}return a.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(zE(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):UR(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,a=[];for(let d=0;d<i.length;){const m=t[i.charAt(d++)],c=d<i.length?t[i.charAt(d)]:0;++d;const k=d<i.length?t[i.charAt(d)]:64;++d;const G=d<i.length?t[i.charAt(d)]:64;if(++d,m==null||c==null||k==null||G==null)throw new jR;const ee=m<<2|c>>4;if(a.push(ee),k!==64){const Y=c<<4&240|k>>2;if(a.push(Y),G!==64){const xe=k<<6&192|G;a.push(xe)}}}return a},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class jR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const qR=function(i){const e=zE(i);return OE.encodeByteArray(e,!0)},f0=function(i){return qR(i).replace(/\./g,"")},NE=function(i){try{return OE.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $R(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GR=()=>$R().__FIREBASE_DEFAULTS__,ZR=()=>{if(typeof process>"u"||typeof v2>"u")return;const i=v2.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},HR=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=i&&NE(i[1]);return e&&JSON.parse(e)},Z0=()=>{try{return VR()||GR()||ZR()||HR()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},BE=i=>{var e,t;return(t=(e=Z0())==null?void 0:e.emulatorHosts)==null?void 0:t[i]},WR=i=>{const e=BE(i);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const a=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),a]:[e.substring(0,t),a]},FE=()=>{var i;return(i=Z0())==null?void 0:i.config},VE=i=>{var e;return(e=Z0())==null?void 0:e[`_${i}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,a)=>{t?this.reject(t):this.resolve(a),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,a))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bg(i){try{return(i.startsWith("http://")||i.startsWith("https://")?new URL(i).hostname:i).endsWith(".cloudworkstations.dev")}catch{return!1}}async function UE(i){return(await fetch(i,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KR(i,e){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},a=e||"demo-project",d=i.iat||0,m=i.sub||i.user_id;if(!m)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const _={iss:`https://securetoken.google.com/${a}`,aud:a,iat:d,exp:d+3600,auth_time:d,sub:m,user_id:m,firebase:{sign_in_provider:"custom",identities:{}},...i};return[f0(JSON.stringify(t)),f0(JSON.stringify(_)),""].join(".")}const G_={};function YR(){const i={prod:[],emulator:[]};for(const e of Object.keys(G_))G_[e]?i.emulator.push(e):i.prod.push(e);return i}function QR(i){let e=document.getElementById(i),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",i),t=!0),{created:t,element:e}}let b2=!1;function jE(i,e){if(typeof window>"u"||typeof document>"u"||!bg(window.location.host)||G_[i]===e||G_[i]||b2)return;G_[i]=e;function t(ee){return`__firebase__banner__${ee}`}const a="__firebase__banner",m=YR().prod.length>0;function _(){const ee=document.getElementById(a);ee&&ee.remove()}function c(ee){ee.style.display="flex",ee.style.background="#7faaf0",ee.style.position="fixed",ee.style.bottom="5px",ee.style.left="5px",ee.style.padding=".5em",ee.style.borderRadius="5px",ee.style.alignItems="center"}function C(ee,Y){ee.setAttribute("width","24"),ee.setAttribute("id",Y),ee.setAttribute("height","24"),ee.setAttribute("viewBox","0 0 24 24"),ee.setAttribute("fill","none"),ee.style.marginLeft="-6px"}function k(){const ee=document.createElement("span");return ee.style.cursor="pointer",ee.style.marginLeft="16px",ee.style.fontSize="24px",ee.innerHTML=" &times;",ee.onclick=()=>{b2=!0,_()},ee}function V(ee,Y){ee.setAttribute("id",Y),ee.innerText="Learn more",ee.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",ee.setAttribute("target","__blank"),ee.style.paddingLeft="5px",ee.style.textDecoration="underline"}function G(){const ee=QR(a),Y=t("text"),xe=document.getElementById(Y)||document.createElement("span"),be=t("learnmore"),Ne=document.getElementById(be)||document.createElement("a"),tt=t("preprendIcon"),Je=document.getElementById(tt)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(ee.created){const Xe=ee.element;c(Xe),V(Ne,be);const Ke=k();C(Je,tt),Xe.append(Je,xe,Ne,Ke),document.body.appendChild(Xe)}m?(xe.innerText="Preview backend disconnected.",Je.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Je.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,xe.innerText="Preview backend running in this workspace."),xe.setAttribute("id",Y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",G):G()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ml(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function JR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ml())}function eL(){var e;const i=(e=Z0())==null?void 0:e.forceEnvironment;if(i==="node")return!0;if(i==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function tL(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function qE(){const i=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof i=="object"&&i.id!==void 0}function nL(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function iL(){const i=Ml();return i.indexOf("MSIE ")>=0||i.indexOf("Trident/")>=0}function rL(){return!eL()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function $E(){try{return typeof indexedDB=="object"}catch{return!1}}function GE(){return new Promise((i,e)=>{try{let t=!0;const a="validate-browser-context-for-indexeddb-analytics-module",d=self.indexedDB.open(a);d.onsuccess=()=>{d.result.close(),t||self.indexedDB.deleteDatabase(a),i(!0)},d.onupgradeneeded=()=>{t=!1},d.onerror=()=>{var m;e(((m=d.error)==null?void 0:m.message)||"")}}catch(t){e(t)}})}function aL(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sL="FirebaseError";class lh extends Error{constructor(e,t,a){super(t),this.code=e,this.customData=a,this.name=sL,Object.setPrototypeOf(this,lh.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qp.prototype.create)}}class Qp{constructor(e,t,a){this.service=e,this.serviceName=t,this.errors=a}create(e,...t){const a=t[0]||{},d=`${this.service}/${e}`,m=this.errors[e],_=m?oL(m,a):"Error",c=`${this.serviceName}: ${_} (${d}).`;return new lh(d,c,a)}}function oL(i,e){return i.replace(lL,(t,a)=>{const d=e[a];return d!=null?String(d):`<${a}?>`})}const lL=/\{\$([^}]+)}/g;function uL(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}function Nf(i,e){if(i===e)return!0;const t=Object.keys(i),a=Object.keys(e);for(const d of t){if(!a.includes(d))return!1;const m=i[d],_=e[d];if(x2(m)&&x2(_)){if(!Nf(m,_))return!1}else if(m!==_)return!1}for(const d of a)if(!t.includes(d))return!1;return!0}function x2(i){return i!==null&&typeof i=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ay(i){const e=[];for(const[t,a]of Object.entries(i))Array.isArray(a)?a.forEach(d=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(d))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(a));return e.length?"&"+e.join("&"):""}function cL(i,e){const t=new hL(i,e);return t.subscribe.bind(t)}class hL{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(a=>{this.error(a)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,a){let d;if(e===void 0&&t===void 0&&a===void 0)throw new Error("Missing Observer.");dL(e,["next","error","complete"])?d=e:d={next:e,error:t,complete:a},d.next===void 0&&(d.next=Kb),d.error===void 0&&(d.error=Kb),d.complete===void 0&&(d.complete=Kb);const m=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?d.error(this.finalError):d.complete()}catch{}}),this.observers.push(d),m}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(a){typeof console<"u"&&console.error&&console.error(a)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function dL(i,e){if(typeof i!="object"||i===null)return!1;for(const t of e)if(t in i&&typeof i[t]=="function")return!0;return!1}function Kb(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fL=1e3,pL=2,mL=14400*1e3,gL=.5;function w2(i,e=fL,t=pL){const a=e*Math.pow(t,i),d=Math.round(gL*a*(Math.random()-.5)*2);return Math.min(mL,a+d)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ql(i){return i&&i._delegate?i._delegate:i}class sh{constructor(e,t,a){this.name=e,this.instanceFactory=t,this.type=a,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ap="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _L{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const a=new XR;if(this.instancesDeferred.set(t,a),this.isInitialized(t)||this.shouldAutoInitialize())try{const d=this.getOrInitializeService({instanceIdentifier:t});d&&a.resolve(d)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(d){if(a)return null;throw d}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(vL(e))try{this.getOrInitializeService({instanceIdentifier:Ap})}catch{}for(const[t,a]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(t);try{const m=this.getOrInitializeService({instanceIdentifier:d});a.resolve(m)}catch{}}}}clearInstance(e=Ap){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ap){return this.instances.has(e)}getOptions(e=Ap){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,a=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(a))throw Error(`${this.name}(${a}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const d=this.getOrInitializeService({instanceIdentifier:a,options:t});for(const[m,_]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(m);a===c&&_.resolve(d)}return d}onInit(e,t){const a=this.normalizeInstanceIdentifier(t),d=this.onInitCallbacks.get(a)??new Set;d.add(e),this.onInitCallbacks.set(a,d);const m=this.instances.get(a);return m&&e(m,a),()=>{d.delete(e)}}invokeOnInitCallbacks(e,t){const a=this.onInitCallbacks.get(t);if(a)for(const d of a)try{d(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let a=this.instances.get(e);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:yL(e),options:t}),this.instances.set(e,a),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(a,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,a)}catch{}return a||null}normalizeInstanceIdentifier(e=Ap){return this.component?this.component.multipleInstances?e:Ap:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function yL(i){return i===Ap?void 0:i}function vL(i){return i.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bL{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new _L(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Oi;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(Oi||(Oi={}));const xL={debug:Oi.DEBUG,verbose:Oi.VERBOSE,info:Oi.INFO,warn:Oi.WARN,error:Oi.ERROR,silent:Oi.SILENT},wL=Oi.INFO,TL={[Oi.DEBUG]:"log",[Oi.VERBOSE]:"log",[Oi.INFO]:"info",[Oi.WARN]:"warn",[Oi.ERROR]:"error"},SL=(i,e,...t)=>{if(e<i.logLevel)return;const a=new Date().toISOString(),d=TL[e];if(d)console[d](`[${a}]  ${i.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class H0{constructor(e){this.name=e,this._logLevel=wL,this._logHandler=SL,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Oi))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?xL[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Oi.DEBUG,...e),this._logHandler(this,Oi.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Oi.VERBOSE,...e),this._logHandler(this,Oi.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Oi.INFO,...e),this._logHandler(this,Oi.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Oi.WARN,...e),this._logHandler(this,Oi.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Oi.ERROR,...e),this._logHandler(this,Oi.ERROR,...e)}}const EL=(i,e)=>e.some(t=>i instanceof t);let T2,S2;function AL(){return T2||(T2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function CL(){return S2||(S2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ZE=new WeakMap,Px=new WeakMap,HE=new WeakMap,Yb=new WeakMap,P1=new WeakMap;function IL(i){const e=new Promise((t,a)=>{const d=()=>{i.removeEventListener("success",m),i.removeEventListener("error",_)},m=()=>{t(Rf(i.result)),d()},_=()=>{a(i.error),d()};i.addEventListener("success",m),i.addEventListener("error",_)});return e.then(t=>{t instanceof IDBCursor&&ZE.set(t,i)}).catch(()=>{}),P1.set(e,i),e}function ML(i){if(Px.has(i))return;const e=new Promise((t,a)=>{const d=()=>{i.removeEventListener("complete",m),i.removeEventListener("error",_),i.removeEventListener("abort",_)},m=()=>{t(),d()},_=()=>{a(i.error||new DOMException("AbortError","AbortError")),d()};i.addEventListener("complete",m),i.addEventListener("error",_),i.addEventListener("abort",_)});Px.set(i,e)}let Rx={get(i,e,t){if(i instanceof IDBTransaction){if(e==="done")return Px.get(i);if(e==="objectStoreNames")return i.objectStoreNames||HE.get(i);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Rf(i[e])},set(i,e,t){return i[e]=t,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function PL(i){Rx=i(Rx)}function RL(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const a=i.call(Qb(this),e,...t);return HE.set(a,e.sort?e.sort():[e]),Rf(a)}:CL().includes(i)?function(...e){return i.apply(Qb(this),e),Rf(ZE.get(this))}:function(...e){return Rf(i.apply(Qb(this),e))}}function LL(i){return typeof i=="function"?RL(i):(i instanceof IDBTransaction&&ML(i),EL(i,AL())?new Proxy(i,Rx):i)}function Rf(i){if(i instanceof IDBRequest)return IL(i);if(Yb.has(i))return Yb.get(i);const e=LL(i);return e!==i&&(Yb.set(i,e),P1.set(e,i)),e}const Qb=i=>P1.get(i);function WE(i,e,{blocked:t,upgrade:a,blocking:d,terminated:m}={}){const _=indexedDB.open(i,e),c=Rf(_);return a&&_.addEventListener("upgradeneeded",C=>{a(Rf(_.result),C.oldVersion,C.newVersion,Rf(_.transaction),C)}),t&&_.addEventListener("blocked",C=>t(C.oldVersion,C.newVersion,C)),c.then(C=>{m&&C.addEventListener("close",()=>m()),d&&C.addEventListener("versionchange",k=>d(k.oldVersion,k.newVersion,k))}).catch(()=>{}),c}const kL=["get","getKey","getAll","getAllKeys","count"],DL=["put","add","delete","clear"],Jb=new Map;function E2(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(Jb.get(e))return Jb.get(e);const t=e.replace(/FromIndex$/,""),a=e!==t,d=DL.includes(t);if(!(t in(a?IDBIndex:IDBObjectStore).prototype)||!(d||kL.includes(t)))return;const m=async function(_,...c){const C=this.transaction(_,d?"readwrite":"readonly");let k=C.store;return a&&(k=k.index(c.shift())),(await Promise.all([k[t](...c),d&&C.done]))[0]};return Jb.set(e,m),m}PL(i=>({...i,get:(e,t,a)=>E2(e,t)||i.get(e,t,a),has:(e,t)=>!!E2(e,t)||i.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zL{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(OL(t)){const a=t.getImmediate();return`${a.library}/${a.version}`}else return null}).filter(t=>t).join(" ")}}function OL(i){const e=i.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Lx="@firebase/app",A2="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vd=new H0("@firebase/app"),NL="@firebase/app-compat",BL="@firebase/analytics-compat",FL="@firebase/analytics",VL="@firebase/app-check-compat",UL="@firebase/app-check",jL="@firebase/auth",qL="@firebase/auth-compat",$L="@firebase/database",GL="@firebase/data-connect",ZL="@firebase/database-compat",HL="@firebase/functions",WL="@firebase/functions-compat",XL="@firebase/installations",KL="@firebase/installations-compat",YL="@firebase/messaging",QL="@firebase/messaging-compat",JL="@firebase/performance",ek="@firebase/performance-compat",tk="@firebase/remote-config",nk="@firebase/remote-config-compat",ik="@firebase/storage",rk="@firebase/storage-compat",ak="@firebase/firestore",sk="@firebase/ai",ok="@firebase/firestore-compat",lk="firebase",uk="12.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kx="[DEFAULT]",ck={[Lx]:"fire-core",[NL]:"fire-core-compat",[FL]:"fire-analytics",[BL]:"fire-analytics-compat",[UL]:"fire-app-check",[VL]:"fire-app-check-compat",[jL]:"fire-auth",[qL]:"fire-auth-compat",[$L]:"fire-rtdb",[GL]:"fire-data-connect",[ZL]:"fire-rtdb-compat",[HL]:"fire-fn",[WL]:"fire-fn-compat",[XL]:"fire-iid",[KL]:"fire-iid-compat",[YL]:"fire-fcm",[QL]:"fire-fcm-compat",[JL]:"fire-perf",[ek]:"fire-perf-compat",[tk]:"fire-rc",[nk]:"fire-rc-compat",[ik]:"fire-gcs",[rk]:"fire-gcs-compat",[ak]:"fire-fst",[ok]:"fire-fst-compat",[sk]:"fire-vertex","fire-js":"fire-js",[lk]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p0=new Map,hk=new Map,Dx=new Map;function C2(i,e){try{i.container.addComponent(e)}catch(t){Vd.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,t)}}function Kh(i){const e=i.name;if(Dx.has(e))return Vd.debug(`There were multiple attempts to register component ${e}.`),!1;Dx.set(e,i);for(const t of p0.values())C2(t,i);for(const t of hk.values())C2(t,i);return!0}function Jp(i,e){const t=i.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),i.container.getProvider(e)}function Nh(i){return i==null?!1:i.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dk={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Lf=new Qp("app","Firebase",dk);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fk{constructor(e,t,a){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=a,this.container.addComponent(new sh("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Lf.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xg=uk;function XE(i,e={}){let t=i;typeof e!="object"&&(e={name:e});const a={name:kx,automaticDataCollectionEnabled:!0,...e},d=a.name;if(typeof d!="string"||!d)throw Lf.create("bad-app-name",{appName:String(d)});if(t||(t=FE()),!t)throw Lf.create("no-options");const m=p0.get(d);if(m){if(Nf(t,m.options)&&Nf(a,m.config))return m;throw Lf.create("duplicate-app",{appName:d})}const _=new bL(d);for(const C of Dx.values())_.addComponent(C);const c=new fk(t,a,_);return p0.set(d,c),c}function R1(i=kx){const e=p0.get(i);if(!e&&i===kx&&FE())return XE();if(!e)throw Lf.create("no-app",{appName:i});return e}function Rc(i,e,t){let a=ck[i]??i;t&&(a+=`-${t}`);const d=a.match(/\s|\//),m=e.match(/\s|\//);if(d||m){const _=[`Unable to register library "${a}" with version "${e}":`];d&&_.push(`library name "${a}" contains illegal characters (whitespace or "/")`),d&&m&&_.push("and"),m&&_.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Vd.warn(_.join(" "));return}Kh(new sh(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pk="firebase-heartbeat-database",mk=1,iy="firebase-heartbeat-store";let ex=null;function KE(){return ex||(ex=WE(pk,mk,{upgrade:(i,e)=>{switch(e){case 0:try{i.createObjectStore(iy)}catch(t){console.warn(t)}}}}).catch(i=>{throw Lf.create("idb-open",{originalErrorMessage:i.message})})),ex}async function gk(i){try{const t=(await KE()).transaction(iy),a=await t.objectStore(iy).get(YE(i));return await t.done,a}catch(e){if(e instanceof lh)Vd.warn(e.message);else{const t=Lf.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Vd.warn(t.message)}}}async function I2(i,e){try{const a=(await KE()).transaction(iy,"readwrite");await a.objectStore(iy).put(e,YE(i)),await a.done}catch(t){if(t instanceof lh)Vd.warn(t.message);else{const a=Lf.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Vd.warn(a.message)}}}function YE(i){return`${i.name}!${i.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _k=1024,yk=30;class vk{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new xk(t),this._heartbeatsCachePromise=this._storage.read().then(a=>(this._heartbeatsCache=a,a))}async triggerHeartbeat(){var e,t;try{const d=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),m=M2();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===m||this._heartbeatsCache.heartbeats.some(_=>_.date===m))return;if(this._heartbeatsCache.heartbeats.push({date:m,agent:d}),this._heartbeatsCache.heartbeats.length>yk){const _=wk(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(_,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(a){Vd.warn(a)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=M2(),{heartbeatsToSend:a,unsentEntries:d}=bk(this._heartbeatsCache.heartbeats),m=f0(JSON.stringify({version:2,heartbeats:a}));return this._heartbeatsCache.lastSentHeartbeatDate=t,d.length>0?(this._heartbeatsCache.heartbeats=d,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),m}catch(t){return Vd.warn(t),""}}}function M2(){return new Date().toISOString().substring(0,10)}function bk(i,e=_k){const t=[];let a=i.slice();for(const d of i){const m=t.find(_=>_.agent===d.agent);if(m){if(m.dates.push(d.date),P2(t)>e){m.dates.pop();break}}else if(t.push({agent:d.agent,dates:[d.date]}),P2(t)>e){t.pop();break}a=a.slice(1)}return{heartbeatsToSend:t,unsentEntries:a}}class xk{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return $E()?GE().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await gk(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const a=await this.read();return I2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const a=await this.read();return I2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function P2(i){return f0(JSON.stringify({version:2,heartbeats:i})).length}function wk(i){if(i.length===0)return-1;let e=0,t=i[0].date;for(let a=1;a<i.length;a++)i[a].date<t&&(t=i[a].date,e=a);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tk(i){Kh(new sh("platform-logger",e=>new zL(e),"PRIVATE")),Kh(new sh("heartbeat",e=>new vk(e),"PRIVATE")),Rc(Lx,A2,i),Rc(Lx,A2,"esm2020"),Rc("fire-js","")}Tk("");var R2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var kf,QE;(function(){var i;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(de,ce){function ge(){}ge.prototype=ce.prototype,de.F=ce.prototype,de.prototype=new ge,de.prototype.constructor=de,de.D=function(Ae,Re,je){for(var Pe=Array(arguments.length-2),Mn=2;Mn<arguments.length;Mn++)Pe[Mn-2]=arguments[Mn];return ce.prototype[Re].apply(Ae,Pe)}}function t(){this.blockSize=-1}function a(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(a,t),a.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function d(de,ce,ge){ge||(ge=0);const Ae=Array(16);if(typeof ce=="string")for(var Re=0;Re<16;++Re)Ae[Re]=ce.charCodeAt(ge++)|ce.charCodeAt(ge++)<<8|ce.charCodeAt(ge++)<<16|ce.charCodeAt(ge++)<<24;else for(Re=0;Re<16;++Re)Ae[Re]=ce[ge++]|ce[ge++]<<8|ce[ge++]<<16|ce[ge++]<<24;ce=de.g[0],ge=de.g[1],Re=de.g[2];let je=de.g[3],Pe;Pe=ce+(je^ge&(Re^je))+Ae[0]+3614090360&4294967295,ce=ge+(Pe<<7&4294967295|Pe>>>25),Pe=je+(Re^ce&(ge^Re))+Ae[1]+3905402710&4294967295,je=ce+(Pe<<12&4294967295|Pe>>>20),Pe=Re+(ge^je&(ce^ge))+Ae[2]+606105819&4294967295,Re=je+(Pe<<17&4294967295|Pe>>>15),Pe=ge+(ce^Re&(je^ce))+Ae[3]+3250441966&4294967295,ge=Re+(Pe<<22&4294967295|Pe>>>10),Pe=ce+(je^ge&(Re^je))+Ae[4]+4118548399&4294967295,ce=ge+(Pe<<7&4294967295|Pe>>>25),Pe=je+(Re^ce&(ge^Re))+Ae[5]+1200080426&4294967295,je=ce+(Pe<<12&4294967295|Pe>>>20),Pe=Re+(ge^je&(ce^ge))+Ae[6]+2821735955&4294967295,Re=je+(Pe<<17&4294967295|Pe>>>15),Pe=ge+(ce^Re&(je^ce))+Ae[7]+4249261313&4294967295,ge=Re+(Pe<<22&4294967295|Pe>>>10),Pe=ce+(je^ge&(Re^je))+Ae[8]+1770035416&4294967295,ce=ge+(Pe<<7&4294967295|Pe>>>25),Pe=je+(Re^ce&(ge^Re))+Ae[9]+2336552879&4294967295,je=ce+(Pe<<12&4294967295|Pe>>>20),Pe=Re+(ge^je&(ce^ge))+Ae[10]+4294925233&4294967295,Re=je+(Pe<<17&4294967295|Pe>>>15),Pe=ge+(ce^Re&(je^ce))+Ae[11]+2304563134&4294967295,ge=Re+(Pe<<22&4294967295|Pe>>>10),Pe=ce+(je^ge&(Re^je))+Ae[12]+1804603682&4294967295,ce=ge+(Pe<<7&4294967295|Pe>>>25),Pe=je+(Re^ce&(ge^Re))+Ae[13]+4254626195&4294967295,je=ce+(Pe<<12&4294967295|Pe>>>20),Pe=Re+(ge^je&(ce^ge))+Ae[14]+2792965006&4294967295,Re=je+(Pe<<17&4294967295|Pe>>>15),Pe=ge+(ce^Re&(je^ce))+Ae[15]+1236535329&4294967295,ge=Re+(Pe<<22&4294967295|Pe>>>10),Pe=ce+(Re^je&(ge^Re))+Ae[1]+4129170786&4294967295,ce=ge+(Pe<<5&4294967295|Pe>>>27),Pe=je+(ge^Re&(ce^ge))+Ae[6]+3225465664&4294967295,je=ce+(Pe<<9&4294967295|Pe>>>23),Pe=Re+(ce^ge&(je^ce))+Ae[11]+643717713&4294967295,Re=je+(Pe<<14&4294967295|Pe>>>18),Pe=ge+(je^ce&(Re^je))+Ae[0]+3921069994&4294967295,ge=Re+(Pe<<20&4294967295|Pe>>>12),Pe=ce+(Re^je&(ge^Re))+Ae[5]+3593408605&4294967295,ce=ge+(Pe<<5&4294967295|Pe>>>27),Pe=je+(ge^Re&(ce^ge))+Ae[10]+38016083&4294967295,je=ce+(Pe<<9&4294967295|Pe>>>23),Pe=Re+(ce^ge&(je^ce))+Ae[15]+3634488961&4294967295,Re=je+(Pe<<14&4294967295|Pe>>>18),Pe=ge+(je^ce&(Re^je))+Ae[4]+3889429448&4294967295,ge=Re+(Pe<<20&4294967295|Pe>>>12),Pe=ce+(Re^je&(ge^Re))+Ae[9]+568446438&4294967295,ce=ge+(Pe<<5&4294967295|Pe>>>27),Pe=je+(ge^Re&(ce^ge))+Ae[14]+3275163606&4294967295,je=ce+(Pe<<9&4294967295|Pe>>>23),Pe=Re+(ce^ge&(je^ce))+Ae[3]+4107603335&4294967295,Re=je+(Pe<<14&4294967295|Pe>>>18),Pe=ge+(je^ce&(Re^je))+Ae[8]+1163531501&4294967295,ge=Re+(Pe<<20&4294967295|Pe>>>12),Pe=ce+(Re^je&(ge^Re))+Ae[13]+2850285829&4294967295,ce=ge+(Pe<<5&4294967295|Pe>>>27),Pe=je+(ge^Re&(ce^ge))+Ae[2]+4243563512&4294967295,je=ce+(Pe<<9&4294967295|Pe>>>23),Pe=Re+(ce^ge&(je^ce))+Ae[7]+1735328473&4294967295,Re=je+(Pe<<14&4294967295|Pe>>>18),Pe=ge+(je^ce&(Re^je))+Ae[12]+2368359562&4294967295,ge=Re+(Pe<<20&4294967295|Pe>>>12),Pe=ce+(ge^Re^je)+Ae[5]+4294588738&4294967295,ce=ge+(Pe<<4&4294967295|Pe>>>28),Pe=je+(ce^ge^Re)+Ae[8]+2272392833&4294967295,je=ce+(Pe<<11&4294967295|Pe>>>21),Pe=Re+(je^ce^ge)+Ae[11]+1839030562&4294967295,Re=je+(Pe<<16&4294967295|Pe>>>16),Pe=ge+(Re^je^ce)+Ae[14]+4259657740&4294967295,ge=Re+(Pe<<23&4294967295|Pe>>>9),Pe=ce+(ge^Re^je)+Ae[1]+2763975236&4294967295,ce=ge+(Pe<<4&4294967295|Pe>>>28),Pe=je+(ce^ge^Re)+Ae[4]+1272893353&4294967295,je=ce+(Pe<<11&4294967295|Pe>>>21),Pe=Re+(je^ce^ge)+Ae[7]+4139469664&4294967295,Re=je+(Pe<<16&4294967295|Pe>>>16),Pe=ge+(Re^je^ce)+Ae[10]+3200236656&4294967295,ge=Re+(Pe<<23&4294967295|Pe>>>9),Pe=ce+(ge^Re^je)+Ae[13]+681279174&4294967295,ce=ge+(Pe<<4&4294967295|Pe>>>28),Pe=je+(ce^ge^Re)+Ae[0]+3936430074&4294967295,je=ce+(Pe<<11&4294967295|Pe>>>21),Pe=Re+(je^ce^ge)+Ae[3]+3572445317&4294967295,Re=je+(Pe<<16&4294967295|Pe>>>16),Pe=ge+(Re^je^ce)+Ae[6]+76029189&4294967295,ge=Re+(Pe<<23&4294967295|Pe>>>9),Pe=ce+(ge^Re^je)+Ae[9]+3654602809&4294967295,ce=ge+(Pe<<4&4294967295|Pe>>>28),Pe=je+(ce^ge^Re)+Ae[12]+3873151461&4294967295,je=ce+(Pe<<11&4294967295|Pe>>>21),Pe=Re+(je^ce^ge)+Ae[15]+530742520&4294967295,Re=je+(Pe<<16&4294967295|Pe>>>16),Pe=ge+(Re^je^ce)+Ae[2]+3299628645&4294967295,ge=Re+(Pe<<23&4294967295|Pe>>>9),Pe=ce+(Re^(ge|~je))+Ae[0]+4096336452&4294967295,ce=ge+(Pe<<6&4294967295|Pe>>>26),Pe=je+(ge^(ce|~Re))+Ae[7]+1126891415&4294967295,je=ce+(Pe<<10&4294967295|Pe>>>22),Pe=Re+(ce^(je|~ge))+Ae[14]+2878612391&4294967295,Re=je+(Pe<<15&4294967295|Pe>>>17),Pe=ge+(je^(Re|~ce))+Ae[5]+4237533241&4294967295,ge=Re+(Pe<<21&4294967295|Pe>>>11),Pe=ce+(Re^(ge|~je))+Ae[12]+1700485571&4294967295,ce=ge+(Pe<<6&4294967295|Pe>>>26),Pe=je+(ge^(ce|~Re))+Ae[3]+2399980690&4294967295,je=ce+(Pe<<10&4294967295|Pe>>>22),Pe=Re+(ce^(je|~ge))+Ae[10]+4293915773&4294967295,Re=je+(Pe<<15&4294967295|Pe>>>17),Pe=ge+(je^(Re|~ce))+Ae[1]+2240044497&4294967295,ge=Re+(Pe<<21&4294967295|Pe>>>11),Pe=ce+(Re^(ge|~je))+Ae[8]+1873313359&4294967295,ce=ge+(Pe<<6&4294967295|Pe>>>26),Pe=je+(ge^(ce|~Re))+Ae[15]+4264355552&4294967295,je=ce+(Pe<<10&4294967295|Pe>>>22),Pe=Re+(ce^(je|~ge))+Ae[6]+2734768916&4294967295,Re=je+(Pe<<15&4294967295|Pe>>>17),Pe=ge+(je^(Re|~ce))+Ae[13]+1309151649&4294967295,ge=Re+(Pe<<21&4294967295|Pe>>>11),Pe=ce+(Re^(ge|~je))+Ae[4]+4149444226&4294967295,ce=ge+(Pe<<6&4294967295|Pe>>>26),Pe=je+(ge^(ce|~Re))+Ae[11]+3174756917&4294967295,je=ce+(Pe<<10&4294967295|Pe>>>22),Pe=Re+(ce^(je|~ge))+Ae[2]+718787259&4294967295,Re=je+(Pe<<15&4294967295|Pe>>>17),Pe=ge+(je^(Re|~ce))+Ae[9]+3951481745&4294967295,de.g[0]=de.g[0]+ce&4294967295,de.g[1]=de.g[1]+(Re+(Pe<<21&4294967295|Pe>>>11))&4294967295,de.g[2]=de.g[2]+Re&4294967295,de.g[3]=de.g[3]+je&4294967295}a.prototype.v=function(de,ce){ce===void 0&&(ce=de.length);const ge=ce-this.blockSize,Ae=this.C;let Re=this.h,je=0;for(;je<ce;){if(Re==0)for(;je<=ge;)d(this,de,je),je+=this.blockSize;if(typeof de=="string"){for(;je<ce;)if(Ae[Re++]=de.charCodeAt(je++),Re==this.blockSize){d(this,Ae),Re=0;break}}else for(;je<ce;)if(Ae[Re++]=de[je++],Re==this.blockSize){d(this,Ae),Re=0;break}}this.h=Re,this.o+=ce},a.prototype.A=function(){var de=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);de[0]=128;for(var ce=1;ce<de.length-8;++ce)de[ce]=0;ce=this.o*8;for(var ge=de.length-8;ge<de.length;++ge)de[ge]=ce&255,ce/=256;for(this.v(de),de=Array(16),ce=0,ge=0;ge<4;++ge)for(let Ae=0;Ae<32;Ae+=8)de[ce++]=this.g[ge]>>>Ae&255;return de};function m(de,ce){var ge=c;return Object.prototype.hasOwnProperty.call(ge,de)?ge[de]:ge[de]=ce(de)}function _(de,ce){this.h=ce;const ge=[];let Ae=!0;for(let Re=de.length-1;Re>=0;Re--){const je=de[Re]|0;Ae&&je==ce||(ge[Re]=je,Ae=!1)}this.g=ge}var c={};function C(de){return-128<=de&&de<128?m(de,function(ce){return new _([ce|0],ce<0?-1:0)}):new _([de|0],de<0?-1:0)}function k(de){if(isNaN(de)||!isFinite(de))return G;if(de<0)return Ne(k(-de));const ce=[];let ge=1;for(let Ae=0;de>=ge;Ae++)ce[Ae]=de/ge|0,ge*=4294967296;return new _(ce,0)}function V(de,ce){if(de.length==0)throw Error("number format error: empty string");if(ce=ce||10,ce<2||36<ce)throw Error("radix out of range: "+ce);if(de.charAt(0)=="-")return Ne(V(de.substring(1),ce));if(de.indexOf("-")>=0)throw Error('number format error: interior "-" character');const ge=k(Math.pow(ce,8));let Ae=G;for(let je=0;je<de.length;je+=8){var Re=Math.min(8,de.length-je);const Pe=parseInt(de.substring(je,je+Re),ce);Re<8?(Re=k(Math.pow(ce,Re)),Ae=Ae.j(Re).add(k(Pe))):(Ae=Ae.j(ge),Ae=Ae.add(k(Pe)))}return Ae}var G=C(0),ee=C(1),Y=C(16777216);i=_.prototype,i.m=function(){if(be(this))return-Ne(this).m();let de=0,ce=1;for(let ge=0;ge<this.g.length;ge++){const Ae=this.i(ge);de+=(Ae>=0?Ae:4294967296+Ae)*ce,ce*=4294967296}return de},i.toString=function(de){if(de=de||10,de<2||36<de)throw Error("radix out of range: "+de);if(xe(this))return"0";if(be(this))return"-"+Ne(this).toString(de);const ce=k(Math.pow(de,6));var ge=this;let Ae="";for(;;){const Re=Ke(ge,ce).g;ge=tt(ge,Re.j(ce));let je=((ge.g.length>0?ge.g[0]:ge.h)>>>0).toString(de);if(ge=Re,xe(ge))return je+Ae;for(;je.length<6;)je="0"+je;Ae=je+Ae}},i.i=function(de){return de<0?0:de<this.g.length?this.g[de]:this.h};function xe(de){if(de.h!=0)return!1;for(let ce=0;ce<de.g.length;ce++)if(de.g[ce]!=0)return!1;return!0}function be(de){return de.h==-1}i.l=function(de){return de=tt(this,de),be(de)?-1:xe(de)?0:1};function Ne(de){const ce=de.g.length,ge=[];for(let Ae=0;Ae<ce;Ae++)ge[Ae]=~de.g[Ae];return new _(ge,~de.h).add(ee)}i.abs=function(){return be(this)?Ne(this):this},i.add=function(de){const ce=Math.max(this.g.length,de.g.length),ge=[];let Ae=0;for(let Re=0;Re<=ce;Re++){let je=Ae+(this.i(Re)&65535)+(de.i(Re)&65535),Pe=(je>>>16)+(this.i(Re)>>>16)+(de.i(Re)>>>16);Ae=Pe>>>16,je&=65535,Pe&=65535,ge[Re]=Pe<<16|je}return new _(ge,ge[ge.length-1]&-2147483648?-1:0)};function tt(de,ce){return de.add(Ne(ce))}i.j=function(de){if(xe(this)||xe(de))return G;if(be(this))return be(de)?Ne(this).j(Ne(de)):Ne(Ne(this).j(de));if(be(de))return Ne(this.j(Ne(de)));if(this.l(Y)<0&&de.l(Y)<0)return k(this.m()*de.m());const ce=this.g.length+de.g.length,ge=[];for(var Ae=0;Ae<2*ce;Ae++)ge[Ae]=0;for(Ae=0;Ae<this.g.length;Ae++)for(let Re=0;Re<de.g.length;Re++){const je=this.i(Ae)>>>16,Pe=this.i(Ae)&65535,Mn=de.i(Re)>>>16,ni=de.i(Re)&65535;ge[2*Ae+2*Re]+=Pe*ni,Je(ge,2*Ae+2*Re),ge[2*Ae+2*Re+1]+=je*ni,Je(ge,2*Ae+2*Re+1),ge[2*Ae+2*Re+1]+=Pe*Mn,Je(ge,2*Ae+2*Re+1),ge[2*Ae+2*Re+2]+=je*Mn,Je(ge,2*Ae+2*Re+2)}for(de=0;de<ce;de++)ge[de]=ge[2*de+1]<<16|ge[2*de];for(de=ce;de<2*ce;de++)ge[de]=0;return new _(ge,0)};function Je(de,ce){for(;(de[ce]&65535)!=de[ce];)de[ce+1]+=de[ce]>>>16,de[ce]&=65535,ce++}function Xe(de,ce){this.g=de,this.h=ce}function Ke(de,ce){if(xe(ce))throw Error("division by zero");if(xe(de))return new Xe(G,G);if(be(de))return ce=Ke(Ne(de),ce),new Xe(Ne(ce.g),Ne(ce.h));if(be(ce))return ce=Ke(de,Ne(ce)),new Xe(Ne(ce.g),ce.h);if(de.g.length>30){if(be(de)||be(ce))throw Error("slowDivide_ only works with positive integers.");for(var ge=ee,Ae=ce;Ae.l(de)<=0;)ge=Ge(ge),Ae=Ge(Ae);var Re=Fe(ge,1),je=Fe(Ae,1);for(Ae=Fe(Ae,2),ge=Fe(ge,2);!xe(Ae);){var Pe=je.add(Ae);Pe.l(de)<=0&&(Re=Re.add(ge),je=Pe),Ae=Fe(Ae,1),ge=Fe(ge,1)}return ce=tt(de,Re.j(ce)),new Xe(Re,ce)}for(Re=G;de.l(ce)>=0;){for(ge=Math.max(1,Math.floor(de.m()/ce.m())),Ae=Math.ceil(Math.log(ge)/Math.LN2),Ae=Ae<=48?1:Math.pow(2,Ae-48),je=k(ge),Pe=je.j(ce);be(Pe)||Pe.l(de)>0;)ge-=Ae,je=k(ge),Pe=je.j(ce);xe(je)&&(je=ee),Re=Re.add(je),de=tt(de,Pe)}return new Xe(Re,de)}i.B=function(de){return Ke(this,de).h},i.and=function(de){const ce=Math.max(this.g.length,de.g.length),ge=[];for(let Ae=0;Ae<ce;Ae++)ge[Ae]=this.i(Ae)&de.i(Ae);return new _(ge,this.h&de.h)},i.or=function(de){const ce=Math.max(this.g.length,de.g.length),ge=[];for(let Ae=0;Ae<ce;Ae++)ge[Ae]=this.i(Ae)|de.i(Ae);return new _(ge,this.h|de.h)},i.xor=function(de){const ce=Math.max(this.g.length,de.g.length),ge=[];for(let Ae=0;Ae<ce;Ae++)ge[Ae]=this.i(Ae)^de.i(Ae);return new _(ge,this.h^de.h)};function Ge(de){const ce=de.g.length+1,ge=[];for(let Ae=0;Ae<ce;Ae++)ge[Ae]=de.i(Ae)<<1|de.i(Ae-1)>>>31;return new _(ge,de.h)}function Fe(de,ce){const ge=ce>>5;ce%=32;const Ae=de.g.length-ge,Re=[];for(let je=0;je<Ae;je++)Re[je]=ce>0?de.i(je+ge)>>>ce|de.i(je+ge+1)<<32-ce:de.i(je+ge);return new _(Re,de.h)}a.prototype.digest=a.prototype.A,a.prototype.reset=a.prototype.u,a.prototype.update=a.prototype.v,QE=a,_.prototype.add=_.prototype.add,_.prototype.multiply=_.prototype.j,_.prototype.modulo=_.prototype.B,_.prototype.compare=_.prototype.l,_.prototype.toNumber=_.prototype.m,_.prototype.toString=_.prototype.toString,_.prototype.getBits=_.prototype.i,_.fromNumber=k,_.fromString=V,kf=_}).apply(typeof R2<"u"?R2:typeof self<"u"?self:typeof window<"u"?window:{});var Lv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var JE,O_,eA,Wv,zx,tA,nA,iA;(function(){var i,e=Object.defineProperty;function t(P){P=[typeof globalThis=="object"&&globalThis,P,typeof window=="object"&&window,typeof self=="object"&&self,typeof Lv=="object"&&Lv];for(var Z=0;Z<P.length;++Z){var ne=P[Z];if(ne&&ne.Math==Math)return ne}throw Error("Cannot find global object")}var a=t(this);function d(P,Z){if(Z)e:{var ne=a;P=P.split(".");for(var ye=0;ye<P.length-1;ye++){var at=P[ye];if(!(at in ne))break e;ne=ne[at]}P=P[P.length-1],ye=ne[P],Z=Z(ye),Z!=ye&&Z!=null&&e(ne,P,{configurable:!0,writable:!0,value:Z})}}d("Symbol.dispose",function(P){return P||Symbol("Symbol.dispose")}),d("Array.prototype.values",function(P){return P||function(){return this[Symbol.iterator]()}}),d("Object.entries",function(P){return P||function(Z){var ne=[],ye;for(ye in Z)Object.prototype.hasOwnProperty.call(Z,ye)&&ne.push([ye,Z[ye]]);return ne}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var m=m||{},_=this||self;function c(P){var Z=typeof P;return Z=="object"&&P!=null||Z=="function"}function C(P,Z,ne){return P.call.apply(P.bind,arguments)}function k(P,Z,ne){return k=C,k.apply(null,arguments)}function V(P,Z){var ne=Array.prototype.slice.call(arguments,1);return function(){var ye=ne.slice();return ye.push.apply(ye,arguments),P.apply(this,ye)}}function G(P,Z){function ne(){}ne.prototype=Z.prototype,P.Z=Z.prototype,P.prototype=new ne,P.prototype.constructor=P,P.Ob=function(ye,at,ht){for(var Xt=Array(arguments.length-2),kn=2;kn<arguments.length;kn++)Xt[kn-2]=arguments[kn];return Z.prototype[at].apply(ye,Xt)}}var ee=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?P=>P&&AsyncContext.Snapshot.wrap(P):P=>P;function Y(P){const Z=P.length;if(Z>0){const ne=Array(Z);for(let ye=0;ye<Z;ye++)ne[ye]=P[ye];return ne}return[]}function xe(P,Z){for(let ye=1;ye<arguments.length;ye++){const at=arguments[ye];var ne=typeof at;if(ne=ne!="object"?ne:at?Array.isArray(at)?"array":ne:"null",ne=="array"||ne=="object"&&typeof at.length=="number"){ne=P.length||0;const ht=at.length||0;P.length=ne+ht;for(let Xt=0;Xt<ht;Xt++)P[ne+Xt]=at[Xt]}else P.push(at)}}class be{constructor(Z,ne){this.i=Z,this.j=ne,this.h=0,this.g=null}get(){let Z;return this.h>0?(this.h--,Z=this.g,this.g=Z.next,Z.next=null):Z=this.i(),Z}}function Ne(P){_.setTimeout(()=>{throw P},0)}function tt(){var P=de;let Z=null;return P.g&&(Z=P.g,P.g=P.g.next,P.g||(P.h=null),Z.next=null),Z}class Je{constructor(){this.h=this.g=null}add(Z,ne){const ye=Xe.get();ye.set(Z,ne),this.h?this.h.next=ye:this.g=ye,this.h=ye}}var Xe=new be(()=>new Ke,P=>P.reset());class Ke{constructor(){this.next=this.g=this.h=null}set(Z,ne){this.h=Z,this.g=ne,this.next=null}reset(){this.next=this.g=this.h=null}}let Ge,Fe=!1,de=new Je,ce=()=>{const P=Promise.resolve(void 0);Ge=()=>{P.then(ge)}};function ge(){for(var P;P=tt();){try{P.h.call(P.g)}catch(ne){Ne(ne)}var Z=Xe;Z.j(P),Z.h<100&&(Z.h++,P.next=Z.g,Z.g=P)}Fe=!1}function Ae(){this.u=this.u,this.C=this.C}Ae.prototype.u=!1,Ae.prototype.dispose=function(){this.u||(this.u=!0,this.N())},Ae.prototype[Symbol.dispose]=function(){this.dispose()},Ae.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Re(P,Z){this.type=P,this.g=this.target=Z,this.defaultPrevented=!1}Re.prototype.h=function(){this.defaultPrevented=!0};var je=(function(){if(!_.addEventListener||!Object.defineProperty)return!1;var P=!1,Z=Object.defineProperty({},"passive",{get:function(){P=!0}});try{const ne=()=>{};_.addEventListener("test",ne,Z),_.removeEventListener("test",ne,Z)}catch{}return P})();function Pe(P){return/^[\s\xa0]*$/.test(P)}function Mn(P,Z){Re.call(this,P?P.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,P&&this.init(P,Z)}G(Mn,Re),Mn.prototype.init=function(P,Z){const ne=this.type=P.type,ye=P.changedTouches&&P.changedTouches.length?P.changedTouches[0]:null;this.target=P.target||P.srcElement,this.g=Z,Z=P.relatedTarget,Z||(ne=="mouseover"?Z=P.fromElement:ne=="mouseout"&&(Z=P.toElement)),this.relatedTarget=Z,ye?(this.clientX=ye.clientX!==void 0?ye.clientX:ye.pageX,this.clientY=ye.clientY!==void 0?ye.clientY:ye.pageY,this.screenX=ye.screenX||0,this.screenY=ye.screenY||0):(this.clientX=P.clientX!==void 0?P.clientX:P.pageX,this.clientY=P.clientY!==void 0?P.clientY:P.pageY,this.screenX=P.screenX||0,this.screenY=P.screenY||0),this.button=P.button,this.key=P.key||"",this.ctrlKey=P.ctrlKey,this.altKey=P.altKey,this.shiftKey=P.shiftKey,this.metaKey=P.metaKey,this.pointerId=P.pointerId||0,this.pointerType=P.pointerType,this.state=P.state,this.i=P,P.defaultPrevented&&Mn.Z.h.call(this)},Mn.prototype.h=function(){Mn.Z.h.call(this);const P=this.i;P.preventDefault?P.preventDefault():P.returnValue=!1};var ni="closure_listenable_"+(Math.random()*1e6|0),mt=0;function At(P,Z,ne,ye,at){this.listener=P,this.proxy=null,this.src=Z,this.type=ne,this.capture=!!ye,this.ha=at,this.key=++mt,this.da=this.fa=!1}function bt(P){P.da=!0,P.listener=null,P.proxy=null,P.src=null,P.ha=null}function Zt(P,Z,ne){for(const ye in P)Z.call(ne,P[ye],ye,P)}function Vt(P,Z){for(const ne in P)Z.call(void 0,P[ne],ne,P)}function ke(P){const Z={};for(const ne in P)Z[ne]=P[ne];return Z}const xt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ot(P,Z){let ne,ye;for(let at=1;at<arguments.length;at++){ye=arguments[at];for(ne in ye)P[ne]=ye[ne];for(let ht=0;ht<xt.length;ht++)ne=xt[ht],Object.prototype.hasOwnProperty.call(ye,ne)&&(P[ne]=ye[ne])}}function Ut(P){this.src=P,this.g={},this.h=0}Ut.prototype.add=function(P,Z,ne,ye,at){const ht=P.toString();P=this.g[ht],P||(P=this.g[ht]=[],this.h++);const Xt=Wt(P,Z,ye,at);return Xt>-1?(Z=P[Xt],ne||(Z.fa=!1)):(Z=new At(Z,this.src,ht,!!ye,at),Z.fa=ne,P.push(Z)),Z};function Jt(P,Z){const ne=Z.type;if(ne in P.g){var ye=P.g[ne],at=Array.prototype.indexOf.call(ye,Z,void 0),ht;(ht=at>=0)&&Array.prototype.splice.call(ye,at,1),ht&&(bt(Z),P.g[ne].length==0&&(delete P.g[ne],P.h--))}}function Wt(P,Z,ne,ye){for(let at=0;at<P.length;++at){const ht=P[at];if(!ht.da&&ht.listener==Z&&ht.capture==!!ne&&ht.ha==ye)return at}return-1}var Fn="closure_lm_"+(Math.random()*1e6|0),oi={};function fi(P,Z,ne,ye,at){if(Array.isArray(Z)){for(let ht=0;ht<Z.length;ht++)fi(P,Z[ht],ne,ye,at);return null}return ne=Sa(ne),P&&P[ni]?P.J(Z,ne,c(ye)?!!ye.capture:!1,at):ds(P,Z,ne,!1,ye,at)}function ds(P,Z,ne,ye,at,ht){if(!Z)throw Error("Invalid event type");const Xt=c(at)?!!at.capture:!!at;let kn=Ta(P);if(kn||(P[Fn]=kn=new Ut(P)),ne=kn.add(Z,ne,ye,Xt,ht),ne.proxy)return ne;if(ye=Ns(),ne.proxy=ye,ye.src=P,ye.listener=ne,P.addEventListener)je||(at=Xt),at===void 0&&(at=!1),P.addEventListener(Z.toString(),ye,at);else if(P.attachEvent)P.attachEvent(Pi(Z.toString()),ye);else if(P.addListener&&P.removeListener)P.addListener(ye);else throw Error("addEventListener and attachEvent are unavailable.");return ne}function Ns(){function P(ne){return Z.call(P.src,P.listener,ne)}const Z=Va;return P}function Dr(P,Z,ne,ye,at){if(Array.isArray(Z))for(var ht=0;ht<Z.length;ht++)Dr(P,Z[ht],ne,ye,at);else ye=c(ye)?!!ye.capture:!!ye,ne=Sa(ne),P&&P[ni]?(P=P.i,ht=String(Z).toString(),ht in P.g&&(Z=P.g[ht],ne=Wt(Z,ne,ye,at),ne>-1&&(bt(Z[ne]),Array.prototype.splice.call(Z,ne,1),Z.length==0&&(delete P.g[ht],P.h--)))):P&&(P=Ta(P))&&(Z=P.g[Z.toString()],P=-1,Z&&(P=Wt(Z,ne,ye,at)),(ne=P>-1?Z[P]:null)&&Fi(ne))}function Fi(P){if(typeof P!="number"&&P&&!P.da){var Z=P.src;if(Z&&Z[ni])Jt(Z.i,P);else{var ne=P.type,ye=P.proxy;Z.removeEventListener?Z.removeEventListener(ne,ye,P.capture):Z.detachEvent?Z.detachEvent(Pi(ne),ye):Z.addListener&&Z.removeListener&&Z.removeListener(ye),(ne=Ta(Z))?(Jt(ne,P),ne.h==0&&(ne.src=null,Z[Fn]=null)):bt(P)}}}function Pi(P){return P in oi?oi[P]:oi[P]="on"+P}function Va(P,Z){if(P.da)P=!0;else{Z=new Mn(Z,this);const ne=P.listener,ye=P.ha||P.src;P.fa&&Fi(P),P=ne.call(ye,Z)}return P}function Ta(P){return P=P[Fn],P instanceof Ut?P:null}var Bs="__closure_events_fn_"+(Math.random()*1e9>>>0);function Sa(P){return typeof P=="function"?P:(P[Bs]||(P[Bs]=function(Z){return P.handleEvent(Z)}),P[Bs])}function Vi(){Ae.call(this),this.i=new Ut(this),this.M=this,this.G=null}G(Vi,Ae),Vi.prototype[ni]=!0,Vi.prototype.removeEventListener=function(P,Z,ne,ye){Dr(this,P,Z,ne,ye)};function pr(P,Z){var ne,ye=P.G;if(ye)for(ne=[];ye;ye=ye.G)ne.push(ye);if(P=P.M,ye=Z.type||Z,typeof Z=="string")Z=new Re(Z,P);else if(Z instanceof Re)Z.target=Z.target||P;else{var at=Z;Z=new Re(ye,P),Ot(Z,at)}at=!0;let ht,Xt;if(ne)for(Xt=ne.length-1;Xt>=0;Xt--)ht=Z.g=ne[Xt],at=Ea(ht,ye,!0,Z)&&at;if(ht=Z.g=P,at=Ea(ht,ye,!0,Z)&&at,at=Ea(ht,ye,!1,Z)&&at,ne)for(Xt=0;Xt<ne.length;Xt++)ht=Z.g=ne[Xt],at=Ea(ht,ye,!1,Z)&&at}Vi.prototype.N=function(){if(Vi.Z.N.call(this),this.i){var P=this.i;for(const Z in P.g){const ne=P.g[Z];for(let ye=0;ye<ne.length;ye++)bt(ne[ye]);delete P.g[Z],P.h--}}this.G=null},Vi.prototype.J=function(P,Z,ne,ye){return this.i.add(String(P),Z,!1,ne,ye)},Vi.prototype.K=function(P,Z,ne,ye){return this.i.add(String(P),Z,!0,ne,ye)};function Ea(P,Z,ne,ye){if(Z=P.i.g[String(Z)],!Z)return!0;Z=Z.concat();let at=!0;for(let ht=0;ht<Z.length;++ht){const Xt=Z[ht];if(Xt&&!Xt.da&&Xt.capture==ne){const kn=Xt.listener,Xn=Xt.ha||Xt.src;Xt.fa&&Jt(P.i,Xt),at=kn.call(Xn,ye)!==!1&&at}}return at&&!ye.defaultPrevented}function wo(P,Z){if(typeof P!="function")if(P&&typeof P.handleEvent=="function")P=k(P.handleEvent,P);else throw Error("Invalid listener argument");return Number(Z)>2147483647?-1:_.setTimeout(P,Z||0)}function ao(P){P.g=wo(()=>{P.g=null,P.i&&(P.i=!1,ao(P))},P.l);const Z=P.h;P.h=null,P.m.apply(null,Z)}class qr extends Ae{constructor(Z,ne){super(),this.m=Z,this.l=ne,this.h=null,this.i=!1,this.g=null}j(Z){this.h=arguments,this.g?this.i=!0:ao(this)}N(){super.N(),this.g&&(_.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function fs(P){Ae.call(this),this.h=P,this.g={}}G(fs,Ae);var ps=[];function Fs(P){Zt(P.g,function(Z,ne){this.g.hasOwnProperty(ne)&&Fi(Z)},P),P.g={}}fs.prototype.N=function(){fs.Z.N.call(this),Fs(this)},fs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ms=_.JSON.stringify,We=_.JSON.parse,se=class{stringify(P){return _.JSON.stringify(P,void 0)}parse(P){return _.JSON.parse(P,void 0)}};function le(){}function fe(){}var Se={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function De(){Re.call(this,"d")}G(De,Re);function $e(){Re.call(this,"c")}G($e,Re);var et={},Ze=null;function _t(){return Ze=Ze||new Vi}et.Ia="serverreachability";function Pt(P){Re.call(this,et.Ia,P)}G(Pt,Re);function wt(P){const Z=_t();pr(Z,new Pt(Z))}et.STAT_EVENT="statevent";function tn(P,Z){Re.call(this,et.STAT_EVENT,P),this.stat=Z}G(tn,Re);function qe(P){const Z=_t();pr(Z,new tn(Z,P))}et.Ja="timingevent";function vn(P,Z){Re.call(this,et.Ja,P),this.size=Z}G(vn,Re);function Rn(P,Z){if(typeof P!="function")throw Error("Fn must not be null and must be a function");return _.setTimeout(function(){P()},Z)}function nn(){this.g=!0}nn.prototype.ua=function(){this.g=!1};function Nn(P,Z,ne,ye,at,ht){P.info(function(){if(P.g)if(ht){var Xt="",kn=ht.split("&");for(let Ti=0;Ti<kn.length;Ti++){var Xn=kn[Ti].split("=");if(Xn.length>1){const Ki=Xn[0];Xn=Xn[1];const $a=Ki.split("_");Xt=$a.length>=2&&$a[1]=="type"?Xt+(Ki+"="+Xn+"&"):Xt+(Ki+"=redacted&")}}}else Xt=null;else Xt=ht;return"XMLHTTP REQ ("+ye+") [attempt "+at+"]: "+Z+`
`+ne+`
`+Xt})}function Ri(P,Z,ne,ye,at,ht,Xt){P.info(function(){return"XMLHTTP RESP ("+ye+") [ attempt "+at+"]: "+Z+`
`+ne+`
`+ht+" "+Xt})}function Gi(P,Z,ne,ye){P.info(function(){return"XMLHTTP TEXT ("+Z+"): "+Ir(P,ne)+(ye?" "+ye:"")})}function tr(P,Z){P.info(function(){return"TIMEOUT: "+Z})}nn.prototype.info=function(){};function Ir(P,Z){if(!P.g)return Z;if(!Z)return null;try{const ht=JSON.parse(Z);if(ht){for(P=0;P<ht.length;P++)if(Array.isArray(ht[P])){var ne=ht[P];if(!(ne.length<2)){var ye=ne[1];if(Array.isArray(ye)&&!(ye.length<1)){var at=ye[0];if(at!="noop"&&at!="stop"&&at!="close")for(let Xt=1;Xt<ye.length;Xt++)ye[Xt]=""}}}}return ms(ht)}catch{return Z}}var Vn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Kn={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},br;function Rt(){}G(Rt,le),Rt.prototype.g=function(){return new XMLHttpRequest},br=new Rt;function en(P){return encodeURIComponent(String(P))}function nr(P){var Z=1;P=P.split(":");const ne=[];for(;Z>0&&P.length;)ne.push(P.shift()),Z--;return P.length&&ne.push(P.join(":")),ne}function ta(P,Z,ne,ye){this.j=P,this.i=Z,this.l=ne,this.S=ye||1,this.V=new fs(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Aa}function Aa(){this.i=null,this.g="",this.h=!1}var kt={},yn={};function In(P,Z,ne){P.M=1,P.A=Ui(Zi(Z)),P.u=ne,P.R=!0,ir(P,null)}function ir(P,Z){P.F=Date.now(),Vs(P),P.B=Zi(P.A);var ne=P.B,ye=P.S;Array.isArray(ye)||(ye=[String(ye)]),qa(ne.i,"t",ye),P.C=0,ne=P.j.L,P.h=new Aa,P.g=kl(P.j,ne?Z:null,!P.u),P.P>0&&(P.O=new qr(k(P.Y,P,P.g),P.P)),Z=P.V,ne=P.g,ye=P.ba;var at="readystatechange";Array.isArray(at)||(at&&(ps[0]=at.toString()),at=ps);for(let ht=0;ht<at.length;ht++){const Xt=fi(ne,at[ht],ye||Z.handleEvent,!1,Z.h||Z);if(!Xt)break;Z.g[Xt.key]=Xt}Z=P.J?ke(P.J):{},P.u?(P.v||(P.v="POST"),Z["Content-Type"]="application/x-www-form-urlencoded",P.g.ea(P.B,P.v,P.u,Z)):(P.v="GET",P.g.ea(P.B,P.v,null,Z)),wt(),Nn(P.i,P.v,P.B,P.l,P.S,P.u)}ta.prototype.ba=function(P){P=P.target;const Z=this.O;Z&&Yr(P)==3?Z.j():this.Y(P)},ta.prototype.Y=function(P){try{if(P==this.g)e:{const kn=Yr(this.g),Xn=this.g.ya(),Ti=this.g.ca();if(!(kn<3)&&(kn!=3||this.g&&(this.h.h||this.g.la()||or(this.g)))){this.K||kn!=4||Xn==7||(Xn==8||Ti<=0?wt(3):wt(2)),gs(this);var Z=this.g.ca();this.X=Z;var ne=tl(this);if(this.o=Z==200,Ri(this.i,this.v,this.B,this.l,this.S,kn,Z),this.o){if(this.U&&!this.L){t:{if(this.g){var ye,at=this.g;if((ye=at.g?at.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Pe(ye)){var ht=ye;break t}}ht=null}if(P=ht)Gi(this.i,this.l,P,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ei(this,P);else{this.o=!1,this.m=3,qe(12),Gr(this),$r(this);break e}}if(this.R){P=!0;let Ki;for(;!this.K&&this.C<ne.length;)if(Ki=Bn(this,ne),Ki==yn){kn==4&&(this.m=4,qe(14),P=!1),Gi(this.i,this.l,null,"[Incomplete Response]");break}else if(Ki==kt){this.m=4,qe(15),Gi(this.i,this.l,ne,"[Invalid Chunk]"),P=!1;break}else Gi(this.i,this.l,Ki,null),Ei(this,Ki);if(To(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),kn!=4||ne.length!=0||this.h.h||(this.m=1,qe(16),P=!1),this.o=this.o&&P,!P)Gi(this.i,this.l,ne,"[Invalid Chunked Response]"),Gr(this),$r(this);else if(ne.length>0&&!this.W){this.W=!0;var Xt=this.j;Xt.g==this&&Xt.aa&&!Xt.P&&(Xt.j.info("Great, no buffering proxy detected. Bytes received: "+ne.length),Vu(Xt),Xt.P=!0,qe(11))}}else Gi(this.i,this.l,ne,null),Ei(this,ne);kn==4&&Gr(this),this.o&&!this.K&&(kn==4?Hs(this.j,this):(this.o=!1,Vs(this)))}else vs(this.g),Z==400&&ne.indexOf("Unknown SID")>0?(this.m=3,qe(12)):(this.m=0,qe(13)),Gr(this),$r(this)}}}catch{}finally{}};function tl(P){if(!To(P))return P.g.la();const Z=or(P.g);if(Z==="")return"";let ne="";const ye=Z.length,at=Yr(P.g)==4;if(!P.h.i){if(typeof TextDecoder>"u")return Gr(P),$r(P),"";P.h.i=new _.TextDecoder}for(let ht=0;ht<ye;ht++)P.h.h=!0,ne+=P.h.i.decode(Z[ht],{stream:!(at&&ht==ye-1)});return Z.length=0,P.h.g+=ne,P.C=0,P.h.g}function To(P){return P.g?P.v=="GET"&&P.M!=2&&P.j.Aa:!1}function Bn(P,Z){var ne=P.C,ye=Z.indexOf(`
`,ne);return ye==-1?yn:(ne=Number(Z.substring(ne,ye)),isNaN(ne)?kt:(ye+=1,ye+ne>Z.length?yn:(Z=Z.slice(ye,ye+ne),P.C=ye+ne,Z)))}ta.prototype.cancel=function(){this.K=!0,Gr(this)};function Vs(P){P.T=Date.now()+P.H,Us(P,P.H)}function Us(P,Z){if(P.D!=null)throw Error("WatchDog timer not null");P.D=Rn(k(P.aa,P),Z)}function gs(P){P.D&&(_.clearTimeout(P.D),P.D=null)}ta.prototype.aa=function(){this.D=null;const P=Date.now();P-this.T>=0?(tr(this.i,this.B),this.M!=2&&(wt(),qe(17)),Gr(this),this.m=2,$r(this)):Us(this,this.T-P)};function $r(P){P.j.I==0||P.K||Hs(P.j,P)}function Gr(P){gs(P);var Z=P.O;Z&&typeof Z.dispose=="function"&&Z.dispose(),P.O=null,Fs(P.V),P.g&&(Z=P.g,P.g=null,Z.abort(),Z.dispose())}function Ei(P,Z){try{var ne=P.j;if(ne.I!=0&&(ne.g==P||Ua(ne.h,P))){if(!P.L&&Ua(ne.h,P)&&ne.I==3){try{var ye=ne.Ba.g.parse(Z)}catch{ye=null}if(Array.isArray(ye)&&ye.length==3){var at=ye;if(at[0]==0){e:if(!ne.v){if(ne.g)if(ne.g.F+3e3<P.F)Gl(ne),Co(ne);else break e;Xi(ne),qe(18)}}else ne.xa=at[1],0<ne.xa-ne.K&&at[2]<37500&&ne.F&&ne.A==0&&!ne.C&&(ne.C=Rn(k(ne.Va,ne),6e3));So(ne.h)<=1&&ne.ta&&(ne.ta=void 0)}else lr(ne,11)}else if((P.L||ne.g==P)&&Gl(ne),!Pe(Z))for(at=ne.Ba.g.parse(Z),Z=0;Z<at.length;Z++){let Ti=at[Z];const Ki=Ti[0];if(!(Ki<=ne.K))if(ne.K=Ki,Ti=Ti[1],ne.I==2)if(Ti[0]=="c"){ne.M=Ti[1],ne.ba=Ti[2];const $a=Ti[3];$a!=null&&(ne.ka=$a,ne.j.info("VER="+ne.ka));const Ga=Ti[4];Ga!=null&&(ne.za=Ga,ne.j.info("SVER="+ne.za));const Ws=Ti[5];Ws!=null&&typeof Ws=="number"&&Ws>0&&(ye=1.5*Ws,ne.O=ye,ne.j.info("backChannelRequestTimeoutMs_="+ye)),ye=ne;const Ts=P.g;if(Ts){const hu=Ts.g?Ts.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(hu){var ht=ye.h;ht.g||hu.indexOf("spdy")==-1&&hu.indexOf("quic")==-1&&hu.indexOf("h2")==-1||(ht.j=ht.l,ht.g=new Set,ht.h&&(Eo(ht,ht.h),ht.h=null))}if(ye.G){const Xs=Ts.g?Ts.g.getResponseHeader("X-HTTP-Session-Id"):null;Xs&&(ye.wa=Xs,on(ye.J,ye.G,Xs))}}ne.I=3,ne.l&&ne.l.ra(),ne.aa&&(ne.T=Date.now()-P.F,ne.j.info("Handshake RTT: "+ne.T+"ms")),ye=ne;var Xt=P;if(ye.na=ws(ye,ye.L?ye.ba:null,ye.W),Xt.L){js(ye.h,Xt);var kn=Xt,Xn=ye.O;Xn&&(kn.H=Xn),kn.D&&(gs(kn),Vs(kn)),ye.g=Xt}else Io(ye);ne.i.length>0&&Ma(ne)}else Ti[0]!="stop"&&Ti[0]!="close"||lr(ne,7);else ne.I==3&&(Ti[0]=="stop"||Ti[0]=="close"?Ti[0]=="stop"?lr(ne,7):Wn(ne):Ti[0]!="noop"&&ne.l&&ne.l.qa(Ti),ne.A=0)}}wt(4)}catch{}}var Mr=class{constructor(P,Z){this.g=P,this.map=Z}};function da(P){this.l=P||10,_.PerformanceNavigationTiming?(P=_.performance.getEntriesByType("navigation"),P=P.length>0&&(P[0].nextHopProtocol=="hq"||P[0].nextHopProtocol=="h2")):P=!!(_.chrome&&_.chrome.loadTimes&&_.chrome.loadTimes()&&_.chrome.loadTimes().wasFetchedViaSpdy),this.j=P?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function wi(P){return P.h?!0:P.g?P.g.size>=P.j:!1}function So(P){return P.h?1:P.g?P.g.size:0}function Ua(P,Z){return P.h?P.h==Z:P.g?P.g.has(Z):!1}function Eo(P,Z){P.g?P.g.add(Z):P.h=Z}function js(P,Z){P.h&&P.h==Z?P.h=null:P.g&&P.g.has(Z)&&P.g.delete(Z)}da.prototype.cancel=function(){if(this.i=qs(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const P of this.g.values())P.cancel();this.g.clear()}};function qs(P){if(P.h!=null)return P.i.concat(P.h.G);if(P.g!=null&&P.g.size!==0){let Z=P.i;for(const ne of P.g.values())Z=Z.concat(ne.G);return Z}return Y(P.i)}var nl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ii(P,Z){if(P){P=P.split("&");for(let ne=0;ne<P.length;ne++){const ye=P[ne].indexOf("=");let at,ht=null;ye>=0?(at=P[ne].substring(0,ye),ht=P[ne].substring(ye+1)):at=P[ne],Z(at,ht?decodeURIComponent(ht.replace(/\+/g," ")):"")}}}function hi(P){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let Z;P instanceof hi?(this.l=P.l,xr(this,P.j),this.o=P.o,this.g=P.g,$s(this,P.u),this.h=P.h,uu(this,Zs(P.i)),this.m=P.m):P&&(Z=String(P).match(nl))?(this.l=!1,xr(this,Z[1]||"",!0),this.o=Ca(Z[2]||""),this.g=Ca(Z[3]||"",!0),$s(this,Z[4]),this.h=Ca(Z[5]||"",!0),uu(this,Z[6]||"",!0),this.m=Ca(Z[7]||"")):(this.l=!1,this.i=new ja(null,this.l))}hi.prototype.toString=function(){const P=[];var Z=this.j;Z&&P.push(so(Z,Ao,!0),":");var ne=this.g;return(ne||Z=="file")&&(P.push("//"),(Z=this.o)&&P.push(so(Z,Ao,!0),"@"),P.push(en(ne).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),ne=this.u,ne!=null&&P.push(":",String(ne))),(ne=this.h)&&(this.g&&ne.charAt(0)!="/"&&P.push("/"),P.push(so(ne,ne.charAt(0)=="/"?Gs:Pl,!0))),(ne=this.i.toString())&&P.push("?",ne),(ne=this.m)&&P.push("#",so(ne,Qa)),P.join("")},hi.prototype.resolve=function(P){const Z=Zi(this);let ne=!!P.j;ne?xr(Z,P.j):ne=!!P.o,ne?Z.o=P.o:ne=!!P.g,ne?Z.g=P.g:ne=P.u!=null;var ye=P.h;if(ne)$s(Z,P.u);else if(ne=!!P.h){if(ye.charAt(0)!="/")if(this.g&&!this.h)ye="/"+ye;else{var at=Z.h.lastIndexOf("/");at!=-1&&(ye=Z.h.slice(0,at+1)+ye)}if(at=ye,at==".."||at==".")ye="";else if(at.indexOf("./")!=-1||at.indexOf("/.")!=-1){ye=at.lastIndexOf("/",0)==0,at=at.split("/");const ht=[];for(let Xt=0;Xt<at.length;){const kn=at[Xt++];kn=="."?ye&&Xt==at.length&&ht.push(""):kn==".."?((ht.length>1||ht.length==1&&ht[0]!="")&&ht.pop(),ye&&Xt==at.length&&ht.push("")):(ht.push(kn),ye=!0)}ye=ht.join("/")}else ye=at}return ne?Z.h=ye:ne=P.i.toString()!=="",ne?uu(Z,Zs(P.i)):ne=!!P.m,ne&&(Z.m=P.m),Z};function Zi(P){return new hi(P)}function xr(P,Z,ne){P.j=ne?Ca(Z,!0):Z,P.j&&(P.j=P.j.replace(/:$/,""))}function $s(P,Z){if(Z){if(Z=Number(Z),isNaN(Z)||Z<0)throw Error("Bad port number "+Z);P.u=Z}else P.u=null}function uu(P,Z,ne){Z instanceof ja?(P.i=Z,ys(P.i,P.l)):(ne||(Z=so(Z,ar)),P.i=new ja(Z,P.l))}function on(P,Z,ne){P.i.set(Z,ne)}function Ui(P){return on(P,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),P}function Ca(P,Z){return P?Z?decodeURI(P.replace(/%25/g,"%2525")):decodeURIComponent(P):""}function so(P,Z,ne){return typeof P=="string"?(P=encodeURI(P).replace(Z,rr),ne&&(P=P.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),P):null}function rr(P){return P=P.charCodeAt(0),"%"+(P>>4&15).toString(16)+(P&15).toString(16)}var Ao=/[#\/\?@]/g,Pl=/[#\?:]/g,Gs=/[#\?]/g,ar=/[#\?@]/g,Qa=/#/g;function ja(P,Z){this.h=this.g=null,this.i=P||null,this.j=!!Z}function Hi(P){P.g||(P.g=new Map,P.h=0,P.i&&ii(P.i,function(Z,ne){P.add(decodeURIComponent(Z.replace(/\+/g," ")),ne)}))}i=ja.prototype,i.add=function(P,Z){Hi(this),this.i=null,P=Ln(this,P);let ne=this.g.get(P);return ne||this.g.set(P,ne=[]),ne.push(Z),this.h+=1,this};function Un(P,Z){Hi(P),Z=Ln(P,Z),P.g.has(Z)&&(P.i=null,P.h-=P.g.get(Z).length,P.g.delete(Z))}function Ja(P,Z){return Hi(P),Z=Ln(P,Z),P.g.has(Z)}i.forEach=function(P,Z){Hi(this),this.g.forEach(function(ne,ye){ne.forEach(function(at){P.call(Z,at,ye,this)},this)},this)};function _s(P,Z){Hi(P);let ne=[];if(typeof Z=="string")Ja(P,Z)&&(ne=ne.concat(P.g.get(Ln(P,Z))));else for(P=Array.from(P.g.values()),Z=0;Z<P.length;Z++)ne=ne.concat(P[Z]);return ne}i.set=function(P,Z){return Hi(this),this.i=null,P=Ln(this,P),Ja(this,P)&&(this.h-=this.g.get(P).length),this.g.set(P,[Z]),this.h+=1,this},i.get=function(P,Z){return P?(P=_s(this,P),P.length>0?String(P[0]):Z):Z};function qa(P,Z,ne){Un(P,Z),ne.length>0&&(P.i=null,P.g.set(Ln(P,Z),Y(ne)),P.h+=ne.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const P=[],Z=Array.from(this.g.keys());for(let ye=0;ye<Z.length;ye++){var ne=Z[ye];const at=en(ne);ne=_s(this,ne);for(let ht=0;ht<ne.length;ht++){let Xt=at;ne[ht]!==""&&(Xt+="="+en(ne[ht])),P.push(Xt)}}return this.i=P.join("&")};function Zs(P){const Z=new ja;return Z.i=P.i,P.g&&(Z.g=new Map(P.g),Z.h=P.h),Z}function Ln(P,Z){return Z=String(Z),P.j&&(Z=Z.toLowerCase()),Z}function ys(P,Z){Z&&!P.j&&(Hi(P),P.i=null,P.g.forEach(function(ne,ye){const at=ye.toLowerCase();ye!=at&&(Un(this,ye),qa(this,at,ne))},P)),P.j=Z}function Ia(P,Z){const ne=new nn;if(_.Image){const ye=new Image;ye.onload=V(Wi,ne,"TestLoadImage: loaded",!0,Z,ye),ye.onerror=V(Wi,ne,"TestLoadImage: error",!1,Z,ye),ye.onabort=V(Wi,ne,"TestLoadImage: abort",!1,Z,ye),ye.ontimeout=V(Wi,ne,"TestLoadImage: timeout",!1,Z,ye),_.setTimeout(function(){ye.ontimeout&&ye.ontimeout()},1e4),ye.src=P}else Z(!1)}function Rl(P,Z){const ne=new nn,ye=new AbortController,at=setTimeout(()=>{ye.abort(),Wi(ne,"TestPingServer: timeout",!1,Z)},1e4);fetch(P,{signal:ye.signal}).then(ht=>{clearTimeout(at),ht.ok?Wi(ne,"TestPingServer: ok",!0,Z):Wi(ne,"TestPingServer: server error",!1,Z)}).catch(()=>{clearTimeout(at),Wi(ne,"TestPingServer: error",!1,Z)})}function Wi(P,Z,ne,ye,at){try{at&&(at.onload=null,at.onerror=null,at.onabort=null,at.ontimeout=null),ye(ne)}catch{}}function mr(){this.g=new se}function hn(P){this.i=P.Sb||null,this.h=P.ab||!1}G(hn,le),hn.prototype.g=function(){return new pi(this.i,this.h)};function pi(P,Z){Vi.call(this),this.H=P,this.o=Z,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}G(pi,Vi),i=pi.prototype,i.open=function(P,Z){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=P,this.D=Z,this.readyState=1,sr(this)},i.send=function(P){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const Z={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};P&&(Z.body=P),(this.H||_).fetch(new Request(this.D,Z)).then(this.Pa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,il(this)),this.readyState=0},i.Pa=function(P){if(this.g&&(this.l=P,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=P.headers,this.readyState=2,sr(this)),this.g&&(this.readyState=3,sr(this),this.g)))if(this.responseType==="arraybuffer")P.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof _.ReadableStream<"u"&&"body"in P){if(this.j=P.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;xn(this)}else P.text().then(this.Oa.bind(this),this.ga.bind(this))};function xn(P){P.j.read().then(P.Ma.bind(P)).catch(P.ga.bind(P))}i.Ma=function(P){if(this.g){if(this.o&&P.value)this.response.push(P.value);else if(!this.o){var Z=P.value?P.value:new Uint8Array(0);(Z=this.B.decode(Z,{stream:!P.done}))&&(this.response=this.responseText+=Z)}P.done?il(this):sr(this),this.readyState==3&&xn(this)}},i.Oa=function(P){this.g&&(this.response=this.responseText=P,il(this))},i.Na=function(P){this.g&&(this.response=P,il(this))},i.ga=function(){this.g&&il(this)};function il(P){P.readyState=4,P.l=null,P.j=null,P.B=null,sr(P)}i.setRequestHeader=function(P,Z){this.A.append(P,Z)},i.getResponseHeader=function(P){return this.h&&this.h.get(P.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const P=[],Z=this.h.entries();for(var ne=Z.next();!ne.done;)ne=ne.value,P.push(ne[0]+": "+ne[1]),ne=Z.next();return P.join(`\r
`)};function sr(P){P.onreadystatechange&&P.onreadystatechange.call(P)}Object.defineProperty(pi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(P){this.m=P?"include":"same-origin"}});function cr(P){let Z="";return Zt(P,function(ne,ye){Z+=ye,Z+=":",Z+=ne,Z+=`\r
`}),Z}function wr(P,Z,ne){e:{for(ye in ne){var ye=!1;break e}ye=!0}ye||(ne=cr(ne),typeof P=="string"?ne!=null&&en(ne):on(P,Z,ne))}function bn(P){Vi.call(this),this.headers=new Map,this.L=P||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}G(bn,Vi);var fa=/^https?$/i,fn=["POST","PUT"];i=bn.prototype,i.Fa=function(P){this.H=P},i.ea=function(P,Z,ne,ye){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+P);Z=Z?Z.toUpperCase():"GET",this.D=P,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():br.g(),this.g.onreadystatechange=ee(k(this.Ca,this));try{this.B=!0,this.g.open(Z,String(P),!0),this.B=!1}catch(ht){sn(this,ht);return}if(P=ne||"",ne=new Map(this.headers),ye)if(Object.getPrototypeOf(ye)===Object.prototype)for(var at in ye)ne.set(at,ye[at]);else if(typeof ye.keys=="function"&&typeof ye.get=="function")for(const ht of ye.keys())ne.set(ht,ye.get(ht));else throw Error("Unknown input type for opt_headers: "+String(ye));ye=Array.from(ne.keys()).find(ht=>ht.toLowerCase()=="content-type"),at=_.FormData&&P instanceof _.FormData,!(Array.prototype.indexOf.call(fn,Z,void 0)>=0)||ye||at||ne.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ht,Xt]of ne)this.g.setRequestHeader(ht,Xt);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(P),this.v=!1}catch(ht){sn(this,ht)}};function sn(P,Z){P.h=!1,P.g&&(P.j=!0,P.g.abort(),P.j=!1),P.l=Z,P.o=5,na(P),zr(P)}function na(P){P.A||(P.A=!0,pr(P,"complete"),pr(P,"error"))}i.abort=function(P){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=P||7,pr(this,"complete"),pr(this,"abort"),zr(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),zr(this,!0)),bn.Z.N.call(this)},i.Ca=function(){this.u||(this.B||this.v||this.j?qn(this):this.Xa())},i.Xa=function(){qn(this)};function qn(P){if(P.h&&typeof m<"u"){if(P.v&&Yr(P)==4)setTimeout(P.Ca.bind(P),0);else if(pr(P,"readystatechange"),Yr(P)==4){P.h=!1;try{const ht=P.ca();e:switch(ht){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var Z=!0;break e;default:Z=!1}var ne;if(!(ne=Z)){var ye;if(ye=ht===0){let Xt=String(P.D).match(nl)[1]||null;!Xt&&_.self&&_.self.location&&(Xt=_.self.location.protocol.slice(0,-1)),ye=!fa.test(Xt?Xt.toLowerCase():"")}ne=ye}if(ne)pr(P,"complete"),pr(P,"success");else{P.o=6;try{var at=Yr(P)>2?P.g.statusText:""}catch{at=""}P.l=at+" ["+P.ca()+"]",na(P)}}finally{zr(P)}}}}function zr(P,Z){if(P.g){P.m&&(clearTimeout(P.m),P.m=null);const ne=P.g;P.g=null,Z||pr(P,"ready");try{ne.onreadystatechange=null}catch{}}}i.isActive=function(){return!!this.g};function Yr(P){return P.g?P.g.readyState:0}i.ca=function(){try{return Yr(this)>2?this.g.status:-1}catch{return-1}},i.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.La=function(P){if(this.g){var Z=this.g.responseText;return P&&Z.indexOf(P)==0&&(Z=Z.substring(P.length)),We(Z)}};function or(P){try{if(!P.g)return null;if("response"in P.g)return P.g.response;switch(P.F){case"":case"text":return P.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in P.g)return P.g.mozResponseArrayBuffer}return null}catch{return null}}function vs(P){const Z={};P=(P.g&&Yr(P)>=2&&P.g.getAllResponseHeaders()||"").split(`\r
`);for(let ye=0;ye<P.length;ye++){if(Pe(P[ye]))continue;var ne=nr(P[ye]);const at=ne[0];if(ne=ne[1],typeof ne!="string")continue;ne=ne.trim();const ht=Z[at]||[];Z[at]=ht,ht.push(ne)}Vt(Z,function(ye){return ye.join(", ")})}i.ya=function(){return this.o},i.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function oo(P,Z,ne){return ne&&ne.internalChannelParams&&ne.internalChannelParams[P]||Z}function bs(P){this.za=0,this.i=[],this.j=new nn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=oo("failFast",!1,P),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=oo("baseRetryDelayMs",5e3,P),this.Za=oo("retryDelaySeedMs",1e4,P),this.Ta=oo("forwardChannelMaxRetries",2,P),this.va=oo("forwardChannelRequestTimeoutMs",2e4,P),this.ma=P&&P.xmlHttpFactory||void 0,this.Ua=P&&P.Rb||void 0,this.Aa=P&&P.useFetchStreams||!1,this.O=void 0,this.L=P&&P.supportsCrossDomainXhr||!1,this.M="",this.h=new da(P&&P.concurrentRequestLimit),this.Ba=new mr,this.S=P&&P.fastHandshake||!1,this.R=P&&P.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=P&&P.Pb||!1,P&&P.ua&&this.j.ua(),P&&P.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&P&&P.detectBufferingProxy||!1,this.ia=void 0,P&&P.longPollingTimeout&&P.longPollingTimeout>0&&(this.ia=P.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}i=bs.prototype,i.ka=8,i.I=1,i.connect=function(P,Z,ne,ye){qe(0),this.W=P,this.H=Z||{},ne&&ye!==void 0&&(this.H.OSID=ne,this.H.OAID=ye),this.F=this.X,this.J=ws(this,null,this.W),Ma(this)};function Wn(P){if(ia(P),P.I==3){var Z=P.V++,ne=Zi(P.J);if(on(ne,"SID",P.M),on(ne,"RID",Z),on(ne,"TYPE","terminate"),xs(P,ne),Z=new ta(P,P.j,Z),Z.M=2,Z.A=Ui(Zi(ne)),ne=!1,_.navigator&&_.navigator.sendBeacon)try{ne=_.navigator.sendBeacon(Z.A.toString(),"")}catch{}!ne&&_.Image&&(new Image().src=Z.A,ne=!0),ne||(Z.g=kl(Z.j,null),Z.g.ea(Z.A)),Z.F=Date.now(),Vs(Z)}es(P)}function Co(P){P.g&&(Vu(P),P.g.cancel(),P.g=null)}function ia(P){Co(P),P.v&&(_.clearTimeout(P.v),P.v=null),Gl(P),P.h.cancel(),P.m&&(typeof P.m=="number"&&_.clearTimeout(P.m),P.m=null)}function Ma(P){if(!wi(P.h)&&!P.m){P.m=!0;var Z=P.Ea;Ge||ce(),Fe||(Ge(),Fe=!0),de.add(Z,P),P.D=0}}function Pa(P,Z){return So(P.h)>=P.h.j-(P.m?1:0)?!1:P.m?(P.i=Z.G.concat(P.i),!0):P.I==1||P.I==2||P.D>=(P.Sa?0:P.Ta)?!1:(P.m=Rn(k(P.Ea,P,Z),Ll(P,P.D)),P.D++,!0)}i.Ea=function(P){if(this.m)if(this.m=null,this.I==1){if(!P){this.V=Math.floor(Math.random()*1e5),P=this.V++;const at=new ta(this,this.j,P);let ht=this.o;if(this.U&&(ht?(ht=ke(ht),Ot(ht,this.U)):ht=this.U),this.u!==null||this.R||(at.J=ht,ht=null),this.S)e:{for(var Z=0,ne=0;ne<this.i.length;ne++){t:{var ye=this.i[ne];if("__data__"in ye.map&&(ye=ye.map.__data__,typeof ye=="string")){ye=ye.length;break t}ye=void 0}if(ye===void 0)break;if(Z+=ye,Z>4096){Z=ne;break e}if(Z===4096||ne===this.i.length-1){Z=ne+1;break e}}Z=1e3}else Z=1e3;Z=$l(this,at,Z),ne=Zi(this.J),on(ne,"RID",P),on(ne,"CVER",22),this.G&&on(ne,"X-HTTP-Session-Id",this.G),xs(this,ne),ht&&(this.R?Z="headers="+en(cr(ht))+"&"+Z:this.u&&wr(ne,this.u,ht)),Eo(this.h,at),this.Ra&&on(ne,"TYPE","init"),this.S?(on(ne,"$req",Z),on(ne,"SID","null"),at.U=!0,In(at,ne,null)):In(at,ne,Z),this.I=2}}else this.I==3&&(P?Or(this,P):this.i.length==0||wi(this.h)||Or(this))};function Or(P,Z){var ne;Z?ne=Z.l:ne=P.V++;const ye=Zi(P.J);on(ye,"SID",P.M),on(ye,"RID",ne),on(ye,"AID",P.K),xs(P,ye),P.u&&P.o&&wr(ye,P.u,P.o),ne=new ta(P,P.j,ne,P.D+1),P.u===null&&(ne.J=P.o),Z&&(P.i=Z.G.concat(P.i)),Z=$l(P,ne,1e3),ne.H=Math.round(P.va*.5)+Math.round(P.va*.5*Math.random()),Eo(P.h,ne),In(ne,ye,Z)}function xs(P,Z){P.H&&Zt(P.H,function(ne,ye){on(Z,ye,ne)}),P.l&&Zt({},function(ne,ye){on(Z,ye,ne)})}function $l(P,Z,ne){ne=Math.min(P.i.length,ne);const ye=P.l?k(P.l.Ka,P.l,P):null;e:{var at=P.i;let kn=-1;for(;;){const Xn=["count="+ne];kn==-1?ne>0?(kn=at[0].g,Xn.push("ofs="+kn)):kn=0:Xn.push("ofs="+kn);let Ti=!0;for(let Ki=0;Ki<ne;Ki++){var ht=at[Ki].g;const $a=at[Ki].map;if(ht-=kn,ht<0)kn=Math.max(0,at[Ki].g-100),Ti=!1;else try{ht="req"+ht+"_"||"";try{var Xt=$a instanceof Map?$a:Object.entries($a);for(const[Ga,Ws]of Xt){let Ts=Ws;c(Ws)&&(Ts=ms(Ws)),Xn.push(ht+Ga+"="+encodeURIComponent(Ts))}}catch(Ga){throw Xn.push(ht+"type="+encodeURIComponent("_badmap")),Ga}}catch{ye&&ye($a)}}if(Ti){Xt=Xn.join("&");break e}}Xt=void 0}return P=P.i.splice(0,ne),Z.G=P,Xt}function Io(P){if(!P.g&&!P.v){P.Y=1;var Z=P.Da;Ge||ce(),Fe||(Ge(),Fe=!0),de.add(Z,P),P.A=0}}function Xi(P){return P.g||P.v||P.A>=3?!1:(P.Y++,P.v=Rn(k(P.Da,P),Ll(P,P.A)),P.A++,!0)}i.Da=function(){if(this.v=null,rl(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var P=4*this.T;this.j.info("BP detection timer enabled: "+P),this.B=Rn(k(this.Wa,this),P)}},i.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,qe(10),Co(this),rl(this))};function Vu(P){P.B!=null&&(_.clearTimeout(P.B),P.B=null)}function rl(P){P.g=new ta(P,P.j,"rpc",P.Y),P.u===null&&(P.g.J=P.o),P.g.P=0;var Z=Zi(P.na);on(Z,"RID","rpc"),on(Z,"SID",P.M),on(Z,"AID",P.K),on(Z,"CI",P.F?"0":"1"),!P.F&&P.ia&&on(Z,"TO",P.ia),on(Z,"TYPE","xmlhttp"),xs(P,Z),P.u&&P.o&&wr(Z,P.u,P.o),P.O&&(P.g.H=P.O);var ne=P.g;P=P.ba,ne.M=1,ne.A=Ui(Zi(Z)),ne.u=null,ne.R=!0,ir(ne,P)}i.Va=function(){this.C!=null&&(this.C=null,Co(this),Xi(this),qe(19))};function Gl(P){P.C!=null&&(_.clearTimeout(P.C),P.C=null)}function Hs(P,Z){var ne=null;if(P.g==Z){Gl(P),Vu(P),P.g=null;var ye=2}else if(Ua(P.h,Z))ne=Z.G,js(P.h,Z),ye=1;else return;if(P.I!=0){if(Z.o)if(ye==1){ne=Z.u?Z.u.length:0,Z=Date.now()-Z.F;var at=P.D;ye=_t(),pr(ye,new vn(ye,ne)),Ma(P)}else Io(P);else if(at=Z.m,at==3||at==0&&Z.X>0||!(ye==1&&Pa(P,Z)||ye==2&&Xi(P)))switch(ne&&ne.length>0&&(Z=P.h,Z.i=Z.i.concat(ne)),at){case 1:lr(P,5);break;case 4:lr(P,10);break;case 3:lr(P,6);break;default:lr(P,2)}}}function Ll(P,Z){let ne=P.Qa+Math.floor(Math.random()*P.Za);return P.isActive()||(ne*=2),ne*Z}function lr(P,Z){if(P.j.info("Error code "+Z),Z==2){var ne=k(P.bb,P),ye=P.Ua;const at=!ye;ye=new hi(ye||"//www.google.com/images/cleardot.gif"),_.location&&_.location.protocol=="http"||xr(ye,"https"),Ui(ye),at?Ia(ye.toString(),ne):Rl(ye.toString(),ne)}else qe(2);P.I=0,P.l&&P.l.pa(Z),es(P),ia(P)}i.bb=function(P){P?(this.j.info("Successfully pinged google.com"),qe(2)):(this.j.info("Failed to ping google.com"),qe(1))};function es(P){if(P.I=0,P.ja=[],P.l){const Z=qs(P.h);(Z.length!=0||P.i.length!=0)&&(xe(P.ja,Z),xe(P.ja,P.i),P.h.i.length=0,Y(P.i),P.i.length=0),P.l.oa()}}function ws(P,Z,ne){var ye=ne instanceof hi?Zi(ne):new hi(ne);if(ye.g!="")Z&&(ye.g=Z+"."+ye.g),$s(ye,ye.u);else{var at=_.location;ye=at.protocol,Z=Z?Z+"."+at.hostname:at.hostname,at=+at.port;const ht=new hi(null);ye&&xr(ht,ye),Z&&(ht.g=Z),at&&$s(ht,at),ne&&(ht.h=ne),ye=ht}return ne=P.G,Z=P.wa,ne&&Z&&on(ye,ne,Z),on(ye,"VER",P.ka),xs(P,ye),ye}function kl(P,Z,ne){if(Z&&!P.L)throw Error("Can't create secondary domain capable XhrIo object.");return Z=P.Aa&&!P.ma?new bn(new hn({ab:ne})):new bn(P.ma),Z.Fa(P.L),Z}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function al(){}i=al.prototype,i.ra=function(){},i.qa=function(){},i.pa=function(){},i.oa=function(){},i.isActive=function(){return!0},i.Ka=function(){};function lo(){}lo.prototype.g=function(P,Z){return new Ai(P,Z)};function Ai(P,Z){Vi.call(this),this.g=new bs(Z),this.l=P,this.h=Z&&Z.messageUrlParams||null,P=Z&&Z.messageHeaders||null,Z&&Z.clientProtocolHeaderRequired&&(P?P["X-Client-Protocol"]="webchannel":P={"X-Client-Protocol":"webchannel"}),this.g.o=P,P=Z&&Z.initMessageHeaders||null,Z&&Z.messageContentType&&(P?P["X-WebChannel-Content-Type"]=Z.messageContentType:P={"X-WebChannel-Content-Type":Z.messageContentType}),Z&&Z.sa&&(P?P["X-WebChannel-Client-Profile"]=Z.sa:P={"X-WebChannel-Client-Profile":Z.sa}),this.g.U=P,(P=Z&&Z.Qb)&&!Pe(P)&&(this.g.u=P),this.A=Z&&Z.supportsCrossDomainXhr||!1,this.v=Z&&Z.sendRawJson||!1,(Z=Z&&Z.httpSessionIdParam)&&!Pe(Z)&&(this.g.G=Z,P=this.h,P!==null&&Z in P&&(P=this.h,Z in P&&delete P[Z])),this.j=new Dl(this)}G(Ai,Vi),Ai.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ai.prototype.close=function(){Wn(this.g)},Ai.prototype.o=function(P){var Z=this.g;if(typeof P=="string"){var ne={};ne.__data__=P,P=ne}else this.v&&(ne={},ne.__data__=ms(P),P=ne);Z.i.push(new Mr(Z.Ya++,P)),Z.I==3&&Ma(Z)},Ai.prototype.N=function(){this.g.l=null,delete this.j,Wn(this.g),delete this.g,Ai.Z.N.call(this)};function Uu(P){De.call(this),P.__headers__&&(this.headers=P.__headers__,this.statusCode=P.__status__,delete P.__headers__,delete P.__status__);var Z=P.__sm__;if(Z){e:{for(const ne in Z){P=ne;break e}P=void 0}(this.i=P)&&(P=this.i,Z=Z!==null&&P in Z?Z[P]:void 0),this.data=Z}else this.data=P}G(Uu,De);function cu(){$e.call(this),this.status=1}G(cu,$e);function Dl(P){this.g=P}G(Dl,al),Dl.prototype.ra=function(){pr(this.g,"a")},Dl.prototype.qa=function(P){pr(this.g,new Uu(P))},Dl.prototype.pa=function(P){pr(this.g,new cu)},Dl.prototype.oa=function(){pr(this.g,"b")},lo.prototype.createWebChannel=lo.prototype.g,Ai.prototype.send=Ai.prototype.o,Ai.prototype.open=Ai.prototype.m,Ai.prototype.close=Ai.prototype.close,iA=function(){return new lo},nA=function(){return _t()},tA=et,zx={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Vn.NO_ERROR=0,Vn.TIMEOUT=8,Vn.HTTP_ERROR=6,Wv=Vn,Kn.COMPLETE="complete",eA=Kn,fe.EventType=Se,Se.OPEN="a",Se.CLOSE="b",Se.ERROR="c",Se.MESSAGE="d",Vi.prototype.listen=Vi.prototype.J,O_=fe,bn.prototype.listenOnce=bn.prototype.K,bn.prototype.getLastError=bn.prototype.Ha,bn.prototype.getLastErrorCode=bn.prototype.ya,bn.prototype.getStatus=bn.prototype.ca,bn.prototype.getResponseJson=bn.prototype.La,bn.prototype.getResponseText=bn.prototype.la,bn.prototype.send=bn.prototype.ea,bn.prototype.setWithCredentials=bn.prototype.Fa,JE=bn}).apply(typeof Lv<"u"?Lv:typeof self<"u"?self:typeof window<"u"?window:{});const L2="@firebase/firestore",k2="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Cl.UNAUTHENTICATED=new Cl(null),Cl.GOOGLE_CREDENTIALS=new Cl("google-credentials-uid"),Cl.FIRST_PARTY=new Cl("first-party-uid"),Cl.MOCK_USER=new Cl("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wg="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $p=new H0("@firebase/firestore");function Zm(){return $p.logLevel}function gn(i,...e){if($p.logLevel<=Oi.DEBUG){const t=e.map(L1);$p.debug(`Firestore (${wg}): ${i}`,...t)}}function Ud(i,...e){if($p.logLevel<=Oi.ERROR){const t=e.map(L1);$p.error(`Firestore (${wg}): ${i}`,...t)}}function ug(i,...e){if($p.logLevel<=Oi.WARN){const t=e.map(L1);$p.warn(`Firestore (${wg}): ${i}`,...t)}}function L1(i){if(typeof i=="string")return i;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(i)}catch{return i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hn(i,e,t){let a="Unexpected state";typeof e=="string"?a=e:t=e,rA(i,a,t)}function rA(i,e,t){let a=`FIRESTORE (${wg}) INTERNAL ASSERTION FAILED: ${e} (ID: ${i.toString(16)})`;if(t!==void 0)try{a+=" CONTEXT: "+JSON.stringify(t)}catch{a+=" CONTEXT: "+t}throw Ud(a),new Error(a)}function Cr(i,e,t,a){let d="Unexpected state";typeof t=="string"?d=t:a=t,i||rA(e,d,a)}function si(i,e){return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class _n extends lh{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Df{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aA{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Sk{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Cl.UNAUTHENTICATED)))}shutdown(){}}class Ek{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Ak{constructor(e){this.t=e,this.currentUser=Cl.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Cr(this.o===void 0,42304);let a=this.i;const d=C=>this.i!==a?(a=this.i,t(C)):Promise.resolve();let m=new Df;this.o=()=>{this.i++,this.currentUser=this.u(),m.resolve(),m=new Df,e.enqueueRetryable((()=>d(this.currentUser)))};const _=()=>{const C=m;e.enqueueRetryable((async()=>{await C.promise,await d(this.currentUser)}))},c=C=>{gn("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=C,this.o&&(this.auth.addAuthTokenListener(this.o),_())};this.t.onInit((C=>c(C))),setTimeout((()=>{if(!this.auth){const C=this.t.getImmediate({optional:!0});C?c(C):(gn("FirebaseAuthCredentialsProvider","Auth not yet detected"),m.resolve(),m=new Df)}}),0),_()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((a=>this.i!==e?(gn("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):a?(Cr(typeof a.accessToken=="string",31837,{l:a}),new aA(a.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Cr(e===null||typeof e=="string",2055,{h:e}),new Cl(e)}}class Ck{constructor(e,t,a){this.P=e,this.T=t,this.I=a,this.type="FirstParty",this.user=Cl.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Ik{constructor(e,t,a){this.P=e,this.T=t,this.I=a}getToken(){return Promise.resolve(new Ck(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Cl.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class D2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Mk{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Nh(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Cr(this.o===void 0,3512);const a=m=>{m.error!=null&&gn("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${m.error.message}`);const _=m.token!==this.m;return this.m=m.token,gn("FirebaseAppCheckTokenProvider",`Received ${_?"new":"existing"} token.`),_?t(m.token):Promise.resolve()};this.o=m=>{e.enqueueRetryable((()=>a(m)))};const d=m=>{gn("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=m,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((m=>d(m))),setTimeout((()=>{if(!this.appCheck){const m=this.V.getImmediate({optional:!0});m?d(m):gn("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new D2(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Cr(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new D2(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pk(i){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(i);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let a=0;a<i;a++)t[a]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let a="";for(;a.length<20;){const d=Pk(40);for(let m=0;m<d.length;++m)a.length<20&&d[m]<t&&(a+=e.charAt(d[m]%62))}return a}}function Ni(i,e){return i<e?-1:i>e?1:0}function Ox(i,e){const t=Math.min(i.length,e.length);for(let a=0;a<t;a++){const d=i.charAt(a),m=e.charAt(a);if(d!==m)return tx(d)===tx(m)?Ni(d,m):tx(d)?1:-1}return Ni(i.length,e.length)}const Rk=55296,Lk=57343;function tx(i){const e=i.charCodeAt(0);return e>=Rk&&e<=Lk}function cg(i,e,t){return i.length===e.length&&i.every(((a,d)=>t(a,e[d])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z2="__name__";class Oh{constructor(e,t,a){t===void 0?t=0:t>e.length&&Hn(637,{offset:t,range:e.length}),a===void 0?a=e.length-t:a>e.length-t&&Hn(1746,{length:a,range:e.length-t}),this.segments=e,this.offset=t,this.len=a}get length(){return this.len}isEqual(e){return Oh.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Oh?e.forEach((a=>{t.push(a)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,a=this.limit();t<a;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const a=Math.min(e.length,t.length);for(let d=0;d<a;d++){const m=Oh.compareSegments(e.get(d),t.get(d));if(m!==0)return m}return Ni(e.length,t.length)}static compareSegments(e,t){const a=Oh.isNumericId(e),d=Oh.isNumericId(t);return a&&!d?-1:!a&&d?1:a&&d?Oh.extractNumericId(e).compare(Oh.extractNumericId(t)):Ox(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return kf.fromString(e.substring(4,e.length-2))}}class ea extends Oh{construct(e,t,a){return new ea(e,t,a)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const a of e){if(a.indexOf("//")>=0)throw new _n(Dt.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);t.push(...a.split("/").filter((d=>d.length>0)))}return new ea(t)}static emptyPath(){return new ea([])}}const kk=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Jo extends Oh{construct(e,t,a){return new Jo(e,t,a)}static isValidIdentifier(e){return kk.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Jo.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===z2}static keyField(){return new Jo([z2])}static fromServerFormat(e){const t=[];let a="",d=0;const m=()=>{if(a.length===0)throw new _n(Dt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(a),a=""};let _=!1;for(;d<e.length;){const c=e[d];if(c==="\\"){if(d+1===e.length)throw new _n(Dt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const C=e[d+1];if(C!=="\\"&&C!=="."&&C!=="`")throw new _n(Dt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);a+=C,d+=2}else c==="`"?(_=!_,d++):c!=="."||_?(a+=c,d++):(m(),d++)}if(m(),_)throw new _n(Dt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Jo(t)}static emptyPath(){return new Jo([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e){this.path=e}static fromPath(e){return new On(ea.fromString(e))}static fromName(e){return new On(ea.fromString(e).popFirst(5))}static empty(){return new On(ea.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ea.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ea.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new On(new ea(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sA(i,e,t){if(!t)throw new _n(Dt.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${e}.`)}function Dk(i,e,t,a){if(e===!0&&a===!0)throw new _n(Dt.INVALID_ARGUMENT,`${i} and ${t} cannot be used together.`)}function O2(i){if(!On.isDocumentKey(i))throw new _n(Dt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function N2(i){if(On.isDocumentKey(i))throw new _n(Dt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function oA(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}function W0(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const e=(function(a){return a.constructor?a.constructor.name:null})(i);return e?`a custom ${e} object`:"an object"}}return typeof i=="function"?"a function":Hn(12329,{type:typeof i})}function m0(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new _n(Dt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=W0(i);throw new _n(Dt.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return i}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zs(i,e){const t={typeString:i};return e&&(t.value=e),t}function Cy(i,e){if(!oA(i))throw new _n(Dt.INVALID_ARGUMENT,"JSON must be an object");let t;for(const a in e)if(e[a]){const d=e[a].typeString,m="value"in e[a]?{value:e[a].value}:void 0;if(!(a in i)){t=`JSON missing required field: '${a}'`;break}const _=i[a];if(d&&typeof _!==d){t=`JSON field '${a}' must be a ${d}.`;break}if(m!==void 0&&_!==m.value){t=`Expected '${a}' field to equal '${m.value}'`;break}}if(t)throw new _n(Dt.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B2=-62135596800,F2=1e6;class ha{static now(){return ha.fromMillis(Date.now())}static fromDate(e){return ha.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),a=Math.floor((e-1e3*t)*F2);return new ha(t,a)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new _n(Dt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new _n(Dt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<B2)throw new _n(Dt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new _n(Dt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/F2}_compareTo(e){return this.seconds===e.seconds?Ni(this.nanoseconds,e.nanoseconds):Ni(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ha._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Cy(e,ha._jsonSchema))return new ha(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-B2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ha._jsonSchemaVersion="firestore/timestamp/1.0",ha._jsonSchema={type:zs("string",ha._jsonSchemaVersion),seconds:zs("number"),nanoseconds:zs("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{static fromTimestamp(e){return new ti(e)}static min(){return new ti(new ha(0,0))}static max(){return new ti(new ha(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ry=-1;function zk(i,e){const t=i.toTimestamp().seconds,a=i.toTimestamp().nanoseconds+1,d=ti.fromTimestamp(a===1e9?new ha(t+1,0):new ha(t,a));return new Bf(d,On.empty(),e)}function Ok(i){return new Bf(i.readTime,i.key,ry)}class Bf{constructor(e,t,a){this.readTime=e,this.documentKey=t,this.largestBatchId=a}static min(){return new Bf(ti.min(),On.empty(),ry)}static max(){return new Bf(ti.max(),On.empty(),ry)}}function Nk(i,e){let t=i.readTime.compareTo(e.readTime);return t!==0?t:(t=On.comparator(i.documentKey,e.documentKey),t!==0?t:Ni(i.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Fk{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tg(i){if(i.code!==Dt.FAILED_PRECONDITION||i.message!==Bk)throw i;gn("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Hn(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new zt(((a,d)=>{this.nextCallback=m=>{this.wrapSuccess(e,m).next(a,d)},this.catchCallback=m=>{this.wrapFailure(t,m).next(a,d)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof zt?t:zt.resolve(t)}catch(t){return zt.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):zt.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):zt.reject(t)}static resolve(e){return new zt(((t,a)=>{t(e)}))}static reject(e){return new zt(((t,a)=>{a(e)}))}static waitFor(e){return new zt(((t,a)=>{let d=0,m=0,_=!1;e.forEach((c=>{++d,c.next((()=>{++m,_&&m===d&&t()}),(C=>a(C)))})),_=!0,m===d&&t()}))}static or(e){let t=zt.resolve(!1);for(const a of e)t=t.next((d=>d?zt.resolve(d):a()));return t}static forEach(e,t){const a=[];return e.forEach(((d,m)=>{a.push(t.call(this,d,m))})),this.waitFor(a)}static mapArray(e,t){return new zt(((a,d)=>{const m=e.length,_=new Array(m);let c=0;for(let C=0;C<m;C++){const k=C;t(e[k]).next((V=>{_[k]=V,++c,c===m&&a(_)}),(V=>d(V)))}}))}static doWhile(e,t){return new zt(((a,d)=>{const m=()=>{e()===!0?t().next((()=>{m()}),d):a()};m()}))}}function Vk(i){const e=i.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Sg(i){return i.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=a=>this.ae(a),this.ue=a=>t.writeSequenceNumber(a))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}X0.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D1=-1;function K0(i){return i==null}function g0(i){return i===0&&1/i==-1/0}function Uk(i){return typeof i=="number"&&Number.isInteger(i)&&!g0(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lA="";function jk(i){let e="";for(let t=0;t<i.length;t++)e.length>0&&(e=V2(e)),e=qk(i.get(t),e);return V2(e)}function qk(i,e){let t=e;const a=i.length;for(let d=0;d<a;d++){const m=i.charAt(d);switch(m){case"\0":t+="";break;case lA:t+="";break;default:t+=m}}return t}function V2(i){return i+lA+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U2(i){let e=0;for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e++;return e}function em(i,e){for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e(t,i[t])}function uA(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa{constructor(e,t){this.comparator=e,this.root=t||Qo.EMPTY}insert(e,t){return new Fa(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Qo.BLACK,null,null))}remove(e){return new Fa(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Qo.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const a=this.comparator(e,t.key);if(a===0)return t.value;a<0?t=t.left:a>0&&(t=t.right)}return null}indexOf(e){let t=0,a=this.root;for(;!a.isEmpty();){const d=this.comparator(e,a.key);if(d===0)return t+a.left.size;d<0?a=a.left:(t+=a.left.size+1,a=a.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,a)=>(e(t,a),!1)))}toString(){const e=[];return this.inorderTraversal(((t,a)=>(e.push(`${t}:${a}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new kv(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new kv(this.root,e,this.comparator,!1)}getReverseIterator(){return new kv(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new kv(this.root,e,this.comparator,!0)}}class kv{constructor(e,t,a,d){this.isReverse=d,this.nodeStack=[];let m=1;for(;!e.isEmpty();)if(m=t?a(e.key,t):1,t&&d&&(m*=-1),m<0)e=this.isReverse?e.left:e.right;else{if(m===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Qo{constructor(e,t,a,d,m){this.key=e,this.value=t,this.color=a??Qo.RED,this.left=d??Qo.EMPTY,this.right=m??Qo.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,a,d,m){return new Qo(e??this.key,t??this.value,a??this.color,d??this.left,m??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,a){let d=this;const m=a(e,d.key);return d=m<0?d.copy(null,null,null,d.left.insert(e,t,a),null):m===0?d.copy(null,t,null,null,null):d.copy(null,null,null,null,d.right.insert(e,t,a)),d.fixUp()}removeMin(){if(this.left.isEmpty())return Qo.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let a,d=this;if(t(e,d.key)<0)d.left.isEmpty()||d.left.isRed()||d.left.left.isRed()||(d=d.moveRedLeft()),d=d.copy(null,null,null,d.left.remove(e,t),null);else{if(d.left.isRed()&&(d=d.rotateRight()),d.right.isEmpty()||d.right.isRed()||d.right.left.isRed()||(d=d.moveRedRight()),t(e,d.key)===0){if(d.right.isEmpty())return Qo.EMPTY;a=d.right.min(),d=d.copy(a.key,a.value,null,null,d.right.removeMin())}d=d.copy(null,null,null,null,d.right.remove(e,t))}return d.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Qo.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Qo.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Hn(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Hn(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Hn(27949);return e+(this.isRed()?0:1)}}Qo.EMPTY=null,Qo.RED=!0,Qo.BLACK=!1;Qo.EMPTY=new class{constructor(){this.size=0}get key(){throw Hn(57766)}get value(){throw Hn(16141)}get color(){throw Hn(16727)}get left(){throw Hn(29726)}get right(){throw Hn(36894)}copy(e,t,a,d,m){return this}insert(e,t,a){return new Qo(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(e){this.comparator=e,this.data=new Fa(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,a)=>(e(t),!1)))}forEachInRange(e,t){const a=this.data.getIteratorFrom(e[0]);for(;a.hasNext();){const d=a.getNext();if(this.comparator(d.key,e[1])>=0)return;t(d.key)}}forEachWhile(e,t){let a;for(a=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();a.hasNext();)if(!e(a.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new j2(this.data.getIterator())}getIteratorFrom(e){return new j2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((a=>{t=t.add(a)})),t}isEqual(e){if(!(e instanceof ro)||this.size!==e.size)return!1;const t=this.data.getIterator(),a=e.data.getIterator();for(;t.hasNext();){const d=t.getNext().key,m=a.getNext().key;if(this.comparator(d,m)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new ro(this.comparator);return t.data=e,t}}class j2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class th{constructor(e){this.fields=e,e.sort(Jo.comparator)}static empty(){return new th([])}unionWith(e){let t=new ro(Jo.comparator);for(const a of this.fields)t=t.add(a);for(const a of e)t=t.add(a);return new th(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return cg(this.fields,e.fields,((t,a)=>t.isEqual(a)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(d){try{return atob(d)}catch(m){throw typeof DOMException<"u"&&m instanceof DOMException?new cA("Invalid base64 string: "+m):m}})(e);return new el(t)}static fromUint8Array(e){const t=(function(d){let m="";for(let _=0;_<d.length;++_)m+=String.fromCharCode(d[_]);return m})(e);return new el(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const a=new Uint8Array(t.length);for(let d=0;d<t.length;d++)a[d]=t.charCodeAt(d);return a})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ni(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}el.EMPTY_BYTE_STRING=new el("");const $k=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ff(i){if(Cr(!!i,39018),typeof i=="string"){let e=0;const t=$k.exec(i);if(Cr(!!t,46558,{timestamp:i}),t[1]){let d=t[1];d=(d+"000000000").substr(0,9),e=Number(d)}const a=new Date(i);return{seconds:Math.floor(a.getTime()/1e3),nanos:e}}return{seconds:hs(i.seconds),nanos:hs(i.nanos)}}function hs(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function Vf(i){return typeof i=="string"?el.fromBase64String(i):el.fromUint8Array(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hA="server_timestamp",dA="__type__",fA="__previous_value__",pA="__local_write_time__";function z1(i){var t,a;return((a=(((t=i==null?void 0:i.mapValue)==null?void 0:t.fields)||{})[dA])==null?void 0:a.stringValue)===hA}function Y0(i){const e=i.mapValue.fields[fA];return z1(e)?Y0(e):e}function ay(i){const e=Ff(i.mapValue.fields[pA].timestampValue);return new ha(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gk{constructor(e,t,a,d,m,_,c,C,k,V){this.databaseId=e,this.appId=t,this.persistenceKey=a,this.host=d,this.ssl=m,this.forceLongPolling=_,this.autoDetectLongPolling=c,this.longPollingOptions=C,this.useFetchStreams=k,this.isUsingEmulator=V}}const _0="(default)";class sy{constructor(e,t){this.projectId=e,this.database=t||_0}static empty(){return new sy("","")}get isDefaultDatabase(){return this.database===_0}isEqual(e){return e instanceof sy&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mA="__type__",Zk="__max__",Dv={mapValue:{}},gA="__vector__",y0="value";function Uf(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?z1(i)?4:Wk(i)?9007199254740991:Hk(i)?10:11:Hn(28295,{value:i})}function Yh(i,e){if(i===e)return!0;const t=Uf(i);if(t!==Uf(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return ay(i).isEqual(ay(e));case 3:return(function(d,m){if(typeof d.timestampValue=="string"&&typeof m.timestampValue=="string"&&d.timestampValue.length===m.timestampValue.length)return d.timestampValue===m.timestampValue;const _=Ff(d.timestampValue),c=Ff(m.timestampValue);return _.seconds===c.seconds&&_.nanos===c.nanos})(i,e);case 5:return i.stringValue===e.stringValue;case 6:return(function(d,m){return Vf(d.bytesValue).isEqual(Vf(m.bytesValue))})(i,e);case 7:return i.referenceValue===e.referenceValue;case 8:return(function(d,m){return hs(d.geoPointValue.latitude)===hs(m.geoPointValue.latitude)&&hs(d.geoPointValue.longitude)===hs(m.geoPointValue.longitude)})(i,e);case 2:return(function(d,m){if("integerValue"in d&&"integerValue"in m)return hs(d.integerValue)===hs(m.integerValue);if("doubleValue"in d&&"doubleValue"in m){const _=hs(d.doubleValue),c=hs(m.doubleValue);return _===c?g0(_)===g0(c):isNaN(_)&&isNaN(c)}return!1})(i,e);case 9:return cg(i.arrayValue.values||[],e.arrayValue.values||[],Yh);case 10:case 11:return(function(d,m){const _=d.mapValue.fields||{},c=m.mapValue.fields||{};if(U2(_)!==U2(c))return!1;for(const C in _)if(_.hasOwnProperty(C)&&(c[C]===void 0||!Yh(_[C],c[C])))return!1;return!0})(i,e);default:return Hn(52216,{left:i})}}function oy(i,e){return(i.values||[]).find((t=>Yh(t,e)))!==void 0}function hg(i,e){if(i===e)return 0;const t=Uf(i),a=Uf(e);if(t!==a)return Ni(t,a);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ni(i.booleanValue,e.booleanValue);case 2:return(function(m,_){const c=hs(m.integerValue||m.doubleValue),C=hs(_.integerValue||_.doubleValue);return c<C?-1:c>C?1:c===C?0:isNaN(c)?isNaN(C)?0:-1:1})(i,e);case 3:return q2(i.timestampValue,e.timestampValue);case 4:return q2(ay(i),ay(e));case 5:return Ox(i.stringValue,e.stringValue);case 6:return(function(m,_){const c=Vf(m),C=Vf(_);return c.compareTo(C)})(i.bytesValue,e.bytesValue);case 7:return(function(m,_){const c=m.split("/"),C=_.split("/");for(let k=0;k<c.length&&k<C.length;k++){const V=Ni(c[k],C[k]);if(V!==0)return V}return Ni(c.length,C.length)})(i.referenceValue,e.referenceValue);case 8:return(function(m,_){const c=Ni(hs(m.latitude),hs(_.latitude));return c!==0?c:Ni(hs(m.longitude),hs(_.longitude))})(i.geoPointValue,e.geoPointValue);case 9:return $2(i.arrayValue,e.arrayValue);case 10:return(function(m,_){var ee,Y,xe,be;const c=m.fields||{},C=_.fields||{},k=(ee=c[y0])==null?void 0:ee.arrayValue,V=(Y=C[y0])==null?void 0:Y.arrayValue,G=Ni(((xe=k==null?void 0:k.values)==null?void 0:xe.length)||0,((be=V==null?void 0:V.values)==null?void 0:be.length)||0);return G!==0?G:$2(k,V)})(i.mapValue,e.mapValue);case 11:return(function(m,_){if(m===Dv.mapValue&&_===Dv.mapValue)return 0;if(m===Dv.mapValue)return 1;if(_===Dv.mapValue)return-1;const c=m.fields||{},C=Object.keys(c),k=_.fields||{},V=Object.keys(k);C.sort(),V.sort();for(let G=0;G<C.length&&G<V.length;++G){const ee=Ox(C[G],V[G]);if(ee!==0)return ee;const Y=hg(c[C[G]],k[V[G]]);if(Y!==0)return Y}return Ni(C.length,V.length)})(i.mapValue,e.mapValue);default:throw Hn(23264,{he:t})}}function q2(i,e){if(typeof i=="string"&&typeof e=="string"&&i.length===e.length)return Ni(i,e);const t=Ff(i),a=Ff(e),d=Ni(t.seconds,a.seconds);return d!==0?d:Ni(t.nanos,a.nanos)}function $2(i,e){const t=i.values||[],a=e.values||[];for(let d=0;d<t.length&&d<a.length;++d){const m=hg(t[d],a[d]);if(m)return m}return Ni(t.length,a.length)}function dg(i){return Nx(i)}function Nx(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?(function(t){const a=Ff(t);return`time(${a.seconds},${a.nanos})`})(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?(function(t){return Vf(t).toBase64()})(i.bytesValue):"referenceValue"in i?(function(t){return On.fromName(t).toString()})(i.referenceValue):"geoPointValue"in i?(function(t){return`geo(${t.latitude},${t.longitude})`})(i.geoPointValue):"arrayValue"in i?(function(t){let a="[",d=!0;for(const m of t.values||[])d?d=!1:a+=",",a+=Nx(m);return a+"]"})(i.arrayValue):"mapValue"in i?(function(t){const a=Object.keys(t.fields||{}).sort();let d="{",m=!0;for(const _ of a)m?m=!1:d+=",",d+=`${_}:${Nx(t.fields[_])}`;return d+"}"})(i.mapValue):Hn(61005,{value:i})}function Xv(i){switch(Uf(i)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Y0(i);return e?16+Xv(e):16;case 5:return 2*i.stringValue.length;case 6:return Vf(i.bytesValue).approximateByteSize();case 7:return i.referenceValue.length;case 9:return(function(a){return(a.values||[]).reduce(((d,m)=>d+Xv(m)),0)})(i.arrayValue);case 10:case 11:return(function(a){let d=0;return em(a.fields,((m,_)=>{d+=m.length+Xv(_)})),d})(i.mapValue);default:throw Hn(13486,{value:i})}}function G2(i,e){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${e.path.canonicalString()}`}}function Bx(i){return!!i&&"integerValue"in i}function O1(i){return!!i&&"arrayValue"in i}function Z2(i){return!!i&&"nullValue"in i}function H2(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function Kv(i){return!!i&&"mapValue"in i}function Hk(i){var t,a;return((a=(((t=i==null?void 0:i.mapValue)==null?void 0:t.fields)||{})[mA])==null?void 0:a.stringValue)===gA}function Z_(i){if(i.geoPointValue)return{geoPointValue:{...i.geoPointValue}};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:{...i.timestampValue}};if(i.mapValue){const e={mapValue:{fields:{}}};return em(i.mapValue.fields,((t,a)=>e.mapValue.fields[t]=Z_(a))),e}if(i.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(i.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Z_(i.arrayValue.values[t]);return e}return{...i}}function Wk(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue===Zk}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec{constructor(e){this.value=e}static empty(){return new Ec({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let a=0;a<e.length-1;++a)if(t=(t.mapValue.fields||{})[e.get(a)],!Kv(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Z_(t)}setAll(e){let t=Jo.emptyPath(),a={},d=[];e.forEach(((_,c)=>{if(!t.isImmediateParentOf(c)){const C=this.getFieldsMap(t);this.applyChanges(C,a,d),a={},d=[],t=c.popLast()}_?a[c.lastSegment()]=Z_(_):d.push(c.lastSegment())}));const m=this.getFieldsMap(t);this.applyChanges(m,a,d)}delete(e){const t=this.field(e.popLast());Kv(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Yh(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let a=0;a<e.length;++a){let d=t.mapValue.fields[e.get(a)];Kv(d)&&d.mapValue.fields||(d={mapValue:{fields:{}}},t.mapValue.fields[e.get(a)]=d),t=d}return t.mapValue.fields}applyChanges(e,t,a){em(t,((d,m)=>e[d]=m));for(const d of a)delete e[d]}clone(){return new Ec(Z_(this.value))}}function _A(i){const e=[];return em(i.fields,((t,a)=>{const d=new Jo([t]);if(Kv(a)){const m=_A(a.mapValue).fields;if(m.length===0)e.push(d);else for(const _ of m)e.push(d.child(_))}else e.push(d)})),new th(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il{constructor(e,t,a,d,m,_,c){this.key=e,this.documentType=t,this.version=a,this.readTime=d,this.createTime=m,this.data=_,this.documentState=c}static newInvalidDocument(e){return new Il(e,0,ti.min(),ti.min(),ti.min(),Ec.empty(),0)}static newFoundDocument(e,t,a,d){return new Il(e,1,t,ti.min(),a,d,0)}static newNoDocument(e,t){return new Il(e,2,t,ti.min(),ti.min(),Ec.empty(),0)}static newUnknownDocument(e,t){return new Il(e,3,t,ti.min(),ti.min(),Ec.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ti.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ec.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ec.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ti.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Il&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Il(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v0{constructor(e,t){this.position=e,this.inclusive=t}}function W2(i,e,t){let a=0;for(let d=0;d<i.position.length;d++){const m=e[d],_=i.position[d];if(m.field.isKeyField()?a=On.comparator(On.fromName(_.referenceValue),t.key):a=hg(_,t.data.field(m.field)),m.dir==="desc"&&(a*=-1),a!==0)break}return a}function X2(i,e){if(i===null)return e===null;if(e===null||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let t=0;t<i.position.length;t++)if(!Yh(i.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b0{constructor(e,t="asc"){this.field=e,this.dir=t}}function Xk(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yA{}class Ds extends yA{constructor(e,t,a){super(),this.field=e,this.op=t,this.value=a}static create(e,t,a){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,a):new Yk(e,t,a):t==="array-contains"?new e5(e,a):t==="in"?new t5(e,a):t==="not-in"?new n5(e,a):t==="array-contains-any"?new i5(e,a):new Ds(e,t,a)}static createKeyFieldInFilter(e,t,a){return t==="in"?new Qk(e,a):new Jk(e,a)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(hg(t,this.value)):t!==null&&Uf(this.value)===Uf(t)&&this.matchesComparison(hg(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Hn(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class oh extends yA{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new oh(e,t)}matches(e){return vA(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function vA(i){return i.op==="and"}function bA(i){return Kk(i)&&vA(i)}function Kk(i){for(const e of i.filters)if(e instanceof oh)return!1;return!0}function Fx(i){if(i instanceof Ds)return i.field.canonicalString()+i.op.toString()+dg(i.value);if(bA(i))return i.filters.map((e=>Fx(e))).join(",");{const e=i.filters.map((t=>Fx(t))).join(",");return`${i.op}(${e})`}}function xA(i,e){return i instanceof Ds?(function(a,d){return d instanceof Ds&&a.op===d.op&&a.field.isEqual(d.field)&&Yh(a.value,d.value)})(i,e):i instanceof oh?(function(a,d){return d instanceof oh&&a.op===d.op&&a.filters.length===d.filters.length?a.filters.reduce(((m,_,c)=>m&&xA(_,d.filters[c])),!0):!1})(i,e):void Hn(19439)}function wA(i){return i instanceof Ds?(function(t){return`${t.field.canonicalString()} ${t.op} ${dg(t.value)}`})(i):i instanceof oh?(function(t){return t.op.toString()+" {"+t.getFilters().map(wA).join(" ,")+"}"})(i):"Filter"}class Yk extends Ds{constructor(e,t,a){super(e,t,a),this.key=On.fromName(a.referenceValue)}matches(e){const t=On.comparator(e.key,this.key);return this.matchesComparison(t)}}class Qk extends Ds{constructor(e,t){super(e,"in",t),this.keys=TA("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Jk extends Ds{constructor(e,t){super(e,"not-in",t),this.keys=TA("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function TA(i,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((a=>On.fromName(a.referenceValue)))}class e5 extends Ds{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return O1(t)&&oy(t.arrayValue,this.value)}}class t5 extends Ds{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&oy(this.value.arrayValue,t)}}class n5 extends Ds{constructor(e,t){super(e,"not-in",t)}matches(e){if(oy(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!oy(this.value.arrayValue,t)}}class i5 extends Ds{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!O1(t)||!t.arrayValue.values)&&t.arrayValue.values.some((a=>oy(this.value.arrayValue,a)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r5{constructor(e,t=null,a=[],d=[],m=null,_=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=a,this.filters=d,this.limit=m,this.startAt=_,this.endAt=c,this.Te=null}}function K2(i,e=null,t=[],a=[],d=null,m=null,_=null){return new r5(i,e,t,a,d,m,_)}function N1(i){const e=si(i);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((a=>Fx(a))).join(","),t+="|ob:",t+=e.orderBy.map((a=>(function(m){return m.field.canonicalString()+m.dir})(a))).join(","),K0(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((a=>dg(a))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((a=>dg(a))).join(",")),e.Te=t}return e.Te}function B1(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<i.orderBy.length;t++)if(!Xk(i.orderBy[t],e.orderBy[t]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let t=0;t<i.filters.length;t++)if(!xA(i.filters[t],e.filters[t]))return!1;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!X2(i.startAt,e.startAt)&&X2(i.endAt,e.endAt)}function Vx(i){return On.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iy{constructor(e,t=null,a=[],d=[],m=null,_="F",c=null,C=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=a,this.filters=d,this.limit=m,this.limitType=_,this.startAt=c,this.endAt=C,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function a5(i,e,t,a,d,m,_,c){return new Iy(i,e,t,a,d,m,_,c)}function SA(i){return new Iy(i)}function Y2(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function EA(i){return i.collectionGroup!==null}function H_(i){const e=si(i);if(e.Ie===null){e.Ie=[];const t=new Set;for(const m of e.explicitOrderBy)e.Ie.push(m),t.add(m.field.canonicalString());const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(_){let c=new ro(Jo.comparator);return _.filters.forEach((C=>{C.getFlattenedFilters().forEach((k=>{k.isInequality()&&(c=c.add(k.field))}))})),c})(e).forEach((m=>{t.has(m.canonicalString())||m.isKeyField()||e.Ie.push(new b0(m,a))})),t.has(Jo.keyField().canonicalString())||e.Ie.push(new b0(Jo.keyField(),a))}return e.Ie}function Fh(i){const e=si(i);return e.Ee||(e.Ee=s5(e,H_(i))),e.Ee}function s5(i,e){if(i.limitType==="F")return K2(i.path,i.collectionGroup,e,i.filters,i.limit,i.startAt,i.endAt);{e=e.map((d=>{const m=d.dir==="desc"?"asc":"desc";return new b0(d.field,m)}));const t=i.endAt?new v0(i.endAt.position,i.endAt.inclusive):null,a=i.startAt?new v0(i.startAt.position,i.startAt.inclusive):null;return K2(i.path,i.collectionGroup,e,i.filters,i.limit,t,a)}}function Ux(i,e){const t=i.filters.concat([e]);return new Iy(i.path,i.collectionGroup,i.explicitOrderBy.slice(),t,i.limit,i.limitType,i.startAt,i.endAt)}function jx(i,e,t){return new Iy(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,t,i.startAt,i.endAt)}function Q0(i,e){return B1(Fh(i),Fh(e))&&i.limitType===e.limitType}function AA(i){return`${N1(Fh(i))}|lt:${i.limitType}`}function Hm(i){return`Query(target=${(function(t){let a=t.path.canonicalString();return t.collectionGroup!==null&&(a+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(a+=`, filters: [${t.filters.map((d=>wA(d))).join(", ")}]`),K0(t.limit)||(a+=", limit: "+t.limit),t.orderBy.length>0&&(a+=`, orderBy: [${t.orderBy.map((d=>(function(_){return`${_.field.canonicalString()} (${_.dir})`})(d))).join(", ")}]`),t.startAt&&(a+=", startAt: ",a+=t.startAt.inclusive?"b:":"a:",a+=t.startAt.position.map((d=>dg(d))).join(",")),t.endAt&&(a+=", endAt: ",a+=t.endAt.inclusive?"a:":"b:",a+=t.endAt.position.map((d=>dg(d))).join(",")),`Target(${a})`})(Fh(i))}; limitType=${i.limitType})`}function J0(i,e){return e.isFoundDocument()&&(function(a,d){const m=d.key.path;return a.collectionGroup!==null?d.key.hasCollectionId(a.collectionGroup)&&a.path.isPrefixOf(m):On.isDocumentKey(a.path)?a.path.isEqual(m):a.path.isImmediateParentOf(m)})(i,e)&&(function(a,d){for(const m of H_(a))if(!m.field.isKeyField()&&d.data.field(m.field)===null)return!1;return!0})(i,e)&&(function(a,d){for(const m of a.filters)if(!m.matches(d))return!1;return!0})(i,e)&&(function(a,d){return!(a.startAt&&!(function(_,c,C){const k=W2(_,c,C);return _.inclusive?k<=0:k<0})(a.startAt,H_(a),d)||a.endAt&&!(function(_,c,C){const k=W2(_,c,C);return _.inclusive?k>=0:k>0})(a.endAt,H_(a),d))})(i,e)}function o5(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function CA(i){return(e,t)=>{let a=!1;for(const d of H_(i)){const m=l5(d,e,t);if(m!==0)return m;a=a||d.field.isKeyField()}return 0}}function l5(i,e,t){const a=i.field.isKeyField()?On.comparator(e.key,t.key):(function(m,_,c){const C=_.data.field(m),k=c.data.field(m);return C!==null&&k!==null?hg(C,k):Hn(42886)})(i.field,e,t);switch(i.dir){case"asc":return a;case"desc":return-1*a;default:return Hn(19790,{direction:i.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tm{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a!==void 0){for(const[d,m]of a)if(this.equalsFn(d,e))return m}}has(e){return this.get(e)!==void 0}set(e,t){const a=this.mapKeyFn(e),d=this.inner[a];if(d===void 0)return this.inner[a]=[[e,t]],void this.innerSize++;for(let m=0;m<d.length;m++)if(this.equalsFn(d[m][0],e))return void(d[m]=[e,t]);d.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a===void 0)return!1;for(let d=0;d<a.length;d++)if(this.equalsFn(a[d][0],e))return a.length===1?delete this.inner[t]:a.splice(d,1),this.innerSize--,!0;return!1}forEach(e){em(this.inner,((t,a)=>{for(const[d,m]of a)e(d,m)}))}isEmpty(){return uA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u5=new Fa(On.comparator);function jd(){return u5}const IA=new Fa(On.comparator);function N_(...i){let e=IA;for(const t of i)e=e.insert(t.key,t);return e}function MA(i){let e=IA;return i.forEach(((t,a)=>e=e.insert(t,a.overlayedDocument))),e}function kp(){return W_()}function PA(){return W_()}function W_(){return new tm((i=>i.toString()),((i,e)=>i.isEqual(e)))}const c5=new Fa(On.comparator),h5=new ro(On.comparator);function Bi(...i){let e=h5;for(const t of i)e=e.add(t);return e}const d5=new ro(Ni);function f5(){return d5}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F1(i,e){if(i.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:g0(e)?"-0":e}}function RA(i){return{integerValue:""+i}}function p5(i,e){return Uk(e)?RA(e):F1(i,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb{constructor(){this._=void 0}}function m5(i,e,t){return i instanceof ly?(function(d,m){const _={fields:{[dA]:{stringValue:hA},[pA]:{timestampValue:{seconds:d.seconds,nanos:d.nanoseconds}}}};return m&&z1(m)&&(m=Y0(m)),m&&(_.fields[fA]=m),{mapValue:_}})(t,e):i instanceof uy?kA(i,e):i instanceof cy?DA(i,e):(function(d,m){const _=LA(d,m),c=Q2(_)+Q2(d.Ae);return Bx(_)&&Bx(d.Ae)?RA(c):F1(d.serializer,c)})(i,e)}function g5(i,e,t){return i instanceof uy?kA(i,e):i instanceof cy?DA(i,e):t}function LA(i,e){return i instanceof x0?(function(a){return Bx(a)||(function(m){return!!m&&"doubleValue"in m})(a)})(e)?e:{integerValue:0}:null}class ly extends eb{}class uy extends eb{constructor(e){super(),this.elements=e}}function kA(i,e){const t=zA(e);for(const a of i.elements)t.some((d=>Yh(d,a)))||t.push(a);return{arrayValue:{values:t}}}class cy extends eb{constructor(e){super(),this.elements=e}}function DA(i,e){let t=zA(e);for(const a of i.elements)t=t.filter((d=>!Yh(d,a)));return{arrayValue:{values:t}}}class x0 extends eb{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Q2(i){return hs(i.integerValue||i.doubleValue)}function zA(i){return O1(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _5{constructor(e,t){this.field=e,this.transform=t}}function y5(i,e){return i.field.isEqual(e.field)&&(function(a,d){return a instanceof uy&&d instanceof uy||a instanceof cy&&d instanceof cy?cg(a.elements,d.elements,Yh):a instanceof x0&&d instanceof x0?Yh(a.Ae,d.Ae):a instanceof ly&&d instanceof ly})(i.transform,e.transform)}class v5{constructor(e,t){this.version=e,this.transformResults=t}}class Od{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Od}static exists(e){return new Od(void 0,e)}static updateTime(e){return new Od(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Yv(i,e){return i.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(i.updateTime):i.exists===void 0||i.exists===e.isFoundDocument()}class tb{}function OA(i,e){if(!i.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return i.isNoDocument()?new BA(i.key,Od.none()):new My(i.key,i.data,Od.none());{const t=i.data,a=Ec.empty();let d=new ro(Jo.comparator);for(let m of e.fields)if(!d.has(m)){let _=t.field(m);_===null&&m.length>1&&(m=m.popLast(),_=t.field(m)),_===null?a.delete(m):a.set(m,_),d=d.add(m)}return new nm(i.key,a,new th(d.toArray()),Od.none())}}function b5(i,e,t){i instanceof My?(function(d,m,_){const c=d.value.clone(),C=eT(d.fieldTransforms,m,_.transformResults);c.setAll(C),m.convertToFoundDocument(_.version,c).setHasCommittedMutations()})(i,e,t):i instanceof nm?(function(d,m,_){if(!Yv(d.precondition,m))return void m.convertToUnknownDocument(_.version);const c=eT(d.fieldTransforms,m,_.transformResults),C=m.data;C.setAll(NA(d)),C.setAll(c),m.convertToFoundDocument(_.version,C).setHasCommittedMutations()})(i,e,t):(function(d,m,_){m.convertToNoDocument(_.version).setHasCommittedMutations()})(0,e,t)}function X_(i,e,t,a){return i instanceof My?(function(m,_,c,C){if(!Yv(m.precondition,_))return c;const k=m.value.clone(),V=tT(m.fieldTransforms,C,_);return k.setAll(V),_.convertToFoundDocument(_.version,k).setHasLocalMutations(),null})(i,e,t,a):i instanceof nm?(function(m,_,c,C){if(!Yv(m.precondition,_))return c;const k=tT(m.fieldTransforms,C,_),V=_.data;return V.setAll(NA(m)),V.setAll(k),_.convertToFoundDocument(_.version,V).setHasLocalMutations(),c===null?null:c.unionWith(m.fieldMask.fields).unionWith(m.fieldTransforms.map((G=>G.field)))})(i,e,t,a):(function(m,_,c){return Yv(m.precondition,_)?(_.convertToNoDocument(_.version).setHasLocalMutations(),null):c})(i,e,t)}function x5(i,e){let t=null;for(const a of i.fieldTransforms){const d=e.data.field(a.field),m=LA(a.transform,d||null);m!=null&&(t===null&&(t=Ec.empty()),t.set(a.field,m))}return t||null}function J2(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&!!(function(a,d){return a===void 0&&d===void 0||!(!a||!d)&&cg(a,d,((m,_)=>y5(m,_)))})(i.fieldTransforms,e.fieldTransforms)&&(i.type===0?i.value.isEqual(e.value):i.type!==1||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask))}class My extends tb{constructor(e,t,a,d=[]){super(),this.key=e,this.value=t,this.precondition=a,this.fieldTransforms=d,this.type=0}getFieldMask(){return null}}class nm extends tb{constructor(e,t,a,d,m=[]){super(),this.key=e,this.data=t,this.fieldMask=a,this.precondition=d,this.fieldTransforms=m,this.type=1}getFieldMask(){return this.fieldMask}}function NA(i){const e=new Map;return i.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const a=i.data.field(t);e.set(t,a)}})),e}function eT(i,e,t){const a=new Map;Cr(i.length===t.length,32656,{Re:t.length,Ve:i.length});for(let d=0;d<t.length;d++){const m=i[d],_=m.transform,c=e.data.field(m.field);a.set(m.field,g5(_,c,t[d]))}return a}function tT(i,e,t){const a=new Map;for(const d of i){const m=d.transform,_=t.data.field(d.field);a.set(d.field,m5(m,_,e))}return a}class BA extends tb{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class w5 extends tb{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T5{constructor(e,t,a,d){this.batchId=e,this.localWriteTime=t,this.baseMutations=a,this.mutations=d}applyToRemoteDocument(e,t){const a=t.mutationResults;for(let d=0;d<this.mutations.length;d++){const m=this.mutations[d];m.key.isEqual(e.key)&&b5(m,e,a[d])}}applyToLocalView(e,t){for(const a of this.baseMutations)a.key.isEqual(e.key)&&(t=X_(a,e,t,this.localWriteTime));for(const a of this.mutations)a.key.isEqual(e.key)&&(t=X_(a,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const a=PA();return this.mutations.forEach((d=>{const m=e.get(d.key),_=m.overlayedDocument;let c=this.applyToLocalView(_,m.mutatedFields);c=t.has(d.key)?null:c;const C=OA(_,c);C!==null&&a.set(d.key,C),_.isValidDocument()||_.convertToNoDocument(ti.min())})),a}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Bi())}isEqual(e){return this.batchId===e.batchId&&cg(this.mutations,e.mutations,((t,a)=>J2(t,a)))&&cg(this.baseMutations,e.baseMutations,((t,a)=>J2(t,a)))}}class V1{constructor(e,t,a,d){this.batch=e,this.commitVersion=t,this.mutationResults=a,this.docVersions=d}static from(e,t,a){Cr(e.mutations.length===a.length,58842,{me:e.mutations.length,fe:a.length});let d=(function(){return c5})();const m=e.mutations;for(let _=0;_<m.length;_++)d=d.insert(m[_].key,a[_].version);return new V1(e,t,a,d)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S5{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E5{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ks,Ji;function A5(i){switch(i){case Dt.OK:return Hn(64938);case Dt.CANCELLED:case Dt.UNKNOWN:case Dt.DEADLINE_EXCEEDED:case Dt.RESOURCE_EXHAUSTED:case Dt.INTERNAL:case Dt.UNAVAILABLE:case Dt.UNAUTHENTICATED:return!1;case Dt.INVALID_ARGUMENT:case Dt.NOT_FOUND:case Dt.ALREADY_EXISTS:case Dt.PERMISSION_DENIED:case Dt.FAILED_PRECONDITION:case Dt.ABORTED:case Dt.OUT_OF_RANGE:case Dt.UNIMPLEMENTED:case Dt.DATA_LOSS:return!0;default:return Hn(15467,{code:i})}}function FA(i){if(i===void 0)return Ud("GRPC error has no .code"),Dt.UNKNOWN;switch(i){case ks.OK:return Dt.OK;case ks.CANCELLED:return Dt.CANCELLED;case ks.UNKNOWN:return Dt.UNKNOWN;case ks.DEADLINE_EXCEEDED:return Dt.DEADLINE_EXCEEDED;case ks.RESOURCE_EXHAUSTED:return Dt.RESOURCE_EXHAUSTED;case ks.INTERNAL:return Dt.INTERNAL;case ks.UNAVAILABLE:return Dt.UNAVAILABLE;case ks.UNAUTHENTICATED:return Dt.UNAUTHENTICATED;case ks.INVALID_ARGUMENT:return Dt.INVALID_ARGUMENT;case ks.NOT_FOUND:return Dt.NOT_FOUND;case ks.ALREADY_EXISTS:return Dt.ALREADY_EXISTS;case ks.PERMISSION_DENIED:return Dt.PERMISSION_DENIED;case ks.FAILED_PRECONDITION:return Dt.FAILED_PRECONDITION;case ks.ABORTED:return Dt.ABORTED;case ks.OUT_OF_RANGE:return Dt.OUT_OF_RANGE;case ks.UNIMPLEMENTED:return Dt.UNIMPLEMENTED;case ks.DATA_LOSS:return Dt.DATA_LOSS;default:return Hn(39323,{code:i})}}(Ji=ks||(ks={}))[Ji.OK=0]="OK",Ji[Ji.CANCELLED=1]="CANCELLED",Ji[Ji.UNKNOWN=2]="UNKNOWN",Ji[Ji.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ji[Ji.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ji[Ji.NOT_FOUND=5]="NOT_FOUND",Ji[Ji.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ji[Ji.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ji[Ji.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ji[Ji.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ji[Ji.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ji[Ji.ABORTED=10]="ABORTED",Ji[Ji.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ji[Ji.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ji[Ji.INTERNAL=13]="INTERNAL",Ji[Ji.UNAVAILABLE=14]="UNAVAILABLE",Ji[Ji.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C5(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I5=new kf([4294967295,4294967295],0);function nT(i){const e=C5().encode(i),t=new QE;return t.update(e),new Uint8Array(t.digest())}function iT(i){const e=new DataView(i.buffer),t=e.getUint32(0,!0),a=e.getUint32(4,!0),d=e.getUint32(8,!0),m=e.getUint32(12,!0);return[new kf([t,a],0),new kf([d,m],0)]}class U1{constructor(e,t,a){if(this.bitmap=e,this.padding=t,this.hashCount=a,t<0||t>=8)throw new B_(`Invalid padding: ${t}`);if(a<0)throw new B_(`Invalid hash count: ${a}`);if(e.length>0&&this.hashCount===0)throw new B_(`Invalid hash count: ${a}`);if(e.length===0&&t!==0)throw new B_(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=kf.fromNumber(this.ge)}ye(e,t,a){let d=e.add(t.multiply(kf.fromNumber(a)));return d.compare(I5)===1&&(d=new kf([d.getBits(0),d.getBits(1)],0)),d.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=nT(e),[a,d]=iT(t);for(let m=0;m<this.hashCount;m++){const _=this.ye(a,d,m);if(!this.we(_))return!1}return!0}static create(e,t,a){const d=e%8==0?0:8-e%8,m=new Uint8Array(Math.ceil(e/8)),_=new U1(m,d,t);return a.forEach((c=>_.insert(c))),_}insert(e){if(this.ge===0)return;const t=nT(e),[a,d]=iT(t);for(let m=0;m<this.hashCount;m++){const _=this.ye(a,d,m);this.Se(_)}}Se(e){const t=Math.floor(e/8),a=e%8;this.bitmap[t]|=1<<a}}class B_ extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb{constructor(e,t,a,d,m){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=a,this.documentUpdates=d,this.resolvedLimboDocuments=m}static createSynthesizedRemoteEventForCurrentChange(e,t,a){const d=new Map;return d.set(e,Py.createSynthesizedTargetChangeForCurrentChange(e,t,a)),new nb(ti.min(),d,new Fa(Ni),jd(),Bi())}}class Py{constructor(e,t,a,d,m){this.resumeToken=e,this.current=t,this.addedDocuments=a,this.modifiedDocuments=d,this.removedDocuments=m}static createSynthesizedTargetChangeForCurrentChange(e,t,a){return new Py(a,t,Bi(),Bi(),Bi())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv{constructor(e,t,a,d){this.be=e,this.removedTargetIds=t,this.key=a,this.De=d}}class VA{constructor(e,t){this.targetId=e,this.Ce=t}}class UA{constructor(e,t,a=el.EMPTY_BYTE_STRING,d=null){this.state=e,this.targetIds=t,this.resumeToken=a,this.cause=d}}class rT{constructor(){this.ve=0,this.Fe=aT(),this.Me=el.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Bi(),t=Bi(),a=Bi();return this.Fe.forEach(((d,m)=>{switch(m){case 0:e=e.add(d);break;case 2:t=t.add(d);break;case 1:a=a.add(d);break;default:Hn(38017,{changeType:m})}})),new Py(this.Me,this.xe,e,t,a)}qe(){this.Oe=!1,this.Fe=aT()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Cr(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class M5{constructor(e){this.Ge=e,this.ze=new Map,this.je=jd(),this.Je=zv(),this.He=zv(),this.Ye=new Fa(Ni)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const a=this.nt(t);switch(e.state){case 0:this.rt(t)&&a.Le(e.resumeToken);break;case 1:a.Ke(),a.Ne||a.qe(),a.Le(e.resumeToken);break;case 2:a.Ke(),a.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(a.We(),a.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),a.Le(e.resumeToken));break;default:Hn(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((a,d)=>{this.rt(d)&&t(d)}))}st(e){const t=e.targetId,a=e.Ce.count,d=this.ot(t);if(d){const m=d.target;if(Vx(m))if(a===0){const _=new On(m.path);this.et(t,_,Il.newNoDocument(_,ti.min()))}else Cr(a===1,20013,{expectedCount:a});else{const _=this._t(t);if(_!==a){const c=this.ut(e),C=c?this.ct(c,e,_):1;if(C!==0){this.it(t);const k=C===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,k)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:a="",padding:d=0},hashCount:m=0}=t;let _,c;try{_=Vf(a).toUint8Array()}catch(C){if(C instanceof cA)return ug("Decoding the base64 bloom filter in existence filter failed ("+C.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw C}try{c=new U1(_,d,m)}catch(C){return ug(C instanceof B_?"BloomFilter error: ":"Applying bloom filter failed: ",C),null}return c.ge===0?null:c}ct(e,t,a){return t.Ce.count===a-this.Pt(e,t.targetId)?0:2}Pt(e,t){const a=this.Ge.getRemoteKeysForTarget(t);let d=0;return a.forEach((m=>{const _=this.Ge.ht(),c=`projects/${_.projectId}/databases/${_.database}/documents/${m.path.canonicalString()}`;e.mightContain(c)||(this.et(t,m,null),d++)})),d}Tt(e){const t=new Map;this.ze.forEach(((m,_)=>{const c=this.ot(_);if(c){if(m.current&&Vx(c.target)){const C=new On(c.target.path);this.It(C).has(_)||this.Et(_,C)||this.et(_,C,Il.newNoDocument(C,e))}m.Be&&(t.set(_,m.ke()),m.qe())}}));let a=Bi();this.He.forEach(((m,_)=>{let c=!0;_.forEachWhile((C=>{const k=this.ot(C);return!k||k.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(a=a.add(m))})),this.je.forEach(((m,_)=>_.setReadTime(e)));const d=new nb(e,t,this.Ye,this.je,a);return this.je=jd(),this.Je=zv(),this.He=zv(),this.Ye=new Fa(Ni),d}Xe(e,t){if(!this.rt(e))return;const a=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,a),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,a){if(!this.rt(e))return;const d=this.nt(e);this.Et(e,t)?d.Qe(t,1):d.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),a&&(this.je=this.je.insert(t,a))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new rT,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new ro(Ni),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new ro(Ni),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||gn("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new rT),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function zv(){return new Fa(On.comparator)}function aT(){return new Fa(On.comparator)}const P5={asc:"ASCENDING",desc:"DESCENDING"},R5={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},L5={and:"AND",or:"OR"};class k5{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function qx(i,e){return i.useProto3Json||K0(e)?e:{value:e}}function w0(i,e){return i.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function jA(i,e){return i.useProto3Json?e.toBase64():e.toUint8Array()}function D5(i,e){return w0(i,e.toTimestamp())}function Vh(i){return Cr(!!i,49232),ti.fromTimestamp((function(t){const a=Ff(t);return new ha(a.seconds,a.nanos)})(i))}function j1(i,e){return $x(i,e).canonicalString()}function $x(i,e){const t=(function(d){return new ea(["projects",d.projectId,"databases",d.database])})(i).child("documents");return e===void 0?t:t.child(e)}function qA(i){const e=ea.fromString(i);return Cr(WA(e),10190,{key:e.toString()}),e}function Gx(i,e){return j1(i.databaseId,e.path)}function nx(i,e){const t=qA(e);if(t.get(1)!==i.databaseId.projectId)throw new _n(Dt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+i.databaseId.projectId);if(t.get(3)!==i.databaseId.database)throw new _n(Dt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+i.databaseId.database);return new On(GA(t))}function $A(i,e){return j1(i.databaseId,e)}function z5(i){const e=qA(i);return e.length===4?ea.emptyPath():GA(e)}function Zx(i){return new ea(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function GA(i){return Cr(i.length>4&&i.get(4)==="documents",29091,{key:i.toString()}),i.popFirst(5)}function sT(i,e,t){return{name:Gx(i,e),fields:t.value.mapValue.fields}}function O5(i,e){let t;if("targetChange"in e){e.targetChange;const a=(function(k){return k==="NO_CHANGE"?0:k==="ADD"?1:k==="REMOVE"?2:k==="CURRENT"?3:k==="RESET"?4:Hn(39313,{state:k})})(e.targetChange.targetChangeType||"NO_CHANGE"),d=e.targetChange.targetIds||[],m=(function(k,V){return k.useProto3Json?(Cr(V===void 0||typeof V=="string",58123),el.fromBase64String(V||"")):(Cr(V===void 0||V instanceof Buffer||V instanceof Uint8Array,16193),el.fromUint8Array(V||new Uint8Array))})(i,e.targetChange.resumeToken),_=e.targetChange.cause,c=_&&(function(k){const V=k.code===void 0?Dt.UNKNOWN:FA(k.code);return new _n(V,k.message||"")})(_);t=new UA(a,d,m,c||null)}else if("documentChange"in e){e.documentChange;const a=e.documentChange;a.document,a.document.name,a.document.updateTime;const d=nx(i,a.document.name),m=Vh(a.document.updateTime),_=a.document.createTime?Vh(a.document.createTime):ti.min(),c=new Ec({mapValue:{fields:a.document.fields}}),C=Il.newFoundDocument(d,m,_,c),k=a.targetIds||[],V=a.removedTargetIds||[];t=new Qv(k,V,C.key,C)}else if("documentDelete"in e){e.documentDelete;const a=e.documentDelete;a.document;const d=nx(i,a.document),m=a.readTime?Vh(a.readTime):ti.min(),_=Il.newNoDocument(d,m),c=a.removedTargetIds||[];t=new Qv([],c,_.key,_)}else if("documentRemove"in e){e.documentRemove;const a=e.documentRemove;a.document;const d=nx(i,a.document),m=a.removedTargetIds||[];t=new Qv([],m,d,null)}else{if(!("filter"in e))return Hn(11601,{Rt:e});{e.filter;const a=e.filter;a.targetId;const{count:d=0,unchangedNames:m}=a,_=new E5(d,m),c=a.targetId;t=new VA(c,_)}}return t}function N5(i,e){let t;if(e instanceof My)t={update:sT(i,e.key,e.value)};else if(e instanceof BA)t={delete:Gx(i,e.key)};else if(e instanceof nm)t={update:sT(i,e.key,e.data),updateMask:Z5(e.fieldMask)};else{if(!(e instanceof w5))return Hn(16599,{Vt:e.type});t={verify:Gx(i,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((a=>(function(m,_){const c=_.transform;if(c instanceof ly)return{fieldPath:_.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof uy)return{fieldPath:_.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof cy)return{fieldPath:_.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof x0)return{fieldPath:_.field.canonicalString(),increment:c.Ae};throw Hn(20930,{transform:_.transform})})(0,a)))),e.precondition.isNone||(t.currentDocument=(function(d,m){return m.updateTime!==void 0?{updateTime:D5(d,m.updateTime)}:m.exists!==void 0?{exists:m.exists}:Hn(27497)})(i,e.precondition)),t}function B5(i,e){return i&&i.length>0?(Cr(e!==void 0,14353),i.map((t=>(function(d,m){let _=d.updateTime?Vh(d.updateTime):Vh(m);return _.isEqual(ti.min())&&(_=Vh(m)),new v5(_,d.transformResults||[])})(t,e)))):[]}function F5(i,e){return{documents:[$A(i,e.path)]}}function V5(i,e){const t={structuredQuery:{}},a=e.path;let d;e.collectionGroup!==null?(d=a,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(d=a.popLast(),t.structuredQuery.from=[{collectionId:a.lastSegment()}]),t.parent=$A(i,d);const m=(function(k){if(k.length!==0)return HA(oh.create(k,"and"))})(e.filters);m&&(t.structuredQuery.where=m);const _=(function(k){if(k.length!==0)return k.map((V=>(function(ee){return{field:Wm(ee.field),direction:q5(ee.dir)}})(V)))})(e.orderBy);_&&(t.structuredQuery.orderBy=_);const c=qx(i,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(k){return{before:k.inclusive,values:k.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(k){return{before:!k.inclusive,values:k.position}})(e.endAt)),{ft:t,parent:d}}function U5(i){let e=z5(i.parent);const t=i.structuredQuery,a=t.from?t.from.length:0;let d=null;if(a>0){Cr(a===1,65062);const V=t.from[0];V.allDescendants?d=V.collectionId:e=e.child(V.collectionId)}let m=[];t.where&&(m=(function(G){const ee=ZA(G);return ee instanceof oh&&bA(ee)?ee.getFilters():[ee]})(t.where));let _=[];t.orderBy&&(_=(function(G){return G.map((ee=>(function(xe){return new b0(Xm(xe.field),(function(Ne){switch(Ne){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(xe.direction))})(ee)))})(t.orderBy));let c=null;t.limit&&(c=(function(G){let ee;return ee=typeof G=="object"?G.value:G,K0(ee)?null:ee})(t.limit));let C=null;t.startAt&&(C=(function(G){const ee=!!G.before,Y=G.values||[];return new v0(Y,ee)})(t.startAt));let k=null;return t.endAt&&(k=(function(G){const ee=!G.before,Y=G.values||[];return new v0(Y,ee)})(t.endAt)),a5(e,d,_,m,c,"F",C,k)}function j5(i,e){const t=(function(d){switch(d){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Hn(28987,{purpose:d})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function ZA(i){return i.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const a=Xm(t.unaryFilter.field);return Ds.create(a,"==",{doubleValue:NaN});case"IS_NULL":const d=Xm(t.unaryFilter.field);return Ds.create(d,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const m=Xm(t.unaryFilter.field);return Ds.create(m,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const _=Xm(t.unaryFilter.field);return Ds.create(_,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Hn(61313);default:return Hn(60726)}})(i):i.fieldFilter!==void 0?(function(t){return Ds.create(Xm(t.fieldFilter.field),(function(d){switch(d){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Hn(58110);default:return Hn(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(i):i.compositeFilter!==void 0?(function(t){return oh.create(t.compositeFilter.filters.map((a=>ZA(a))),(function(d){switch(d){case"AND":return"and";case"OR":return"or";default:return Hn(1026)}})(t.compositeFilter.op))})(i):Hn(30097,{filter:i})}function q5(i){return P5[i]}function $5(i){return R5[i]}function G5(i){return L5[i]}function Wm(i){return{fieldPath:i.canonicalString()}}function Xm(i){return Jo.fromServerFormat(i.fieldPath)}function HA(i){return i instanceof Ds?(function(t){if(t.op==="=="){if(H2(t.value))return{unaryFilter:{field:Wm(t.field),op:"IS_NAN"}};if(Z2(t.value))return{unaryFilter:{field:Wm(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(H2(t.value))return{unaryFilter:{field:Wm(t.field),op:"IS_NOT_NAN"}};if(Z2(t.value))return{unaryFilter:{field:Wm(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wm(t.field),op:$5(t.op),value:t.value}}})(i):i instanceof oh?(function(t){const a=t.getFilters().map((d=>HA(d)));return a.length===1?a[0]:{compositeFilter:{op:G5(t.op),filters:a}}})(i):Hn(54877,{filter:i})}function Z5(i){const e=[];return i.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function WA(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(e,t,a,d,m=ti.min(),_=ti.min(),c=el.EMPTY_BYTE_STRING,C=null){this.target=e,this.targetId=t,this.purpose=a,this.sequenceNumber=d,this.snapshotVersion=m,this.lastLimboFreeSnapshotVersion=_,this.resumeToken=c,this.expectedCount=C}withSequenceNumber(e){return new If(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new If(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new If(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new If(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H5{constructor(e){this.yt=e}}function W5(i){const e=U5({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?jx(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X5{constructor(){this.Cn=new K5}addToCollectionParentIndex(e,t){return this.Cn.add(t),zt.resolve()}getCollectionParents(e,t){return zt.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return zt.resolve()}deleteFieldIndex(e,t){return zt.resolve()}deleteAllFieldIndexes(e){return zt.resolve()}createTargetIndexes(e,t){return zt.resolve()}getDocumentsMatchingTarget(e,t){return zt.resolve(null)}getIndexType(e,t){return zt.resolve(0)}getFieldIndexes(e,t){return zt.resolve([])}getNextCollectionGroupToUpdate(e){return zt.resolve(null)}getMinOffset(e,t){return zt.resolve(Bf.min())}getMinOffsetFromCollectionGroup(e,t){return zt.resolve(Bf.min())}updateCollectionGroup(e,t,a){return zt.resolve()}updateIndexEntries(e,t){return zt.resolve()}}class K5{constructor(){this.index={}}add(e){const t=e.lastSegment(),a=e.popLast(),d=this.index[t]||new ro(ea.comparator),m=!d.has(a);return this.index[t]=d.add(a),m}has(e){const t=e.lastSegment(),a=e.popLast(),d=this.index[t];return d&&d.has(a)}getEntries(e){return(this.index[e]||new ro(ea.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},XA=41943040;class ou{static withCacheSize(e){return new ou(e,ou.DEFAULT_COLLECTION_PERCENTILE,ou.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,a){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ou.DEFAULT_COLLECTION_PERCENTILE=10,ou.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ou.DEFAULT=new ou(XA,ou.DEFAULT_COLLECTION_PERCENTILE,ou.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ou.DISABLED=new ou(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fg{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new fg(0)}static cr(){return new fg(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lT="LruGarbageCollector",Y5=1048576;function uT([i,e],[t,a]){const d=Ni(i,t);return d===0?Ni(e,a):d}class Q5{constructor(e){this.Ir=e,this.buffer=new ro(uT),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const a=this.buffer.last();uT(t,a)<0&&(this.buffer=this.buffer.delete(a).add(t))}}get maxValue(){return this.buffer.last()[0]}}class J5{constructor(e,t,a){this.garbageCollector=e,this.asyncQueue=t,this.localStore=a,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){gn(lT,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Sg(t)?gn(lT,"Ignoring IndexedDB error during garbage collection: ",t):await Tg(t)}await this.Vr(3e5)}))}}class eD{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((a=>Math.floor(t/100*a)))}nthSequenceNumber(e,t){if(t===0)return zt.resolve(X0.ce);const a=new Q5(t);return this.mr.forEachTarget(e,(d=>a.Ar(d.sequenceNumber))).next((()=>this.mr.pr(e,(d=>a.Ar(d))))).next((()=>a.maxValue))}removeTargets(e,t,a){return this.mr.removeTargets(e,t,a)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(gn("LruGarbageCollector","Garbage collection skipped; disabled"),zt.resolve(oT)):this.getCacheSize(e).next((a=>a<this.params.cacheSizeCollectionThreshold?(gn("LruGarbageCollector",`Garbage collection skipped; Cache size ${a} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),oT):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let a,d,m,_,c,C,k;const V=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((G=>(G>this.params.maximumSequenceNumbersToCollect?(gn("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${G}`),d=this.params.maximumSequenceNumbersToCollect):d=G,_=Date.now(),this.nthSequenceNumber(e,d)))).next((G=>(a=G,c=Date.now(),this.removeTargets(e,a,t)))).next((G=>(m=G,C=Date.now(),this.removeOrphanedDocuments(e,a)))).next((G=>(k=Date.now(),Zm()<=Oi.DEBUG&&gn("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${_-V}ms
	Determined least recently used ${d} in `+(c-_)+`ms
	Removed ${m} targets in `+(C-c)+`ms
	Removed ${G} documents in `+(k-C)+`ms
Total Duration: ${k-V}ms`),zt.resolve({didRun:!0,sequenceNumbersCollected:d,targetsRemoved:m,documentsRemoved:G}))))}}function tD(i,e){return new eD(i,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nD{constructor(){this.changes=new tm((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Il.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const a=this.changes.get(t);return a!==void 0?zt.resolve(a):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iD{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rD{constructor(e,t,a,d){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=a,this.indexManager=d}getDocument(e,t){let a=null;return this.documentOverlayCache.getOverlay(e,t).next((d=>(a=d,this.remoteDocumentCache.getEntry(e,t)))).next((d=>(a!==null&&X_(a.mutation,d,th.empty(),ha.now()),d)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((a=>this.getLocalViewOfDocuments(e,a,Bi()).next((()=>a))))}getLocalViewOfDocuments(e,t,a=Bi()){const d=kp();return this.populateOverlays(e,d,t).next((()=>this.computeViews(e,t,d,a).next((m=>{let _=N_();return m.forEach(((c,C)=>{_=_.insert(c,C.overlayedDocument)})),_}))))}getOverlayedDocuments(e,t){const a=kp();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,Bi())))}populateOverlays(e,t,a){const d=[];return a.forEach((m=>{t.has(m)||d.push(m)})),this.documentOverlayCache.getOverlays(e,d).next((m=>{m.forEach(((_,c)=>{t.set(_,c)}))}))}computeViews(e,t,a,d){let m=jd();const _=W_(),c=(function(){return W_()})();return t.forEach(((C,k)=>{const V=a.get(k.key);d.has(k.key)&&(V===void 0||V.mutation instanceof nm)?m=m.insert(k.key,k):V!==void 0?(_.set(k.key,V.mutation.getFieldMask()),X_(V.mutation,k,V.mutation.getFieldMask(),ha.now())):_.set(k.key,th.empty())})),this.recalculateAndSaveOverlays(e,m).next((C=>(C.forEach(((k,V)=>_.set(k,V))),t.forEach(((k,V)=>c.set(k,new iD(V,_.get(k)??null)))),c)))}recalculateAndSaveOverlays(e,t){const a=W_();let d=new Fa(((_,c)=>_-c)),m=Bi();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((_=>{for(const c of _)c.keys().forEach((C=>{const k=t.get(C);if(k===null)return;let V=a.get(C)||th.empty();V=c.applyToLocalView(k,V),a.set(C,V);const G=(d.get(c.batchId)||Bi()).add(C);d=d.insert(c.batchId,G)}))})).next((()=>{const _=[],c=d.getReverseIterator();for(;c.hasNext();){const C=c.getNext(),k=C.key,V=C.value,G=PA();V.forEach((ee=>{if(!m.has(ee)){const Y=OA(t.get(ee),a.get(ee));Y!==null&&G.set(ee,Y),m=m.add(ee)}})),_.push(this.documentOverlayCache.saveOverlays(e,k,G))}return zt.waitFor(_)})).next((()=>a))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((a=>this.recalculateAndSaveOverlays(e,a)))}getDocumentsMatchingQuery(e,t,a,d){return(function(_){return On.isDocumentKey(_.path)&&_.collectionGroup===null&&_.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):EA(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,a,d):this.getDocumentsMatchingCollectionQuery(e,t,a,d)}getNextDocuments(e,t,a,d){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,a,d).next((m=>{const _=d-m.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,a.largestBatchId,d-m.size):zt.resolve(kp());let c=ry,C=m;return _.next((k=>zt.forEach(k,((V,G)=>(c<G.largestBatchId&&(c=G.largestBatchId),m.get(V)?zt.resolve():this.remoteDocumentCache.getEntry(e,V).next((ee=>{C=C.insert(V,ee)}))))).next((()=>this.populateOverlays(e,k,m))).next((()=>this.computeViews(e,C,k,Bi()))).next((V=>({batchId:c,changes:MA(V)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new On(t)).next((a=>{let d=N_();return a.isFoundDocument()&&(d=d.insert(a.key,a)),d}))}getDocumentsMatchingCollectionGroupQuery(e,t,a,d){const m=t.collectionGroup;let _=N_();return this.indexManager.getCollectionParents(e,m).next((c=>zt.forEach(c,(C=>{const k=(function(G,ee){return new Iy(ee,null,G.explicitOrderBy.slice(),G.filters.slice(),G.limit,G.limitType,G.startAt,G.endAt)})(t,C.child(m));return this.getDocumentsMatchingCollectionQuery(e,k,a,d).next((V=>{V.forEach(((G,ee)=>{_=_.insert(G,ee)}))}))})).next((()=>_))))}getDocumentsMatchingCollectionQuery(e,t,a,d){let m;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,a.largestBatchId).next((_=>(m=_,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,a,m,d)))).next((_=>{m.forEach(((C,k)=>{const V=k.getKey();_.get(V)===null&&(_=_.insert(V,Il.newInvalidDocument(V)))}));let c=N_();return _.forEach(((C,k)=>{const V=m.get(C);V!==void 0&&X_(V.mutation,k,th.empty(),ha.now()),J0(t,k)&&(c=c.insert(C,k))})),c}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aD{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return zt.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(d){return{id:d.id,version:d.version,createTime:Vh(d.createTime)}})(t)),zt.resolve()}getNamedQuery(e,t){return zt.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(d){return{name:d.name,query:W5(d.bundledQuery),readTime:Vh(d.readTime)}})(t)),zt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sD{constructor(){this.overlays=new Fa(On.comparator),this.qr=new Map}getOverlay(e,t){return zt.resolve(this.overlays.get(t))}getOverlays(e,t){const a=kp();return zt.forEach(t,(d=>this.getOverlay(e,d).next((m=>{m!==null&&a.set(d,m)})))).next((()=>a))}saveOverlays(e,t,a){return a.forEach(((d,m)=>{this.St(e,t,m)})),zt.resolve()}removeOverlaysForBatchId(e,t,a){const d=this.qr.get(a);return d!==void 0&&(d.forEach((m=>this.overlays=this.overlays.remove(m))),this.qr.delete(a)),zt.resolve()}getOverlaysForCollection(e,t,a){const d=kp(),m=t.length+1,_=new On(t.child("")),c=this.overlays.getIteratorFrom(_);for(;c.hasNext();){const C=c.getNext().value,k=C.getKey();if(!t.isPrefixOf(k.path))break;k.path.length===m&&C.largestBatchId>a&&d.set(C.getKey(),C)}return zt.resolve(d)}getOverlaysForCollectionGroup(e,t,a,d){let m=new Fa(((k,V)=>k-V));const _=this.overlays.getIterator();for(;_.hasNext();){const k=_.getNext().value;if(k.getKey().getCollectionGroup()===t&&k.largestBatchId>a){let V=m.get(k.largestBatchId);V===null&&(V=kp(),m=m.insert(k.largestBatchId,V)),V.set(k.getKey(),k)}}const c=kp(),C=m.getIterator();for(;C.hasNext()&&(C.getNext().value.forEach(((k,V)=>c.set(k,V))),!(c.size()>=d)););return zt.resolve(c)}St(e,t,a){const d=this.overlays.get(a.key);if(d!==null){const _=this.qr.get(d.largestBatchId).delete(a.key);this.qr.set(d.largestBatchId,_)}this.overlays=this.overlays.insert(a.key,new S5(t,a));let m=this.qr.get(t);m===void 0&&(m=Bi(),this.qr.set(t,m)),this.qr.set(t,m.add(a.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oD{constructor(){this.sessionToken=el.EMPTY_BYTE_STRING}getSessionToken(e){return zt.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,zt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q1{constructor(){this.Qr=new ro(vo.$r),this.Ur=new ro(vo.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const a=new vo(e,t);this.Qr=this.Qr.add(a),this.Ur=this.Ur.add(a)}Wr(e,t){e.forEach((a=>this.addReference(a,t)))}removeReference(e,t){this.Gr(new vo(e,t))}zr(e,t){e.forEach((a=>this.removeReference(a,t)))}jr(e){const t=new On(new ea([])),a=new vo(t,e),d=new vo(t,e+1),m=[];return this.Ur.forEachInRange([a,d],(_=>{this.Gr(_),m.push(_.key)})),m}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new On(new ea([])),a=new vo(t,e),d=new vo(t,e+1);let m=Bi();return this.Ur.forEachInRange([a,d],(_=>{m=m.add(_.key)})),m}containsKey(e){const t=new vo(e,0),a=this.Qr.firstAfterOrEqual(t);return a!==null&&e.isEqual(a.key)}}class vo{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return On.comparator(e.key,t.key)||Ni(e.Yr,t.Yr)}static Kr(e,t){return Ni(e.Yr,t.Yr)||On.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lD{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new ro(vo.$r)}checkEmpty(e){return zt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,a,d){const m=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const _=new T5(m,t,a,d);this.mutationQueue.push(_);for(const c of d)this.Zr=this.Zr.add(new vo(c.key,m)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return zt.resolve(_)}lookupMutationBatch(e,t){return zt.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const a=t+1,d=this.ei(a),m=d<0?0:d;return zt.resolve(this.mutationQueue.length>m?this.mutationQueue[m]:null)}getHighestUnacknowledgedBatchId(){return zt.resolve(this.mutationQueue.length===0?D1:this.tr-1)}getAllMutationBatches(e){return zt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const a=new vo(t,0),d=new vo(t,Number.POSITIVE_INFINITY),m=[];return this.Zr.forEachInRange([a,d],(_=>{const c=this.Xr(_.Yr);m.push(c)})),zt.resolve(m)}getAllMutationBatchesAffectingDocumentKeys(e,t){let a=new ro(Ni);return t.forEach((d=>{const m=new vo(d,0),_=new vo(d,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([m,_],(c=>{a=a.add(c.Yr)}))})),zt.resolve(this.ti(a))}getAllMutationBatchesAffectingQuery(e,t){const a=t.path,d=a.length+1;let m=a;On.isDocumentKey(m)||(m=m.child(""));const _=new vo(new On(m),0);let c=new ro(Ni);return this.Zr.forEachWhile((C=>{const k=C.key.path;return!!a.isPrefixOf(k)&&(k.length===d&&(c=c.add(C.Yr)),!0)}),_),zt.resolve(this.ti(c))}ti(e){const t=[];return e.forEach((a=>{const d=this.Xr(a);d!==null&&t.push(d)})),t}removeMutationBatch(e,t){Cr(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let a=this.Zr;return zt.forEach(t.mutations,(d=>{const m=new vo(d.key,t.batchId);return a=a.delete(m),this.referenceDelegate.markPotentiallyOrphaned(e,d.key)})).next((()=>{this.Zr=a}))}ir(e){}containsKey(e,t){const a=new vo(t,0),d=this.Zr.firstAfterOrEqual(a);return zt.resolve(t.isEqual(d&&d.key))}performConsistencyCheck(e){return this.mutationQueue.length,zt.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uD{constructor(e){this.ri=e,this.docs=(function(){return new Fa(On.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const a=t.key,d=this.docs.get(a),m=d?d.size:0,_=this.ri(t);return this.docs=this.docs.insert(a,{document:t.mutableCopy(),size:_}),this.size+=_-m,this.indexManager.addToCollectionParentIndex(e,a.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const a=this.docs.get(t);return zt.resolve(a?a.document.mutableCopy():Il.newInvalidDocument(t))}getEntries(e,t){let a=jd();return t.forEach((d=>{const m=this.docs.get(d);a=a.insert(d,m?m.document.mutableCopy():Il.newInvalidDocument(d))})),zt.resolve(a)}getDocumentsMatchingQuery(e,t,a,d){let m=jd();const _=t.path,c=new On(_.child("__id-9223372036854775808__")),C=this.docs.getIteratorFrom(c);for(;C.hasNext();){const{key:k,value:{document:V}}=C.getNext();if(!_.isPrefixOf(k.path))break;k.path.length>_.length+1||Nk(Ok(V),a)<=0||(d.has(V.key)||J0(t,V))&&(m=m.insert(V.key,V.mutableCopy()))}return zt.resolve(m)}getAllFromCollectionGroup(e,t,a,d){Hn(9500)}ii(e,t){return zt.forEach(this.docs,(a=>t(a)))}newChangeBuffer(e){return new cD(this)}getSize(e){return zt.resolve(this.size)}}class cD extends nD{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((a,d)=>{d.isValidDocument()?t.push(this.Nr.addEntry(e,d)):this.Nr.removeEntry(a)})),zt.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(e){this.persistence=e,this.si=new tm((t=>N1(t)),B1),this.lastRemoteSnapshotVersion=ti.min(),this.highestTargetId=0,this.oi=0,this._i=new q1,this.targetCount=0,this.ai=fg.ur()}forEachTarget(e,t){return this.si.forEach(((a,d)=>t(d))),zt.resolve()}getLastRemoteSnapshotVersion(e){return zt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return zt.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),zt.resolve(this.highestTargetId)}setTargetsMetadata(e,t,a){return a&&(this.lastRemoteSnapshotVersion=a),t>this.oi&&(this.oi=t),zt.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new fg(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,zt.resolve()}updateTargetData(e,t){return this.Pr(t),zt.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,zt.resolve()}removeTargets(e,t,a){let d=0;const m=[];return this.si.forEach(((_,c)=>{c.sequenceNumber<=t&&a.get(c.targetId)===null&&(this.si.delete(_),m.push(this.removeMatchingKeysForTargetId(e,c.targetId)),d++)})),zt.waitFor(m).next((()=>d))}getTargetCount(e){return zt.resolve(this.targetCount)}getTargetData(e,t){const a=this.si.get(t)||null;return zt.resolve(a)}addMatchingKeys(e,t,a){return this._i.Wr(t,a),zt.resolve()}removeMatchingKeys(e,t,a){this._i.zr(t,a);const d=this.persistence.referenceDelegate,m=[];return d&&t.forEach((_=>{m.push(d.markPotentiallyOrphaned(e,_))})),zt.waitFor(m)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),zt.resolve()}getMatchingKeysForTargetId(e,t){const a=this._i.Hr(t);return zt.resolve(a)}containsKey(e,t){return zt.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KA{constructor(e,t){this.ui={},this.overlays={},this.ci=new X0(0),this.li=!1,this.li=!0,this.hi=new oD,this.referenceDelegate=e(this),this.Pi=new hD(this),this.indexManager=new X5,this.remoteDocumentCache=(function(d){return new uD(d)})((a=>this.referenceDelegate.Ti(a))),this.serializer=new H5(t),this.Ii=new aD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new sD,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let a=this.ui[e.toKey()];return a||(a=new lD(t,this.referenceDelegate),this.ui[e.toKey()]=a),a}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,a){gn("MemoryPersistence","Starting transaction:",e);const d=new dD(this.ci.next());return this.referenceDelegate.Ei(),a(d).next((m=>this.referenceDelegate.di(d).next((()=>m)))).toPromise().then((m=>(d.raiseOnCommittedEvent(),m)))}Ai(e,t){return zt.or(Object.values(this.ui).map((a=>()=>a.containsKey(e,t))))}}class dD extends Fk{constructor(e){super(),this.currentSequenceNumber=e}}class $1{constructor(e){this.persistence=e,this.Ri=new q1,this.Vi=null}static mi(e){return new $1(e)}get fi(){if(this.Vi)return this.Vi;throw Hn(60996)}addReference(e,t,a){return this.Ri.addReference(a,t),this.fi.delete(a.toString()),zt.resolve()}removeReference(e,t,a){return this.Ri.removeReference(a,t),this.fi.add(a.toString()),zt.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),zt.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((d=>this.fi.add(d.toString())));const a=this.persistence.getTargetCache();return a.getMatchingKeysForTargetId(e,t.targetId).next((d=>{d.forEach((m=>this.fi.add(m.toString())))})).next((()=>a.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return zt.forEach(this.fi,(a=>{const d=On.fromPath(a);return this.gi(e,d).next((m=>{m||t.removeEntry(d,ti.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((a=>{a?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return zt.or([()=>zt.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class T0{constructor(e,t){this.persistence=e,this.pi=new tm((a=>jk(a.path)),((a,d)=>a.isEqual(d))),this.garbageCollector=tD(this,t)}static mi(e,t){return new T0(e,t)}Ei(){}di(e){return zt.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((a=>t.next((d=>a+d))))}wr(e){let t=0;return this.pr(e,(a=>{t++})).next((()=>t))}pr(e,t){return zt.forEach(this.pi,((a,d)=>this.br(e,a,d).next((m=>m?zt.resolve():t(d)))))}removeTargets(e,t,a){return this.persistence.getTargetCache().removeTargets(e,t,a)}removeOrphanedDocuments(e,t){let a=0;const d=this.persistence.getRemoteDocumentCache(),m=d.newChangeBuffer();return d.ii(e,(_=>this.br(e,_,t).next((c=>{c||(a++,m.removeEntry(_,ti.min()))})))).next((()=>m.apply(e))).next((()=>a))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),zt.resolve()}removeTarget(e,t){const a=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,a)}addReference(e,t,a){return this.pi.set(a,e.currentSequenceNumber),zt.resolve()}removeReference(e,t,a){return this.pi.set(a,e.currentSequenceNumber),zt.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),zt.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Xv(e.data.value)),t}br(e,t,a){return zt.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const d=this.pi.get(t);return zt.resolve(d!==void 0&&d>a)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1{constructor(e,t,a,d){this.targetId=e,this.fromCache=t,this.Es=a,this.ds=d}static As(e,t){let a=Bi(),d=Bi();for(const m of t.docChanges)switch(m.type){case 0:a=a.add(m.doc.key);break;case 1:d=d.add(m.doc.key)}return new G1(e,t.fromCache,a,d)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return rL()?8:Vk(Ml())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,a,d){const m={result:null};return this.ys(e,t).next((_=>{m.result=_})).next((()=>{if(!m.result)return this.ws(e,t,d,a).next((_=>{m.result=_}))})).next((()=>{if(m.result)return;const _=new fD;return this.Ss(e,t,_).next((c=>{if(m.result=c,this.Vs)return this.bs(e,t,_,c.size)}))})).next((()=>m.result))}bs(e,t,a,d){return a.documentReadCount<this.fs?(Zm()<=Oi.DEBUG&&gn("QueryEngine","SDK will not create cache indexes for query:",Hm(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),zt.resolve()):(Zm()<=Oi.DEBUG&&gn("QueryEngine","Query:",Hm(t),"scans",a.documentReadCount,"local documents and returns",d,"documents as results."),a.documentReadCount>this.gs*d?(Zm()<=Oi.DEBUG&&gn("QueryEngine","The SDK decides to create cache indexes for query:",Hm(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Fh(t))):zt.resolve())}ys(e,t){if(Y2(t))return zt.resolve(null);let a=Fh(t);return this.indexManager.getIndexType(e,a).next((d=>d===0?null:(t.limit!==null&&d===1&&(t=jx(t,null,"F"),a=Fh(t)),this.indexManager.getDocumentsMatchingTarget(e,a).next((m=>{const _=Bi(...m);return this.ps.getDocuments(e,_).next((c=>this.indexManager.getMinOffset(e,a).next((C=>{const k=this.Ds(t,c);return this.Cs(t,k,_,C.readTime)?this.ys(e,jx(t,null,"F")):this.vs(e,k,t,C)}))))})))))}ws(e,t,a,d){return Y2(t)||d.isEqual(ti.min())?zt.resolve(null):this.ps.getDocuments(e,a).next((m=>{const _=this.Ds(t,m);return this.Cs(t,_,a,d)?zt.resolve(null):(Zm()<=Oi.DEBUG&&gn("QueryEngine","Re-using previous result from %s to execute query: %s",d.toString(),Hm(t)),this.vs(e,_,t,zk(d,ry)).next((c=>c)))}))}Ds(e,t){let a=new ro(CA(e));return t.forEach(((d,m)=>{J0(e,m)&&(a=a.add(m))})),a}Cs(e,t,a,d){if(e.limit===null)return!1;if(a.size!==t.size)return!0;const m=e.limitType==="F"?t.last():t.first();return!!m&&(m.hasPendingWrites||m.version.compareTo(d)>0)}Ss(e,t,a){return Zm()<=Oi.DEBUG&&gn("QueryEngine","Using full collection scan to execute query:",Hm(t)),this.ps.getDocumentsMatchingQuery(e,t,Bf.min(),a)}vs(e,t,a,d){return this.ps.getDocumentsMatchingQuery(e,a,d).next((m=>(t.forEach((_=>{m=m.insert(_.key,_)})),m)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z1="LocalStore",mD=3e8;class gD{constructor(e,t,a,d){this.persistence=e,this.Fs=t,this.serializer=d,this.Ms=new Fa(Ni),this.xs=new tm((m=>N1(m)),B1),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(a)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new rD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function _D(i,e,t,a){return new gD(i,e,t,a)}async function YA(i,e){const t=si(i);return await t.persistence.runTransaction("Handle user change","readonly",(a=>{let d;return t.mutationQueue.getAllMutationBatches(a).next((m=>(d=m,t.Bs(e),t.mutationQueue.getAllMutationBatches(a)))).next((m=>{const _=[],c=[];let C=Bi();for(const k of d){_.push(k.batchId);for(const V of k.mutations)C=C.add(V.key)}for(const k of m){c.push(k.batchId);for(const V of k.mutations)C=C.add(V.key)}return t.localDocuments.getDocuments(a,C).next((k=>({Ls:k,removedBatchIds:_,addedBatchIds:c})))}))}))}function yD(i,e){const t=si(i);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(a=>{const d=e.batch.keys(),m=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,C,k,V){const G=k.batch,ee=G.keys();let Y=zt.resolve();return ee.forEach((xe=>{Y=Y.next((()=>V.getEntry(C,xe))).next((be=>{const Ne=k.docVersions.get(xe);Cr(Ne!==null,48541),be.version.compareTo(Ne)<0&&(G.applyToRemoteDocument(be,k),be.isValidDocument()&&(be.setReadTime(k.commitVersion),V.addEntry(be)))}))})),Y.next((()=>c.mutationQueue.removeMutationBatch(C,G)))})(t,a,e,m).next((()=>m.apply(a))).next((()=>t.mutationQueue.performConsistencyCheck(a))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(a,d,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(a,(function(c){let C=Bi();for(let k=0;k<c.mutationResults.length;++k)c.mutationResults[k].transformResults.length>0&&(C=C.add(c.batch.mutations[k].key));return C})(e)))).next((()=>t.localDocuments.getDocuments(a,d)))}))}function QA(i){const e=si(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function vD(i,e){const t=si(i),a=e.snapshotVersion;let d=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(m=>{const _=t.Ns.newChangeBuffer({trackRemovals:!0});d=t.Ms;const c=[];e.targetChanges.forEach(((V,G)=>{const ee=d.get(G);if(!ee)return;c.push(t.Pi.removeMatchingKeys(m,V.removedDocuments,G).next((()=>t.Pi.addMatchingKeys(m,V.addedDocuments,G))));let Y=ee.withSequenceNumber(m.currentSequenceNumber);e.targetMismatches.get(G)!==null?Y=Y.withResumeToken(el.EMPTY_BYTE_STRING,ti.min()).withLastLimboFreeSnapshotVersion(ti.min()):V.resumeToken.approximateByteSize()>0&&(Y=Y.withResumeToken(V.resumeToken,a)),d=d.insert(G,Y),(function(be,Ne,tt){return be.resumeToken.approximateByteSize()===0||Ne.snapshotVersion.toMicroseconds()-be.snapshotVersion.toMicroseconds()>=mD?!0:tt.addedDocuments.size+tt.modifiedDocuments.size+tt.removedDocuments.size>0})(ee,Y,V)&&c.push(t.Pi.updateTargetData(m,Y))}));let C=jd(),k=Bi();if(e.documentUpdates.forEach((V=>{e.resolvedLimboDocuments.has(V)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(m,V))})),c.push(bD(m,_,e.documentUpdates).next((V=>{C=V.ks,k=V.qs}))),!a.isEqual(ti.min())){const V=t.Pi.getLastRemoteSnapshotVersion(m).next((G=>t.Pi.setTargetsMetadata(m,m.currentSequenceNumber,a)));c.push(V)}return zt.waitFor(c).next((()=>_.apply(m))).next((()=>t.localDocuments.getLocalViewOfDocuments(m,C,k))).next((()=>C))})).then((m=>(t.Ms=d,m)))}function bD(i,e,t){let a=Bi(),d=Bi();return t.forEach((m=>a=a.add(m))),e.getEntries(i,a).next((m=>{let _=jd();return t.forEach(((c,C)=>{const k=m.get(c);C.isFoundDocument()!==k.isFoundDocument()&&(d=d.add(c)),C.isNoDocument()&&C.version.isEqual(ti.min())?(e.removeEntry(c,C.readTime),_=_.insert(c,C)):!k.isValidDocument()||C.version.compareTo(k.version)>0||C.version.compareTo(k.version)===0&&k.hasPendingWrites?(e.addEntry(C),_=_.insert(c,C)):gn(Z1,"Ignoring outdated watch update for ",c,". Current version:",k.version," Watch version:",C.version)})),{ks:_,qs:d}}))}function xD(i,e){const t=si(i);return t.persistence.runTransaction("Get next mutation batch","readonly",(a=>(e===void 0&&(e=D1),t.mutationQueue.getNextMutationBatchAfterBatchId(a,e))))}function wD(i,e){const t=si(i);return t.persistence.runTransaction("Allocate target","readwrite",(a=>{let d;return t.Pi.getTargetData(a,e).next((m=>m?(d=m,zt.resolve(d)):t.Pi.allocateTargetId(a).next((_=>(d=new If(e,_,"TargetPurposeListen",a.currentSequenceNumber),t.Pi.addTargetData(a,d).next((()=>d)))))))})).then((a=>{const d=t.Ms.get(a.targetId);return(d===null||a.snapshotVersion.compareTo(d.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(a.targetId,a),t.xs.set(e,a.targetId)),a}))}async function Hx(i,e,t){const a=si(i),d=a.Ms.get(e),m=t?"readwrite":"readwrite-primary";try{t||await a.persistence.runTransaction("Release target",m,(_=>a.persistence.referenceDelegate.removeTarget(_,d)))}catch(_){if(!Sg(_))throw _;gn(Z1,`Failed to update sequence numbers for target ${e}: ${_}`)}a.Ms=a.Ms.remove(e),a.xs.delete(d.target)}function cT(i,e,t){const a=si(i);let d=ti.min(),m=Bi();return a.persistence.runTransaction("Execute query","readwrite",(_=>(function(C,k,V){const G=si(C),ee=G.xs.get(V);return ee!==void 0?zt.resolve(G.Ms.get(ee)):G.Pi.getTargetData(k,V)})(a,_,Fh(e)).next((c=>{if(c)return d=c.lastLimboFreeSnapshotVersion,a.Pi.getMatchingKeysForTargetId(_,c.targetId).next((C=>{m=C}))})).next((()=>a.Fs.getDocumentsMatchingQuery(_,e,t?d:ti.min(),t?m:Bi()))).next((c=>(TD(a,o5(e),c),{documents:c,Qs:m})))))}function TD(i,e,t){let a=i.Os.get(e)||ti.min();t.forEach(((d,m)=>{m.readTime.compareTo(a)>0&&(a=m.readTime)})),i.Os.set(e,a)}class hT{constructor(){this.activeTargetIds=f5()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class SD{constructor(){this.Mo=new hT,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,a){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,a){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new hT,Promise.resolve()}handleUserChange(e,t,a){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ED{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dT="ConnectivityMonitor";class fT{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){gn(dT,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){gn(dT,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ov=null;function Wx(){return Ov===null?Ov=(function(){return 268435456+Math.round(2147483648*Math.random())})():Ov++,"0x"+Ov.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ix="RestConnection",AD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class CD{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),d=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${a}/databases/${d}`,this.Wo=this.databaseId.database===_0?`project_id=${a}`:`project_id=${a}&database_id=${d}`}Go(e,t,a,d,m){const _=Wx(),c=this.zo(e,t.toUriEncodedString());gn(ix,`Sending RPC '${e}' ${_}:`,c,a);const C={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(C,d,m);const{host:k}=new URL(c),V=bg(k);return this.Jo(e,c,C,a,V).then((G=>(gn(ix,`Received RPC '${e}' ${_}: `,G),G)),(G=>{throw ug(ix,`RPC '${e}' ${_} failed with error: `,G,"url: ",c,"request:",a),G}))}Ho(e,t,a,d,m,_){return this.Go(e,t,a,d,m)}jo(e,t,a){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+wg})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((d,m)=>e[m]=d)),a&&a.headers.forEach(((d,m)=>e[m]=d))}zo(e,t){const a=AD[e];return`${this.Uo}/v1/${t}:${a}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Al="WebChannelConnection";class MD extends CD{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,a,d,m){const _=Wx();return new Promise(((c,C)=>{const k=new JE;k.setWithCredentials(!0),k.listenOnce(eA.COMPLETE,(()=>{try{switch(k.getLastErrorCode()){case Wv.NO_ERROR:const G=k.getResponseJson();gn(Al,`XHR for RPC '${e}' ${_} received:`,JSON.stringify(G)),c(G);break;case Wv.TIMEOUT:gn(Al,`RPC '${e}' ${_} timed out`),C(new _n(Dt.DEADLINE_EXCEEDED,"Request time out"));break;case Wv.HTTP_ERROR:const ee=k.getStatus();if(gn(Al,`RPC '${e}' ${_} failed with status:`,ee,"response text:",k.getResponseText()),ee>0){let Y=k.getResponseJson();Array.isArray(Y)&&(Y=Y[0]);const xe=Y==null?void 0:Y.error;if(xe&&xe.status&&xe.message){const be=(function(tt){const Je=tt.toLowerCase().replace(/_/g,"-");return Object.values(Dt).indexOf(Je)>=0?Je:Dt.UNKNOWN})(xe.status);C(new _n(be,xe.message))}else C(new _n(Dt.UNKNOWN,"Server responded with status "+k.getStatus()))}else C(new _n(Dt.UNAVAILABLE,"Connection failed."));break;default:Hn(9055,{l_:e,streamId:_,h_:k.getLastErrorCode(),P_:k.getLastError()})}}finally{gn(Al,`RPC '${e}' ${_} completed.`)}}));const V=JSON.stringify(d);gn(Al,`RPC '${e}' ${_} sending request:`,d),k.send(t,"POST",V,a,15)}))}T_(e,t,a){const d=Wx(),m=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],_=iA(),c=nA(),C={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},k=this.longPollingOptions.timeoutSeconds;k!==void 0&&(C.longPollingTimeout=Math.round(1e3*k)),this.useFetchStreams&&(C.useFetchStreams=!0),this.jo(C.initMessageHeaders,t,a),C.encodeInitMessageHeaders=!0;const V=m.join("");gn(Al,`Creating RPC '${e}' stream ${d}: ${V}`,C);const G=_.createWebChannel(V,C);this.I_(G);let ee=!1,Y=!1;const xe=new ID({Yo:Ne=>{Y?gn(Al,`Not sending because RPC '${e}' stream ${d} is closed:`,Ne):(ee||(gn(Al,`Opening RPC '${e}' stream ${d} transport.`),G.open(),ee=!0),gn(Al,`RPC '${e}' stream ${d} sending:`,Ne),G.send(Ne))},Zo:()=>G.close()}),be=(Ne,tt,Je)=>{Ne.listen(tt,(Xe=>{try{Je(Xe)}catch(Ke){setTimeout((()=>{throw Ke}),0)}}))};return be(G,O_.EventType.OPEN,(()=>{Y||(gn(Al,`RPC '${e}' stream ${d} transport opened.`),xe.o_())})),be(G,O_.EventType.CLOSE,(()=>{Y||(Y=!0,gn(Al,`RPC '${e}' stream ${d} transport closed`),xe.a_(),this.E_(G))})),be(G,O_.EventType.ERROR,(Ne=>{Y||(Y=!0,ug(Al,`RPC '${e}' stream ${d} transport errored. Name:`,Ne.name,"Message:",Ne.message),xe.a_(new _n(Dt.UNAVAILABLE,"The operation could not be completed")))})),be(G,O_.EventType.MESSAGE,(Ne=>{var tt;if(!Y){const Je=Ne.data[0];Cr(!!Je,16349);const Xe=Je,Ke=(Xe==null?void 0:Xe.error)||((tt=Xe[0])==null?void 0:tt.error);if(Ke){gn(Al,`RPC '${e}' stream ${d} received error:`,Ke);const Ge=Ke.status;let Fe=(function(ge){const Ae=ks[ge];if(Ae!==void 0)return FA(Ae)})(Ge),de=Ke.message;Fe===void 0&&(Fe=Dt.INTERNAL,de="Unknown error status: "+Ge+" with message "+Ke.message),Y=!0,xe.a_(new _n(Fe,de)),G.close()}else gn(Al,`RPC '${e}' stream ${d} received:`,Je),xe.u_(Je)}})),be(c,tA.STAT_EVENT,(Ne=>{Ne.stat===zx.PROXY?gn(Al,`RPC '${e}' stream ${d} detected buffering proxy`):Ne.stat===zx.NOPROXY&&gn(Al,`RPC '${e}' stream ${d} detected no buffering proxy`)})),setTimeout((()=>{xe.__()}),0),xe}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function rx(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ib(i){return new k5(i,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JA{constructor(e,t,a=1e3,d=1.5,m=6e4){this.Mi=e,this.timerId=t,this.d_=a,this.A_=d,this.R_=m,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),a=Math.max(0,Date.now()-this.f_),d=Math.max(0,t-a);d>0&&gn("ExponentialBackoff",`Backing off for ${d} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${a} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,d,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pT="PersistentStream";class eC{constructor(e,t,a,d,m,_,c,C){this.Mi=e,this.S_=a,this.b_=d,this.connection=m,this.authCredentialsProvider=_,this.appCheckCredentialsProvider=c,this.listener=C,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new JA(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Dt.RESOURCE_EXHAUSTED?(Ud(t.toString()),Ud("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Dt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([a,d])=>{this.D_===t&&this.G_(a,d)}),(a=>{e((()=>{const d=new _n(Dt.UNKNOWN,"Fetching auth token failed: "+a.message);return this.z_(d)}))}))}G_(e,t){const a=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{a((()=>this.listener.Xo()))})),this.stream.t_((()=>{a((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((d=>{a((()=>this.z_(d)))})),this.stream.onMessage((d=>{a((()=>++this.F_==1?this.J_(d):this.onNext(d)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return gn(pT,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(gn(pT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class PD extends eC{constructor(e,t,a,d,m,_){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,a,d,_),this.serializer=m}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=O5(this.serializer,e),a=(function(m){if(!("targetChange"in m))return ti.min();const _=m.targetChange;return _.targetIds&&_.targetIds.length?ti.min():_.readTime?Vh(_.readTime):ti.min()})(e);return this.listener.H_(t,a)}Y_(e){const t={};t.database=Zx(this.serializer),t.addTarget=(function(m,_){let c;const C=_.target;if(c=Vx(C)?{documents:F5(m,C)}:{query:V5(m,C).ft},c.targetId=_.targetId,_.resumeToken.approximateByteSize()>0){c.resumeToken=jA(m,_.resumeToken);const k=qx(m,_.expectedCount);k!==null&&(c.expectedCount=k)}else if(_.snapshotVersion.compareTo(ti.min())>0){c.readTime=w0(m,_.snapshotVersion.toTimestamp());const k=qx(m,_.expectedCount);k!==null&&(c.expectedCount=k)}return c})(this.serializer,e);const a=j5(this.serializer,e);a&&(t.labels=a),this.q_(t)}Z_(e){const t={};t.database=Zx(this.serializer),t.removeTarget=e,this.q_(t)}}class RD extends eC{constructor(e,t,a,d,m,_){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,a,d,_),this.serializer=m}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Cr(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Cr(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Cr(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=B5(e.writeResults,e.commitTime),a=Vh(e.commitTime);return this.listener.na(a,t)}ra(){const e={};e.database=Zx(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((a=>N5(this.serializer,a)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LD{}class kD extends LD{constructor(e,t,a,d){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=a,this.serializer=d,this.ia=!1}sa(){if(this.ia)throw new _n(Dt.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,a,d){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([m,_])=>this.connection.Go(e,$x(t,a),d,m,_))).catch((m=>{throw m.name==="FirebaseError"?(m.code===Dt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),m):new _n(Dt.UNKNOWN,m.toString())}))}Ho(e,t,a,d,m){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([_,c])=>this.connection.Ho(e,$x(t,a),d,_,c,m))).catch((_=>{throw _.name==="FirebaseError"?(_.code===Dt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),_):new _n(Dt.UNKNOWN,_.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class DD{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ud(t),this.aa=!1):gn("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gp="RemoteStore";class zD{constructor(e,t,a,d,m){this.localStore=e,this.datastore=t,this.asyncQueue=a,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=m,this.Aa.Oo((_=>{a.enqueueAndForget((async()=>{im(this)&&(gn(Gp,"Restarting streams for network reachability change."),await(async function(C){const k=si(C);k.Ea.add(4),await Ry(k),k.Ra.set("Unknown"),k.Ea.delete(4),await rb(k)})(this))}))})),this.Ra=new DD(a,d)}}async function rb(i){if(im(i))for(const e of i.da)await e(!0)}async function Ry(i){for(const e of i.da)await e(!1)}function tC(i,e){const t=si(i);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),K1(t)?X1(t):Eg(t).O_()&&W1(t,e))}function H1(i,e){const t=si(i),a=Eg(t);t.Ia.delete(e),a.O_()&&nC(t,e),t.Ia.size===0&&(a.O_()?a.L_():im(t)&&t.Ra.set("Unknown"))}function W1(i,e){if(i.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ti.min())>0){const t=i.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Eg(i).Y_(e)}function nC(i,e){i.Va.Ue(e),Eg(i).Z_(e)}function X1(i){i.Va=new M5({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),At:e=>i.Ia.get(e)||null,ht:()=>i.datastore.serializer.databaseId}),Eg(i).start(),i.Ra.ua()}function K1(i){return im(i)&&!Eg(i).x_()&&i.Ia.size>0}function im(i){return si(i).Ea.size===0}function iC(i){i.Va=void 0}async function OD(i){i.Ra.set("Online")}async function ND(i){i.Ia.forEach(((e,t)=>{W1(i,e)}))}async function BD(i,e){iC(i),K1(i)?(i.Ra.ha(e),X1(i)):i.Ra.set("Unknown")}async function FD(i,e,t){if(i.Ra.set("Online"),e instanceof UA&&e.state===2&&e.cause)try{await(async function(d,m){const _=m.cause;for(const c of m.targetIds)d.Ia.has(c)&&(await d.remoteSyncer.rejectListen(c,_),d.Ia.delete(c),d.Va.removeTarget(c))})(i,e)}catch(a){gn(Gp,"Failed to remove targets %s: %s ",e.targetIds.join(","),a),await S0(i,a)}else if(e instanceof Qv?i.Va.Ze(e):e instanceof VA?i.Va.st(e):i.Va.tt(e),!t.isEqual(ti.min()))try{const a=await QA(i.localStore);t.compareTo(a)>=0&&await(function(m,_){const c=m.Va.Tt(_);return c.targetChanges.forEach(((C,k)=>{if(C.resumeToken.approximateByteSize()>0){const V=m.Ia.get(k);V&&m.Ia.set(k,V.withResumeToken(C.resumeToken,_))}})),c.targetMismatches.forEach(((C,k)=>{const V=m.Ia.get(C);if(!V)return;m.Ia.set(C,V.withResumeToken(el.EMPTY_BYTE_STRING,V.snapshotVersion)),nC(m,C);const G=new If(V.target,C,k,V.sequenceNumber);W1(m,G)})),m.remoteSyncer.applyRemoteEvent(c)})(i,t)}catch(a){gn(Gp,"Failed to raise snapshot:",a),await S0(i,a)}}async function S0(i,e,t){if(!Sg(e))throw e;i.Ea.add(1),await Ry(i),i.Ra.set("Offline"),t||(t=()=>QA(i.localStore)),i.asyncQueue.enqueueRetryable((async()=>{gn(Gp,"Retrying IndexedDB access"),await t(),i.Ea.delete(1),await rb(i)}))}function rC(i,e){return e().catch((t=>S0(i,t,e)))}async function ab(i){const e=si(i),t=jf(e);let a=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:D1;for(;VD(e);)try{const d=await xD(e.localStore,a);if(d===null){e.Ta.length===0&&t.L_();break}a=d.batchId,UD(e,d)}catch(d){await S0(e,d)}aC(e)&&sC(e)}function VD(i){return im(i)&&i.Ta.length<10}function UD(i,e){i.Ta.push(e);const t=jf(i);t.O_()&&t.X_&&t.ea(e.mutations)}function aC(i){return im(i)&&!jf(i).x_()&&i.Ta.length>0}function sC(i){jf(i).start()}async function jD(i){jf(i).ra()}async function qD(i){const e=jf(i);for(const t of i.Ta)e.ea(t.mutations)}async function $D(i,e,t){const a=i.Ta.shift(),d=V1.from(a,e,t);await rC(i,(()=>i.remoteSyncer.applySuccessfulWrite(d))),await ab(i)}async function GD(i,e){e&&jf(i).X_&&await(async function(a,d){if((function(_){return A5(_)&&_!==Dt.ABORTED})(d.code)){const m=a.Ta.shift();jf(a).B_(),await rC(a,(()=>a.remoteSyncer.rejectFailedWrite(m.batchId,d))),await ab(a)}})(i,e),aC(i)&&sC(i)}async function mT(i,e){const t=si(i);t.asyncQueue.verifyOperationInProgress(),gn(Gp,"RemoteStore received new credentials");const a=im(t);t.Ea.add(3),await Ry(t),a&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await rb(t)}async function ZD(i,e){const t=si(i);e?(t.Ea.delete(2),await rb(t)):e||(t.Ea.add(2),await Ry(t),t.Ra.set("Unknown"))}function Eg(i){return i.ma||(i.ma=(function(t,a,d){const m=si(t);return m.sa(),new PD(a,m.connection,m.authCredentials,m.appCheckCredentials,m.serializer,d)})(i.datastore,i.asyncQueue,{Xo:OD.bind(null,i),t_:ND.bind(null,i),r_:BD.bind(null,i),H_:FD.bind(null,i)}),i.da.push((async e=>{e?(i.ma.B_(),K1(i)?X1(i):i.Ra.set("Unknown")):(await i.ma.stop(),iC(i))}))),i.ma}function jf(i){return i.fa||(i.fa=(function(t,a,d){const m=si(t);return m.sa(),new RD(a,m.connection,m.authCredentials,m.appCheckCredentials,m.serializer,d)})(i.datastore,i.asyncQueue,{Xo:()=>Promise.resolve(),t_:jD.bind(null,i),r_:GD.bind(null,i),ta:qD.bind(null,i),na:$D.bind(null,i)}),i.da.push((async e=>{e?(i.fa.B_(),await ab(i)):(await i.fa.stop(),i.Ta.length>0&&(gn(Gp,`Stopping write stream with ${i.Ta.length} pending writes`),i.Ta=[]))}))),i.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y1{constructor(e,t,a,d,m){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=a,this.op=d,this.removalCallback=m,this.deferred=new Df,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((_=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,a,d,m){const _=Date.now()+a,c=new Y1(e,t,_,d,m);return c.start(a),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new _n(Dt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Q1(i,e){if(Ud("AsyncQueue",`${e}: ${i}`),Sg(i))return new _n(Dt.UNAVAILABLE,`${e}: ${i}`);throw i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jm{static emptySet(e){return new Jm(e.comparator)}constructor(e){this.comparator=e?(t,a)=>e(t,a)||On.comparator(t.key,a.key):(t,a)=>On.comparator(t.key,a.key),this.keyedMap=N_(),this.sortedSet=new Fa(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,a)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Jm)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),a=e.sortedSet.getIterator();for(;t.hasNext();){const d=t.getNext().key,m=a.getNext().key;if(!d.isEqual(m))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const a=new Jm;return a.comparator=this.comparator,a.keyedMap=e,a.sortedSet=t,a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gT{constructor(){this.ga=new Fa(On.comparator)}track(e){const t=e.doc.key,a=this.ga.get(t);a?e.type!==0&&a.type===3?this.ga=this.ga.insert(t,e):e.type===3&&a.type!==1?this.ga=this.ga.insert(t,{type:a.type,doc:e.doc}):e.type===2&&a.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&a.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&a.type===0?this.ga=this.ga.remove(t):e.type===1&&a.type===2?this.ga=this.ga.insert(t,{type:1,doc:a.doc}):e.type===0&&a.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Hn(63341,{Rt:e,pa:a}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,a)=>{e.push(a)})),e}}class pg{constructor(e,t,a,d,m,_,c,C,k){this.query=e,this.docs=t,this.oldDocs=a,this.docChanges=d,this.mutatedKeys=m,this.fromCache=_,this.syncStateChanged=c,this.excludesMetadataChanges=C,this.hasCachedResults=k}static fromInitialDocuments(e,t,a,d,m){const _=[];return t.forEach((c=>{_.push({type:0,doc:c})})),new pg(e,t,Jm.emptySet(t),_,a,d,!0,!1,m)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Q0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,a=e.docChanges;if(t.length!==a.length)return!1;for(let d=0;d<t.length;d++)if(t[d].type!==a[d].type||!t[d].doc.isEqual(a[d].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HD{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class WD{constructor(){this.queries=_T(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,a){const d=si(t),m=d.queries;d.queries=_T(),m.forEach(((_,c)=>{for(const C of c.Sa)C.onError(a)}))})(this,new _n(Dt.ABORTED,"Firestore shutting down"))}}function _T(){return new tm((i=>AA(i)),Q0)}async function XD(i,e){const t=si(i);let a=3;const d=e.query;let m=t.queries.get(d);m?!m.ba()&&e.Da()&&(a=2):(m=new HD,a=e.Da()?0:1);try{switch(a){case 0:m.wa=await t.onListen(d,!0);break;case 1:m.wa=await t.onListen(d,!1);break;case 2:await t.onFirstRemoteStoreListen(d)}}catch(_){const c=Q1(_,`Initialization of query '${Hm(e.query)}' failed`);return void e.onError(c)}t.queries.set(d,m),m.Sa.push(e),e.va(t.onlineState),m.wa&&e.Fa(m.wa)&&J1(t)}async function KD(i,e){const t=si(i),a=e.query;let d=3;const m=t.queries.get(a);if(m){const _=m.Sa.indexOf(e);_>=0&&(m.Sa.splice(_,1),m.Sa.length===0?d=e.Da()?0:1:!m.ba()&&e.Da()&&(d=2))}switch(d){case 0:return t.queries.delete(a),t.onUnlisten(a,!0);case 1:return t.queries.delete(a),t.onUnlisten(a,!1);case 2:return t.onLastRemoteStoreUnlisten(a);default:return}}function YD(i,e){const t=si(i);let a=!1;for(const d of e){const m=d.query,_=t.queries.get(m);if(_){for(const c of _.Sa)c.Fa(d)&&(a=!0);_.wa=d}}a&&J1(t)}function QD(i,e,t){const a=si(i),d=a.queries.get(e);if(d)for(const m of d.Sa)m.onError(t);a.queries.delete(e)}function J1(i){i.Ca.forEach((e=>{e.next()}))}var Xx,yT;(yT=Xx||(Xx={})).Ma="default",yT.Cache="cache";class JD{constructor(e,t,a){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=a||{}}Fa(e){if(!this.options.includeMetadataChanges){const a=[];for(const d of e.docChanges)d.type!==3&&a.push(d);e=new pg(e.query,e.docs,e.oldDocs,a,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const a=t!=="Offline";return(!this.options.qa||!a)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=pg.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Xx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(e){this.key=e}}class lC{constructor(e){this.key=e}}class ez{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Bi(),this.mutatedKeys=Bi(),this.eu=CA(e),this.tu=new Jm(this.eu)}get nu(){return this.Ya}ru(e,t){const a=t?t.iu:new gT,d=t?t.tu:this.tu;let m=t?t.mutatedKeys:this.mutatedKeys,_=d,c=!1;const C=this.query.limitType==="F"&&d.size===this.query.limit?d.last():null,k=this.query.limitType==="L"&&d.size===this.query.limit?d.first():null;if(e.inorderTraversal(((V,G)=>{const ee=d.get(V),Y=J0(this.query,G)?G:null,xe=!!ee&&this.mutatedKeys.has(ee.key),be=!!Y&&(Y.hasLocalMutations||this.mutatedKeys.has(Y.key)&&Y.hasCommittedMutations);let Ne=!1;ee&&Y?ee.data.isEqual(Y.data)?xe!==be&&(a.track({type:3,doc:Y}),Ne=!0):this.su(ee,Y)||(a.track({type:2,doc:Y}),Ne=!0,(C&&this.eu(Y,C)>0||k&&this.eu(Y,k)<0)&&(c=!0)):!ee&&Y?(a.track({type:0,doc:Y}),Ne=!0):ee&&!Y&&(a.track({type:1,doc:ee}),Ne=!0,(C||k)&&(c=!0)),Ne&&(Y?(_=_.add(Y),m=be?m.add(V):m.delete(V)):(_=_.delete(V),m=m.delete(V)))})),this.query.limit!==null)for(;_.size>this.query.limit;){const V=this.query.limitType==="F"?_.last():_.first();_=_.delete(V.key),m=m.delete(V.key),a.track({type:1,doc:V})}return{tu:_,iu:a,Cs:c,mutatedKeys:m}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,a,d){const m=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const _=e.iu.ya();_.sort(((V,G)=>(function(Y,xe){const be=Ne=>{switch(Ne){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Hn(20277,{Rt:Ne})}};return be(Y)-be(xe)})(V.type,G.type)||this.eu(V.doc,G.doc))),this.ou(a),d=d??!1;const c=t&&!d?this._u():[],C=this.Xa.size===0&&this.current&&!d?1:0,k=C!==this.Za;return this.Za=C,_.length!==0||k?{snapshot:new pg(this.query,e.tu,m,_,e.mutatedKeys,C===0,k,!1,!!a&&a.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new gT,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Bi(),this.tu.forEach((a=>{this.uu(a.key)&&(this.Xa=this.Xa.add(a.key))}));const t=[];return e.forEach((a=>{this.Xa.has(a)||t.push(new lC(a))})),this.Xa.forEach((a=>{e.has(a)||t.push(new oC(a))})),t}cu(e){this.Ya=e.Qs,this.Xa=Bi();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return pg.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const ew="SyncEngine";class tz{constructor(e,t,a){this.query=e,this.targetId=t,this.view=a}}class nz{constructor(e){this.key=e,this.hu=!1}}class iz{constructor(e,t,a,d,m,_){this.localStore=e,this.remoteStore=t,this.eventManager=a,this.sharedClientState=d,this.currentUser=m,this.maxConcurrentLimboResolutions=_,this.Pu={},this.Tu=new tm((c=>AA(c)),Q0),this.Iu=new Map,this.Eu=new Set,this.du=new Fa(On.comparator),this.Au=new Map,this.Ru=new q1,this.Vu={},this.mu=new Map,this.fu=fg.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function rz(i,e,t=!0){const a=pC(i);let d;const m=a.Tu.get(e);return m?(a.sharedClientState.addLocalQueryTarget(m.targetId),d=m.view.lu()):d=await uC(a,e,t,!0),d}async function az(i,e){const t=pC(i);await uC(t,e,!0,!1)}async function uC(i,e,t,a){const d=await wD(i.localStore,Fh(e)),m=d.targetId,_=i.sharedClientState.addLocalQueryTarget(m,t);let c;return a&&(c=await sz(i,e,m,_==="current",d.resumeToken)),i.isPrimaryClient&&t&&tC(i.remoteStore,d),c}async function sz(i,e,t,a,d){i.pu=(G,ee,Y)=>(async function(be,Ne,tt,Je){let Xe=Ne.view.ru(tt);Xe.Cs&&(Xe=await cT(be.localStore,Ne.query,!1).then((({documents:de})=>Ne.view.ru(de,Xe))));const Ke=Je&&Je.targetChanges.get(Ne.targetId),Ge=Je&&Je.targetMismatches.get(Ne.targetId)!=null,Fe=Ne.view.applyChanges(Xe,be.isPrimaryClient,Ke,Ge);return bT(be,Ne.targetId,Fe.au),Fe.snapshot})(i,G,ee,Y);const m=await cT(i.localStore,e,!0),_=new ez(e,m.Qs),c=_.ru(m.documents),C=Py.createSynthesizedTargetChangeForCurrentChange(t,a&&i.onlineState!=="Offline",d),k=_.applyChanges(c,i.isPrimaryClient,C);bT(i,t,k.au);const V=new tz(e,t,_);return i.Tu.set(e,V),i.Iu.has(t)?i.Iu.get(t).push(e):i.Iu.set(t,[e]),k.snapshot}async function oz(i,e,t){const a=si(i),d=a.Tu.get(e),m=a.Iu.get(d.targetId);if(m.length>1)return a.Iu.set(d.targetId,m.filter((_=>!Q0(_,e)))),void a.Tu.delete(e);a.isPrimaryClient?(a.sharedClientState.removeLocalQueryTarget(d.targetId),a.sharedClientState.isActiveQueryTarget(d.targetId)||await Hx(a.localStore,d.targetId,!1).then((()=>{a.sharedClientState.clearQueryState(d.targetId),t&&H1(a.remoteStore,d.targetId),Kx(a,d.targetId)})).catch(Tg)):(Kx(a,d.targetId),await Hx(a.localStore,d.targetId,!0))}async function lz(i,e){const t=si(i),a=t.Tu.get(e),d=t.Iu.get(a.targetId);t.isPrimaryClient&&d.length===1&&(t.sharedClientState.removeLocalQueryTarget(a.targetId),H1(t.remoteStore,a.targetId))}async function uz(i,e,t){const a=gz(i);try{const d=await(function(_,c){const C=si(_),k=ha.now(),V=c.reduce(((Y,xe)=>Y.add(xe.key)),Bi());let G,ee;return C.persistence.runTransaction("Locally write mutations","readwrite",(Y=>{let xe=jd(),be=Bi();return C.Ns.getEntries(Y,V).next((Ne=>{xe=Ne,xe.forEach(((tt,Je)=>{Je.isValidDocument()||(be=be.add(tt))}))})).next((()=>C.localDocuments.getOverlayedDocuments(Y,xe))).next((Ne=>{G=Ne;const tt=[];for(const Je of c){const Xe=x5(Je,G.get(Je.key).overlayedDocument);Xe!=null&&tt.push(new nm(Je.key,Xe,_A(Xe.value.mapValue),Od.exists(!0)))}return C.mutationQueue.addMutationBatch(Y,k,tt,c)})).next((Ne=>{ee=Ne;const tt=Ne.applyToLocalDocumentSet(G,be);return C.documentOverlayCache.saveOverlays(Y,Ne.batchId,tt)}))})).then((()=>({batchId:ee.batchId,changes:MA(G)})))})(a.localStore,e);a.sharedClientState.addPendingMutation(d.batchId),(function(_,c,C){let k=_.Vu[_.currentUser.toKey()];k||(k=new Fa(Ni)),k=k.insert(c,C),_.Vu[_.currentUser.toKey()]=k})(a,d.batchId,t),await Ly(a,d.changes),await ab(a.remoteStore)}catch(d){const m=Q1(d,"Failed to persist write");t.reject(m)}}async function cC(i,e){const t=si(i);try{const a=await vD(t.localStore,e);e.targetChanges.forEach(((d,m)=>{const _=t.Au.get(m);_&&(Cr(d.addedDocuments.size+d.modifiedDocuments.size+d.removedDocuments.size<=1,22616),d.addedDocuments.size>0?_.hu=!0:d.modifiedDocuments.size>0?Cr(_.hu,14607):d.removedDocuments.size>0&&(Cr(_.hu,42227),_.hu=!1))})),await Ly(t,a,e)}catch(a){await Tg(a)}}function vT(i,e,t){const a=si(i);if(a.isPrimaryClient&&t===0||!a.isPrimaryClient&&t===1){const d=[];a.Tu.forEach(((m,_)=>{const c=_.view.va(e);c.snapshot&&d.push(c.snapshot)})),(function(_,c){const C=si(_);C.onlineState=c;let k=!1;C.queries.forEach(((V,G)=>{for(const ee of G.Sa)ee.va(c)&&(k=!0)})),k&&J1(C)})(a.eventManager,e),d.length&&a.Pu.H_(d),a.onlineState=e,a.isPrimaryClient&&a.sharedClientState.setOnlineState(e)}}async function cz(i,e,t){const a=si(i);a.sharedClientState.updateQueryState(e,"rejected",t);const d=a.Au.get(e),m=d&&d.key;if(m){let _=new Fa(On.comparator);_=_.insert(m,Il.newNoDocument(m,ti.min()));const c=Bi().add(m),C=new nb(ti.min(),new Map,new Fa(Ni),_,c);await cC(a,C),a.du=a.du.remove(m),a.Au.delete(e),tw(a)}else await Hx(a.localStore,e,!1).then((()=>Kx(a,e,t))).catch(Tg)}async function hz(i,e){const t=si(i),a=e.batch.batchId;try{const d=await yD(t.localStore,e);dC(t,a,null),hC(t,a),t.sharedClientState.updateMutationState(a,"acknowledged"),await Ly(t,d)}catch(d){await Tg(d)}}async function dz(i,e,t){const a=si(i);try{const d=await(function(_,c){const C=si(_);return C.persistence.runTransaction("Reject batch","readwrite-primary",(k=>{let V;return C.mutationQueue.lookupMutationBatch(k,c).next((G=>(Cr(G!==null,37113),V=G.keys(),C.mutationQueue.removeMutationBatch(k,G)))).next((()=>C.mutationQueue.performConsistencyCheck(k))).next((()=>C.documentOverlayCache.removeOverlaysForBatchId(k,V,c))).next((()=>C.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(k,V))).next((()=>C.localDocuments.getDocuments(k,V)))}))})(a.localStore,e);dC(a,e,t),hC(a,e),a.sharedClientState.updateMutationState(e,"rejected",t),await Ly(a,d)}catch(d){await Tg(d)}}function hC(i,e){(i.mu.get(e)||[]).forEach((t=>{t.resolve()})),i.mu.delete(e)}function dC(i,e,t){const a=si(i);let d=a.Vu[a.currentUser.toKey()];if(d){const m=d.get(e);m&&(t?m.reject(t):m.resolve(),d=d.remove(e)),a.Vu[a.currentUser.toKey()]=d}}function Kx(i,e,t=null){i.sharedClientState.removeLocalQueryTarget(e);for(const a of i.Iu.get(e))i.Tu.delete(a),t&&i.Pu.yu(a,t);i.Iu.delete(e),i.isPrimaryClient&&i.Ru.jr(e).forEach((a=>{i.Ru.containsKey(a)||fC(i,a)}))}function fC(i,e){i.Eu.delete(e.path.canonicalString());const t=i.du.get(e);t!==null&&(H1(i.remoteStore,t),i.du=i.du.remove(e),i.Au.delete(t),tw(i))}function bT(i,e,t){for(const a of t)a instanceof oC?(i.Ru.addReference(a.key,e),fz(i,a)):a instanceof lC?(gn(ew,"Document no longer in limbo: "+a.key),i.Ru.removeReference(a.key,e),i.Ru.containsKey(a.key)||fC(i,a.key)):Hn(19791,{wu:a})}function fz(i,e){const t=e.key,a=t.path.canonicalString();i.du.get(t)||i.Eu.has(a)||(gn(ew,"New document in limbo: "+t),i.Eu.add(a),tw(i))}function tw(i){for(;i.Eu.size>0&&i.du.size<i.maxConcurrentLimboResolutions;){const e=i.Eu.values().next().value;i.Eu.delete(e);const t=new On(ea.fromString(e)),a=i.fu.next();i.Au.set(a,new nz(t)),i.du=i.du.insert(t,a),tC(i.remoteStore,new If(Fh(SA(t.path)),a,"TargetPurposeLimboResolution",X0.ce))}}async function Ly(i,e,t){const a=si(i),d=[],m=[],_=[];a.Tu.isEmpty()||(a.Tu.forEach(((c,C)=>{_.push(a.pu(C,e,t).then((k=>{var V;if((k||t)&&a.isPrimaryClient){const G=k?!k.fromCache:(V=t==null?void 0:t.targetChanges.get(C.targetId))==null?void 0:V.current;a.sharedClientState.updateQueryState(C.targetId,G?"current":"not-current")}if(k){d.push(k);const G=G1.As(C.targetId,k);m.push(G)}})))})),await Promise.all(_),a.Pu.H_(d),await(async function(C,k){const V=si(C);try{await V.persistence.runTransaction("notifyLocalViewChanges","readwrite",(G=>zt.forEach(k,(ee=>zt.forEach(ee.Es,(Y=>V.persistence.referenceDelegate.addReference(G,ee.targetId,Y))).next((()=>zt.forEach(ee.ds,(Y=>V.persistence.referenceDelegate.removeReference(G,ee.targetId,Y)))))))))}catch(G){if(!Sg(G))throw G;gn(Z1,"Failed to update sequence numbers: "+G)}for(const G of k){const ee=G.targetId;if(!G.fromCache){const Y=V.Ms.get(ee),xe=Y.snapshotVersion,be=Y.withLastLimboFreeSnapshotVersion(xe);V.Ms=V.Ms.insert(ee,be)}}})(a.localStore,m))}async function pz(i,e){const t=si(i);if(!t.currentUser.isEqual(e)){gn(ew,"User change. New user:",e.toKey());const a=await YA(t.localStore,e);t.currentUser=e,(function(m,_){m.mu.forEach((c=>{c.forEach((C=>{C.reject(new _n(Dt.CANCELLED,_))}))})),m.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,a.removedBatchIds,a.addedBatchIds),await Ly(t,a.Ls)}}function mz(i,e){const t=si(i),a=t.Au.get(e);if(a&&a.hu)return Bi().add(a.key);{let d=Bi();const m=t.Iu.get(e);if(!m)return d;for(const _ of m){const c=t.Tu.get(_);d=d.unionWith(c.view.nu)}return d}}function pC(i){const e=si(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=cC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=mz.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=cz.bind(null,e),e.Pu.H_=YD.bind(null,e.eventManager),e.Pu.yu=QD.bind(null,e.eventManager),e}function gz(i){const e=si(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=hz.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=dz.bind(null,e),e}class E0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ib(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return _D(this.persistence,new pD,e.initialUser,this.serializer)}Cu(e){return new KA($1.mi,this.serializer)}Du(e){return new SD}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}E0.provider={build:()=>new E0};class _z extends E0{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Cr(this.persistence.referenceDelegate instanceof T0,46915);const a=this.persistence.referenceDelegate.garbageCollector;return new J5(a,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?ou.withCacheSize(this.cacheSizeBytes):ou.DEFAULT;return new KA((a=>T0.mi(a,t)),this.serializer)}}class Yx{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=a=>vT(this.syncEngine,a,1),this.remoteStore.remoteSyncer.handleCredentialChange=pz.bind(null,this.syncEngine),await ZD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new WD})()}createDatastore(e){const t=ib(e.databaseInfo.databaseId),a=(function(m){return new MD(m)})(e.databaseInfo);return(function(m,_,c,C){return new kD(m,_,c,C)})(e.authCredentials,e.appCheckCredentials,a,t)}createRemoteStore(e){return(function(a,d,m,_,c){return new zD(a,d,m,_,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>vT(this.syncEngine,t,0)),(function(){return fT.v()?new fT:new ED})())}createSyncEngine(e,t){return(function(d,m,_,c,C,k,V){const G=new iz(d,m,_,c,C,k);return V&&(G.gu=!0),G})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(d){const m=si(d);gn(Gp,"RemoteStore shutting down."),m.Ea.add(5),await Ry(m),m.Aa.shutdown(),m.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Yx.provider={build:()=>new Yx};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yz{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ud("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qf="FirestoreClient";class vz{constructor(e,t,a,d,m){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=a,this.databaseInfo=d,this.user=Cl.UNAUTHENTICATED,this.clientId=k1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=m,this.authCredentials.start(a,(async _=>{gn(qf,"Received user=",_.uid),await this.authCredentialListener(_),this.user=_})),this.appCheckCredentials.start(a,(_=>(gn(qf,"Received new app check token=",_),this.appCheckCredentialListener(_,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Df;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const a=Q1(t,"Failed to shutdown persistence");e.reject(a)}})),e.promise}}async function ax(i,e){i.asyncQueue.verifyOperationInProgress(),gn(qf,"Initializing OfflineComponentProvider");const t=i.configuration;await e.initialize(t);let a=t.initialUser;i.setCredentialChangeListener((async d=>{a.isEqual(d)||(await YA(e.localStore,d),a=d)})),e.persistence.setDatabaseDeletedListener((()=>i.terminate())),i._offlineComponents=e}async function xT(i,e){i.asyncQueue.verifyOperationInProgress();const t=await bz(i);gn(qf,"Initializing OnlineComponentProvider"),await e.initialize(t,i.configuration),i.setCredentialChangeListener((a=>mT(e.remoteStore,a))),i.setAppCheckTokenChangeListener(((a,d)=>mT(e.remoteStore,d))),i._onlineComponents=e}async function bz(i){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){gn(qf,"Using user provided OfflineComponentProvider");try{await ax(i,i._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(d){return d.name==="FirebaseError"?d.code===Dt.FAILED_PRECONDITION||d.code===Dt.UNIMPLEMENTED:!(typeof DOMException<"u"&&d instanceof DOMException)||d.code===22||d.code===20||d.code===11})(t))throw t;ug("Error using user provided cache. Falling back to memory cache: "+t),await ax(i,new E0)}}else gn(qf,"Using default OfflineComponentProvider"),await ax(i,new _z(void 0));return i._offlineComponents}async function mC(i){return i._onlineComponents||(i._uninitializedComponentsProvider?(gn(qf,"Using user provided OnlineComponentProvider"),await xT(i,i._uninitializedComponentsProvider._online)):(gn(qf,"Using default OnlineComponentProvider"),await xT(i,new Yx))),i._onlineComponents}function xz(i){return mC(i).then((e=>e.syncEngine))}async function wz(i){const e=await mC(i),t=e.eventManager;return t.onListen=rz.bind(null,e.syncEngine),t.onUnlisten=oz.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=az.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=lz.bind(null,e.syncEngine),t}function Tz(i,e,t={}){const a=new Df;return i.asyncQueue.enqueueAndForget((async()=>(function(m,_,c,C,k){const V=new yz({next:ee=>{V.Nu(),_.enqueueAndForget((()=>KD(m,G))),ee.fromCache&&C.source==="server"?k.reject(new _n(Dt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):k.resolve(ee)},error:ee=>k.reject(ee)}),G=new JD(c,V,{includeMetadataChanges:!0,qa:!0});return XD(m,G)})(await wz(i),i.asyncQueue,e,t,a))),a.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gC(i){const e={};return i.timeoutSeconds!==void 0&&(e.timeoutSeconds=i.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wT=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _C="firestore.googleapis.com",TT=!0;class ST{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new _n(Dt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=_C,this.ssl=TT}else this.host=e.host,this.ssl=e.ssl??TT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=XA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Y5)throw new _n(Dt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Dk("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=gC(e.experimentalLongPollingOptions??{}),(function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new _n(Dt.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new _n(Dt.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new _n(Dt.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(a,d){return a.timeoutSeconds===d.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class sb{constructor(e,t,a,d){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=a,this._app=d,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ST({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new _n(Dt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new _n(Dt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ST(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(a){if(!a)return new Sk;switch(a.type){case"firstParty":return new Ik(a.sessionIndex||"0",a.iamToken||null,a.authTokenFactory||null);case"provider":return a.client;default:throw new _n(Dt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const a=wT.get(t);a&&(gn("ComponentProvider","Removing Datastore"),wT.delete(t),a.terminate())})(this),Promise.resolve()}}function Sz(i,e,t,a={}){var k;i=m0(i,sb);const d=bg(e),m=i._getSettings(),_={...m,emulatorOptions:i._getEmulatorOptions()},c=`${e}:${t}`;d&&(UE(`https://${c}`),jE("Firestore",!0)),m.host!==_C&&m.host!==c&&ug("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const C={...m,host:c,ssl:d,emulatorOptions:a};if(!Nf(C,_)&&(i._setSettings(C),a.mockUserToken)){let V,G;if(typeof a.mockUserToken=="string")V=a.mockUserToken,G=Cl.MOCK_USER;else{V=KR(a.mockUserToken,(k=i._app)==null?void 0:k.options.projectId);const ee=a.mockUserToken.sub||a.mockUserToken.user_id;if(!ee)throw new _n(Dt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");G=new Cl(ee)}i._authCredentials=new Ek(new aA(V,G))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(e,t,a){this.converter=t,this._query=a,this.type="query",this.firestore=e}withConverter(e){return new Ag(this.firestore,e,this._query)}}class bo{constructor(e,t,a){this.converter=t,this._key=a,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new zf(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new bo(this.firestore,e,this._key)}toJSON(){return{type:bo._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,a){if(Cy(t,bo._jsonSchema))return new bo(e,a||null,new On(ea.fromString(t.referencePath)))}}bo._jsonSchemaVersion="firestore/documentReference/1.0",bo._jsonSchema={type:zs("string",bo._jsonSchemaVersion),referencePath:zs("string")};class zf extends Ag{constructor(e,t,a){super(e,t,SA(a)),this._path=a,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new bo(this.firestore,null,new On(e))}withConverter(e){return new zf(this.firestore,e,this._path)}}function yC(i,e,...t){if(i=ql(i),sA("collection","path",e),i instanceof sb){const a=ea.fromString(e,...t);return N2(a),new zf(i,null,a)}{if(!(i instanceof bo||i instanceof zf))throw new _n(Dt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=i._path.child(ea.fromString(e,...t));return N2(a),new zf(i.firestore,null,a)}}function Ez(i,e,...t){if(i=ql(i),arguments.length===1&&(e=k1.newId()),sA("doc","path",e),i instanceof sb){const a=ea.fromString(e,...t);return O2(a),new bo(i,null,new On(a))}{if(!(i instanceof bo||i instanceof zf))throw new _n(Dt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=i._path.child(ea.fromString(e,...t));return O2(a),new bo(i.firestore,i instanceof zf?i.converter:null,new On(a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ET="AsyncQueue";class AT{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new JA(this,"async_queue_retry"),this._c=()=>{const a=rx();a&&gn(ET,"Visibility state changed to "+a.visibilityState),this.M_.w_()},this.ac=e;const t=rx();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=rx();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Df;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Sg(e))throw e;gn(ET,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((a=>{throw this.nc=a,this.rc=!1,Ud("INTERNAL UNHANDLED ERROR: ",CT(a)),a})).then((a=>(this.rc=!1,a))))));return this.ac=t,t}enqueueAfterDelay(e,t,a){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const d=Y1.createAndSchedule(this,e,t,a,(m=>this.hc(m)));return this.tc.push(d),d}uc(){this.nc&&Hn(47125,{Pc:CT(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,a)=>t.targetTimeMs-a.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function CT(i){let e=i.message||"";return i.stack&&(e=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),e}class nw extends sb{constructor(e,t,a,d){super(e,t,a,d),this.type="firestore",this._queue=new AT,this._persistenceKey=(d==null?void 0:d.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new AT(e),this._firestoreClient=void 0,await e}}}function Az(i,e){const t=typeof i=="object"?i:R1(),a=typeof i=="string"?i:_0,d=Jp(t,"firestore").getImmediate({identifier:a});if(!d._initialized){const m=WR("firestore");m&&Sz(d,...m)}return d}function vC(i){if(i._terminated)throw new _n(Dt.FAILED_PRECONDITION,"The client has already been terminated.");return i._firestoreClient||Cz(i),i._firestoreClient}function Cz(i){var a,d,m;const e=i._freezeSettings(),t=(function(c,C,k,V){return new Gk(c,C,k,V.host,V.ssl,V.experimentalForceLongPolling,V.experimentalAutoDetectLongPolling,gC(V.experimentalLongPollingOptions),V.useFetchStreams,V.isUsingEmulator)})(i._databaseId,((a=i._app)==null?void 0:a.options.appId)||"",i._persistenceKey,e);i._componentsProvider||(d=e.localCache)!=null&&d._offlineComponentProvider&&((m=e.localCache)!=null&&m._onlineComponentProvider)&&(i._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),i._firestoreClient=new vz(i._authCredentials,i._appCheckCredentials,i._queue,t,i._componentsProvider&&(function(c){const C=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(C),_online:C}})(i._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ac(el.fromBase64String(e))}catch(t){throw new _n(Dt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ac(el.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ac._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Cy(e,Ac._jsonSchema))return Ac.fromBase64String(e.bytes)}}Ac._jsonSchemaVersion="firestore/bytes/1.0",Ac._jsonSchema={type:zs("string",Ac._jsonSchemaVersion),bytes:zs("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iw{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new _n(Dt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Jo(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rw{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new _n(Dt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new _n(Dt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ni(this._lat,e._lat)||Ni(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Uh._jsonSchemaVersion}}static fromJSON(e){if(Cy(e,Uh._jsonSchema))return new Uh(e.latitude,e.longitude)}}Uh._jsonSchemaVersion="firestore/geoPoint/1.0",Uh._jsonSchema={type:zs("string",Uh._jsonSchemaVersion),latitude:zs("number"),longitude:zs("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jh{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(a,d){if(a.length!==d.length)return!1;for(let m=0;m<a.length;++m)if(a[m]!==d[m])return!1;return!0})(this._values,e._values)}toJSON(){return{type:jh._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Cy(e,jh._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new jh(e.vectorValues);throw new _n(Dt.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}jh._jsonSchemaVersion="firestore/vectorValue/1.0",jh._jsonSchema={type:zs("string",jh._jsonSchemaVersion),vectorValues:zs("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iz=/^__.*__$/;class Mz{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return this.fieldMask!==null?new nm(e,this.data,this.fieldMask,t,this.fieldTransforms):new My(e,this.data,t,this.fieldTransforms)}}function bC(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Hn(40011,{Ac:i})}}class aw{constructor(e,t,a,d,m,_){this.settings=e,this.databaseId=t,this.serializer=a,this.ignoreUndefinedProperties=d,m===void 0&&this.Rc(),this.fieldTransforms=m||[],this.fieldMask=_||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new aw({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var d;const t=(d=this.path)==null?void 0:d.child(e),a=this.Vc({path:t,fc:!1});return a.gc(e),a}yc(e){var d;const t=(d=this.path)==null?void 0:d.child(e),a=this.Vc({path:t,fc:!1});return a.Rc(),a}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return A0(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(bC(this.Ac)&&Iz.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Pz{constructor(e,t,a){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=a||ib(e)}Cc(e,t,a,d=!1){return new aw({Ac:e,methodName:t,Dc:a,path:Jo.emptyPath(),fc:!1,bc:d},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function xC(i){const e=i._freezeSettings(),t=ib(i._databaseId);return new Pz(i._databaseId,!!e.ignoreUndefinedProperties,t)}function Rz(i,e,t,a,d,m={}){const _=i.Cc(m.merge||m.mergeFields?2:0,e,t,d);SC("Data must be an object, but it was:",_,a);const c=wC(a,_);let C,k;if(m.merge)C=new th(_.fieldMask),k=_.fieldTransforms;else if(m.mergeFields){const V=[];for(const G of m.mergeFields){const ee=kz(e,G,t);if(!_.contains(ee))throw new _n(Dt.INVALID_ARGUMENT,`Field '${ee}' is specified in your field mask but missing from your input data.`);zz(V,ee)||V.push(ee)}C=new th(V),k=_.fieldTransforms.filter((G=>C.covers(G.field)))}else C=null,k=_.fieldTransforms;return new Mz(new Ec(c),C,k)}class sw extends rw{_toFieldTransform(e){return new _5(e.path,new ly)}isEqual(e){return e instanceof sw}}function Lz(i,e,t,a=!1){return ow(t,i.Cc(a?4:3,e))}function ow(i,e){if(TC(i=ql(i)))return SC("Unsupported field value:",e,i),wC(i,e);if(i instanceof rw)return(function(a,d){if(!bC(d.Ac))throw d.Sc(`${a._methodName}() can only be used with update() and set()`);if(!d.path)throw d.Sc(`${a._methodName}() is not currently supported inside arrays`);const m=a._toFieldTransform(d);m&&d.fieldTransforms.push(m)})(i,e),null;if(i===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(a,d){const m=[];let _=0;for(const c of a){let C=ow(c,d.wc(_));C==null&&(C={nullValue:"NULL_VALUE"}),m.push(C),_++}return{arrayValue:{values:m}}})(i,e)}return(function(a,d){if((a=ql(a))===null)return{nullValue:"NULL_VALUE"};if(typeof a=="number")return p5(d.serializer,a);if(typeof a=="boolean")return{booleanValue:a};if(typeof a=="string")return{stringValue:a};if(a instanceof Date){const m=ha.fromDate(a);return{timestampValue:w0(d.serializer,m)}}if(a instanceof ha){const m=new ha(a.seconds,1e3*Math.floor(a.nanoseconds/1e3));return{timestampValue:w0(d.serializer,m)}}if(a instanceof Uh)return{geoPointValue:{latitude:a.latitude,longitude:a.longitude}};if(a instanceof Ac)return{bytesValue:jA(d.serializer,a._byteString)};if(a instanceof bo){const m=d.databaseId,_=a.firestore._databaseId;if(!_.isEqual(m))throw d.Sc(`Document reference is for database ${_.projectId}/${_.database} but should be for database ${m.projectId}/${m.database}`);return{referenceValue:j1(a.firestore._databaseId||d.databaseId,a._key.path)}}if(a instanceof jh)return(function(_,c){return{mapValue:{fields:{[mA]:{stringValue:gA},[y0]:{arrayValue:{values:_.toArray().map((k=>{if(typeof k!="number")throw c.Sc("VectorValues must only contain numeric values.");return F1(c.serializer,k)}))}}}}}})(a,d);throw d.Sc(`Unsupported field value: ${W0(a)}`)})(i,e)}function wC(i,e){const t={};return uA(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):em(i,((a,d)=>{const m=ow(d,e.mc(a));m!=null&&(t[a]=m)})),{mapValue:{fields:t}}}function TC(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof ha||i instanceof Uh||i instanceof Ac||i instanceof bo||i instanceof rw||i instanceof jh)}function SC(i,e,t){if(!TC(t)||!oA(t)){const a=W0(t);throw a==="an object"?e.Sc(i+" a custom object"):e.Sc(i+" "+a)}}function kz(i,e,t){if((e=ql(e))instanceof iw)return e._internalPath;if(typeof e=="string")return EC(i,e);throw A0("Field path arguments must be of type string or ",i,!1,void 0,t)}const Dz=new RegExp("[~\\*/\\[\\]]");function EC(i,e,t){if(e.search(Dz)>=0)throw A0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,t);try{return new iw(...e.split("."))._internalPath}catch{throw A0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,t)}}function A0(i,e,t,a,d){const m=a&&!a.isEmpty(),_=d!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let C="";return(m||_)&&(C+=" (found",m&&(C+=` in field ${a}`),_&&(C+=` in document ${d}`),C+=")"),new _n(Dt.INVALID_ARGUMENT,c+i+C)}function zz(i,e){return i.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AC{constructor(e,t,a,d,m){this._firestore=e,this._userDataWriter=t,this._key=a,this._document=d,this._converter=m}get id(){return this._key.path.lastSegment()}get ref(){return new bo(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Oz(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(CC("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Oz extends AC{data(){return super.data()}}function CC(i,e){return typeof e=="string"?EC(i,e):e instanceof iw?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nz(i){if(i.limitType==="L"&&i.explicitOrderBy.length===0)throw new _n(Dt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class lw{}class Bz extends lw{}function Fz(i,e,...t){let a=[];e instanceof lw&&a.push(e),a=a.concat(t),(function(m){const _=m.filter((C=>C instanceof cw)).length,c=m.filter((C=>C instanceof uw)).length;if(_>1||_>0&&c>0)throw new _n(Dt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(a);for(const d of a)i=d._apply(i);return i}class uw extends Bz{constructor(e,t,a){super(),this._field=e,this._op=t,this._value=a,this.type="where"}static _create(e,t,a){return new uw(e,t,a)}_apply(e){const t=this._parse(e);return IC(e._query,t),new Ag(e.firestore,e.converter,Ux(e._query,t))}_parse(e){const t=xC(e.firestore);return(function(m,_,c,C,k,V,G){let ee;if(k.isKeyField()){if(V==="array-contains"||V==="array-contains-any")throw new _n(Dt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${V}' queries on documentId().`);if(V==="in"||V==="not-in"){MT(G,V);const xe=[];for(const be of G)xe.push(IT(C,m,be));ee={arrayValue:{values:xe}}}else ee=IT(C,m,G)}else V!=="in"&&V!=="not-in"&&V!=="array-contains-any"||MT(G,V),ee=Lz(c,_,G,V==="in"||V==="not-in");return Ds.create(k,V,ee)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class cw extends lw{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new cw(e,t)}_parse(e){const t=this._queryConstraints.map((a=>a._parse(e))).filter((a=>a.getFilters().length>0));return t.length===1?t[0]:oh.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(d,m){let _=d;const c=m.getFlattenedFilters();for(const C of c)IC(_,C),_=Ux(_,C)})(e._query,t),new Ag(e.firestore,e.converter,Ux(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function IT(i,e,t){if(typeof(t=ql(t))=="string"){if(t==="")throw new _n(Dt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!EA(e)&&t.indexOf("/")!==-1)throw new _n(Dt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const a=e.path.child(ea.fromString(t));if(!On.isDocumentKey(a))throw new _n(Dt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${a}' is not because it has an odd number of segments (${a.length}).`);return G2(i,new On(a))}if(t instanceof bo)return G2(i,t._key);throw new _n(Dt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${W0(t)}.`)}function MT(i,e){if(!Array.isArray(i)||i.length===0)throw new _n(Dt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function IC(i,e){const t=(function(d,m){for(const _ of d)for(const c of _.getFlattenedFilters())if(m.indexOf(c.op)>=0)return c.op;return null})(i.filters,(function(d){switch(d){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new _n(Dt.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new _n(Dt.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Vz{convertValue(e,t="none"){switch(Uf(e)){case 0:return null;case 1:return e.booleanValue;case 2:return hs(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Vf(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Hn(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const a={};return em(e,((d,m)=>{a[d]=this.convertValue(m,t)})),a}convertVectorValue(e){var a,d,m;const t=(m=(d=(a=e.fields)==null?void 0:a[y0].arrayValue)==null?void 0:d.values)==null?void 0:m.map((_=>hs(_.doubleValue)));return new jh(t)}convertGeoPoint(e){return new Uh(hs(e.latitude),hs(e.longitude))}convertArray(e,t){return(e.values||[]).map((a=>this.convertValue(a,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const a=Y0(e);return a==null?null:this.convertValue(a,t);case"estimate":return this.convertTimestamp(ay(e));default:return null}}convertTimestamp(e){const t=Ff(e);return new ha(t.seconds,t.nanos)}convertDocumentKey(e,t){const a=ea.fromString(e);Cr(WA(a),9688,{name:e});const d=new sy(a.get(1),a.get(3)),m=new On(a.popFirst(5));return d.isEqual(t)||Ud(`Document ${m} contains a document reference within a different database (${d.projectId}/${d.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uz(i,e,t){let a;return a=i?i.toFirestore(e):e,a}class Nv{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class eg extends AC{constructor(e,t,a,d,m,_){super(e,t,a,d,_),this._firestore=e,this._firestoreImpl=e,this.metadata=m}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Jv(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const a=this._document.data.field(CC("DocumentSnapshot.get",e));if(a!==null)return this._userDataWriter.convertValue(a,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new _n(Dt.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=eg._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}eg._jsonSchemaVersion="firestore/documentSnapshot/1.0",eg._jsonSchema={type:zs("string",eg._jsonSchemaVersion),bundleSource:zs("string","DocumentSnapshot"),bundleName:zs("string"),bundle:zs("string")};class Jv extends eg{data(e={}){return super.data(e)}}class tg{constructor(e,t,a,d){this._firestore=e,this._userDataWriter=t,this._snapshot=d,this.metadata=new Nv(d.hasPendingWrites,d.fromCache),this.query=a}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((a=>{e.call(t,new Jv(this._firestore,this._userDataWriter,a.key,a,new Nv(this._snapshot.mutatedKeys.has(a.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new _n(Dt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(d,m){if(d._snapshot.oldDocs.isEmpty()){let _=0;return d._snapshot.docChanges.map((c=>{const C=new Jv(d._firestore,d._userDataWriter,c.doc.key,c.doc,new Nv(d._snapshot.mutatedKeys.has(c.doc.key),d._snapshot.fromCache),d.query.converter);return c.doc,{type:"added",doc:C,oldIndex:-1,newIndex:_++}}))}{let _=d._snapshot.oldDocs;return d._snapshot.docChanges.filter((c=>m||c.type!==3)).map((c=>{const C=new Jv(d._firestore,d._userDataWriter,c.doc.key,c.doc,new Nv(d._snapshot.mutatedKeys.has(c.doc.key),d._snapshot.fromCache),d.query.converter);let k=-1,V=-1;return c.type!==0&&(k=_.indexOf(c.doc.key),_=_.delete(c.doc.key)),c.type!==1&&(_=_.add(c.doc),V=_.indexOf(c.doc.key)),{type:jz(c.type),doc:C,oldIndex:k,newIndex:V}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new _n(Dt.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=tg._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=k1.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],a=[],d=[];return this.docs.forEach((m=>{m._document!==null&&(t.push(m._document),a.push(this._userDataWriter.convertObjectMap(m._document.data.value.mapValue.fields,"previous")),d.push(m.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function jz(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Hn(61501,{type:i})}}tg._jsonSchemaVersion="firestore/querySnapshot/1.0",tg._jsonSchema={type:zs("string",tg._jsonSchemaVersion),bundleSource:zs("string","QuerySnapshot"),bundleName:zs("string"),bundle:zs("string")};class qz extends Vz{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ac(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new bo(this.firestore,null,t)}}function $z(i){i=m0(i,Ag);const e=m0(i.firestore,nw),t=vC(e),a=new qz(e);return Nz(i._query),Tz(t,i._query).then((d=>new tg(e,a,i,d)))}function Gz(i,e){const t=m0(i.firestore,nw),a=Ez(i),d=Uz(i.converter,e);return Zz(t,[Rz(xC(i.firestore),"addDoc",a._key,d,i.converter!==null,{}).toMutation(a._key,Od.exists(!1))]).then((()=>a))}function Zz(i,e){return(function(a,d){const m=new Df;return a.asyncQueue.enqueueAndForget((async()=>uz(await xz(a),d,m))),m.promise})(vC(i),e)}function PT(){return new sw("serverTimestamp")}(function(e,t=!0){(function(d){wg=d})(xg),Kh(new sh("firestore",((a,{instanceIdentifier:d,options:m})=>{const _=a.getProvider("app").getImmediate(),c=new nw(new Ak(a.getProvider("auth-internal")),new Mk(_,a.getProvider("app-check-internal")),(function(k,V){if(!Object.prototype.hasOwnProperty.apply(k.options,["projectId"]))throw new _n(Dt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new sy(k.options.projectId,V)})(_,d),_);return m={useFetchStreams:t,...m},c._setSettings(m),c}),"PUBLIC").setMultipleInstances(!0)),Rc(L2,k2,e),Rc(L2,k2,"esm2020")})();var Hz="firebase",Wz="12.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Rc(Hz,Wz,"app");function MC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Xz=MC,PC=new Qp("auth","Firebase",MC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C0=new H0("@firebase/auth");function Kz(i,...e){C0.logLevel<=Oi.WARN&&C0.warn(`Auth (${xg}): ${i}`,...e)}function e0(i,...e){C0.logLevel<=Oi.ERROR&&C0.error(`Auth (${xg}): ${i}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qd(i,...e){throw hw(i,...e)}function qh(i,...e){return hw(i,...e)}function RC(i,e,t){const a={...Xz(),[e]:t};return new Qp("auth","Firebase",a).create(e,{appName:i.name})}function Op(i){return RC(i,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function hw(i,...e){if(typeof i!="string"){const t=e[0],a=[...e.slice(1)];return a[0]&&(a[0].appName=i.name),i._errorFactory.create(t,...a)}return PC.create(i,...e)}function Jn(i,e,...t){if(!i)throw hw(e,...t)}function kd(i){const e="INTERNAL ASSERTION FAILED: "+i;throw e0(e),new Error(e)}function $d(i,e){i||kd(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qx(){var i;return typeof self<"u"&&((i=self.location)==null?void 0:i.href)||""}function Yz(){return RT()==="http:"||RT()==="https:"}function RT(){var i;return typeof self<"u"&&((i=self.location)==null?void 0:i.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qz(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Yz()||qE()||"connection"in navigator)?navigator.onLine:!0}function Jz(){if(typeof navigator>"u")return null;const i=navigator;return i.languages&&i.languages[0]||i.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ky{constructor(e,t){this.shortDelay=e,this.longDelay=t,$d(t>e,"Short delay should be less than long delay!"),this.isMobile=JR()||nL()}get(){return Qz()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dw(i,e){$d(i.emulator,"Emulator should always be set here");const{url:t}=i.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LC{static initialize(e,t,a){this.fetchImpl=e,t&&(this.headersImpl=t),a&&(this.responseImpl=a)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;kd("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;kd("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;kd("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e3={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t3=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],n3=new ky(3e4,6e4);function fw(i,e){return i.tenantId&&!e.tenantId?{...e,tenantId:i.tenantId}:e}async function Cg(i,e,t,a,d={}){return kC(i,d,async()=>{let m={},_={};a&&(e==="GET"?_=a:m={body:JSON.stringify(a)});const c=Ay({key:i.config.apiKey,..._}).slice(1),C=await i._getAdditionalHeaders();C["Content-Type"]="application/json",i.languageCode&&(C["X-Firebase-Locale"]=i.languageCode);const k={method:e,headers:C,...m};return tL()||(k.referrerPolicy="no-referrer"),i.emulatorConfig&&bg(i.emulatorConfig.host)&&(k.credentials="include"),LC.fetch()(await DC(i,i.config.apiHost,t,c),k)})}async function kC(i,e,t){i._canInitEmulator=!1;const a={...e3,...e};try{const d=new r3(i),m=await Promise.race([t(),d.promise]);d.clearNetworkTimeout();const _=await m.json();if("needConfirmation"in _)throw Bv(i,"account-exists-with-different-credential",_);if(m.ok&&!("errorMessage"in _))return _;{const c=m.ok?_.errorMessage:_.error.message,[C,k]=c.split(" : ");if(C==="FEDERATED_USER_ID_ALREADY_LINKED")throw Bv(i,"credential-already-in-use",_);if(C==="EMAIL_EXISTS")throw Bv(i,"email-already-in-use",_);if(C==="USER_DISABLED")throw Bv(i,"user-disabled",_);const V=a[C]||C.toLowerCase().replace(/[_\s]+/g,"-");if(k)throw RC(i,V,k);qd(i,V)}}catch(d){if(d instanceof lh)throw d;qd(i,"network-request-failed",{message:String(d)})}}async function i3(i,e,t,a,d={}){const m=await Cg(i,e,t,a,d);return"mfaPendingCredential"in m&&qd(i,"multi-factor-auth-required",{_serverResponse:m}),m}async function DC(i,e,t,a){const d=`${e}${t}?${a}`,m=i,_=m.config.emulator?dw(i.config,d):`${i.config.apiScheme}://${d}`;return t3.includes(t)&&(await m._persistenceManagerAvailable,m._getPersistenceType()==="COOKIE")?m._getPersistence()._getFinalTarget(_).toString():_}class r3{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,a)=>{this.timer=setTimeout(()=>a(qh(this.auth,"network-request-failed")),n3.get())})}}function Bv(i,e,t){const a={appName:i.name};t.email&&(a.email=t.email),t.phoneNumber&&(a.phoneNumber=t.phoneNumber);const d=qh(i,e,a);return d.customData._tokenResponse=t,d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function a3(i,e){return Cg(i,"POST","/v1/accounts:delete",e)}async function I0(i,e){return Cg(i,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K_(i){if(i)try{const e=new Date(Number(i));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function s3(i,e=!1){const t=ql(i),a=await t.getIdToken(e),d=pw(a);Jn(d&&d.exp&&d.auth_time&&d.iat,t.auth,"internal-error");const m=typeof d.firebase=="object"?d.firebase:void 0,_=m==null?void 0:m.sign_in_provider;return{claims:d,token:a,authTime:K_(sx(d.auth_time)),issuedAtTime:K_(sx(d.iat)),expirationTime:K_(sx(d.exp)),signInProvider:_||null,signInSecondFactor:(m==null?void 0:m.sign_in_second_factor)||null}}function sx(i){return Number(i)*1e3}function pw(i){const[e,t,a]=i.split(".");if(e===void 0||t===void 0||a===void 0)return e0("JWT malformed, contained fewer than 3 sections"),null;try{const d=NE(t);return d?JSON.parse(d):(e0("Failed to decode base64 JWT payload"),null)}catch(d){return e0("Caught error parsing JWT payload as JSON",d==null?void 0:d.toString()),null}}function LT(i){const e=pw(i);return Jn(e,"internal-error"),Jn(typeof e.exp<"u","internal-error"),Jn(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hy(i,e,t=!1){if(t)return e;try{return await e}catch(a){throw a instanceof lh&&o3(a)&&i.auth.currentUser===i&&await i.auth.signOut(),a}}function o3({code:i}){return i==="auth/user-disabled"||i==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l3{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const a=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jx{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=K_(this.lastLoginAt),this.creationTime=K_(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M0(i){var G;const e=i.auth,t=await i.getIdToken(),a=await hy(i,I0(e,{idToken:t}));Jn(a==null?void 0:a.users.length,e,"internal-error");const d=a.users[0];i._notifyReloadListener(d);const m=(G=d.providerUserInfo)!=null&&G.length?zC(d.providerUserInfo):[],_=c3(i.providerData,m),c=i.isAnonymous,C=!(i.email&&d.passwordHash)&&!(_!=null&&_.length),k=c?C:!1,V={uid:d.localId,displayName:d.displayName||null,photoURL:d.photoUrl||null,email:d.email||null,emailVerified:d.emailVerified||!1,phoneNumber:d.phoneNumber||null,tenantId:d.tenantId||null,providerData:_,metadata:new Jx(d.createdAt,d.lastLoginAt),isAnonymous:k};Object.assign(i,V)}async function u3(i){const e=ql(i);await M0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function c3(i,e){return[...i.filter(a=>!e.some(d=>d.providerId===a.providerId)),...e]}function zC(i){return i.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function h3(i,e){const t=await kC(i,{},async()=>{const a=Ay({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:d,apiKey:m}=i.config,_=await DC(i,d,"/v1/token",`key=${m}`),c=await i._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const C={method:"POST",headers:c,body:a};return i.emulatorConfig&&bg(i.emulatorConfig.host)&&(C.credentials="include"),LC.fetch()(_,C)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function d3(i,e){return Cg(i,"POST","/v2/accounts:revokeToken",fw(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Jn(e.idToken,"internal-error"),Jn(typeof e.idToken<"u","internal-error"),Jn(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):LT(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Jn(e.length!==0,"internal-error");const t=LT(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Jn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:a,refreshToken:d,expiresIn:m}=await h3(e,t);this.updateTokensAndExpiration(a,d,Number(m))}updateTokensAndExpiration(e,t,a){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+a*1e3}static fromJSON(e,t){const{refreshToken:a,accessToken:d,expirationTime:m}=t,_=new ng;return a&&(Jn(typeof a=="string","internal-error",{appName:e}),_.refreshToken=a),d&&(Jn(typeof d=="string","internal-error",{appName:e}),_.accessToken=d),m&&(Jn(typeof m=="number","internal-error",{appName:e}),_.expirationTime=m),_}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ng,this.toJSON())}_performRefresh(){return kd("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wf(i,e){Jn(typeof i=="string"||typeof i>"u","internal-error",{appName:e})}class nh{constructor({uid:e,auth:t,stsTokenManager:a,...d}){this.providerId="firebase",this.proactiveRefresh=new l3(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=d.displayName||null,this.email=d.email||null,this.emailVerified=d.emailVerified||!1,this.phoneNumber=d.phoneNumber||null,this.photoURL=d.photoURL||null,this.isAnonymous=d.isAnonymous||!1,this.tenantId=d.tenantId||null,this.providerData=d.providerData?[...d.providerData]:[],this.metadata=new Jx(d.createdAt||void 0,d.lastLoginAt||void 0)}async getIdToken(e){const t=await hy(this,this.stsTokenManager.getToken(this.auth,e));return Jn(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return s3(this,e)}reload(){return u3(this)}_assign(e){this!==e&&(Jn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new nh({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Jn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let a=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),a=!0),t&&await M0(this),await this.auth._persistUserIfCurrent(this),a&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Nh(this.auth.app))return Promise.reject(Op(this.auth));const e=await this.getIdToken();return await hy(this,a3(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const a=t.displayName??void 0,d=t.email??void 0,m=t.phoneNumber??void 0,_=t.photoURL??void 0,c=t.tenantId??void 0,C=t._redirectEventId??void 0,k=t.createdAt??void 0,V=t.lastLoginAt??void 0,{uid:G,emailVerified:ee,isAnonymous:Y,providerData:xe,stsTokenManager:be}=t;Jn(G&&be,e,"internal-error");const Ne=ng.fromJSON(this.name,be);Jn(typeof G=="string",e,"internal-error"),wf(a,e.name),wf(d,e.name),Jn(typeof ee=="boolean",e,"internal-error"),Jn(typeof Y=="boolean",e,"internal-error"),wf(m,e.name),wf(_,e.name),wf(c,e.name),wf(C,e.name),wf(k,e.name),wf(V,e.name);const tt=new nh({uid:G,auth:e,email:d,emailVerified:ee,displayName:a,isAnonymous:Y,photoURL:_,phoneNumber:m,tenantId:c,stsTokenManager:Ne,createdAt:k,lastLoginAt:V});return xe&&Array.isArray(xe)&&(tt.providerData=xe.map(Je=>({...Je}))),C&&(tt._redirectEventId=C),tt}static async _fromIdTokenResponse(e,t,a=!1){const d=new ng;d.updateFromServerResponse(t);const m=new nh({uid:t.localId,auth:e,stsTokenManager:d,isAnonymous:a});return await M0(m),m}static async _fromGetAccountInfoResponse(e,t,a){const d=t.users[0];Jn(d.localId!==void 0,"internal-error");const m=d.providerUserInfo!==void 0?zC(d.providerUserInfo):[],_=!(d.email&&d.passwordHash)&&!(m!=null&&m.length),c=new ng;c.updateFromIdToken(a);const C=new nh({uid:d.localId,auth:e,stsTokenManager:c,isAnonymous:_}),k={uid:d.localId,displayName:d.displayName||null,photoURL:d.photoUrl||null,email:d.email||null,emailVerified:d.emailVerified||!1,phoneNumber:d.phoneNumber||null,tenantId:d.tenantId||null,providerData:m,metadata:new Jx(d.createdAt,d.lastLoginAt),isAnonymous:!(d.email&&d.passwordHash)&&!(m!=null&&m.length)};return Object.assign(C,k),C}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kT=new Map;function Dd(i){$d(i instanceof Function,"Expected a class definition");let e=kT.get(i);return e?($d(e instanceof i,"Instance stored in cache mismatched with class"),e):(e=new i,kT.set(i,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}OC.type="NONE";const DT=OC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t0(i,e,t){return`firebase:${i}:${e}:${t}`}class ig{constructor(e,t,a){this.persistence=e,this.auth=t,this.userKey=a;const{config:d,name:m}=this.auth;this.fullUserKey=t0(this.userKey,d.apiKey,m),this.fullPersistenceKey=t0("persistence",d.apiKey,m),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await I0(this.auth,{idToken:e}).catch(()=>{});return t?nh._fromGetAccountInfoResponse(this.auth,t,e):null}return nh._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,a="authUser"){if(!t.length)return new ig(Dd(DT),e,a);const d=(await Promise.all(t.map(async k=>{if(await k._isAvailable())return k}))).filter(k=>k);let m=d[0]||Dd(DT);const _=t0(a,e.config.apiKey,e.name);let c=null;for(const k of t)try{const V=await k._get(_);if(V){let G;if(typeof V=="string"){const ee=await I0(e,{idToken:V}).catch(()=>{});if(!ee)break;G=await nh._fromGetAccountInfoResponse(e,ee,V)}else G=nh._fromJSON(e,V);k!==m&&(c=G),m=k;break}}catch{}const C=d.filter(k=>k._shouldAllowMigration);return!m._shouldAllowMigration||!C.length?new ig(m,e,a):(m=C[0],c&&await m._set(_,c.toJSON()),await Promise.all(t.map(async k=>{if(k!==m)try{await k._remove(_)}catch{}})),new ig(m,e,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zT(i){const e=i.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(VC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(NC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(jC(e))return"Blackberry";if(qC(e))return"Webos";if(BC(e))return"Safari";if((e.includes("chrome/")||FC(e))&&!e.includes("edge/"))return"Chrome";if(UC(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,a=i.match(t);if((a==null?void 0:a.length)===2)return a[1]}return"Other"}function NC(i=Ml()){return/firefox\//i.test(i)}function BC(i=Ml()){const e=i.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function FC(i=Ml()){return/crios\//i.test(i)}function VC(i=Ml()){return/iemobile/i.test(i)}function UC(i=Ml()){return/android/i.test(i)}function jC(i=Ml()){return/blackberry/i.test(i)}function qC(i=Ml()){return/webos/i.test(i)}function mw(i=Ml()){return/iphone|ipad|ipod/i.test(i)||/macintosh/i.test(i)&&/mobile/i.test(i)}function f3(i=Ml()){var e;return mw(i)&&!!((e=window.navigator)!=null&&e.standalone)}function p3(){return iL()&&document.documentMode===10}function $C(i=Ml()){return mw(i)||UC(i)||qC(i)||jC(i)||/windows phone/i.test(i)||VC(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GC(i,e=[]){let t;switch(i){case"Browser":t=zT(Ml());break;case"Worker":t=`${zT(Ml())}-${i}`;break;default:t=i}const a=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${xg}/${a}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m3{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const a=m=>new Promise((_,c)=>{try{const C=e(m);_(C)}catch(C){c(C)}});a.onAbort=t,this.queue.push(a);const d=this.queue.length-1;return()=>{this.queue[d]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const a of this.queue)await a(e),a.onAbort&&t.push(a.onAbort)}catch(a){t.reverse();for(const d of t)try{d()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:a==null?void 0:a.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g3(i,e={}){return Cg(i,"GET","/v2/passwordPolicy",fw(i,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _3=6;class y3{constructor(e){var a;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??_3,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((a=e.allowedNonAlphanumericCharacters)==null?void 0:a.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const a=this.customStrengthOptions.minPasswordLength,d=this.customStrengthOptions.maxPasswordLength;a&&(t.meetsMinPasswordLength=e.length>=a),d&&(t.meetsMaxPasswordLength=e.length<=d)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let a;for(let d=0;d<e.length;d++)a=e.charAt(d),this.updatePasswordCharacterOptionsStatuses(t,a>="a"&&a<="z",a>="A"&&a<="Z",a>="0"&&a<="9",this.allowedNonAlphanumericCharacters.includes(a))}updatePasswordCharacterOptionsStatuses(e,t,a,d,m){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=a)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=d)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v3{constructor(e,t,a,d){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=a,this.config=d,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new OT(this),this.idTokenSubscription=new OT(this),this.beforeStateQueue=new m3(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=PC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=d.sdkClientVersion,this._persistenceManagerAvailable=new Promise(m=>this._resolvePersistenceManagerAvailable=m)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Dd(t)),this._initializationPromise=this.queue(async()=>{var a,d,m;if(!this._deleted&&(this.persistenceManager=await ig.create(this,e),(a=this._resolvePersistenceManagerAvailable)==null||a.call(this),!this._deleted)){if((d=this._popupRedirectResolver)!=null&&d._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((m=this.currentUser)==null?void 0:m.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await I0(this,{idToken:e}),a=await nh._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(a)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var m;if(Nh(this.app)){const _=this.app.settings.authIdToken;return _?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(_).then(c,c))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let a=t,d=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const _=(m=this.redirectUser)==null?void 0:m._redirectEventId,c=a==null?void 0:a._redirectEventId,C=await this.tryRedirectSignIn(e);(!_||_===c)&&(C!=null&&C.user)&&(a=C.user,d=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(d)try{await this.beforeStateQueue.runMiddleware(a)}catch(_){a=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(_))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return Jn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await M0(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Jz()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Nh(this.app))return Promise.reject(Op(this));const t=e?ql(e):null;return t&&Jn(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Jn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Nh(this.app)?Promise.reject(Op(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Nh(this.app)?Promise.reject(Op(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Dd(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await g3(this),t=new y3(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Qp("auth","Firebase",e())}onAuthStateChanged(e,t,a){return this.registerStateListener(this.authStateSubscription,e,t,a)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,a){return this.registerStateListener(this.idTokenSubscription,e,t,a)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const a=this.onAuthStateChanged(()=>{a(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),a={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(a.tenantId=this.tenantId),await d3(this,a)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const a=await this.getOrInitRedirectPersistenceManager(t);return e===null?a.removeCurrentUser():a.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Dd(e)||this._popupRedirectResolver;Jn(t,this,"argument-error"),this.redirectPersistenceManager=await ig.create(this,[Dd(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,a;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((a=this.redirectUser)==null?void 0:a._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,a,d){if(this._deleted)return()=>{};const m=typeof t=="function"?t:t.next.bind(t);let _=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(Jn(c,this,"internal-error"),c.then(()=>{_||m(this.currentUser)}),typeof t=="function"){const C=e.addObserver(t,a,d);return()=>{_=!0,C()}}else{const C=e.addObserver(t);return()=>{_=!0,C()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Jn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=GC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var d;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((d=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:d.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const a=await this._getAppCheckToken();return a&&(e["X-Firebase-AppCheck"]=a),e}async _getAppCheckToken(){var t;if(Nh(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&Kz(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function gw(i){return ql(i)}class OT{constructor(e){this.auth=e,this.observer=null,this.addObserver=cL(t=>this.observer=t)}get next(){return Jn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _w={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function b3(i){_w=i}function x3(i){return _w.loadJS(i)}function w3(){return _w.gapiScript}function T3(i){return`__${i}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S3(i,e){const t=Jp(i,"auth");if(t.isInitialized()){const d=t.getImmediate(),m=t.getOptions();if(Nf(m,e??{}))return d;qd(d,"already-initialized")}return t.initialize({options:e})}function E3(i,e){const t=(e==null?void 0:e.persistence)||[],a=(Array.isArray(t)?t:[t]).map(Dd);e!=null&&e.errorMap&&i._updateErrorMap(e.errorMap),i._initializeWithPersistence(a,e==null?void 0:e.popupRedirectResolver)}function A3(i,e,t){const a=gw(i);Jn(/^https?:\/\//.test(e),a,"invalid-emulator-scheme");const d=!1,m=ZC(e),{host:_,port:c}=C3(e),C=c===null?"":`:${c}`,k={url:`${m}//${_}${C}/`},V=Object.freeze({host:_,port:c,protocol:m.replace(":",""),options:Object.freeze({disableWarnings:d})});if(!a._canInitEmulator){Jn(a.config.emulator&&a.emulatorConfig,a,"emulator-config-failed"),Jn(Nf(k,a.config.emulator)&&Nf(V,a.emulatorConfig),a,"emulator-config-failed");return}a.config.emulator=k,a.emulatorConfig=V,a.settings.appVerificationDisabledForTesting=!0,bg(_)?(UE(`${m}//${_}${C}`),jE("Auth",!0)):I3()}function ZC(i){const e=i.indexOf(":");return e<0?"":i.substr(0,e+1)}function C3(i){const e=ZC(i),t=/(\/\/)?([^?#/]+)/.exec(i.substr(e.length));if(!t)return{host:"",port:null};const a=t[2].split("@").pop()||"",d=/^(\[[^\]]+\])(:|$)/.exec(a);if(d){const m=d[1];return{host:m,port:NT(a.substr(m.length+1))}}else{const[m,_]=a.split(":");return{host:m,port:NT(_)}}}function NT(i){if(!i)return null;const e=Number(i);return isNaN(e)?null:e}function I3(){function i(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",i):i())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return kd("not implemented")}_getIdTokenResponse(e){return kd("not implemented")}_linkToIdToken(e,t){return kd("not implemented")}_getReauthenticationResolver(e){return kd("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rg(i,e){return i3(i,"POST","/v1/accounts:signInWithIdp",fw(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M3="http://localhost";class Zp extends HC{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Zp(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):qd("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:a,signInMethod:d,...m}=t;if(!a||!d)return null;const _=new Zp(a,d);return _.idToken=m.idToken||void 0,_.accessToken=m.accessToken||void 0,_.secret=m.secret,_.nonce=m.nonce,_.pendingToken=m.pendingToken||null,_}_getIdTokenResponse(e){const t=this.buildRequest();return rg(e,t)}_linkToIdToken(e,t){const a=this.buildRequest();return a.idToken=t,rg(e,a)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,rg(e,t)}buildRequest(){const e={requestUri:M3,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ay(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WC{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dy extends WC{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf extends Dy{constructor(){super("facebook.com")}static credential(e){return Zp._fromParams({providerId:Sf.PROVIDER_ID,signInMethod:Sf.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Sf.credentialFromTaggedObject(e)}static credentialFromError(e){return Sf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Sf.credential(e.oauthAccessToken)}catch{return null}}}Sf.FACEBOOK_SIGN_IN_METHOD="facebook.com";Sf.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef extends Dy{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Zp._fromParams({providerId:Ef.PROVIDER_ID,signInMethod:Ef.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ef.credentialFromTaggedObject(e)}static credentialFromError(e){return Ef.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:a}=e;if(!t&&!a)return null;try{return Ef.credential(t,a)}catch{return null}}}Ef.GOOGLE_SIGN_IN_METHOD="google.com";Ef.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af extends Dy{constructor(){super("github.com")}static credential(e){return Zp._fromParams({providerId:Af.PROVIDER_ID,signInMethod:Af.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Af.credentialFromTaggedObject(e)}static credentialFromError(e){return Af.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Af.credential(e.oauthAccessToken)}catch{return null}}}Af.GITHUB_SIGN_IN_METHOD="github.com";Af.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf extends Dy{constructor(){super("twitter.com")}static credential(e,t){return Zp._fromParams({providerId:Cf.PROVIDER_ID,signInMethod:Cf.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Cf.credentialFromTaggedObject(e)}static credentialFromError(e){return Cf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:a}=e;if(!t||!a)return null;try{return Cf.credential(t,a)}catch{return null}}}Cf.TWITTER_SIGN_IN_METHOD="twitter.com";Cf.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mg{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,a,d=!1){const m=await nh._fromIdTokenResponse(e,a,d),_=BT(a);return new mg({user:m,providerId:_,_tokenResponse:a,operationType:t})}static async _forOperation(e,t,a){await e._updateTokensIfNecessary(a,!0);const d=BT(a);return new mg({user:e,providerId:d,_tokenResponse:a,operationType:t})}}function BT(i){return i.providerId?i.providerId:"phoneNumber"in i?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0 extends lh{constructor(e,t,a,d){super(t.code,t.message),this.operationType=a,this.user=d,Object.setPrototypeOf(this,P0.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:a}}static _fromErrorAndOperation(e,t,a,d){return new P0(e,t,a,d)}}function XC(i,e,t,a){return(e==="reauthenticate"?t._getReauthenticationResolver(i):t._getIdTokenResponse(i)).catch(m=>{throw m.code==="auth/multi-factor-auth-required"?P0._fromErrorAndOperation(i,m,e,a):m})}async function P3(i,e,t=!1){const a=await hy(i,e._linkToIdToken(i.auth,await i.getIdToken()),t);return mg._forOperation(i,"link",a)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R3(i,e,t=!1){const{auth:a}=i;if(Nh(a.app))return Promise.reject(Op(a));const d="reauthenticate";try{const m=await hy(i,XC(a,d,e,i),t);Jn(m.idToken,a,"internal-error");const _=pw(m.idToken);Jn(_,a,"internal-error");const{sub:c}=_;return Jn(i.uid===c,a,"user-mismatch"),mg._forOperation(i,d,m)}catch(m){throw(m==null?void 0:m.code)==="auth/user-not-found"&&qd(a,"user-mismatch"),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L3(i,e,t=!1){if(Nh(i.app))return Promise.reject(Op(i));const a="signIn",d=await XC(i,a,e),m=await mg._fromIdTokenResponse(i,a,d);return t||await i._updateCurrentUser(m.user),m}function k3(i,e,t,a){return ql(i).onIdTokenChanged(e,t,a)}function D3(i,e,t){return ql(i).beforeAuthStateChanged(e,t)}const R0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KC{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(R0,"1"),this.storage.removeItem(R0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z3=1e3,O3=10;class YC extends KC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=$C(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const a=this.storage.getItem(t),d=this.localCache[t];a!==d&&e(t,d,a)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((_,c,C)=>{this.notifyListeners(_,C)});return}const a=e.key;t?this.detachListener():this.stopPolling();const d=()=>{const _=this.storage.getItem(a);!t&&this.localCache[a]===_||this.notifyListeners(a,_)},m=this.storage.getItem(a);p3()&&m!==e.newValue&&e.newValue!==e.oldValue?setTimeout(d,O3):d()}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const d of Array.from(a))d(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,a)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:a}),!0)})},z3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}YC.type="LOCAL";const N3=YC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC extends KC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}QC.type="SESSION";const JC=QC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B3(i){return Promise.all(i.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ob{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(d=>d.isListeningto(e));if(t)return t;const a=new ob(e);return this.receivers.push(a),a}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:a,eventType:d,data:m}=t.data,_=this.handlersMap[d];if(!(_!=null&&_.size))return;t.ports[0].postMessage({status:"ack",eventId:a,eventType:d});const c=Array.from(_).map(async k=>k(t.origin,m)),C=await B3(c);t.ports[0].postMessage({status:"done",eventId:a,eventType:d,response:C})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ob.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yw(i="",e=10){let t="";for(let a=0;a<e;a++)t+=Math.floor(Math.random()*10);return i+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F3{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,a=50){const d=typeof MessageChannel<"u"?new MessageChannel:null;if(!d)throw new Error("connection_unavailable");let m,_;return new Promise((c,C)=>{const k=yw("",20);d.port1.start();const V=setTimeout(()=>{C(new Error("unsupported_event"))},a);_={messageChannel:d,onMessage(G){const ee=G;if(ee.data.eventId===k)switch(ee.data.status){case"ack":clearTimeout(V),m=setTimeout(()=>{C(new Error("timeout"))},3e3);break;case"done":clearTimeout(m),c(ee.data.response);break;default:clearTimeout(V),clearTimeout(m),C(new Error("invalid_response"));break}}},this.handlers.add(_),d.port1.addEventListener("message",_.onMessage),this.target.postMessage({eventType:e,eventId:k,data:t},[d.port2])}).finally(()=>{_&&this.removeMessageHandler(_)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $h(){return window}function V3(i){$h().location.href=i}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eI(){return typeof $h().WorkerGlobalScope<"u"&&typeof $h().importScripts=="function"}async function U3(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function j3(){var i;return((i=navigator==null?void 0:navigator.serviceWorker)==null?void 0:i.controller)||null}function q3(){return eI()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tI="firebaseLocalStorageDb",$3=1,L0="firebaseLocalStorage",nI="fbase_key";class zy{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function lb(i,e){return i.transaction([L0],e?"readwrite":"readonly").objectStore(L0)}function G3(){const i=indexedDB.deleteDatabase(tI);return new zy(i).toPromise()}function e1(){const i=indexedDB.open(tI,$3);return new Promise((e,t)=>{i.addEventListener("error",()=>{t(i.error)}),i.addEventListener("upgradeneeded",()=>{const a=i.result;try{a.createObjectStore(L0,{keyPath:nI})}catch(d){t(d)}}),i.addEventListener("success",async()=>{const a=i.result;a.objectStoreNames.contains(L0)?e(a):(a.close(),await G3(),e(await e1()))})})}async function FT(i,e,t){const a=lb(i,!0).put({[nI]:e,value:t});return new zy(a).toPromise()}async function Z3(i,e){const t=lb(i,!1).get(e),a=await new zy(t).toPromise();return a===void 0?null:a.value}function VT(i,e){const t=lb(i,!0).delete(e);return new zy(t).toPromise()}const H3=800,W3=3;class iI{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await e1(),this.db)}async _withRetries(e){let t=0;for(;;)try{const a=await this._openDb();return await e(a)}catch(a){if(t++>W3)throw a;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return eI()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ob._getInstance(q3()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,a;if(this.activeServiceWorker=await U3(),!this.activeServiceWorker)return;this.sender=new F3(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(a=e[0])!=null&&a.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||j3()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await e1();return await FT(e,R0,"1"),await VT(e,R0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(a=>FT(a,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(a=>Z3(a,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>VT(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(d=>{const m=lb(d,!1).getAll();return new zy(m).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],a=new Set;if(e.length!==0)for(const{fbase_key:d,value:m}of e)a.add(d),JSON.stringify(this.localCache[d])!==JSON.stringify(m)&&(this.notifyListeners(d,m),t.push(d));for(const d of Object.keys(this.localCache))this.localCache[d]&&!a.has(d)&&(this.notifyListeners(d,null),t.push(d));return t}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const d of Array.from(a))d(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),H3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}iI.type="LOCAL";const X3=iI;new ky(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K3(i,e){return e?Dd(e):(Jn(i._popupRedirectResolver,i,"argument-error"),i._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw extends HC{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return rg(e,this._buildIdpRequest())}_linkToIdToken(e,t){return rg(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return rg(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Y3(i){return L3(i.auth,new vw(i),i.bypassAuthState)}function Q3(i){const{auth:e,user:t}=i;return Jn(t,e,"internal-error"),R3(t,new vw(i),i.bypassAuthState)}async function J3(i){const{auth:e,user:t}=i;return Jn(t,e,"internal-error"),P3(t,new vw(i),i.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rI{constructor(e,t,a,d,m=!1){this.auth=e,this.resolver=a,this.user=d,this.bypassAuthState=m,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(a){this.reject(a)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:a,postBody:d,tenantId:m,error:_,type:c}=e;if(_){this.reject(_);return}const C={auth:this.auth,requestUri:t,sessionId:a,tenantId:m||void 0,postBody:d||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(C))}catch(k){this.reject(k)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Y3;case"linkViaPopup":case"linkViaRedirect":return J3;case"reauthViaPopup":case"reauthViaRedirect":return Q3;default:qd(this.auth,"internal-error")}}resolve(e){$d(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){$d(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eO=new ky(2e3,1e4);class Qm extends rI{constructor(e,t,a,d,m){super(e,t,d,m),this.provider=a,this.authWindow=null,this.pollId=null,Qm.currentPopupAction&&Qm.currentPopupAction.cancel(),Qm.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Jn(e,this.auth,"internal-error"),e}async onExecution(){$d(this.filter.length===1,"Popup operations only handle one event");const e=yw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(qh(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(qh(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Qm.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,a;if((a=(t=this.authWindow)==null?void 0:t.window)!=null&&a.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(qh(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,eO.get())};e()}}Qm.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tO="pendingRedirect",n0=new Map;class nO extends rI{constructor(e,t,a=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,a),this.eventId=null}async execute(){let e=n0.get(this.auth._key());if(!e){try{const a=await iO(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(a)}catch(t){e=()=>Promise.reject(t)}n0.set(this.auth._key(),e)}return this.bypassAuthState||n0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function iO(i,e){const t=sO(e),a=aO(i);if(!await a._isAvailable())return!1;const d=await a._get(t)==="true";return await a._remove(t),d}function rO(i,e){n0.set(i._key(),e)}function aO(i){return Dd(i._redirectPersistence)}function sO(i){return t0(tO,i.config.apiKey,i.name)}async function oO(i,e,t=!1){if(Nh(i.app))return Promise.reject(Op(i));const a=gw(i),d=K3(a,e),_=await new nO(a,d,t).execute();return _&&!t&&(delete _.user._redirectEventId,await a._persistUserIfCurrent(_.user),await a._setRedirectUser(null,e)),_}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lO=600*1e3;class uO{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(a=>{this.isEventForConsumer(e,a)&&(t=!0,this.sendToConsumer(e,a),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!cO(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var a;if(e.error&&!aI(e)){const d=((a=e.error.code)==null?void 0:a.split("auth/")[1])||"internal-error";t.onError(qh(this.auth,d))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const a=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&a}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=lO&&this.cachedEventUids.clear(),this.cachedEventUids.has(UT(e))}saveEventToCache(e){this.cachedEventUids.add(UT(e)),this.lastProcessedEventTime=Date.now()}}function UT(i){return[i.type,i.eventId,i.sessionId,i.tenantId].filter(e=>e).join("-")}function aI({type:i,error:e}){return i==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function cO(i){switch(i.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return aI(i);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hO(i,e={}){return Cg(i,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dO=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,fO=/^https?/;async function pO(i){if(i.config.emulator)return;const{authorizedDomains:e}=await hO(i);for(const t of e)try{if(mO(t))return}catch{}qd(i,"unauthorized-domain")}function mO(i){const e=Qx(),{protocol:t,hostname:a}=new URL(e);if(i.startsWith("chrome-extension://")){const _=new URL(i);return _.hostname===""&&a===""?t==="chrome-extension:"&&i.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&_.hostname===a}if(!fO.test(t))return!1;if(dO.test(i))return a===i;const d=i.replace(/\./g,"\\.");return new RegExp("^(.+\\."+d+"|"+d+")$","i").test(a)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gO=new ky(3e4,6e4);function jT(){const i=$h().___jsl;if(i!=null&&i.H){for(const e of Object.keys(i.H))if(i.H[e].r=i.H[e].r||[],i.H[e].L=i.H[e].L||[],i.H[e].r=[...i.H[e].L],i.CP)for(let t=0;t<i.CP.length;t++)i.CP[t]=null}}function _O(i){return new Promise((e,t)=>{var d,m,_;function a(){jT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{jT(),t(qh(i,"network-request-failed"))},timeout:gO.get()})}if((m=(d=$h().gapi)==null?void 0:d.iframes)!=null&&m.Iframe)e(gapi.iframes.getContext());else if((_=$h().gapi)!=null&&_.load)a();else{const c=T3("iframefcb");return $h()[c]=()=>{gapi.load?a():t(qh(i,"network-request-failed"))},x3(`${w3()}?onload=${c}`).catch(C=>t(C))}}).catch(e=>{throw i0=null,e})}let i0=null;function yO(i){return i0=i0||_O(i),i0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vO=new ky(5e3,15e3),bO="__/auth/iframe",xO="emulator/auth/iframe",wO={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},TO=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function SO(i){const e=i.config;Jn(e.authDomain,i,"auth-domain-config-required");const t=e.emulator?dw(e,xO):`https://${i.config.authDomain}/${bO}`,a={apiKey:e.apiKey,appName:i.name,v:xg},d=TO.get(i.config.apiHost);d&&(a.eid=d);const m=i._getFrameworks();return m.length&&(a.fw=m.join(",")),`${t}?${Ay(a).slice(1)}`}async function EO(i){const e=await yO(i),t=$h().gapi;return Jn(t,i,"internal-error"),e.open({where:document.body,url:SO(i),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:wO,dontclear:!0},a=>new Promise(async(d,m)=>{await a.restyle({setHideOnLeave:!1});const _=qh(i,"network-request-failed"),c=$h().setTimeout(()=>{m(_)},vO.get());function C(){$h().clearTimeout(c),d(a)}a.ping(C).then(C,()=>{m(_)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AO={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},CO=500,IO=600,MO="_blank",PO="http://localhost";class qT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function RO(i,e,t,a=CO,d=IO){const m=Math.max((window.screen.availHeight-d)/2,0).toString(),_=Math.max((window.screen.availWidth-a)/2,0).toString();let c="";const C={...AO,width:a.toString(),height:d.toString(),top:m,left:_},k=Ml().toLowerCase();t&&(c=FC(k)?MO:t),NC(k)&&(e=e||PO,C.scrollbars="yes");const V=Object.entries(C).reduce((ee,[Y,xe])=>`${ee}${Y}=${xe},`,"");if(f3(k)&&c!=="_self")return LO(e||"",c),new qT(null);const G=window.open(e||"",c,V);Jn(G,i,"popup-blocked");try{G.focus()}catch{}return new qT(G)}function LO(i,e){const t=document.createElement("a");t.href=i,t.target=e;const a=document.createEvent("MouseEvent");a.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kO="__/auth/handler",DO="emulator/auth/handler",zO=encodeURIComponent("fac");async function $T(i,e,t,a,d,m){Jn(i.config.authDomain,i,"auth-domain-config-required"),Jn(i.config.apiKey,i,"invalid-api-key");const _={apiKey:i.config.apiKey,appName:i.name,authType:t,redirectUrl:a,v:xg,eventId:d};if(e instanceof WC){e.setDefaultLanguage(i.languageCode),_.providerId=e.providerId||"",uL(e.getCustomParameters())||(_.customParameters=JSON.stringify(e.getCustomParameters()));for(const[V,G]of Object.entries({}))_[V]=G}if(e instanceof Dy){const V=e.getScopes().filter(G=>G!=="");V.length>0&&(_.scopes=V.join(","))}i.tenantId&&(_.tid=i.tenantId);const c=_;for(const V of Object.keys(c))c[V]===void 0&&delete c[V];const C=await i._getAppCheckToken(),k=C?`#${zO}=${encodeURIComponent(C)}`:"";return`${OO(i)}?${Ay(c).slice(1)}${k}`}function OO({config:i}){return i.emulator?dw(i,DO):`https://${i.authDomain}/${kO}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ox="webStorageSupport";class NO{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=JC,this._completeRedirectFn=oO,this._overrideRedirectResult=rO}async _openPopup(e,t,a,d){var _;$d((_=this.eventManagers[e._key()])==null?void 0:_.manager,"_initialize() not called before _openPopup()");const m=await $T(e,t,a,Qx(),d);return RO(e,m,yw())}async _openRedirect(e,t,a,d){await this._originValidation(e);const m=await $T(e,t,a,Qx(),d);return V3(m),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:d,promise:m}=this.eventManagers[t];return d?Promise.resolve(d):($d(m,"If manager is not set, promise should be"),m)}const a=this.initAndGetManager(e);return this.eventManagers[t]={promise:a},a.catch(()=>{delete this.eventManagers[t]}),a}async initAndGetManager(e){const t=await EO(e),a=new uO(e);return t.register("authEvent",d=>(Jn(d==null?void 0:d.authEvent,e,"invalid-auth-event"),{status:a.onEvent(d.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:a},this.iframes[e._key()]=t,a}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ox,{type:ox},d=>{var _;const m=(_=d==null?void 0:d[0])==null?void 0:_[ox];m!==void 0&&t(!!m),qd(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=pO(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return $C()||BC()||mw()}}const BO=NO;var GT="@firebase/auth",ZT="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FO{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(a=>{e((a==null?void 0:a.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Jn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VO(i){switch(i){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function UO(i){Kh(new sh("auth",(e,{options:t})=>{const a=e.getProvider("app").getImmediate(),d=e.getProvider("heartbeat"),m=e.getProvider("app-check-internal"),{apiKey:_,authDomain:c}=a.options;Jn(_&&!_.includes(":"),"invalid-api-key",{appName:a.name});const C={apiKey:_,authDomain:c,clientPlatform:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:GC(i)},k=new v3(a,d,m,C);return E3(k,t),k},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,a)=>{e.getProvider("auth-internal").initialize()})),Kh(new sh("auth-internal",e=>{const t=gw(e.getProvider("auth").getImmediate());return(a=>new FO(a))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Rc(GT,ZT,VO(i)),Rc(GT,ZT,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jO=300,qO=VE("authIdTokenMaxAge")||jO;let HT=null;const $O=i=>async e=>{const t=e&&await e.getIdTokenResult(),a=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(a&&a>qO)return;const d=t==null?void 0:t.token;HT!==d&&(HT=d,await fetch(i,{method:d?"POST":"DELETE",headers:d?{Authorization:`Bearer ${d}`}:{}}))};function GO(i=R1()){const e=Jp(i,"auth");if(e.isInitialized())return e.getImmediate();const t=S3(i,{popupRedirectResolver:BO,persistence:[X3,N3,JC]}),a=VE("authTokenSyncURL");if(a&&typeof isSecureContext=="boolean"&&isSecureContext){const m=new URL(a,location.origin);if(location.origin===m.origin){const _=$O(m.toString());D3(t,_,()=>_(t.currentUser)),k3(t,c=>_(c))}}const d=BE("auth");return d&&A3(t,`http://${d}`),t}function ZO(){var i;return((i=document.getElementsByTagName("head"))==null?void 0:i[0])??document}b3({loadJS(i){return new Promise((e,t)=>{const a=document.createElement("script");a.setAttribute("src",i),a.onload=e,a.onerror=d=>{const m=qh("internal-error");m.customData=d,t(m)},a.type="text/javascript",a.charset="UTF-8",ZO().appendChild(a)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});UO("Browser");const sI="@firebase/installations",bw="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oI=1e4,lI=`w:${bw}`,uI="FIS_v2",HO="https://firebaseinstallations.googleapis.com/v1",WO=3600*1e3,XO="installations",KO="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YO={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Hp=new Qp(XO,KO,YO);function cI(i){return i instanceof lh&&i.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hI({projectId:i}){return`${HO}/projects/${i}/installations`}function dI(i){return{token:i.token,requestStatus:2,expiresIn:JO(i.expiresIn),creationTime:Date.now()}}async function fI(i,e){const a=(await e.json()).error;return Hp.create("request-failed",{requestName:i,serverCode:a.code,serverMessage:a.message,serverStatus:a.status})}function pI({apiKey:i}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":i})}function QO(i,{refreshToken:e}){const t=pI(i);return t.append("Authorization",e4(e)),t}async function mI(i){const e=await i();return e.status>=500&&e.status<600?i():e}function JO(i){return Number(i.replace("s","000"))}function e4(i){return`${uI} ${i}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t4({appConfig:i,heartbeatServiceProvider:e},{fid:t}){const a=hI(i),d=pI(i),m=e.getImmediate({optional:!0});if(m){const k=await m.getHeartbeatsHeader();k&&d.append("x-firebase-client",k)}const _={fid:t,authVersion:uI,appId:i.appId,sdkVersion:lI},c={method:"POST",headers:d,body:JSON.stringify(_)},C=await mI(()=>fetch(a,c));if(C.ok){const k=await C.json();return{fid:k.fid||t,registrationStatus:2,refreshToken:k.refreshToken,authToken:dI(k.authToken)}}else throw await fI("Create Installation",C)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gI(i){return new Promise(e=>{setTimeout(e,i)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n4(i){return btoa(String.fromCharCode(...i)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i4=/^[cdef][\w-]{21}$/,t1="";function r4(){try{const i=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(i),i[0]=112+i[0]%16;const t=a4(i);return i4.test(t)?t:t1}catch{return t1}}function a4(i){return n4(i).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ub(i){return`${i.appName}!${i.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I=new Map;function yI(i,e){const t=ub(i);vI(t,e),s4(t,e)}function vI(i,e){const t=_I.get(i);if(t)for(const a of t)a(e)}function s4(i,e){const t=o4();t&&t.postMessage({key:i,fid:e}),l4()}let Dp=null;function o4(){return!Dp&&"BroadcastChannel"in self&&(Dp=new BroadcastChannel("[Firebase] FID Change"),Dp.onmessage=i=>{vI(i.data.key,i.data.fid)}),Dp}function l4(){_I.size===0&&Dp&&(Dp.close(),Dp=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u4="firebase-installations-database",c4=1,Wp="firebase-installations-store";let lx=null;function xw(){return lx||(lx=WE(u4,c4,{upgrade:(i,e)=>{switch(e){case 0:i.createObjectStore(Wp)}}})),lx}async function k0(i,e){const t=ub(i),d=(await xw()).transaction(Wp,"readwrite"),m=d.objectStore(Wp),_=await m.get(t);return await m.put(e,t),await d.done,(!_||_.fid!==e.fid)&&yI(i,e.fid),e}async function bI(i){const e=ub(i),a=(await xw()).transaction(Wp,"readwrite");await a.objectStore(Wp).delete(e),await a.done}async function cb(i,e){const t=ub(i),d=(await xw()).transaction(Wp,"readwrite"),m=d.objectStore(Wp),_=await m.get(t),c=e(_);return c===void 0?await m.delete(t):await m.put(c,t),await d.done,c&&(!_||_.fid!==c.fid)&&yI(i,c.fid),c}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ww(i){let e;const t=await cb(i.appConfig,a=>{const d=h4(a),m=d4(i,d);return e=m.registrationPromise,m.installationEntry});return t.fid===t1?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function h4(i){const e=i||{fid:r4(),registrationStatus:0};return xI(e)}function d4(i,e){if(e.registrationStatus===0){if(!navigator.onLine){const d=Promise.reject(Hp.create("app-offline"));return{installationEntry:e,registrationPromise:d}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},a=f4(i,t);return{installationEntry:t,registrationPromise:a}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:p4(i)}:{installationEntry:e}}async function f4(i,e){try{const t=await t4(i,e);return k0(i.appConfig,t)}catch(t){throw cI(t)&&t.customData.serverCode===409?await bI(i.appConfig):await k0(i.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function p4(i){let e=await WT(i.appConfig);for(;e.registrationStatus===1;)await gI(100),e=await WT(i.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:a}=await ww(i);return a||t}return e}function WT(i){return cb(i,e=>{if(!e)throw Hp.create("installation-not-found");return xI(e)})}function xI(i){return m4(i)?{fid:i.fid,registrationStatus:0}:i}function m4(i){return i.registrationStatus===1&&i.registrationTime+oI<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g4({appConfig:i,heartbeatServiceProvider:e},t){const a=_4(i,t),d=QO(i,t),m=e.getImmediate({optional:!0});if(m){const k=await m.getHeartbeatsHeader();k&&d.append("x-firebase-client",k)}const _={installation:{sdkVersion:lI,appId:i.appId}},c={method:"POST",headers:d,body:JSON.stringify(_)},C=await mI(()=>fetch(a,c));if(C.ok){const k=await C.json();return dI(k)}else throw await fI("Generate Auth Token",C)}function _4(i,{fid:e}){return`${hI(i)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tw(i,e=!1){let t;const a=await cb(i.appConfig,m=>{if(!wI(m))throw Hp.create("not-registered");const _=m.authToken;if(!e&&b4(_))return m;if(_.requestStatus===1)return t=y4(i,e),m;{if(!navigator.onLine)throw Hp.create("app-offline");const c=w4(m);return t=v4(i,c),c}});return t?await t:a.authToken}async function y4(i,e){let t=await XT(i.appConfig);for(;t.authToken.requestStatus===1;)await gI(100),t=await XT(i.appConfig);const a=t.authToken;return a.requestStatus===0?Tw(i,e):a}function XT(i){return cb(i,e=>{if(!wI(e))throw Hp.create("not-registered");const t=e.authToken;return T4(t)?{...e,authToken:{requestStatus:0}}:e})}async function v4(i,e){try{const t=await g4(i,e),a={...e,authToken:t};return await k0(i.appConfig,a),t}catch(t){if(cI(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await bI(i.appConfig);else{const a={...e,authToken:{requestStatus:0}};await k0(i.appConfig,a)}throw t}}function wI(i){return i!==void 0&&i.registrationStatus===2}function b4(i){return i.requestStatus===2&&!x4(i)}function x4(i){const e=Date.now();return e<i.creationTime||i.creationTime+i.expiresIn<e+WO}function w4(i){const e={requestStatus:1,requestTime:Date.now()};return{...i,authToken:e}}function T4(i){return i.requestStatus===1&&i.requestTime+oI<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S4(i){const e=i,{installationEntry:t,registrationPromise:a}=await ww(e);return a?a.catch(console.error):Tw(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E4(i,e=!1){const t=i;return await A4(t),(await Tw(t,e)).token}async function A4(i){const{registrationPromise:e}=await ww(i);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C4(i){if(!i||!i.options)throw ux("App Configuration");if(!i.name)throw ux("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!i.options[t])throw ux(t);return{appName:i.name,projectId:i.options.projectId,apiKey:i.options.apiKey,appId:i.options.appId}}function ux(i){return Hp.create("missing-app-config-values",{valueName:i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TI="installations",I4="installations-internal",M4=i=>{const e=i.getProvider("app").getImmediate(),t=C4(e),a=Jp(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:a,_delete:()=>Promise.resolve()}},P4=i=>{const e=i.getProvider("app").getImmediate(),t=Jp(e,TI).getImmediate();return{getId:()=>S4(t),getToken:d=>E4(t,d)}};function R4(){Kh(new sh(TI,M4,"PUBLIC")),Kh(new sh(I4,P4,"PRIVATE"))}R4();Rc(sI,bw);Rc(sI,bw,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D0="analytics",L4="firebase_id",k4="origin",D4=60*1e3,z4="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Sw="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jl=new H0("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O4={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Bu=new Qp("analytics","Analytics",O4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N4(i){if(!i.startsWith(Sw)){const e=Bu.create("invalid-gtag-resource",{gtagURL:i});return jl.warn(e.message),""}return i}function SI(i){return Promise.all(i.map(e=>e.catch(t=>t)))}function B4(i,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(i,e)),t}function F4(i,e){const t=B4("firebase-js-sdk-policy",{createScriptURL:N4}),a=document.createElement("script"),d=`${Sw}?l=${i}&id=${e}`;a.src=t?t==null?void 0:t.createScriptURL(d):d,a.async=!0,document.head.appendChild(a)}function V4(i){let e=[];return Array.isArray(window[i])?e=window[i]:window[i]=e,e}async function U4(i,e,t,a,d,m){const _=a[d];try{if(_)await e[_];else{const C=(await SI(t)).find(k=>k.measurementId===d);C&&await e[C.appId]}}catch(c){jl.error(c)}i("config",d,m)}async function j4(i,e,t,a,d){try{let m=[];if(d&&d.send_to){let _=d.send_to;Array.isArray(_)||(_=[_]);const c=await SI(t);for(const C of _){const k=c.find(G=>G.measurementId===C),V=k&&e[k.appId];if(V)m.push(V);else{m=[];break}}}m.length===0&&(m=Object.values(e)),await Promise.all(m),i("event",a,d||{})}catch(m){jl.error(m)}}function q4(i,e,t,a){async function d(m,..._){try{if(m==="event"){const[c,C]=_;await j4(i,e,t,c,C)}else if(m==="config"){const[c,C]=_;await U4(i,e,t,a,c,C)}else if(m==="consent"){const[c,C]=_;i("consent",c,C)}else if(m==="get"){const[c,C,k]=_;i("get",c,C,k)}else if(m==="set"){const[c]=_;i("set",c)}else i(m,..._)}catch(c){jl.error(c)}}return d}function $4(i,e,t,a,d){let m=function(..._){window[a].push(arguments)};return window[d]&&typeof window[d]=="function"&&(m=window[d]),window[d]=q4(m,i,e,t),{gtagCore:m,wrappedGtag:window[d]}}function G4(i){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(Sw)&&t.src.includes(i))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z4=30,H4=1e3;class W4{constructor(e={},t=H4){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const EI=new W4;function X4(i){return new Headers({Accept:"application/json","x-goog-api-key":i})}async function K4(i){var _;const{appId:e,apiKey:t}=i,a={method:"GET",headers:X4(t)},d=z4.replace("{app-id}",e),m=await fetch(d,a);if(m.status!==200&&m.status!==304){let c="";try{const C=await m.json();(_=C.error)!=null&&_.message&&(c=C.error.message)}catch{}throw Bu.create("config-fetch-failed",{httpStatus:m.status,responseMessage:c})}return m.json()}async function Y4(i,e=EI,t){const{appId:a,apiKey:d,measurementId:m}=i.options;if(!a)throw Bu.create("no-app-id");if(!d){if(m)return{measurementId:m,appId:a};throw Bu.create("no-api-key")}const _=e.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new eN;return setTimeout(async()=>{c.abort()},D4),AI({appId:a,apiKey:d,measurementId:m},_,c,e)}async function AI(i,{throttleEndTimeMillis:e,backoffCount:t},a,d=EI){var c;const{appId:m,measurementId:_}=i;try{await Q4(a,e)}catch(C){if(_)return jl.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${_} provided in the "measurementId" field in the local Firebase config. [${C==null?void 0:C.message}]`),{appId:m,measurementId:_};throw C}try{const C=await K4(i);return d.deleteThrottleMetadata(m),C}catch(C){const k=C;if(!J4(k)){if(d.deleteThrottleMetadata(m),_)return jl.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${_} provided in the "measurementId" field in the local Firebase config. [${k==null?void 0:k.message}]`),{appId:m,measurementId:_};throw C}const V=Number((c=k==null?void 0:k.customData)==null?void 0:c.httpStatus)===503?w2(t,d.intervalMillis,Z4):w2(t,d.intervalMillis),G={throttleEndTimeMillis:Date.now()+V,backoffCount:t+1};return d.setThrottleMetadata(m,G),jl.debug(`Calling attemptFetch again in ${V} millis`),AI(i,G,a,d)}}function Q4(i,e){return new Promise((t,a)=>{const d=Math.max(e-Date.now(),0),m=setTimeout(t,d);i.addEventListener(()=>{clearTimeout(m),a(Bu.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function J4(i){if(!(i instanceof lh)||!i.customData)return!1;const e=Number(i.customData.httpStatus);return e===429||e===500||e===503||e===504}class eN{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function tN(i,e,t,a,d){if(d&&d.global){i("event",t,a);return}else{const m=await e,_={...a,send_to:m};i("event",t,_)}}async function nN(i,e,t,a){if(a&&a.global){const d={};for(const m of Object.keys(t))d[`user_properties.${m}`]=t[m];return i("set",d),Promise.resolve()}else{const d=await e;i("config",d,{update:!0,user_properties:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iN(){if($E())try{await GE()}catch(i){return jl.warn(Bu.create("indexeddb-unavailable",{errorInfo:i==null?void 0:i.toString()}).message),!1}else return jl.warn(Bu.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function rN(i,e,t,a,d,m,_){const c=Y4(i);c.then(ee=>{t[ee.measurementId]=ee.appId,i.options.measurementId&&ee.measurementId!==i.options.measurementId&&jl.warn(`The measurement ID in the local Firebase config (${i.options.measurementId}) does not match the measurement ID fetched from the server (${ee.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(ee=>jl.error(ee)),e.push(c);const C=iN().then(ee=>{if(ee)return a.getId()}),[k,V]=await Promise.all([c,C]);G4(m)||F4(m,k.measurementId),d("js",new Date);const G=(_==null?void 0:_.config)??{};return G[k4]="firebase",G.update=!0,V!=null&&(G[L4]=V),d("config",k.measurementId,G),k.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(e){this.app=e}_delete(){return delete ag[this.app.options.appId],Promise.resolve()}}let ag={},KT=[];const YT={};let cx="dataLayer",sN="gtag",QT,Ew,JT=!1;function oN(){const i=[];if(qE()&&i.push("This is a browser extension environment."),aL()||i.push("Cookies are not available."),i.length>0){const e=i.map((a,d)=>`(${d+1}) ${a}`).join(" "),t=Bu.create("invalid-analytics-context",{errorInfo:e});jl.warn(t.message)}}function lN(i,e,t){oN();const a=i.options.appId;if(!a)throw Bu.create("no-app-id");if(!i.options.apiKey)if(i.options.measurementId)jl.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${i.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Bu.create("no-api-key");if(ag[a]!=null)throw Bu.create("already-exists",{id:a});if(!JT){V4(cx);const{wrappedGtag:m,gtagCore:_}=$4(ag,KT,YT,cx,sN);Ew=m,QT=_,JT=!0}return ag[a]=rN(i,KT,YT,e,QT,cx,t),new aN(i)}function uN(i=R1()){i=ql(i);const e=Jp(i,D0);return e.isInitialized()?e.getImmediate():cN(i)}function cN(i,e={}){const t=Jp(i,D0);if(t.isInitialized()){const d=t.getImmediate();if(Nf(e,t.getOptions()))return d;throw Bu.create("already-initialized")}return t.initialize({options:e})}function hN(i,e,t){i=ql(i),nN(Ew,ag[i.app.options.appId],e,t).catch(a=>jl.error(a))}function dN(i,e,t,a){i=ql(i),tN(Ew,ag[i.app.options.appId],e,t,a).catch(d=>jl.error(d))}const eS="@firebase/analytics",tS="0.10.19";function fN(){Kh(new sh(D0,(e,{options:t})=>{const a=e.getProvider("app").getImmediate(),d=e.getProvider("installations-internal").getImmediate();return lN(a,d,t)},"PUBLIC")),Kh(new sh("analytics-internal",i,"PRIVATE")),Rc(eS,tS),Rc(eS,tS,"esm2020");function i(e){try{const t=e.getProvider(D0).getImmediate();return{logEvent:(a,d,m)=>dN(t,a,d,m),setUserProperties:(a,d)=>hN(t,a,d)}}catch(t){throw Bu.create("interop-component-reg-failed",{reason:t})}}}fN();const pN={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_CLARITY_ID:"somgjzobm3",VITE_FIREBASE_API_KEY:"AIzaSyC5EgMfrRpFh8_ZFyQ_ieF-YYD9xPrOaVU",VITE_FIREBASE_APP_ID:"1:1016256516850:web:5b902e0616dfc3c926766b",VITE_FIREBASE_AUTH_DOMAIN:"redreport-29023.firebaseapp.com",VITE_FIREBASE_MEASUREMENT_ID:"G-S4C6LSBB9G",VITE_FIREBASE_MESSAGING_SENDER_ID:"1016256516850",VITE_FIREBASE_PROJECT_ID:"redreport-29023",VITE_FIREBASE_STORAGE_BUCKET:"redreport-29023.firebasestorage.app",VITE_MAP_KEY:"0UGrg19TXtYRROinsJ9a"},mN={apiKey:"AIzaSyC5EgMfrRpFh8_ZFyQ_ieF-YYD9xPrOaVU",authDomain:"redreport-29023.firebaseapp.com",projectId:"redreport-29023",storageBucket:"redreport-29023.firebasestorage.app",messagingSenderId:"1016256516850",appId:"1:1016256516850:web:5b902e0616dfc3c926766b",measurementId:"G-S4C6LSBB9G"},gN=["VITE_FIREBASE_API_KEY","VITE_FIREBASE_AUTH_DOMAIN","VITE_FIREBASE_PROJECT_ID"];gN.forEach(i=>{if(!pN[i])throw new Error(`Missing required environment variable: ${i}`)});const Aw=XE(mN),CI=Az(Aw);GO(Aw);typeof window<"u"&&uN(Aw);const Cw=[{"Notre-Dame":{"Residence Halls":[{name:"Alumni Hall",latitude:41.6984,longitude:-86.2339,id:"alumni-hall",type:"Residence Halls",location:"Notre Dame"},{name:"Badin Hall",latitude:41.7006,longitude:-86.2412,id:"badin-hall",type:"Residence Halls",location:"Notre Dame"},{name:"Breen-Phillips Hall",latitude:41.70278,longitude:-86.24,id:"breen-phillips-hall",type:"Residence Halls",location:"Notre Dame"},{name:"Carroll Hall",latitude:41.70194,longitude:-86.24778,id:"carroll-hall",type:"Residence Halls",location:"Notre Dame"},{name:"Cavanaugh Hall",latitude:41.702807,longitude:-86.237164,id:"cavanaugh-hall",type:"Residence Halls",location:"Notre Dame"},{name:"Dillon Hall",latitude:41.6984,longitude:-86.2339,id:"dillon-hall",type:"Residence Halls",location:"Notre Dame"},{name:"Duncan Hall",latitude:41.6984,longitude:-86.2339,id:"duncan-hall",type:"Residence Halls",location:"Notre Dame"},{name:"Dunne Hall",latitude:41.7045274,longitude:-86.2329434,id:"dunne-hall",type:"Residence Halls",location:"Notre Dame"},{name:"Farley Hall",latitude:41.7036468,longitude:-86.2361456,id:"farley-hall",type:"Residence Halls",location:"Notre Dame"},{name:"Fisher Hall",latitude:41.6984,longitude:-86.2339,id:"fisher-hall",type:"Residence Halls",location:"Notre Dame"},{name:"Keenan Hall",latitude:41.703917,longitude:-86.237477,id:"keenan-hall",type:"Residence Halls",location:"Notre Dame"},{name:"Sacred Heart Parish Center",latitude:41.7068221,longitude:-86.2450146,id:"sacred-heart-parish-center",type:"Residence Halls",location:"Notre Dame"},{name:"Baumer Hall",latitude:41.697,longitude:-86.2414,id:"baumer-hall",type:"Residence Halls",location:"Notre Dame"},{name:"Fischer Graduate Residences",latitude:41.7051,longitude:-86.229,id:"fischer-graduate-residences",type:"Residence Halls",location:"Notre Dame"},{name:"Harper Hall",latitude:41.69928,longitude:-86.238899,id:"harper-hall",type:"Residence Halls",location:"Notre Dame"},{name:"Flaherty Hall",latitude:41.7035,longitude:-86.2328,id:"flaherty-hall",type:"Residence Halls",location:"Notre Dame"},{name:"Howard Hall",latitude:41.700833,longitude:-86.241667,id:"howard-hall",type:"Residence Halls",location:"Notre Dame"}],"Academic Buildings":[{name:"Law School",latitude:41.698379,longitude:-86.23863,location:"Notre Dame",id:"law-school",buildingType:"Academic Buildings"},{name:"Hesburgh Library",latitude:41.7023892,longitude:-86.2341526,id:"hesburgh-library",type:"Academic Buildings",location:"Notre Dame"},{name:"Corbett Family Hall",latitude:41.699192,longitude:-86.234851,id:"corbett-family-hall",location:"Notre Dame",buildingType:"Academic Buildings"},{name:"Walsh Family Hall of Architecture",latitude:41.695,longitude:-86.235,id:"walsh-family-hall-of-architecture",type:"Academic Buildings",location:"Notre Dame"},{name:"Jordan Hall of Science",latitude:41.700685,longitude:-86.233075,id:"jordan-hall-of-science",type:"Academic Buildings",location:"Notre Dame"},{name:"DeBartolo Hall",latitude:41.6982522,longitude:-86.2362484,id:"debartolo-hall",type:"Academic Buildings",location:"Notre Dame"},{name:"Decio Faculty Hall",latitude:41.700545,longitude:-86.235967,id:"decio-family-hall",location:"Notre Dame",buildingType:"Academic Buildings"},{name:"Stayer Center for Executive Education",latitude:41.71048456,longitude:-86.2360535,id:"stayer-center-for-executive-education",type:"Academic Buildings",location:"Notre Dame"},{name:"O'Shaughnessy Hall",latitude:41.7003185,longitude:-86.2356855,id:"oshaughnessy-hall",type:"Academic Buildings",location:"Notre Dame"},{name:"Hayes-Healy Center",latitude:41.700344,longitude:-86.236814,id:"hayes-healy-center",location:"Notre Dame",buildingType:"Academic Buildings"},{name:"Mendoza College of Business",latitude:41.6970083,longitude:-86.23615,id:"mendoza-college-of-business",type:"Academic Buildings",location:"Notre Dame"},{name:"Raclin Murphy Museum of Art",latitude:41.693889,longitude:-86.235,id:"raclin-murphy-museum-of-art",type:"Academic Buildings",location:"Notre Dame"},{name:"Fitzpatrick College of Engineering",latitude:41.699234,longitude:-86.23695,id:"fitzpatrick-college-of-engineering",location:"Notre Dame",buildingType:"Academic Buildings"},{name:"Riley Hall of Art & Design",latitude:41.70083425,longitude:-86.23722792,id:"riley-hall-of-art-design",type:"Academic Buildings",location:"Notre Dame"},{name:"Spes Unica Hall",latitude:41.70632,longitude:-86.2570306,id:"spes-unica-hall",type:"Academic Buildings",location:"Notre Dame"},{name:"O'Neill Hall",latitude:41.69822114,longitude:-86.2319385,id:"oneill-hall",type:"Academic Buildings",location:"Notre Dame"},{name:"DPAC",latitude:41.694799,longitude:-86.236694,id:"DPAC",type:"Academic Buildings",location:"Notre Dame"},{name:"Nieuwland Science Hall",latitude:41.70153583,longitude:-86.2366288,id:"nieuwland-science-hall",type:"Academic Buildings",location:"Notre Dame"}],"Student Buildings":[{name:"LaFortune Student Center",latitude:41.7002,longitude:-86.2379,id:"lafortune-student-center",type:"Student Buildings",location:"Notre Dame"},{name:"LaFortune Food Court",latitude:41.7002,longitude:-86.2379,id:"lafortune-food-court",type:"Student Buildings",location:"Notre Dame"},{name:"Haggar Parlor",latitude:41.7002,longitude:-86.2379,id:"haggar-parlor",type:"Student Buildings",location:"Notre Dame"},{name:"Joyce Center",latitude:41.7002,longitude:-86.2379,id:"joyce-center",type:"Student Buildings",location:"Notre Dame"},{name:"Compton Family Ice Arena",latitude:41.7002,longitude:-86.2379,id:"compton-ice-arena",type:"Student Buildings",location:"Notre Dame"},{name:"Notre Dame Stadium",latitude:41.7002,longitude:-86.2379,id:"notre-dame-stadium",type:"Student Buildings",location:"Notre Dame"},{name:"Wellness Center",latitude:41.7002,longitude:-86.2379,id:"wellness-center",type:"Student Buildings",location:"Notre Dame"},{name:"Grotto of Our Lady of Lourdes",latitude:41.7002,longitude:-86.2379,id:"grotto",type:"Student Buildings",location:"Notre Dame"},{name:"Basilica",latitude:41.7026336,longitude:-86.2397856,id:"basilica-of-the-sacred-heart",type:"Student Buildings",location:"Notre Dame"}]},"Holy-Cross":{"Academic Buildings":[{name:"Holy Cross College",latitude:41.7000923,longitude:-86.2537078,location:"Holy Cross",buildingType:"Academic Buildings"}]},"Saint-Marys":{}}],nS=["All",...Object.keys(Cw[0])],iS=Cw[0],rS=Object.values(Cw[0]).flatMap(i=>Object.values(i)).flat(),aS=()=>{const[i,e]=Tt.useState(1),[t,a]=Tt.useState({campus:"",location:"",specificLocation:"",offenseTypes:[],time:"",additionalInfo:""}),[d,m]=Tt.useState(!1),[_,c]=Tt.useState(""),[C,k]=Tt.useState([]),[V,G]=Tt.useState(""),[ee,Y]=Tt.useState(""),[xe,be]=Tt.useState([]);Tt.useRef(null);const Ne=Tt.useRef(null),tt=4;var[Je,Xe]=Tt.useState(Object.values(iS["Notre-Dame"]));const Ke=At=>{const{name:bt,value:Zt}=At.target;if(console.log("Input Change ",bt,Zt),bt==="campus")(Zt=="Notre-Dame"||Zt=="Saint-Marys"||Zt=="Holy-Cross")&&Xe(iS[Zt]),a(Vt=>({...Vt,campus:Zt,location:"",specificLocation:""})),be([]);else if(bt==="location"){const Vt=Je[Zt];be(Vt.map(ke=>ke.name)),a(ke=>({...ke,[bt]:Zt,specificLocation:""}))}else a(Vt=>({...Vt,[bt]:Zt}))},Ge=At=>{const{value:bt,checked:Zt}=At.target;a(Vt=>({...Vt,offenseTypes:Zt?[...Vt.offenseTypes,bt]:Vt.offenseTypes.filter(ke=>ke!==bt)}))},Fe=()=>{if(i===1){if(!t.location)return alert("Please select where you felt unsafe."),!1}else if(i===2){if(t.offenseTypes.length===0)return alert("Please select at least one type of offense."),!1}else if(i===3&&!t.time)return alert("Please select when this occurred."),!1;return!0},de=At=>{if(At>0&&!Fe())return;const bt=i+At;bt>=1&&bt<=tt&&e(bt)},ce=At=>{At.preventDefault(),Fe()&&(m(!0),setTimeout(()=>{const bt=mt();c(bt.toString()),e(5),m(!1)},2e3))},ge=At=>At.replace(/-/g," ").replace(/\b\w/g,bt=>bt.toUpperCase()),Ae=At=>At.replace(/-/g," ").replace(/\b\w/g,bt=>bt.toUpperCase()),Re=At=>{const bt=At.replace(/[^a-zA-Z0-9 ]/g,"").trim();if(!bt||!xe||xe.length===0)return[];const Zt=bt.toLowerCase();return xe.filter(ke=>ke.toLowerCase().replace(/[^a-z0-9]/g,"").includes(Zt.replace(/[^a-z0-9]/g,"")))},je={"uncomfortable-situation":"Uncomfortable Situation","sexual-misconduct":"Sexual Misconduct","physical-aggression":"Physical Aggression","verbal-aggression":"Verbal Aggression",discrimination:"Discrimination"},Pe=()=>Ce.jsxs("div",{id:"report-summary",style:{background:"rgba(216, 47, 37, 0.05)",padding:"1.5rem",borderRadius:"10px",marginBottom:"2rem"},children:[Ce.jsxs("div",{style:{marginBottom:"1rem"},children:[Ce.jsx("strong",{children:"Campus:"})," ",ge(t.campus),t.campus&&` (${t.campus})`]}),Ce.jsxs("div",{style:{marginBottom:"1rem"},children:[Ce.jsx("strong",{children:"Location:"})," ",ge(t.location),t.specificLocation&&` (${t.specificLocation})`]}),Ce.jsxs("div",{style:{marginBottom:"1rem"},children:[Ce.jsx("strong",{children:"Incident Types:"})," ",t.offenseTypes.map(At=>je[At]).join(", ")]}),Ce.jsxs("div",{style:{marginBottom:"1rem"},children:[Ce.jsx("strong",{children:"When:"})," ",Ae(t.time)]}),t.additionalInfo.trim()&&Ce.jsxs("div",{children:[Ce.jsx("strong",{children:"Additional Information:"})," ",t.additionalInfo.substring(0,200),t.additionalInfo.length>200?"...":""]})]}),Mn=At=>{Ke(At);const bt=At.target.value.trim();Y(bt);const Zt=Re(bt);if(k(Zt),Zt.length>0){const Vt=Zt[0],ke=bt.toLowerCase();Vt.toLowerCase().startsWith(ke)&&ke.length>0?(console.log(bt+Vt.substring(bt.length)),G(Vt.substring(bt.length))):G("")}else G("")},ni=At=>{if(At.key==="Enter"&&V){At.preventDefault();const Zt={target:{name:"specificLocation",value:t.specificLocation+V}};Ke(Zt),G(""),k([])}};async function mt(){return(await Gz(yC(CI,"reports"),{...t,Time:PT(),createdAt:PT()})).id}return Ce.jsxs(Ce.Fragment,{children:[Ce.jsx(DE,{}),Ce.jsx("div",{children:Ce.jsxs("div",{className:"report-container",children:[Ce.jsxs("div",{className:"report-header",children:[Ce.jsxs("h1",{children:["Anonymous ",Ce.jsx("span",{className:"highlight",children:"Report"})]}),Ce.jsx("p",{children:"Your voice matters. Share your experience in a safe, secure environment where your identity remains completely protected."})]}),Ce.jsxs("div",{className:"security-notice",children:[Ce.jsx("h3",{children:"Your Privacy is Protected"}),Ce.jsx("p",{children:"This form uses advanced encryption and anonymization techniques. No identifying information is collected or stored."})]}),Ce.jsxs("div",{className:"report-form",children:[Ce.jsxs("div",{className:"form-progress",children:[Ce.jsxs("div",{className:`progress-step ${i===1?"active":""}`,children:[Ce.jsx("div",{className:"step-circle",children:"1"}),Ce.jsx("span",{children:"Location"})]}),Ce.jsxs("div",{className:`progress-step ${i===2?"active":""}`,children:[Ce.jsx("div",{className:"step-circle",children:"2"}),Ce.jsx("span",{children:"Incident"})]}),Ce.jsxs("div",{className:`progress-step ${i===3?"active":""}`,children:[Ce.jsx("div",{className:"step-circle",children:"3"}),Ce.jsx("span",{children:"Details"})]}),Ce.jsxs("div",{className:`progress-step ${i===4?"active":""}`,children:[Ce.jsx("div",{className:"step-circle",children:"4"}),Ce.jsx("span",{children:"Submit"})]})]}),Ce.jsxs("form",{onSubmit:ce,children:[Ce.jsxs("div",{className:`form-section ${i===1?"active":""}`,children:[Ce.jsxs("div",{className:"form-group",children:[Ce.jsx("label",{htmlFor:"campus",children:"Where did you feel unsafe? *"}),Ce.jsx("div",{className:"label-description",children:"Select the campus where the incident occurred"}),Ce.jsxs("select",{id:"campus",name:"campus",value:t.campus,onChange:Ke,required:!0,children:[Ce.jsx("option",{value:"",children:"Choose a campus"}),Ce.jsx("option",{value:"Notre-Dame",children:"Notre Dame"}),Ce.jsx("option",{value:"Saint-Marys",children:"Saint Mary's College"}),Ce.jsx("option",{value:"Holy-Cross",children:"Holy Cross College"})]})]}),Ce.jsxs("div",{className:"form-group",children:[Ce.jsx("label",{htmlFor:"location",children:"Where did you feel unsafe? *"}),Ce.jsx("div",{className:"label-description",children:"What type of building was it?"}),Ce.jsxs("select",{id:"location",name:"location",value:t.location,onChange:Ke,required:!0,children:[Ce.jsx("option",{value:"",children:"Choose a location"}),Object.keys(Je).map(At=>Ce.jsx("option",{value:At,children:At.replace(/-/g," ").replace(/\b\w/g,bt=>bt.toUpperCase())},At))]})]}),Ce.jsxs("div",{className:"form-group",children:[Ce.jsx("label",{htmlFor:"specificLocation",children:"Specific Location (Optional)"}),Ce.jsx("div",{className:"label-description",children:"How is the building called?"}),Ce.jsxs("div",{style:{position:"relative",display:"inline-block"},children:[Ce.jsx("input",{className:"form-select",ref:Ne,type:"text",id:"specificLocation",name:"specificLocation",value:t.specificLocation,onChange:Mn,onKeyDown:ni,placeholder:"e.g., Main Library, 2nd floor",autoComplete:"off"}),Ce.jsx("span",{style:{position:"absolute",left:`${ee.length*10+18}px `,top:"50%",transform:"translateY(-50%)",opacity:.5,pointerEvents:"none",userSelect:"none",color:"#666"},children:V})]})]})]}),Ce.jsx("div",{className:`form-section ${i===2?"active":""}`,children:Ce.jsxs("div",{className:"form-group",children:[Ce.jsx("label",{children:"What type of offense would you group it as? *"}),Ce.jsx("div",{className:"label-description",children:"Select all that apply to your experience"}),Ce.jsxs("div",{className:"checkbox-group",children:[Ce.jsxs("label",{className:"checkbox-item",children:[Ce.jsx("input",{type:"checkbox",name:"offense-type",value:"uncomfortable-situation",checked:t.offenseTypes.includes("uncomfortable-situation"),onChange:Ge}),Ce.jsxs("div",{className:"checkbox-content",children:[Ce.jsx("strong",{children:"Uncomfortable Situation"}),Ce.jsx("small",{children:"Situations that made you feel uneasy or uncomfortable"})]})]}),Ce.jsxs("label",{className:"checkbox-item",children:[Ce.jsx("input",{type:"checkbox",name:"offense-type",value:"sexual-misconduct",checked:t.offenseTypes.includes("sexual-misconduct"),onChange:Ge}),Ce.jsxs("div",{className:"checkbox-content",children:[Ce.jsx("strong",{children:"Sexual Misconduct"}),Ce.jsx("small",{children:"Physical contact without permission"})]})]}),Ce.jsxs("label",{className:"checkbox-item",children:[Ce.jsx("input",{type:"checkbox",name:"offense-type",value:"physical-aggression",checked:t.offenseTypes.includes("physical-aggression"),onChange:Ge}),Ce.jsxs("div",{className:"checkbox-content",children:[Ce.jsx("strong",{children:"Physical Aggression"}),Ce.jsx("small",{children:"Physical violence or threat of violence"})]})]}),Ce.jsxs("label",{className:"checkbox-item",children:[Ce.jsx("input",{type:"checkbox",name:"offense-type",value:"verbal-aggression",checked:t.offenseTypes.includes("verbal-aggression"),onChange:Ge}),Ce.jsxs("div",{className:"checkbox-content",children:[Ce.jsx("strong",{children:"Verbal Aggression"}),Ce.jsx("small",{children:"Threatening, hostile, or abusive language"})]})]}),Ce.jsxs("label",{className:"checkbox-item",children:[Ce.jsx("input",{type:"checkbox",name:"offense-type",value:"discrimination",checked:t.offenseTypes.includes("discrimination"),onChange:Ge}),Ce.jsxs("div",{className:"checkbox-content",children:[Ce.jsx("strong",{children:"Discrimination"}),Ce.jsx("small",{children:"Treatment based on identity, race, gender, religion, etc."})]})]})]})]})}),Ce.jsxs("div",{className:`form-section ${i===3?"active":""}`,children:[Ce.jsxs("div",{className:"form-group",children:[Ce.jsx("label",{htmlFor:"time",children:"When did this occur? *"}),Ce.jsxs("select",{id:"time",name:"time",value:t.time,onChange:Ke,required:!0,children:[Ce.jsx("option",{value:"",children:"Select timeframe"}),Ce.jsx("option",{value:"within-24-hours",children:"Within the last 24 hours"}),Ce.jsx("option",{value:"within-week",children:"Within the last week"}),Ce.jsx("option",{value:"within-month",children:"Within the last month"}),Ce.jsx("option",{value:"longer-ago",children:"Longer ago"})]})]}),Ce.jsxs("div",{className:"form-group",children:[Ce.jsx("label",{htmlFor:"additionalInfo",children:"Additional Information (Optional)"}),Ce.jsx("div",{className:"label-description",children:"Anything else you'd like to share"}),Ce.jsx("textarea",{id:"additionalInfo",name:"additionalInfo",value:t.additionalInfo,onChange:Ke,placeholder:"Any additional context, concerns, or information you'd like to provide"})]})]}),Ce.jsx("div",{className:`form-section ${i===4?"active":""}`,children:Ce.jsxs("div",{id:"review-content",children:[Ce.jsx("h3",{style:{color:"#113052",marginBottom:"1rem"},children:"Review Your Report"}),Ce.jsx("p",{style:{marginBottom:"2rem",opacity:.8},children:"Please review the information below before submitting your anonymous report."}),Pe(),Ce.jsxs("div",{className:"security-notice",style:{marginBottom:0},children:[Ce.jsx("h3",{children:"Final Privacy Reminder"}),Ce.jsx("p",{children:"Once submitted, this report cannot be traced back to you. Your anonymity is guaranteed."})]})]})}),i===5&&Ce.jsxs("div",{className:"success-message",children:[Ce.jsx("div",{className:"success-icon",children:""}),Ce.jsx("h2",{children:"Report Submitted Successfully"}),Ce.jsx("p",{children:"Thank you for sharing your experience. Your voice contributes to making our campus community safer for everyone."}),Ce.jsxs("p",{children:[Ce.jsx("strong",{children:"Report ID:"})," ",_]}),Ce.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>window.close(),children:"Return to Home"})]}),i<5&&Ce.jsxs("div",{className:"form-navigation",children:[Ce.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>de(-1),style:{display:i>1?"block":"none"},children:"Previous"}),i<4&&Ce.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>de(1),children:"Next"}),i===4&&Ce.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:d,children:[!d&&Ce.jsx("span",{children:"Submit Anonymous Report"}),d&&Ce.jsxs("span",{children:[Ce.jsx("span",{className:"loading"}),"Submitting..."]})]})]})]})]})]})})]})};var F_={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var _N=F_.exports,sS;function yN(){return sS||(sS=1,(function(i,e){(function(t,a){a(e)})(_N,(function(t){var a="1.9.4";function d(f){var x,R,U,K;for(R=1,U=arguments.length;R<U;R++){K=arguments[R];for(x in K)f[x]=K[x]}return f}var m=Object.create||(function(){function f(){}return function(x){return f.prototype=x,new f}})();function _(f,x){var R=Array.prototype.slice;if(f.bind)return f.bind.apply(f,R.call(arguments,1));var U=R.call(arguments,2);return function(){return f.apply(x,U.length?U.concat(R.call(arguments)):arguments)}}var c=0;function C(f){return"_leaflet_id"in f||(f._leaflet_id=++c),f._leaflet_id}function k(f,x,R){var U,K,ue,Oe;return Oe=function(){U=!1,K&&(ue.apply(R,K),K=!1)},ue=function(){U?K=arguments:(f.apply(R,arguments),setTimeout(Oe,x),U=!0)},ue}function V(f,x,R){var U=x[1],K=x[0],ue=U-K;return f===U&&R?f:((f-K)%ue+ue)%ue+K}function G(){return!1}function ee(f,x){if(x===!1)return f;var R=Math.pow(10,x===void 0?6:x);return Math.round(f*R)/R}function Y(f){return f.trim?f.trim():f.replace(/^\s+|\s+$/g,"")}function xe(f){return Y(f).split(/\s+/)}function be(f,x){Object.prototype.hasOwnProperty.call(f,"options")||(f.options=f.options?m(f.options):{});for(var R in x)f.options[R]=x[R];return f.options}function Ne(f,x,R){var U=[];for(var K in f)U.push(encodeURIComponent(R?K.toUpperCase():K)+"="+encodeURIComponent(f[K]));return(!x||x.indexOf("?")===-1?"?":"&")+U.join("&")}var tt=/\{ *([\w_ -]+) *\}/g;function Je(f,x){return f.replace(tt,function(R,U){var K=x[U];if(K===void 0)throw new Error("No value provided for variable "+R);return typeof K=="function"&&(K=K(x)),K})}var Xe=Array.isArray||function(f){return Object.prototype.toString.call(f)==="[object Array]"};function Ke(f,x){for(var R=0;R<f.length;R++)if(f[R]===x)return R;return-1}var Ge="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Fe(f){return window["webkit"+f]||window["moz"+f]||window["ms"+f]}var de=0;function ce(f){var x=+new Date,R=Math.max(0,16-(x-de));return de=x+R,window.setTimeout(f,R)}var ge=window.requestAnimationFrame||Fe("RequestAnimationFrame")||ce,Ae=window.cancelAnimationFrame||Fe("CancelAnimationFrame")||Fe("CancelRequestAnimationFrame")||function(f){window.clearTimeout(f)};function Re(f,x,R){if(R&&ge===ce)f.call(x);else return ge.call(window,_(f,x))}function je(f){f&&Ae.call(window,f)}var Pe={__proto__:null,extend:d,create:m,bind:_,get lastId(){return c},stamp:C,throttle:k,wrapNum:V,falseFn:G,formatNum:ee,trim:Y,splitWords:xe,setOptions:be,getParamString:Ne,template:Je,isArray:Xe,indexOf:Ke,emptyImageUrl:Ge,requestFn:ge,cancelFn:Ae,requestAnimFrame:Re,cancelAnimFrame:je};function Mn(){}Mn.extend=function(f){var x=function(){be(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},R=x.__super__=this.prototype,U=m(R);U.constructor=x,x.prototype=U;for(var K in this)Object.prototype.hasOwnProperty.call(this,K)&&K!=="prototype"&&K!=="__super__"&&(x[K]=this[K]);return f.statics&&d(x,f.statics),f.includes&&(ni(f.includes),d.apply(null,[U].concat(f.includes))),d(U,f),delete U.statics,delete U.includes,U.options&&(U.options=R.options?m(R.options):{},d(U.options,f.options)),U._initHooks=[],U.callInitHooks=function(){if(!this._initHooksCalled){R.callInitHooks&&R.callInitHooks.call(this),this._initHooksCalled=!0;for(var ue=0,Oe=U._initHooks.length;ue<Oe;ue++)U._initHooks[ue].call(this)}},x},Mn.include=function(f){var x=this.prototype.options;return d(this.prototype,f),f.options&&(this.prototype.options=x,this.mergeOptions(f.options)),this},Mn.mergeOptions=function(f){return d(this.prototype.options,f),this},Mn.addInitHook=function(f){var x=Array.prototype.slice.call(arguments,1),R=typeof f=="function"?f:function(){this[f].apply(this,x)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(R),this};function ni(f){if(!(typeof L>"u"||!L||!L.Mixin)){f=Xe(f)?f:[f];for(var x=0;x<f.length;x++)f[x]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var mt={on:function(f,x,R){if(typeof f=="object")for(var U in f)this._on(U,f[U],x);else{f=xe(f);for(var K=0,ue=f.length;K<ue;K++)this._on(f[K],x,R)}return this},off:function(f,x,R){if(!arguments.length)delete this._events;else if(typeof f=="object")for(var U in f)this._off(U,f[U],x);else{f=xe(f);for(var K=arguments.length===1,ue=0,Oe=f.length;ue<Oe;ue++)K?this._off(f[ue]):this._off(f[ue],x,R)}return this},_on:function(f,x,R,U){if(typeof x!="function"){console.warn("wrong listener type: "+typeof x);return}if(this._listens(f,x,R)===!1){R===this&&(R=void 0);var K={fn:x,ctx:R};U&&(K.once=!0),this._events=this._events||{},this._events[f]=this._events[f]||[],this._events[f].push(K)}},_off:function(f,x,R){var U,K,ue;if(this._events&&(U=this._events[f],!!U)){if(arguments.length===1){if(this._firingCount)for(K=0,ue=U.length;K<ue;K++)U[K].fn=G;delete this._events[f];return}if(typeof x!="function"){console.warn("wrong listener type: "+typeof x);return}var Oe=this._listens(f,x,R);if(Oe!==!1){var nt=U[Oe];this._firingCount&&(nt.fn=G,this._events[f]=U=U.slice()),U.splice(Oe,1)}}},fire:function(f,x,R){if(!this.listens(f,R))return this;var U=d({},x,{type:f,target:this,sourceTarget:x&&x.sourceTarget||this});if(this._events){var K=this._events[f];if(K){this._firingCount=this._firingCount+1||1;for(var ue=0,Oe=K.length;ue<Oe;ue++){var nt=K[ue],ut=nt.fn;nt.once&&this.off(f,ut,nt.ctx),ut.call(nt.ctx||this,U)}this._firingCount--}}return R&&this._propagateEvent(U),this},listens:function(f,x,R,U){typeof f!="string"&&console.warn('"string" type argument expected');var K=x;typeof x!="function"&&(U=!!x,K=void 0,R=void 0);var ue=this._events&&this._events[f];if(ue&&ue.length&&this._listens(f,K,R)!==!1)return!0;if(U){for(var Oe in this._eventParents)if(this._eventParents[Oe].listens(f,x,R,U))return!0}return!1},_listens:function(f,x,R){if(!this._events)return!1;var U=this._events[f]||[];if(!x)return!!U.length;R===this&&(R=void 0);for(var K=0,ue=U.length;K<ue;K++)if(U[K].fn===x&&U[K].ctx===R)return K;return!1},once:function(f,x,R){if(typeof f=="object")for(var U in f)this._on(U,f[U],x,!0);else{f=xe(f);for(var K=0,ue=f.length;K<ue;K++)this._on(f[K],x,R,!0)}return this},addEventParent:function(f){return this._eventParents=this._eventParents||{},this._eventParents[C(f)]=f,this},removeEventParent:function(f){return this._eventParents&&delete this._eventParents[C(f)],this},_propagateEvent:function(f){for(var x in this._eventParents)this._eventParents[x].fire(f.type,d({layer:f.target,propagatedFrom:f.target},f),!0)}};mt.addEventListener=mt.on,mt.removeEventListener=mt.clearAllEventListeners=mt.off,mt.addOneTimeEventListener=mt.once,mt.fireEvent=mt.fire,mt.hasEventListeners=mt.listens;var At=Mn.extend(mt);function bt(f,x,R){this.x=R?Math.round(f):f,this.y=R?Math.round(x):x}var Zt=Math.trunc||function(f){return f>0?Math.floor(f):Math.ceil(f)};bt.prototype={clone:function(){return new bt(this.x,this.y)},add:function(f){return this.clone()._add(Vt(f))},_add:function(f){return this.x+=f.x,this.y+=f.y,this},subtract:function(f){return this.clone()._subtract(Vt(f))},_subtract:function(f){return this.x-=f.x,this.y-=f.y,this},divideBy:function(f){return this.clone()._divideBy(f)},_divideBy:function(f){return this.x/=f,this.y/=f,this},multiplyBy:function(f){return this.clone()._multiplyBy(f)},_multiplyBy:function(f){return this.x*=f,this.y*=f,this},scaleBy:function(f){return new bt(this.x*f.x,this.y*f.y)},unscaleBy:function(f){return new bt(this.x/f.x,this.y/f.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Zt(this.x),this.y=Zt(this.y),this},distanceTo:function(f){f=Vt(f);var x=f.x-this.x,R=f.y-this.y;return Math.sqrt(x*x+R*R)},equals:function(f){return f=Vt(f),f.x===this.x&&f.y===this.y},contains:function(f){return f=Vt(f),Math.abs(f.x)<=Math.abs(this.x)&&Math.abs(f.y)<=Math.abs(this.y)},toString:function(){return"Point("+ee(this.x)+", "+ee(this.y)+")"}};function Vt(f,x,R){return f instanceof bt?f:Xe(f)?new bt(f[0],f[1]):f==null?f:typeof f=="object"&&"x"in f&&"y"in f?new bt(f.x,f.y):new bt(f,x,R)}function ke(f,x){if(f)for(var R=x?[f,x]:f,U=0,K=R.length;U<K;U++)this.extend(R[U])}ke.prototype={extend:function(f){var x,R;if(!f)return this;if(f instanceof bt||typeof f[0]=="number"||"x"in f)x=R=Vt(f);else if(f=xt(f),x=f.min,R=f.max,!x||!R)return this;return!this.min&&!this.max?(this.min=x.clone(),this.max=R.clone()):(this.min.x=Math.min(x.x,this.min.x),this.max.x=Math.max(R.x,this.max.x),this.min.y=Math.min(x.y,this.min.y),this.max.y=Math.max(R.y,this.max.y)),this},getCenter:function(f){return Vt((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,f)},getBottomLeft:function(){return Vt(this.min.x,this.max.y)},getTopRight:function(){return Vt(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(f){var x,R;return typeof f[0]=="number"||f instanceof bt?f=Vt(f):f=xt(f),f instanceof ke?(x=f.min,R=f.max):x=R=f,x.x>=this.min.x&&R.x<=this.max.x&&x.y>=this.min.y&&R.y<=this.max.y},intersects:function(f){f=xt(f);var x=this.min,R=this.max,U=f.min,K=f.max,ue=K.x>=x.x&&U.x<=R.x,Oe=K.y>=x.y&&U.y<=R.y;return ue&&Oe},overlaps:function(f){f=xt(f);var x=this.min,R=this.max,U=f.min,K=f.max,ue=K.x>x.x&&U.x<R.x,Oe=K.y>x.y&&U.y<R.y;return ue&&Oe},isValid:function(){return!!(this.min&&this.max)},pad:function(f){var x=this.min,R=this.max,U=Math.abs(x.x-R.x)*f,K=Math.abs(x.y-R.y)*f;return xt(Vt(x.x-U,x.y-K),Vt(R.x+U,R.y+K))},equals:function(f){return f?(f=xt(f),this.min.equals(f.getTopLeft())&&this.max.equals(f.getBottomRight())):!1}};function xt(f,x){return!f||f instanceof ke?f:new ke(f,x)}function Ot(f,x){if(f)for(var R=x?[f,x]:f,U=0,K=R.length;U<K;U++)this.extend(R[U])}Ot.prototype={extend:function(f){var x=this._southWest,R=this._northEast,U,K;if(f instanceof Jt)U=f,K=f;else if(f instanceof Ot){if(U=f._southWest,K=f._northEast,!U||!K)return this}else return f?this.extend(Wt(f)||Ut(f)):this;return!x&&!R?(this._southWest=new Jt(U.lat,U.lng),this._northEast=new Jt(K.lat,K.lng)):(x.lat=Math.min(U.lat,x.lat),x.lng=Math.min(U.lng,x.lng),R.lat=Math.max(K.lat,R.lat),R.lng=Math.max(K.lng,R.lng)),this},pad:function(f){var x=this._southWest,R=this._northEast,U=Math.abs(x.lat-R.lat)*f,K=Math.abs(x.lng-R.lng)*f;return new Ot(new Jt(x.lat-U,x.lng-K),new Jt(R.lat+U,R.lng+K))},getCenter:function(){return new Jt((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Jt(this.getNorth(),this.getWest())},getSouthEast:function(){return new Jt(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(f){typeof f[0]=="number"||f instanceof Jt||"lat"in f?f=Wt(f):f=Ut(f);var x=this._southWest,R=this._northEast,U,K;return f instanceof Ot?(U=f.getSouthWest(),K=f.getNorthEast()):U=K=f,U.lat>=x.lat&&K.lat<=R.lat&&U.lng>=x.lng&&K.lng<=R.lng},intersects:function(f){f=Ut(f);var x=this._southWest,R=this._northEast,U=f.getSouthWest(),K=f.getNorthEast(),ue=K.lat>=x.lat&&U.lat<=R.lat,Oe=K.lng>=x.lng&&U.lng<=R.lng;return ue&&Oe},overlaps:function(f){f=Ut(f);var x=this._southWest,R=this._northEast,U=f.getSouthWest(),K=f.getNorthEast(),ue=K.lat>x.lat&&U.lat<R.lat,Oe=K.lng>x.lng&&U.lng<R.lng;return ue&&Oe},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(f,x){return f?(f=Ut(f),this._southWest.equals(f.getSouthWest(),x)&&this._northEast.equals(f.getNorthEast(),x)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Ut(f,x){return f instanceof Ot?f:new Ot(f,x)}function Jt(f,x,R){if(isNaN(f)||isNaN(x))throw new Error("Invalid LatLng object: ("+f+", "+x+")");this.lat=+f,this.lng=+x,R!==void 0&&(this.alt=+R)}Jt.prototype={equals:function(f,x){if(!f)return!1;f=Wt(f);var R=Math.max(Math.abs(this.lat-f.lat),Math.abs(this.lng-f.lng));return R<=(x===void 0?1e-9:x)},toString:function(f){return"LatLng("+ee(this.lat,f)+", "+ee(this.lng,f)+")"},distanceTo:function(f){return oi.distance(this,Wt(f))},wrap:function(){return oi.wrapLatLng(this)},toBounds:function(f){var x=180*f/40075017,R=x/Math.cos(Math.PI/180*this.lat);return Ut([this.lat-x,this.lng-R],[this.lat+x,this.lng+R])},clone:function(){return new Jt(this.lat,this.lng,this.alt)}};function Wt(f,x,R){return f instanceof Jt?f:Xe(f)&&typeof f[0]!="object"?f.length===3?new Jt(f[0],f[1],f[2]):f.length===2?new Jt(f[0],f[1]):null:f==null?f:typeof f=="object"&&"lat"in f?new Jt(f.lat,"lng"in f?f.lng:f.lon,f.alt):x===void 0?null:new Jt(f,x,R)}var Fn={latLngToPoint:function(f,x){var R=this.projection.project(f),U=this.scale(x);return this.transformation._transform(R,U)},pointToLatLng:function(f,x){var R=this.scale(x),U=this.transformation.untransform(f,R);return this.projection.unproject(U)},project:function(f){return this.projection.project(f)},unproject:function(f){return this.projection.unproject(f)},scale:function(f){return 256*Math.pow(2,f)},zoom:function(f){return Math.log(f/256)/Math.LN2},getProjectedBounds:function(f){if(this.infinite)return null;var x=this.projection.bounds,R=this.scale(f),U=this.transformation.transform(x.min,R),K=this.transformation.transform(x.max,R);return new ke(U,K)},infinite:!1,wrapLatLng:function(f){var x=this.wrapLng?V(f.lng,this.wrapLng,!0):f.lng,R=this.wrapLat?V(f.lat,this.wrapLat,!0):f.lat,U=f.alt;return new Jt(R,x,U)},wrapLatLngBounds:function(f){var x=f.getCenter(),R=this.wrapLatLng(x),U=x.lat-R.lat,K=x.lng-R.lng;if(U===0&&K===0)return f;var ue=f.getSouthWest(),Oe=f.getNorthEast(),nt=new Jt(ue.lat-U,ue.lng-K),ut=new Jt(Oe.lat-U,Oe.lng-K);return new Ot(nt,ut)}},oi=d({},Fn,{wrapLng:[-180,180],R:6371e3,distance:function(f,x){var R=Math.PI/180,U=f.lat*R,K=x.lat*R,ue=Math.sin((x.lat-f.lat)*R/2),Oe=Math.sin((x.lng-f.lng)*R/2),nt=ue*ue+Math.cos(U)*Math.cos(K)*Oe*Oe,ut=2*Math.atan2(Math.sqrt(nt),Math.sqrt(1-nt));return this.R*ut}}),fi=6378137,ds={R:fi,MAX_LATITUDE:85.0511287798,project:function(f){var x=Math.PI/180,R=this.MAX_LATITUDE,U=Math.max(Math.min(R,f.lat),-R),K=Math.sin(U*x);return new bt(this.R*f.lng*x,this.R*Math.log((1+K)/(1-K))/2)},unproject:function(f){var x=180/Math.PI;return new Jt((2*Math.atan(Math.exp(f.y/this.R))-Math.PI/2)*x,f.x*x/this.R)},bounds:(function(){var f=fi*Math.PI;return new ke([-f,-f],[f,f])})()};function Ns(f,x,R,U){if(Xe(f)){this._a=f[0],this._b=f[1],this._c=f[2],this._d=f[3];return}this._a=f,this._b=x,this._c=R,this._d=U}Ns.prototype={transform:function(f,x){return this._transform(f.clone(),x)},_transform:function(f,x){return x=x||1,f.x=x*(this._a*f.x+this._b),f.y=x*(this._c*f.y+this._d),f},untransform:function(f,x){return x=x||1,new bt((f.x/x-this._b)/this._a,(f.y/x-this._d)/this._c)}};function Dr(f,x,R,U){return new Ns(f,x,R,U)}var Fi=d({},oi,{code:"EPSG:3857",projection:ds,transformation:(function(){var f=.5/(Math.PI*ds.R);return Dr(f,.5,-f,.5)})()}),Pi=d({},Fi,{code:"EPSG:900913"});function Va(f){return document.createElementNS("http://www.w3.org/2000/svg",f)}function Ta(f,x){var R="",U,K,ue,Oe,nt,ut;for(U=0,ue=f.length;U<ue;U++){for(nt=f[U],K=0,Oe=nt.length;K<Oe;K++)ut=nt[K],R+=(K?"L":"M")+ut.x+" "+ut.y;R+=x?en.svg?"z":"x":""}return R||"M0 0"}var Bs=document.documentElement.style,Sa="ActiveXObject"in window,Vi=Sa&&!document.addEventListener,pr="msLaunchUri"in navigator&&!("documentMode"in document),Ea=Rt("webkit"),wo=Rt("android"),ao=Rt("android 2")||Rt("android 3"),qr=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),fs=wo&&Rt("Google")&&qr<537&&!("AudioNode"in window),ps=!!window.opera,Fs=!pr&&Rt("chrome"),ms=Rt("gecko")&&!Ea&&!ps&&!Sa,We=!Fs&&Rt("safari"),se=Rt("phantom"),le="OTransition"in Bs,fe=navigator.platform.indexOf("Win")===0,Se=Sa&&"transition"in Bs,De="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ao,$e="MozPerspective"in Bs,et=!window.L_DISABLE_3D&&(Se||De||$e)&&!le&&!se,Ze=typeof orientation<"u"||Rt("mobile"),_t=Ze&&Ea,Pt=Ze&&De,wt=!window.PointerEvent&&window.MSPointerEvent,tn=!!(window.PointerEvent||wt),qe="ontouchstart"in window||!!window.TouchEvent,vn=!window.L_NO_TOUCH&&(qe||tn),Rn=Ze&&ps,nn=Ze&&ms,Nn=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Ri=(function(){var f=!1;try{var x=Object.defineProperty({},"passive",{get:function(){f=!0}});window.addEventListener("testPassiveEventSupport",G,x),window.removeEventListener("testPassiveEventSupport",G,x)}catch{}return f})(),Gi=(function(){return!!document.createElement("canvas").getContext})(),tr=!!(document.createElementNS&&Va("svg").createSVGRect),Ir=!!tr&&(function(){var f=document.createElement("div");return f.innerHTML="<svg/>",(f.firstChild&&f.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),Vn=!tr&&(function(){try{var f=document.createElement("div");f.innerHTML='<v:shape adj="1"/>';var x=f.firstChild;return x.style.behavior="url(#default#VML)",x&&typeof x.adj=="object"}catch{return!1}})(),Kn=navigator.platform.indexOf("Mac")===0,br=navigator.platform.indexOf("Linux")===0;function Rt(f){return navigator.userAgent.toLowerCase().indexOf(f)>=0}var en={ie:Sa,ielt9:Vi,edge:pr,webkit:Ea,android:wo,android23:ao,androidStock:fs,opera:ps,chrome:Fs,gecko:ms,safari:We,phantom:se,opera12:le,win:fe,ie3d:Se,webkit3d:De,gecko3d:$e,any3d:et,mobile:Ze,mobileWebkit:_t,mobileWebkit3d:Pt,msPointer:wt,pointer:tn,touch:vn,touchNative:qe,mobileOpera:Rn,mobileGecko:nn,retina:Nn,passiveEvents:Ri,canvas:Gi,svg:tr,vml:Vn,inlineSvg:Ir,mac:Kn,linux:br},nr=en.msPointer?"MSPointerDown":"pointerdown",ta=en.msPointer?"MSPointerMove":"pointermove",Aa=en.msPointer?"MSPointerUp":"pointerup",kt=en.msPointer?"MSPointerCancel":"pointercancel",yn={touchstart:nr,touchmove:ta,touchend:Aa,touchcancel:kt},In={touchstart:Ei,touchmove:Gr,touchend:Gr,touchcancel:Gr},ir={},tl=!1;function To(f,x,R){return x==="touchstart"&&$r(),In[x]?(R=In[x].bind(this,R),f.addEventListener(yn[x],R,!1),R):(console.warn("wrong event specified:",x),G)}function Bn(f,x,R){if(!yn[x]){console.warn("wrong event specified:",x);return}f.removeEventListener(yn[x],R,!1)}function Vs(f){ir[f.pointerId]=f}function Us(f){ir[f.pointerId]&&(ir[f.pointerId]=f)}function gs(f){delete ir[f.pointerId]}function $r(){tl||(document.addEventListener(nr,Vs,!0),document.addEventListener(ta,Us,!0),document.addEventListener(Aa,gs,!0),document.addEventListener(kt,gs,!0),tl=!0)}function Gr(f,x){if(x.pointerType!==(x.MSPOINTER_TYPE_MOUSE||"mouse")){x.touches=[];for(var R in ir)x.touches.push(ir[R]);x.changedTouches=[x],f(x)}}function Ei(f,x){x.MSPOINTER_TYPE_TOUCH&&x.pointerType===x.MSPOINTER_TYPE_TOUCH&&sn(x),Gr(f,x)}function Mr(f){var x={},R,U;for(U in f)R=f[U],x[U]=R&&R.bind?R.bind(f):R;return f=x,x.type="dblclick",x.detail=2,x.isTrusted=!1,x._simulated=!0,x}var da=200;function wi(f,x){f.addEventListener("dblclick",x);var R=0,U;function K(ue){if(ue.detail!==1){U=ue.detail;return}if(!(ue.pointerType==="mouse"||ue.sourceCapabilities&&!ue.sourceCapabilities.firesTouchEvents)){var Oe=qn(ue);if(!(Oe.some(function(ut){return ut instanceof HTMLLabelElement&&ut.attributes.for})&&!Oe.some(function(ut){return ut instanceof HTMLInputElement||ut instanceof HTMLSelectElement}))){var nt=Date.now();nt-R<=da?(U++,U===2&&x(Mr(ue))):U=1,R=nt}}}return f.addEventListener("click",K),{dblclick:x,simDblclick:K}}function So(f,x){f.removeEventListener("dblclick",x.dblclick),f.removeEventListener("click",x.simDblclick)}var Ua=Pl(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Eo=Pl(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),js=Eo==="webkitTransition"||Eo==="OTransition"?Eo+"End":"transitionend";function qs(f){return typeof f=="string"?document.getElementById(f):f}function nl(f,x){var R=f.style[x]||f.currentStyle&&f.currentStyle[x];if((!R||R==="auto")&&document.defaultView){var U=document.defaultView.getComputedStyle(f,null);R=U?U[x]:null}return R==="auto"?null:R}function ii(f,x,R){var U=document.createElement(f);return U.className=x||"",R&&R.appendChild(U),U}function hi(f){var x=f.parentNode;x&&x.removeChild(f)}function Zi(f){for(;f.firstChild;)f.removeChild(f.firstChild)}function xr(f){var x=f.parentNode;x&&x.lastChild!==f&&x.appendChild(f)}function $s(f){var x=f.parentNode;x&&x.firstChild!==f&&x.insertBefore(f,x.firstChild)}function uu(f,x){if(f.classList!==void 0)return f.classList.contains(x);var R=so(f);return R.length>0&&new RegExp("(^|\\s)"+x+"(\\s|$)").test(R)}function on(f,x){if(f.classList!==void 0)for(var R=xe(x),U=0,K=R.length;U<K;U++)f.classList.add(R[U]);else if(!uu(f,x)){var ue=so(f);Ca(f,(ue?ue+" ":"")+x)}}function Ui(f,x){f.classList!==void 0?f.classList.remove(x):Ca(f,Y((" "+so(f)+" ").replace(" "+x+" "," ")))}function Ca(f,x){f.className.baseVal===void 0?f.className=x:f.className.baseVal=x}function so(f){return f.correspondingElement&&(f=f.correspondingElement),f.className.baseVal===void 0?f.className:f.className.baseVal}function rr(f,x){"opacity"in f.style?f.style.opacity=x:"filter"in f.style&&Ao(f,x)}function Ao(f,x){var R=!1,U="DXImageTransform.Microsoft.Alpha";try{R=f.filters.item(U)}catch{if(x===1)return}x=Math.round(x*100),R?(R.Enabled=x!==100,R.Opacity=x):f.style.filter+=" progid:"+U+"(opacity="+x+")"}function Pl(f){for(var x=document.documentElement.style,R=0;R<f.length;R++)if(f[R]in x)return f[R];return!1}function Gs(f,x,R){var U=x||new bt(0,0);f.style[Ua]=(en.ie3d?"translate("+U.x+"px,"+U.y+"px)":"translate3d("+U.x+"px,"+U.y+"px,0)")+(R?" scale("+R+")":"")}function ar(f,x){f._leaflet_pos=x,en.any3d?Gs(f,x):(f.style.left=x.x+"px",f.style.top=x.y+"px")}function Qa(f){return f._leaflet_pos||new bt(0,0)}var ja,Hi,Un;if("onselectstart"in document)ja=function(){hn(window,"selectstart",sn)},Hi=function(){xn(window,"selectstart",sn)};else{var Ja=Pl(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);ja=function(){if(Ja){var f=document.documentElement.style;Un=f[Ja],f[Ja]="none"}},Hi=function(){Ja&&(document.documentElement.style[Ja]=Un,Un=void 0)}}function _s(){hn(window,"dragstart",sn)}function qa(){xn(window,"dragstart",sn)}var Zs,Ln;function ys(f){for(;f.tabIndex===-1;)f=f.parentNode;f.style&&(Ia(),Zs=f,Ln=f.style.outlineStyle,f.style.outlineStyle="none",hn(window,"keydown",Ia))}function Ia(){Zs&&(Zs.style.outlineStyle=Ln,Zs=void 0,Ln=void 0,xn(window,"keydown",Ia))}function Rl(f){do f=f.parentNode;while((!f.offsetWidth||!f.offsetHeight)&&f!==document.body);return f}function Wi(f){var x=f.getBoundingClientRect();return{x:x.width/f.offsetWidth||1,y:x.height/f.offsetHeight||1,boundingClientRect:x}}var mr={__proto__:null,TRANSFORM:Ua,TRANSITION:Eo,TRANSITION_END:js,get:qs,getStyle:nl,create:ii,remove:hi,empty:Zi,toFront:xr,toBack:$s,hasClass:uu,addClass:on,removeClass:Ui,setClass:Ca,getClass:so,setOpacity:rr,testProp:Pl,setTransform:Gs,setPosition:ar,getPosition:Qa,get disableTextSelection(){return ja},get enableTextSelection(){return Hi},disableImageDrag:_s,enableImageDrag:qa,preventOutline:ys,restoreOutline:Ia,getSizedParentNode:Rl,getScale:Wi};function hn(f,x,R,U){if(x&&typeof x=="object")for(var K in x)cr(f,K,x[K],R);else{x=xe(x);for(var ue=0,Oe=x.length;ue<Oe;ue++)cr(f,x[ue],R,U)}return this}var pi="_leaflet_events";function xn(f,x,R,U){if(arguments.length===1)il(f),delete f[pi];else if(x&&typeof x=="object")for(var K in x)wr(f,K,x[K],R);else if(x=xe(x),arguments.length===2)il(f,function(nt){return Ke(x,nt)!==-1});else for(var ue=0,Oe=x.length;ue<Oe;ue++)wr(f,x[ue],R,U);return this}function il(f,x){for(var R in f[pi]){var U=R.split(/\d/)[0];(!x||x(U))&&wr(f,U,null,null,R)}}var sr={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function cr(f,x,R,U){var K=x+C(R)+(U?"_"+C(U):"");if(f[pi]&&f[pi][K])return this;var ue=function(nt){return R.call(U||f,nt||window.event)},Oe=ue;!en.touchNative&&en.pointer&&x.indexOf("touch")===0?ue=To(f,x,ue):en.touch&&x==="dblclick"?ue=wi(f,ue):"addEventListener"in f?x==="touchstart"||x==="touchmove"||x==="wheel"||x==="mousewheel"?f.addEventListener(sr[x]||x,ue,en.passiveEvents?{passive:!1}:!1):x==="mouseenter"||x==="mouseleave"?(ue=function(nt){nt=nt||window.event,vs(f,nt)&&Oe(nt)},f.addEventListener(sr[x],ue,!1)):f.addEventListener(x,Oe,!1):f.attachEvent("on"+x,ue),f[pi]=f[pi]||{},f[pi][K]=ue}function wr(f,x,R,U,K){K=K||x+C(R)+(U?"_"+C(U):"");var ue=f[pi]&&f[pi][K];if(!ue)return this;!en.touchNative&&en.pointer&&x.indexOf("touch")===0?Bn(f,x,ue):en.touch&&x==="dblclick"?So(f,ue):"removeEventListener"in f?f.removeEventListener(sr[x]||x,ue,!1):f.detachEvent("on"+x,ue),f[pi][K]=null}function bn(f){return f.stopPropagation?f.stopPropagation():f.originalEvent?f.originalEvent._stopped=!0:f.cancelBubble=!0,this}function fa(f){return cr(f,"wheel",bn),this}function fn(f){return hn(f,"mousedown touchstart dblclick contextmenu",bn),f._leaflet_disable_click=!0,this}function sn(f){return f.preventDefault?f.preventDefault():f.returnValue=!1,this}function na(f){return sn(f),bn(f),this}function qn(f){if(f.composedPath)return f.composedPath();for(var x=[],R=f.target;R;)x.push(R),R=R.parentNode;return x}function zr(f,x){if(!x)return new bt(f.clientX,f.clientY);var R=Wi(x),U=R.boundingClientRect;return new bt((f.clientX-U.left)/R.x-x.clientLeft,(f.clientY-U.top)/R.y-x.clientTop)}var Yr=en.linux&&en.chrome?window.devicePixelRatio:en.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function or(f){return en.edge?f.wheelDeltaY/2:f.deltaY&&f.deltaMode===0?-f.deltaY/Yr:f.deltaY&&f.deltaMode===1?-f.deltaY*20:f.deltaY&&f.deltaMode===2?-f.deltaY*60:f.deltaX||f.deltaZ?0:f.wheelDelta?(f.wheelDeltaY||f.wheelDelta)/2:f.detail&&Math.abs(f.detail)<32765?-f.detail*20:f.detail?f.detail/-32765*60:0}function vs(f,x){var R=x.relatedTarget;if(!R)return!0;try{for(;R&&R!==f;)R=R.parentNode}catch{return!1}return R!==f}var oo={__proto__:null,on:hn,off:xn,stopPropagation:bn,disableScrollPropagation:fa,disableClickPropagation:fn,preventDefault:sn,stop:na,getPropagationPath:qn,getMousePosition:zr,getWheelDelta:or,isExternalTarget:vs,addListener:hn,removeListener:xn},bs=At.extend({run:function(f,x,R,U){this.stop(),this._el=f,this._inProgress=!0,this._duration=R||.25,this._easeOutPower=1/Math.max(U||.5,.2),this._startPos=Qa(f),this._offset=x.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=Re(this._animate,this),this._step()},_step:function(f){var x=+new Date-this._startTime,R=this._duration*1e3;x<R?this._runFrame(this._easeOut(x/R),f):(this._runFrame(1),this._complete())},_runFrame:function(f,x){var R=this._startPos.add(this._offset.multiplyBy(f));x&&R._round(),ar(this._el,R),this.fire("step")},_complete:function(){je(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(f){return 1-Math.pow(1-f,this._easeOutPower)}}),Wn=At.extend({options:{crs:Fi,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(f,x){x=be(this,x),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(f),this._initLayout(),this._onResize=_(this._onResize,this),this._initEvents(),x.maxBounds&&this.setMaxBounds(x.maxBounds),x.zoom!==void 0&&(this._zoom=this._limitZoom(x.zoom)),x.center&&x.zoom!==void 0&&this.setView(Wt(x.center),x.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Eo&&en.any3d&&!en.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),hn(this._proxy,js,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(f,x,R){if(x=x===void 0?this._zoom:this._limitZoom(x),f=this._limitCenter(Wt(f),x,this.options.maxBounds),R=R||{},this._stop(),this._loaded&&!R.reset&&R!==!0){R.animate!==void 0&&(R.zoom=d({animate:R.animate},R.zoom),R.pan=d({animate:R.animate,duration:R.duration},R.pan));var U=this._zoom!==x?this._tryAnimatedZoom&&this._tryAnimatedZoom(f,x,R.zoom):this._tryAnimatedPan(f,R.pan);if(U)return clearTimeout(this._sizeTimer),this}return this._resetView(f,x,R.pan&&R.pan.noMoveStart),this},setZoom:function(f,x){return this._loaded?this.setView(this.getCenter(),f,{zoom:x}):(this._zoom=f,this)},zoomIn:function(f,x){return f=f||(en.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+f,x)},zoomOut:function(f,x){return f=f||(en.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-f,x)},setZoomAround:function(f,x,R){var U=this.getZoomScale(x),K=this.getSize().divideBy(2),ue=f instanceof bt?f:this.latLngToContainerPoint(f),Oe=ue.subtract(K).multiplyBy(1-1/U),nt=this.containerPointToLatLng(K.add(Oe));return this.setView(nt,x,{zoom:R})},_getBoundsCenterZoom:function(f,x){x=x||{},f=f.getBounds?f.getBounds():Ut(f);var R=Vt(x.paddingTopLeft||x.padding||[0,0]),U=Vt(x.paddingBottomRight||x.padding||[0,0]),K=this.getBoundsZoom(f,!1,R.add(U));if(K=typeof x.maxZoom=="number"?Math.min(x.maxZoom,K):K,K===1/0)return{center:f.getCenter(),zoom:K};var ue=U.subtract(R).divideBy(2),Oe=this.project(f.getSouthWest(),K),nt=this.project(f.getNorthEast(),K),ut=this.unproject(Oe.add(nt).divideBy(2).add(ue),K);return{center:ut,zoom:K}},fitBounds:function(f,x){if(f=Ut(f),!f.isValid())throw new Error("Bounds are not valid.");var R=this._getBoundsCenterZoom(f,x);return this.setView(R.center,R.zoom,x)},fitWorld:function(f){return this.fitBounds([[-90,-180],[90,180]],f)},panTo:function(f,x){return this.setView(f,this._zoom,{pan:x})},panBy:function(f,x){if(f=Vt(f).round(),x=x||{},!f.x&&!f.y)return this.fire("moveend");if(x.animate!==!0&&!this.getSize().contains(f))return this._resetView(this.unproject(this.project(this.getCenter()).add(f)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new bs,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),x.noMoveStart||this.fire("movestart"),x.animate!==!1){on(this._mapPane,"leaflet-pan-anim");var R=this._getMapPanePos().subtract(f).round();this._panAnim.run(this._mapPane,R,x.duration||.25,x.easeLinearity)}else this._rawPanBy(f),this.fire("move").fire("moveend");return this},flyTo:function(f,x,R){if(R=R||{},R.animate===!1||!en.any3d)return this.setView(f,x,R);this._stop();var U=this.project(this.getCenter()),K=this.project(f),ue=this.getSize(),Oe=this._zoom;f=Wt(f),x=x===void 0?Oe:x;var nt=Math.max(ue.x,ue.y),ut=nt*this.getZoomScale(Oe,x),Mt=K.distanceTo(U)||1,Kt=1.42,pn=Kt*Kt;function Yn(Nr){var rs=Nr?-1:1,fl=Nr?ut:nt,Oo=ut*ut-nt*nt+rs*pn*pn*Mt*Mt,xu=2*fl*pn*Mt,tc=Oo/xu,Ol=Math.sqrt(tc*tc+1)-tc,pl=Ol<1e-9?-18:Math.log(Ol);return pl}function ga(Nr){return(Math.exp(Nr)-Math.exp(-Nr))/2}function Zr(Nr){return(Math.exp(Nr)+Math.exp(-Nr))/2}function Za(Nr){return ga(Nr)/Zr(Nr)}var Si=Yn(0);function Li(Nr){return nt*(Zr(Si)/Zr(Si+Kt*Nr))}function ui(Nr){return nt*(Zr(Si)*Za(Si+Kt*Nr)-ga(Si))/pn}function ki(Nr){return 1-Math.pow(1-Nr,1.5)}var Hr=Date.now(),is=(Yn(1)-Si)/Kt,zo=R.duration?1e3*R.duration:1e3*is*.8;function bu(){var Nr=(Date.now()-Hr)/zo,rs=ki(Nr)*is;Nr<=1?(this._flyToFrame=Re(bu,this),this._move(this.unproject(U.add(K.subtract(U).multiplyBy(ui(rs)/Mt)),Oe),this.getScaleZoom(nt/Li(rs),Oe),{flyTo:!0})):this._move(f,x)._moveEnd(!0)}return this._moveStart(!0,R.noMoveStart),bu.call(this),this},flyToBounds:function(f,x){var R=this._getBoundsCenterZoom(f,x);return this.flyTo(R.center,R.zoom,x)},setMaxBounds:function(f){return f=Ut(f),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),f.isValid()?(this.options.maxBounds=f,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(f){var x=this.options.minZoom;return this.options.minZoom=f,this._loaded&&x!==f&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(f):this},setMaxZoom:function(f){var x=this.options.maxZoom;return this.options.maxZoom=f,this._loaded&&x!==f&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(f):this},panInsideBounds:function(f,x){this._enforcingBounds=!0;var R=this.getCenter(),U=this._limitCenter(R,this._zoom,Ut(f));return R.equals(U)||this.panTo(U,x),this._enforcingBounds=!1,this},panInside:function(f,x){x=x||{};var R=Vt(x.paddingTopLeft||x.padding||[0,0]),U=Vt(x.paddingBottomRight||x.padding||[0,0]),K=this.project(this.getCenter()),ue=this.project(f),Oe=this.getPixelBounds(),nt=xt([Oe.min.add(R),Oe.max.subtract(U)]),ut=nt.getSize();if(!nt.contains(ue)){this._enforcingBounds=!0;var Mt=ue.subtract(nt.getCenter()),Kt=nt.extend(ue).getSize().subtract(ut);K.x+=Mt.x<0?-Kt.x:Kt.x,K.y+=Mt.y<0?-Kt.y:Kt.y,this.panTo(this.unproject(K),x),this._enforcingBounds=!1}return this},invalidateSize:function(f){if(!this._loaded)return this;f=d({animate:!1,pan:!0},f===!0?{animate:!0}:f);var x=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var R=this.getSize(),U=x.divideBy(2).round(),K=R.divideBy(2).round(),ue=U.subtract(K);return!ue.x&&!ue.y?this:(f.animate&&f.pan?this.panBy(ue):(f.pan&&this._rawPanBy(ue),this.fire("move"),f.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(_(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:x,newSize:R}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(f){if(f=this._locateOptions=d({timeout:1e4,watch:!1},f),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var x=_(this._handleGeolocationResponse,this),R=_(this._handleGeolocationError,this);return f.watch?this._locationWatchId=navigator.geolocation.watchPosition(x,R,f):navigator.geolocation.getCurrentPosition(x,R,f),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(f){if(this._container._leaflet_id){var x=f.code,R=f.message||(x===1?"permission denied":x===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:x,message:"Geolocation error: "+R+"."})}},_handleGeolocationResponse:function(f){if(this._container._leaflet_id){var x=f.coords.latitude,R=f.coords.longitude,U=new Jt(x,R),K=U.toBounds(f.coords.accuracy*2),ue=this._locateOptions;if(ue.setView){var Oe=this.getBoundsZoom(K);this.setView(U,ue.maxZoom?Math.min(Oe,ue.maxZoom):Oe)}var nt={latlng:U,bounds:K,timestamp:f.timestamp};for(var ut in f.coords)typeof f.coords[ut]=="number"&&(nt[ut]=f.coords[ut]);this.fire("locationfound",nt)}},addHandler:function(f,x){if(!x)return this;var R=this[f]=new x(this);return this._handlers.push(R),this.options[f]&&R.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),hi(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(je(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var f;for(f in this._layers)this._layers[f].remove();for(f in this._panes)hi(this._panes[f]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(f,x){var R="leaflet-pane"+(f?" leaflet-"+f.replace("Pane","")+"-pane":""),U=ii("div",R,x||this._mapPane);return f&&(this._panes[f]=U),U},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var f=this.getPixelBounds(),x=this.unproject(f.getBottomLeft()),R=this.unproject(f.getTopRight());return new Ot(x,R)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(f,x,R){f=Ut(f),R=Vt(R||[0,0]);var U=this.getZoom()||0,K=this.getMinZoom(),ue=this.getMaxZoom(),Oe=f.getNorthWest(),nt=f.getSouthEast(),ut=this.getSize().subtract(R),Mt=xt(this.project(nt,U),this.project(Oe,U)).getSize(),Kt=en.any3d?this.options.zoomSnap:1,pn=ut.x/Mt.x,Yn=ut.y/Mt.y,ga=x?Math.max(pn,Yn):Math.min(pn,Yn);return U=this.getScaleZoom(ga,U),Kt&&(U=Math.round(U/(Kt/100))*(Kt/100),U=x?Math.ceil(U/Kt)*Kt:Math.floor(U/Kt)*Kt),Math.max(K,Math.min(ue,U))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new bt(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(f,x){var R=this._getTopLeftPoint(f,x);return new ke(R,R.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(f){return this.options.crs.getProjectedBounds(f===void 0?this.getZoom():f)},getPane:function(f){return typeof f=="string"?this._panes[f]:f},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(f,x){var R=this.options.crs;return x=x===void 0?this._zoom:x,R.scale(f)/R.scale(x)},getScaleZoom:function(f,x){var R=this.options.crs;x=x===void 0?this._zoom:x;var U=R.zoom(f*R.scale(x));return isNaN(U)?1/0:U},project:function(f,x){return x=x===void 0?this._zoom:x,this.options.crs.latLngToPoint(Wt(f),x)},unproject:function(f,x){return x=x===void 0?this._zoom:x,this.options.crs.pointToLatLng(Vt(f),x)},layerPointToLatLng:function(f){var x=Vt(f).add(this.getPixelOrigin());return this.unproject(x)},latLngToLayerPoint:function(f){var x=this.project(Wt(f))._round();return x._subtract(this.getPixelOrigin())},wrapLatLng:function(f){return this.options.crs.wrapLatLng(Wt(f))},wrapLatLngBounds:function(f){return this.options.crs.wrapLatLngBounds(Ut(f))},distance:function(f,x){return this.options.crs.distance(Wt(f),Wt(x))},containerPointToLayerPoint:function(f){return Vt(f).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(f){return Vt(f).add(this._getMapPanePos())},containerPointToLatLng:function(f){var x=this.containerPointToLayerPoint(Vt(f));return this.layerPointToLatLng(x)},latLngToContainerPoint:function(f){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Wt(f)))},mouseEventToContainerPoint:function(f){return zr(f,this._container)},mouseEventToLayerPoint:function(f){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(f))},mouseEventToLatLng:function(f){return this.layerPointToLatLng(this.mouseEventToLayerPoint(f))},_initContainer:function(f){var x=this._container=qs(f);if(x){if(x._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");hn(x,"scroll",this._onScroll,this),this._containerId=C(x)},_initLayout:function(){var f=this._container;this._fadeAnimated=this.options.fadeAnimation&&en.any3d,on(f,"leaflet-container"+(en.touch?" leaflet-touch":"")+(en.retina?" leaflet-retina":"")+(en.ielt9?" leaflet-oldie":"")+(en.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var x=nl(f,"position");x!=="absolute"&&x!=="relative"&&x!=="fixed"&&x!=="sticky"&&(f.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var f=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ar(this._mapPane,new bt(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(on(f.markerPane,"leaflet-zoom-hide"),on(f.shadowPane,"leaflet-zoom-hide"))},_resetView:function(f,x,R){ar(this._mapPane,new bt(0,0));var U=!this._loaded;this._loaded=!0,x=this._limitZoom(x),this.fire("viewprereset");var K=this._zoom!==x;this._moveStart(K,R)._move(f,x)._moveEnd(K),this.fire("viewreset"),U&&this.fire("load")},_moveStart:function(f,x){return f&&this.fire("zoomstart"),x||this.fire("movestart"),this},_move:function(f,x,R,U){x===void 0&&(x=this._zoom);var K=this._zoom!==x;return this._zoom=x,this._lastCenter=f,this._pixelOrigin=this._getNewPixelOrigin(f),U?R&&R.pinch&&this.fire("zoom",R):((K||R&&R.pinch)&&this.fire("zoom",R),this.fire("move",R)),this},_moveEnd:function(f){return f&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return je(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(f){ar(this._mapPane,this._getMapPanePos().subtract(f))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(f){this._targets={},this._targets[C(this._container)]=this;var x=f?xn:hn;x(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&x(window,"resize",this._onResize,this),en.any3d&&this.options.transform3DLimit&&(f?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){je(this._resizeRequest),this._resizeRequest=Re(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var f=this._getMapPanePos();Math.max(Math.abs(f.x),Math.abs(f.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(f,x){for(var R=[],U,K=x==="mouseout"||x==="mouseover",ue=f.target||f.srcElement,Oe=!1;ue;){if(U=this._targets[C(ue)],U&&(x==="click"||x==="preclick")&&this._draggableMoved(U)){Oe=!0;break}if(U&&U.listens(x,!0)&&(K&&!vs(ue,f)||(R.push(U),K))||ue===this._container)break;ue=ue.parentNode}return!R.length&&!Oe&&!K&&this.listens(x,!0)&&(R=[this]),R},_isClickDisabled:function(f){for(;f&&f!==this._container;){if(f._leaflet_disable_click)return!0;f=f.parentNode}},_handleDOMEvent:function(f){var x=f.target||f.srcElement;if(!(!this._loaded||x._leaflet_disable_events||f.type==="click"&&this._isClickDisabled(x))){var R=f.type;R==="mousedown"&&ys(x),this._fireDOMEvent(f,R)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(f,x,R){if(f.type==="click"){var U=d({},f);U.type="preclick",this._fireDOMEvent(U,U.type,R)}var K=this._findEventTargets(f,x);if(R){for(var ue=[],Oe=0;Oe<R.length;Oe++)R[Oe].listens(x,!0)&&ue.push(R[Oe]);K=ue.concat(K)}if(K.length){x==="contextmenu"&&sn(f);var nt=K[0],ut={originalEvent:f};if(f.type!=="keypress"&&f.type!=="keydown"&&f.type!=="keyup"){var Mt=nt.getLatLng&&(!nt._radius||nt._radius<=10);ut.containerPoint=Mt?this.latLngToContainerPoint(nt.getLatLng()):this.mouseEventToContainerPoint(f),ut.layerPoint=this.containerPointToLayerPoint(ut.containerPoint),ut.latlng=Mt?nt.getLatLng():this.layerPointToLatLng(ut.layerPoint)}for(Oe=0;Oe<K.length;Oe++)if(K[Oe].fire(x,ut,!0),ut.originalEvent._stopped||K[Oe].options.bubblingMouseEvents===!1&&Ke(this._mouseEvents,x)!==-1)return}},_draggableMoved:function(f){return f=f.dragging&&f.dragging.enabled()?f:this,f.dragging&&f.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var f=0,x=this._handlers.length;f<x;f++)this._handlers[f].disable()},whenReady:function(f,x){return this._loaded?f.call(x||this,{target:this}):this.on("load",f,x),this},_getMapPanePos:function(){return Qa(this._mapPane)||new bt(0,0)},_moved:function(){var f=this._getMapPanePos();return f&&!f.equals([0,0])},_getTopLeftPoint:function(f,x){var R=f&&x!==void 0?this._getNewPixelOrigin(f,x):this.getPixelOrigin();return R.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(f,x){var R=this.getSize()._divideBy(2);return this.project(f,x)._subtract(R)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(f,x,R){var U=this._getNewPixelOrigin(R,x);return this.project(f,x)._subtract(U)},_latLngBoundsToNewLayerBounds:function(f,x,R){var U=this._getNewPixelOrigin(R,x);return xt([this.project(f.getSouthWest(),x)._subtract(U),this.project(f.getNorthWest(),x)._subtract(U),this.project(f.getSouthEast(),x)._subtract(U),this.project(f.getNorthEast(),x)._subtract(U)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(f){return this.latLngToLayerPoint(f).subtract(this._getCenterLayerPoint())},_limitCenter:function(f,x,R){if(!R)return f;var U=this.project(f,x),K=this.getSize().divideBy(2),ue=new ke(U.subtract(K),U.add(K)),Oe=this._getBoundsOffset(ue,R,x);return Math.abs(Oe.x)<=1&&Math.abs(Oe.y)<=1?f:this.unproject(U.add(Oe),x)},_limitOffset:function(f,x){if(!x)return f;var R=this.getPixelBounds(),U=new ke(R.min.add(f),R.max.add(f));return f.add(this._getBoundsOffset(U,x))},_getBoundsOffset:function(f,x,R){var U=xt(this.project(x.getNorthEast(),R),this.project(x.getSouthWest(),R)),K=U.min.subtract(f.min),ue=U.max.subtract(f.max),Oe=this._rebound(K.x,-ue.x),nt=this._rebound(K.y,-ue.y);return new bt(Oe,nt)},_rebound:function(f,x){return f+x>0?Math.round(f-x)/2:Math.max(0,Math.ceil(f))-Math.max(0,Math.floor(x))},_limitZoom:function(f){var x=this.getMinZoom(),R=this.getMaxZoom(),U=en.any3d?this.options.zoomSnap:1;return U&&(f=Math.round(f/U)*U),Math.max(x,Math.min(R,f))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Ui(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(f,x){var R=this._getCenterOffset(f)._trunc();return(x&&x.animate)!==!0&&!this.getSize().contains(R)?!1:(this.panBy(R,x),!0)},_createAnimProxy:function(){var f=this._proxy=ii("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(f),this.on("zoomanim",function(x){var R=Ua,U=this._proxy.style[R];Gs(this._proxy,this.project(x.center,x.zoom),this.getZoomScale(x.zoom,1)),U===this._proxy.style[R]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){hi(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var f=this.getCenter(),x=this.getZoom();Gs(this._proxy,this.project(f,x),this.getZoomScale(x,1))},_catchTransitionEnd:function(f){this._animatingZoom&&f.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(f,x,R){if(this._animatingZoom)return!0;if(R=R||{},!this._zoomAnimated||R.animate===!1||this._nothingToAnimate()||Math.abs(x-this._zoom)>this.options.zoomAnimationThreshold)return!1;var U=this.getZoomScale(x),K=this._getCenterOffset(f)._divideBy(1-1/U);return R.animate!==!0&&!this.getSize().contains(K)?!1:(Re(function(){this._moveStart(!0,R.noMoveStart||!1)._animateZoom(f,x,!0)},this),!0)},_animateZoom:function(f,x,R,U){this._mapPane&&(R&&(this._animatingZoom=!0,this._animateToCenter=f,this._animateToZoom=x,on(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:f,zoom:x,noUpdate:U}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(_(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Ui(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Co(f,x){return new Wn(f,x)}var ia=Mn.extend({options:{position:"topright"},initialize:function(f){be(this,f)},getPosition:function(){return this.options.position},setPosition:function(f){var x=this._map;return x&&x.removeControl(this),this.options.position=f,x&&x.addControl(this),this},getContainer:function(){return this._container},addTo:function(f){this.remove(),this._map=f;var x=this._container=this.onAdd(f),R=this.getPosition(),U=f._controlCorners[R];return on(x,"leaflet-control"),R.indexOf("bottom")!==-1?U.insertBefore(x,U.firstChild):U.appendChild(x),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(hi(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(f){this._map&&f&&f.screenX>0&&f.screenY>0&&this._map.getContainer().focus()}}),Ma=function(f){return new ia(f)};Wn.include({addControl:function(f){return f.addTo(this),this},removeControl:function(f){return f.remove(),this},_initControlPos:function(){var f=this._controlCorners={},x="leaflet-",R=this._controlContainer=ii("div",x+"control-container",this._container);function U(K,ue){var Oe=x+K+" "+x+ue;f[K+ue]=ii("div",Oe,R)}U("top","left"),U("top","right"),U("bottom","left"),U("bottom","right")},_clearControlPos:function(){for(var f in this._controlCorners)hi(this._controlCorners[f]);hi(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Pa=ia.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(f,x,R,U){return R<U?-1:U<R?1:0}},initialize:function(f,x,R){be(this,R),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var U in f)this._addLayer(f[U],U);for(U in x)this._addLayer(x[U],U,!0)},onAdd:function(f){this._initLayout(),this._update(),this._map=f,f.on("zoomend",this._checkDisabledLayers,this);for(var x=0;x<this._layers.length;x++)this._layers[x].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(f){return ia.prototype.addTo.call(this,f),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var f=0;f<this._layers.length;f++)this._layers[f].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(f,x){return this._addLayer(f,x),this._map?this._update():this},addOverlay:function(f,x){return this._addLayer(f,x,!0),this._map?this._update():this},removeLayer:function(f){f.off("add remove",this._onLayerChange,this);var x=this._getLayer(C(f));return x&&this._layers.splice(this._layers.indexOf(x),1),this._map?this._update():this},expand:function(){on(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var f=this._map.getSize().y-(this._container.offsetTop+50);return f<this._section.clientHeight?(on(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=f+"px"):Ui(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Ui(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var f="leaflet-control-layers",x=this._container=ii("div",f),R=this.options.collapsed;x.setAttribute("aria-haspopup",!0),fn(x),fa(x);var U=this._section=ii("section",f+"-list");R&&(this._map.on("click",this.collapse,this),hn(x,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var K=this._layersLink=ii("a",f+"-toggle",x);K.href="#",K.title="Layers",K.setAttribute("role","button"),hn(K,{keydown:function(ue){ue.keyCode===13&&this._expandSafely()},click:function(ue){sn(ue),this._expandSafely()}},this),R||this.expand(),this._baseLayersList=ii("div",f+"-base",U),this._separator=ii("div",f+"-separator",U),this._overlaysList=ii("div",f+"-overlays",U),x.appendChild(U)},_getLayer:function(f){for(var x=0;x<this._layers.length;x++)if(this._layers[x]&&C(this._layers[x].layer)===f)return this._layers[x]},_addLayer:function(f,x,R){this._map&&f.on("add remove",this._onLayerChange,this),this._layers.push({layer:f,name:x,overlay:R}),this.options.sortLayers&&this._layers.sort(_(function(U,K){return this.options.sortFunction(U.layer,K.layer,U.name,K.name)},this)),this.options.autoZIndex&&f.setZIndex&&(this._lastZIndex++,f.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Zi(this._baseLayersList),Zi(this._overlaysList),this._layerControlInputs=[];var f,x,R,U,K=0;for(R=0;R<this._layers.length;R++)U=this._layers[R],this._addItem(U),x=x||U.overlay,f=f||!U.overlay,K+=U.overlay?0:1;return this.options.hideSingleBase&&(f=f&&K>1,this._baseLayersList.style.display=f?"":"none"),this._separator.style.display=x&&f?"":"none",this},_onLayerChange:function(f){this._handlingClick||this._update();var x=this._getLayer(C(f.target)),R=x.overlay?f.type==="add"?"overlayadd":"overlayremove":f.type==="add"?"baselayerchange":null;R&&this._map.fire(R,x)},_createRadioElement:function(f,x){var R='<input type="radio" class="leaflet-control-layers-selector" name="'+f+'"'+(x?' checked="checked"':"")+"/>",U=document.createElement("div");return U.innerHTML=R,U.firstChild},_addItem:function(f){var x=document.createElement("label"),R=this._map.hasLayer(f.layer),U;f.overlay?(U=document.createElement("input"),U.type="checkbox",U.className="leaflet-control-layers-selector",U.defaultChecked=R):U=this._createRadioElement("leaflet-base-layers_"+C(this),R),this._layerControlInputs.push(U),U.layerId=C(f.layer),hn(U,"click",this._onInputClick,this);var K=document.createElement("span");K.innerHTML=" "+f.name;var ue=document.createElement("span");x.appendChild(ue),ue.appendChild(U),ue.appendChild(K);var Oe=f.overlay?this._overlaysList:this._baseLayersList;return Oe.appendChild(x),this._checkDisabledLayers(),x},_onInputClick:function(){if(!this._preventClick){var f=this._layerControlInputs,x,R,U=[],K=[];this._handlingClick=!0;for(var ue=f.length-1;ue>=0;ue--)x=f[ue],R=this._getLayer(x.layerId).layer,x.checked?U.push(R):x.checked||K.push(R);for(ue=0;ue<K.length;ue++)this._map.hasLayer(K[ue])&&this._map.removeLayer(K[ue]);for(ue=0;ue<U.length;ue++)this._map.hasLayer(U[ue])||this._map.addLayer(U[ue]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var f=this._layerControlInputs,x,R,U=this._map.getZoom(),K=f.length-1;K>=0;K--)x=f[K],R=this._getLayer(x.layerId).layer,x.disabled=R.options.minZoom!==void 0&&U<R.options.minZoom||R.options.maxZoom!==void 0&&U>R.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var f=this._section;this._preventClick=!0,hn(f,"click",sn),this.expand();var x=this;setTimeout(function(){xn(f,"click",sn),x._preventClick=!1})}}),Or=function(f,x,R){return new Pa(f,x,R)},xs=ia.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(f){var x="leaflet-control-zoom",R=ii("div",x+" leaflet-bar"),U=this.options;return this._zoomInButton=this._createButton(U.zoomInText,U.zoomInTitle,x+"-in",R,this._zoomIn),this._zoomOutButton=this._createButton(U.zoomOutText,U.zoomOutTitle,x+"-out",R,this._zoomOut),this._updateDisabled(),f.on("zoomend zoomlevelschange",this._updateDisabled,this),R},onRemove:function(f){f.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(f){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(f.shiftKey?3:1))},_zoomOut:function(f){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(f.shiftKey?3:1))},_createButton:function(f,x,R,U,K){var ue=ii("a",R,U);return ue.innerHTML=f,ue.href="#",ue.title=x,ue.setAttribute("role","button"),ue.setAttribute("aria-label",x),fn(ue),hn(ue,"click",na),hn(ue,"click",K,this),hn(ue,"click",this._refocusOnMap,this),ue},_updateDisabled:function(){var f=this._map,x="leaflet-disabled";Ui(this._zoomInButton,x),Ui(this._zoomOutButton,x),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||f._zoom===f.getMinZoom())&&(on(this._zoomOutButton,x),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||f._zoom===f.getMaxZoom())&&(on(this._zoomInButton,x),this._zoomInButton.setAttribute("aria-disabled","true"))}});Wn.mergeOptions({zoomControl:!0}),Wn.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new xs,this.addControl(this.zoomControl))});var $l=function(f){return new xs(f)},Io=ia.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(f){var x="leaflet-control-scale",R=ii("div",x),U=this.options;return this._addScales(U,x+"-line",R),f.on(U.updateWhenIdle?"moveend":"move",this._update,this),f.whenReady(this._update,this),R},onRemove:function(f){f.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(f,x,R){f.metric&&(this._mScale=ii("div",x,R)),f.imperial&&(this._iScale=ii("div",x,R))},_update:function(){var f=this._map,x=f.getSize().y/2,R=f.distance(f.containerPointToLatLng([0,x]),f.containerPointToLatLng([this.options.maxWidth,x]));this._updateScales(R)},_updateScales:function(f){this.options.metric&&f&&this._updateMetric(f),this.options.imperial&&f&&this._updateImperial(f)},_updateMetric:function(f){var x=this._getRoundNum(f),R=x<1e3?x+" m":x/1e3+" km";this._updateScale(this._mScale,R,x/f)},_updateImperial:function(f){var x=f*3.2808399,R,U,K;x>5280?(R=x/5280,U=this._getRoundNum(R),this._updateScale(this._iScale,U+" mi",U/R)):(K=this._getRoundNum(x),this._updateScale(this._iScale,K+" ft",K/x))},_updateScale:function(f,x,R){f.style.width=Math.round(this.options.maxWidth*R)+"px",f.innerHTML=x},_getRoundNum:function(f){var x=Math.pow(10,(Math.floor(f)+"").length-1),R=f/x;return R=R>=10?10:R>=5?5:R>=3?3:R>=2?2:1,x*R}}),Xi=function(f){return new Io(f)},Vu='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',rl=ia.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(en.inlineSvg?Vu+" ":"")+"Leaflet</a>"},initialize:function(f){be(this,f),this._attributions={}},onAdd:function(f){f.attributionControl=this,this._container=ii("div","leaflet-control-attribution"),fn(this._container);for(var x in f._layers)f._layers[x].getAttribution&&this.addAttribution(f._layers[x].getAttribution());return this._update(),f.on("layeradd",this._addAttribution,this),this._container},onRemove:function(f){f.off("layeradd",this._addAttribution,this)},_addAttribution:function(f){f.layer.getAttribution&&(this.addAttribution(f.layer.getAttribution()),f.layer.once("remove",function(){this.removeAttribution(f.layer.getAttribution())},this))},setPrefix:function(f){return this.options.prefix=f,this._update(),this},addAttribution:function(f){return f?(this._attributions[f]||(this._attributions[f]=0),this._attributions[f]++,this._update(),this):this},removeAttribution:function(f){return f?(this._attributions[f]&&(this._attributions[f]--,this._update()),this):this},_update:function(){if(this._map){var f=[];for(var x in this._attributions)this._attributions[x]&&f.push(x);var R=[];this.options.prefix&&R.push(this.options.prefix),f.length&&R.push(f.join(", ")),this._container.innerHTML=R.join(' <span aria-hidden="true">|</span> ')}}});Wn.mergeOptions({attributionControl:!0}),Wn.addInitHook(function(){this.options.attributionControl&&new rl().addTo(this)});var Gl=function(f){return new rl(f)};ia.Layers=Pa,ia.Zoom=xs,ia.Scale=Io,ia.Attribution=rl,Ma.layers=Or,Ma.zoom=$l,Ma.scale=Xi,Ma.attribution=Gl;var Hs=Mn.extend({initialize:function(f){this._map=f},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Hs.addTo=function(f,x){return f.addHandler(x,this),this};var Ll={Events:mt},lr=en.touch?"touchstart mousedown":"mousedown",es=At.extend({options:{clickTolerance:3},initialize:function(f,x,R,U){be(this,U),this._element=f,this._dragStartTarget=x||f,this._preventOutline=R},enable:function(){this._enabled||(hn(this._dragStartTarget,lr,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(es._dragging===this&&this.finishDrag(!0),xn(this._dragStartTarget,lr,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(f){if(this._enabled&&(this._moved=!1,!uu(this._element,"leaflet-zoom-anim"))){if(f.touches&&f.touches.length!==1){es._dragging===this&&this.finishDrag();return}if(!(es._dragging||f.shiftKey||f.which!==1&&f.button!==1&&!f.touches)&&(es._dragging=this,this._preventOutline&&ys(this._element),_s(),ja(),!this._moving)){this.fire("down");var x=f.touches?f.touches[0]:f,R=Rl(this._element);this._startPoint=new bt(x.clientX,x.clientY),this._startPos=Qa(this._element),this._parentScale=Wi(R);var U=f.type==="mousedown";hn(document,U?"mousemove":"touchmove",this._onMove,this),hn(document,U?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(f){if(this._enabled){if(f.touches&&f.touches.length>1){this._moved=!0;return}var x=f.touches&&f.touches.length===1?f.touches[0]:f,R=new bt(x.clientX,x.clientY)._subtract(this._startPoint);!R.x&&!R.y||Math.abs(R.x)+Math.abs(R.y)<this.options.clickTolerance||(R.x/=this._parentScale.x,R.y/=this._parentScale.y,sn(f),this._moved||(this.fire("dragstart"),this._moved=!0,on(document.body,"leaflet-dragging"),this._lastTarget=f.target||f.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),on(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(R),this._moving=!0,this._lastEvent=f,this._updatePosition())}},_updatePosition:function(){var f={originalEvent:this._lastEvent};this.fire("predrag",f),ar(this._element,this._newPos),this.fire("drag",f)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(f){Ui(document.body,"leaflet-dragging"),this._lastTarget&&(Ui(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),xn(document,"mousemove touchmove",this._onMove,this),xn(document,"mouseup touchend touchcancel",this._onUp,this),qa(),Hi();var x=this._moved&&this._moving;this._moving=!1,es._dragging=!1,x&&this.fire("dragend",{noInertia:f,distance:this._newPos.distanceTo(this._startPos)})}});function ws(f,x,R){var U,K=[1,4,2,8],ue,Oe,nt,ut,Mt,Kt,pn,Yn;for(ue=0,Kt=f.length;ue<Kt;ue++)f[ue]._code=ht(f[ue],x);for(nt=0;nt<4;nt++){for(pn=K[nt],U=[],ue=0,Kt=f.length,Oe=Kt-1;ue<Kt;Oe=ue++)ut=f[ue],Mt=f[Oe],ut._code&pn?Mt._code&pn||(Yn=at(Mt,ut,pn,x,R),Yn._code=ht(Yn,x),U.push(Yn)):(Mt._code&pn&&(Yn=at(Mt,ut,pn,x,R),Yn._code=ht(Yn,x),U.push(Yn)),U.push(ut));f=U}return f}function kl(f,x){var R,U,K,ue,Oe,nt,ut,Mt,Kt;if(!f||f.length===0)throw new Error("latlngs not passed");Xn(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var pn=Wt([0,0]),Yn=Ut(f),ga=Yn.getNorthWest().distanceTo(Yn.getSouthWest())*Yn.getNorthEast().distanceTo(Yn.getNorthWest());ga<1700&&(pn=al(f));var Zr=f.length,Za=[];for(R=0;R<Zr;R++){var Si=Wt(f[R]);Za.push(x.project(Wt([Si.lat-pn.lat,Si.lng-pn.lng])))}for(nt=ut=Mt=0,R=0,U=Zr-1;R<Zr;U=R++)K=Za[R],ue=Za[U],Oe=K.y*ue.x-ue.y*K.x,ut+=(K.x+ue.x)*Oe,Mt+=(K.y+ue.y)*Oe,nt+=Oe*3;nt===0?Kt=Za[0]:Kt=[ut/nt,Mt/nt];var Li=x.unproject(Vt(Kt));return Wt([Li.lat+pn.lat,Li.lng+pn.lng])}function al(f){for(var x=0,R=0,U=0,K=0;K<f.length;K++){var ue=Wt(f[K]);x+=ue.lat,R+=ue.lng,U++}return Wt([x/U,R/U])}var lo={__proto__:null,clipPolygon:ws,polygonCenter:kl,centroid:al};function Ai(f,x){if(!x||!f.length)return f.slice();var R=x*x;return f=Z(f,R),f=Dl(f,R),f}function Uu(f,x,R){return Math.sqrt(kn(f,x,R,!0))}function cu(f,x,R){return kn(f,x,R)}function Dl(f,x){var R=f.length,U=typeof Uint8Array<"u"?Uint8Array:Array,K=new U(R);K[0]=K[R-1]=1,P(f,K,x,0,R-1);var ue,Oe=[];for(ue=0;ue<R;ue++)K[ue]&&Oe.push(f[ue]);return Oe}function P(f,x,R,U,K){var ue=0,Oe,nt,ut;for(nt=U+1;nt<=K-1;nt++)ut=kn(f[nt],f[U],f[K],!0),ut>ue&&(Oe=nt,ue=ut);ue>R&&(x[Oe]=1,P(f,x,R,U,Oe),P(f,x,R,Oe,K))}function Z(f,x){for(var R=[f[0]],U=1,K=0,ue=f.length;U<ue;U++)Xt(f[U],f[K])>x&&(R.push(f[U]),K=U);return K<ue-1&&R.push(f[ue-1]),R}var ne;function ye(f,x,R,U,K){var ue=U?ne:ht(f,R),Oe=ht(x,R),nt,ut,Mt;for(ne=Oe;;){if(!(ue|Oe))return[f,x];if(ue&Oe)return!1;nt=ue||Oe,ut=at(f,x,nt,R,K),Mt=ht(ut,R),nt===ue?(f=ut,ue=Mt):(x=ut,Oe=Mt)}}function at(f,x,R,U,K){var ue=x.x-f.x,Oe=x.y-f.y,nt=U.min,ut=U.max,Mt,Kt;return R&8?(Mt=f.x+ue*(ut.y-f.y)/Oe,Kt=ut.y):R&4?(Mt=f.x+ue*(nt.y-f.y)/Oe,Kt=nt.y):R&2?(Mt=ut.x,Kt=f.y+Oe*(ut.x-f.x)/ue):R&1&&(Mt=nt.x,Kt=f.y+Oe*(nt.x-f.x)/ue),new bt(Mt,Kt,K)}function ht(f,x){var R=0;return f.x<x.min.x?R|=1:f.x>x.max.x&&(R|=2),f.y<x.min.y?R|=4:f.y>x.max.y&&(R|=8),R}function Xt(f,x){var R=x.x-f.x,U=x.y-f.y;return R*R+U*U}function kn(f,x,R,U){var K=x.x,ue=x.y,Oe=R.x-K,nt=R.y-ue,ut=Oe*Oe+nt*nt,Mt;return ut>0&&(Mt=((f.x-K)*Oe+(f.y-ue)*nt)/ut,Mt>1?(K=R.x,ue=R.y):Mt>0&&(K+=Oe*Mt,ue+=nt*Mt)),Oe=f.x-K,nt=f.y-ue,U?Oe*Oe+nt*nt:new bt(K,ue)}function Xn(f){return!Xe(f[0])||typeof f[0][0]!="object"&&typeof f[0][0]<"u"}function Ti(f){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Xn(f)}function Ki(f,x){var R,U,K,ue,Oe,nt,ut,Mt;if(!f||f.length===0)throw new Error("latlngs not passed");Xn(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var Kt=Wt([0,0]),pn=Ut(f),Yn=pn.getNorthWest().distanceTo(pn.getSouthWest())*pn.getNorthEast().distanceTo(pn.getNorthWest());Yn<1700&&(Kt=al(f));var ga=f.length,Zr=[];for(R=0;R<ga;R++){var Za=Wt(f[R]);Zr.push(x.project(Wt([Za.lat-Kt.lat,Za.lng-Kt.lng])))}for(R=0,U=0;R<ga-1;R++)U+=Zr[R].distanceTo(Zr[R+1])/2;if(U===0)Mt=Zr[0];else for(R=0,ue=0;R<ga-1;R++)if(Oe=Zr[R],nt=Zr[R+1],K=Oe.distanceTo(nt),ue+=K,ue>U){ut=(ue-U)/K,Mt=[nt.x-ut*(nt.x-Oe.x),nt.y-ut*(nt.y-Oe.y)];break}var Si=x.unproject(Vt(Mt));return Wt([Si.lat+Kt.lat,Si.lng+Kt.lng])}var $a={__proto__:null,simplify:Ai,pointToSegmentDistance:Uu,closestPointOnSegment:cu,clipSegment:ye,_getEdgeIntersection:at,_getBitCode:ht,_sqClosestPointOnSegment:kn,isFlat:Xn,_flat:Ti,polylineCenter:Ki},Ga={project:function(f){return new bt(f.lng,f.lat)},unproject:function(f){return new Jt(f.y,f.x)},bounds:new ke([-180,-90],[180,90])},Ws={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ke([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(f){var x=Math.PI/180,R=this.R,U=f.lat*x,K=this.R_MINOR/R,ue=Math.sqrt(1-K*K),Oe=ue*Math.sin(U),nt=Math.tan(Math.PI/4-U/2)/Math.pow((1-Oe)/(1+Oe),ue/2);return U=-R*Math.log(Math.max(nt,1e-10)),new bt(f.lng*x*R,U)},unproject:function(f){for(var x=180/Math.PI,R=this.R,U=this.R_MINOR/R,K=Math.sqrt(1-U*U),ue=Math.exp(-f.y/R),Oe=Math.PI/2-2*Math.atan(ue),nt=0,ut=.1,Mt;nt<15&&Math.abs(ut)>1e-7;nt++)Mt=K*Math.sin(Oe),Mt=Math.pow((1-Mt)/(1+Mt),K/2),ut=Math.PI/2-2*Math.atan(ue*Mt)-Oe,Oe+=ut;return new Jt(Oe*x,f.x*x/R)}},Ts={__proto__:null,LonLat:Ga,Mercator:Ws,SphericalMercator:ds},hu=d({},oi,{code:"EPSG:3395",projection:Ws,transformation:(function(){var f=.5/(Math.PI*Ws.R);return Dr(f,.5,-f,.5)})()}),Xs=d({},oi,{code:"EPSG:4326",projection:Ga,transformation:Dr(1/180,1,-1/180,.5)}),du=d({},Fn,{projection:Ga,transformation:Dr(1,0,-1,0),scale:function(f){return Math.pow(2,f)},zoom:function(f){return Math.log(f)/Math.LN2},distance:function(f,x){var R=x.lng-f.lng,U=x.lat-f.lat;return Math.sqrt(R*R+U*U)},infinite:!0});Fn.Earth=oi,Fn.EPSG3395=hu,Fn.EPSG3857=Fi,Fn.EPSG900913=Pi,Fn.EPSG4326=Xs,Fn.Simple=du;var Ks=At.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(f){return f.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(f){return f&&f.removeLayer(this),this},getPane:function(f){return this._map.getPane(f?this.options[f]||f:this.options.pane)},addInteractiveTarget:function(f){return this._map._targets[C(f)]=this,this},removeInteractiveTarget:function(f){return delete this._map._targets[C(f)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(f){var x=f.target;if(x.hasLayer(this)){if(this._map=x,this._zoomAnimated=x._zoomAnimated,this.getEvents){var R=this.getEvents();x.on(R,this),this.once("remove",function(){x.off(R,this)},this)}this.onAdd(x),this.fire("add"),x.fire("layeradd",{layer:this})}}});Wn.include({addLayer:function(f){if(!f._layerAdd)throw new Error("The provided object is not a Layer.");var x=C(f);return this._layers[x]?this:(this._layers[x]=f,f._mapToAdd=this,f.beforeAdd&&f.beforeAdd(this),this.whenReady(f._layerAdd,f),this)},removeLayer:function(f){var x=C(f);return this._layers[x]?(this._loaded&&f.onRemove(this),delete this._layers[x],this._loaded&&(this.fire("layerremove",{layer:f}),f.fire("remove")),f._map=f._mapToAdd=null,this):this},hasLayer:function(f){return C(f)in this._layers},eachLayer:function(f,x){for(var R in this._layers)f.call(x,this._layers[R]);return this},_addLayers:function(f){f=f?Xe(f)?f:[f]:[];for(var x=0,R=f.length;x<R;x++)this.addLayer(f[x])},_addZoomLimit:function(f){(!isNaN(f.options.maxZoom)||!isNaN(f.options.minZoom))&&(this._zoomBoundLayers[C(f)]=f,this._updateZoomLevels())},_removeZoomLimit:function(f){var x=C(f);this._zoomBoundLayers[x]&&(delete this._zoomBoundLayers[x],this._updateZoomLevels())},_updateZoomLevels:function(){var f=1/0,x=-1/0,R=this._getZoomSpan();for(var U in this._zoomBoundLayers){var K=this._zoomBoundLayers[U].options;f=K.minZoom===void 0?f:Math.min(f,K.minZoom),x=K.maxZoom===void 0?x:Math.max(x,K.maxZoom)}this._layersMaxZoom=x===-1/0?void 0:x,this._layersMinZoom=f===1/0?void 0:f,R!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ju=Ks.extend({initialize:function(f,x){be(this,x),this._layers={};var R,U;if(f)for(R=0,U=f.length;R<U;R++)this.addLayer(f[R])},addLayer:function(f){var x=this.getLayerId(f);return this._layers[x]=f,this._map&&this._map.addLayer(f),this},removeLayer:function(f){var x=f in this._layers?f:this.getLayerId(f);return this._map&&this._layers[x]&&this._map.removeLayer(this._layers[x]),delete this._layers[x],this},hasLayer:function(f){var x=typeof f=="number"?f:this.getLayerId(f);return x in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(f){var x=Array.prototype.slice.call(arguments,1),R,U;for(R in this._layers)U=this._layers[R],U[f]&&U[f].apply(U,x);return this},onAdd:function(f){this.eachLayer(f.addLayer,f)},onRemove:function(f){this.eachLayer(f.removeLayer,f)},eachLayer:function(f,x){for(var R in this._layers)f.call(x,this._layers[R]);return this},getLayer:function(f){return this._layers[f]},getLayers:function(){var f=[];return this.eachLayer(f.push,f),f},setZIndex:function(f){return this.invoke("setZIndex",f)},getLayerId:function(f){return C(f)}}),Hd=function(f,x){return new ju(f,x)},uo=ju.extend({addLayer:function(f){return this.hasLayer(f)?this:(f.addEventParent(this),ju.prototype.addLayer.call(this,f),this.fire("layeradd",{layer:f}))},removeLayer:function(f){return this.hasLayer(f)?(f in this._layers&&(f=this._layers[f]),f.removeEventParent(this),ju.prototype.removeLayer.call(this,f),this.fire("layerremove",{layer:f})):this},setStyle:function(f){return this.invoke("setStyle",f)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var f=new Ot;for(var x in this._layers){var R=this._layers[x];f.extend(R.getBounds?R.getBounds():R.getLatLng())}return f}}),Jh=function(f,x){return new uo(f,x)},Ys=Mn.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(f){be(this,f)},createIcon:function(f){return this._createIcon("icon",f)},createShadow:function(f){return this._createIcon("shadow",f)},_createIcon:function(f,x){var R=this._getIconUrl(f);if(!R){if(f==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var U=this._createImg(R,x&&x.tagName==="IMG"?x:null);return this._setIconStyles(U,f),(this.options.crossOrigin||this.options.crossOrigin==="")&&(U.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),U},_setIconStyles:function(f,x){var R=this.options,U=R[x+"Size"];typeof U=="number"&&(U=[U,U]);var K=Vt(U),ue=Vt(x==="shadow"&&R.shadowAnchor||R.iconAnchor||K&&K.divideBy(2,!0));f.className="leaflet-marker-"+x+" "+(R.className||""),ue&&(f.style.marginLeft=-ue.x+"px",f.style.marginTop=-ue.y+"px"),K&&(f.style.width=K.x+"px",f.style.height=K.y+"px")},_createImg:function(f,x){return x=x||document.createElement("img"),x.src=f,x},_getIconUrl:function(f){return en.retina&&this.options[f+"RetinaUrl"]||this.options[f+"Url"]}});function qu(f){return new Ys(f)}var $u=Ys.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(f){return typeof $u.imagePath!="string"&&($u.imagePath=this._detectIconPath()),(this.options.imagePath||$u.imagePath)+Ys.prototype._getIconUrl.call(this,f)},_stripUrl:function(f){var x=function(R,U,K){var ue=U.exec(R);return ue&&ue[K]};return f=x(f,/^url\((['"])?(.+)\1\)$/,2),f&&x(f,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var f=ii("div","leaflet-default-icon-path",document.body),x=nl(f,"background-image")||nl(f,"backgroundImage");if(document.body.removeChild(f),x=this._stripUrl(x),x)return x;var R=document.querySelector('link[href$="leaflet.css"]');return R?R.href.substring(0,R.href.length-11-1):""}}),Mo=Hs.extend({initialize:function(f){this._marker=f},addHooks:function(){var f=this._marker._icon;this._draggable||(this._draggable=new es(f,f,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),on(f,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Ui(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(f){var x=this._marker,R=x._map,U=this._marker.options.autoPanSpeed,K=this._marker.options.autoPanPadding,ue=Qa(x._icon),Oe=R.getPixelBounds(),nt=R.getPixelOrigin(),ut=xt(Oe.min._subtract(nt).add(K),Oe.max._subtract(nt).subtract(K));if(!ut.contains(ue)){var Mt=Vt((Math.max(ut.max.x,ue.x)-ut.max.x)/(Oe.max.x-ut.max.x)-(Math.min(ut.min.x,ue.x)-ut.min.x)/(Oe.min.x-ut.min.x),(Math.max(ut.max.y,ue.y)-ut.max.y)/(Oe.max.y-ut.max.y)-(Math.min(ut.min.y,ue.y)-ut.min.y)/(Oe.min.y-ut.min.y)).multiplyBy(U);R.panBy(Mt,{animate:!1}),this._draggable._newPos._add(Mt),this._draggable._startPos._add(Mt),ar(x._icon,this._draggable._newPos),this._onDrag(f),this._panRequest=Re(this._adjustPan.bind(this,f))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(f){this._marker.options.autoPan&&(je(this._panRequest),this._panRequest=Re(this._adjustPan.bind(this,f)))},_onDrag:function(f){var x=this._marker,R=x._shadow,U=Qa(x._icon),K=x._map.layerPointToLatLng(U);R&&ar(R,U),x._latlng=K,f.latlng=K,f.oldLatLng=this._oldLatLng,x.fire("move",f).fire("drag",f)},_onDragEnd:function(f){je(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",f)}}),fu=Ks.extend({options:{icon:new $u,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(f,x){be(this,x),this._latlng=Wt(f)},onAdd:function(f){this._zoomAnimated=this._zoomAnimated&&f.options.markerZoomAnimation,this._zoomAnimated&&f.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(f){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&f.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(f){var x=this._latlng;return this._latlng=Wt(f),this.update(),this.fire("move",{oldLatLng:x,latlng:this._latlng})},setZIndexOffset:function(f){return this.options.zIndexOffset=f,this.update()},getIcon:function(){return this.options.icon},setIcon:function(f){return this.options.icon=f,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var f=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(f)}return this},_initIcon:function(){var f=this.options,x="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),R=f.icon.createIcon(this._icon),U=!1;R!==this._icon&&(this._icon&&this._removeIcon(),U=!0,f.title&&(R.title=f.title),R.tagName==="IMG"&&(R.alt=f.alt||"")),on(R,x),f.keyboard&&(R.tabIndex="0",R.setAttribute("role","button")),this._icon=R,f.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&hn(R,"focus",this._panOnFocus,this);var K=f.icon.createShadow(this._shadow),ue=!1;K!==this._shadow&&(this._removeShadow(),ue=!0),K&&(on(K,x),K.alt=""),this._shadow=K,f.opacity<1&&this._updateOpacity(),U&&this.getPane().appendChild(this._icon),this._initInteraction(),K&&ue&&this.getPane(f.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&xn(this._icon,"focus",this._panOnFocus,this),hi(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&hi(this._shadow),this._shadow=null},_setPos:function(f){this._icon&&ar(this._icon,f),this._shadow&&ar(this._shadow,f),this._zIndex=f.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(f){this._icon&&(this._icon.style.zIndex=this._zIndex+f)},_animateZoom:function(f){var x=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center).round();this._setPos(x)},_initInteraction:function(){if(this.options.interactive&&(on(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Mo)){var f=this.options.draggable;this.dragging&&(f=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Mo(this),f&&this.dragging.enable()}},setOpacity:function(f){return this.options.opacity=f,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var f=this.options.opacity;this._icon&&rr(this._icon,f),this._shadow&&rr(this._shadow,f)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var f=this._map;if(f){var x=this.options.icon.options,R=x.iconSize?Vt(x.iconSize):Vt(0,0),U=x.iconAnchor?Vt(x.iconAnchor):Vt(0,0);f.panInside(this._latlng,{paddingTopLeft:U,paddingBottomRight:R.subtract(U)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function hh(f,x){return new fu(f,x)}var Ss=Ks.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(f){this._renderer=f.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(f){return be(this,f),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&f&&Object.prototype.hasOwnProperty.call(f,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Gu=Ss.extend({options:{fill:!0,radius:10},initialize:function(f,x){be(this,x),this._latlng=Wt(f),this._radius=this.options.radius},setLatLng:function(f){var x=this._latlng;return this._latlng=Wt(f),this.redraw(),this.fire("move",{oldLatLng:x,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(f){return this.options.radius=this._radius=f,this.redraw()},getRadius:function(){return this._radius},setStyle:function(f){var x=f&&f.radius||this._radius;return Ss.prototype.setStyle.call(this,f),this.setRadius(x),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var f=this._radius,x=this._radiusY||f,R=this._clickTolerance(),U=[f+R,x+R];this._pxBounds=new ke(this._point.subtract(U),this._point.add(U))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(f){return f.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Zu(f,x){return new Gu(f,x)}var Lc=Gu.extend({initialize:function(f,x,R){if(typeof x=="number"&&(x=d({},R,{radius:x})),be(this,x),this._latlng=Wt(f),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(f){return this._mRadius=f,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var f=[this._radius,this._radiusY||this._radius];return new Ot(this._map.layerPointToLatLng(this._point.subtract(f)),this._map.layerPointToLatLng(this._point.add(f)))},setStyle:Ss.prototype.setStyle,_project:function(){var f=this._latlng.lng,x=this._latlng.lat,R=this._map,U=R.options.crs;if(U.distance===oi.distance){var K=Math.PI/180,ue=this._mRadius/oi.R/K,Oe=R.project([x+ue,f]),nt=R.project([x-ue,f]),ut=Oe.add(nt).divideBy(2),Mt=R.unproject(ut).lat,Kt=Math.acos((Math.cos(ue*K)-Math.sin(x*K)*Math.sin(Mt*K))/(Math.cos(x*K)*Math.cos(Mt*K)))/K;(isNaN(Kt)||Kt===0)&&(Kt=ue/Math.cos(Math.PI/180*x)),this._point=ut.subtract(R.getPixelOrigin()),this._radius=isNaN(Kt)?0:ut.x-R.project([Mt,f-Kt]).x,this._radiusY=ut.y-Oe.y}else{var pn=U.unproject(U.project(this._latlng).subtract([this._mRadius,0]));this._point=R.latLngToLayerPoint(this._latlng),this._radius=this._point.x-R.latLngToLayerPoint(pn).x}this._updateBounds()}});function Wd(f,x,R){return new Lc(f,x,R)}var sl=Ss.extend({options:{smoothFactor:1,noClip:!1},initialize:function(f,x){be(this,x),this._setLatLngs(f)},getLatLngs:function(){return this._latlngs},setLatLngs:function(f){return this._setLatLngs(f),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(f){for(var x=1/0,R=null,U=kn,K,ue,Oe=0,nt=this._parts.length;Oe<nt;Oe++)for(var ut=this._parts[Oe],Mt=1,Kt=ut.length;Mt<Kt;Mt++){K=ut[Mt-1],ue=ut[Mt];var pn=U(f,K,ue,!0);pn<x&&(x=pn,R=U(f,K,ue))}return R&&(R.distance=Math.sqrt(x)),R},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ki(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(f,x){return x=x||this._defaultShape(),f=Wt(f),x.push(f),this._bounds.extend(f),this.redraw()},_setLatLngs:function(f){this._bounds=new Ot,this._latlngs=this._convertLatLngs(f)},_defaultShape:function(){return Xn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(f){for(var x=[],R=Xn(f),U=0,K=f.length;U<K;U++)R?(x[U]=Wt(f[U]),this._bounds.extend(x[U])):x[U]=this._convertLatLngs(f[U]);return x},_project:function(){var f=new ke;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,f),this._bounds.isValid()&&f.isValid()&&(this._rawPxBounds=f,this._updateBounds())},_updateBounds:function(){var f=this._clickTolerance(),x=new bt(f,f);this._rawPxBounds&&(this._pxBounds=new ke([this._rawPxBounds.min.subtract(x),this._rawPxBounds.max.add(x)]))},_projectLatlngs:function(f,x,R){var U=f[0]instanceof Jt,K=f.length,ue,Oe;if(U){for(Oe=[],ue=0;ue<K;ue++)Oe[ue]=this._map.latLngToLayerPoint(f[ue]),R.extend(Oe[ue]);x.push(Oe)}else for(ue=0;ue<K;ue++)this._projectLatlngs(f[ue],x,R)},_clipPoints:function(){var f=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}var x=this._parts,R,U,K,ue,Oe,nt,ut;for(R=0,K=0,ue=this._rings.length;R<ue;R++)for(ut=this._rings[R],U=0,Oe=ut.length;U<Oe-1;U++)nt=ye(ut[U],ut[U+1],f,U,!0),nt&&(x[K]=x[K]||[],x[K].push(nt[0]),(nt[1]!==ut[U+1]||U===Oe-2)&&(x[K].push(nt[1]),K++))}},_simplifyPoints:function(){for(var f=this._parts,x=this.options.smoothFactor,R=0,U=f.length;R<U;R++)f[R]=Ai(f[R],x)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(f,x){var R,U,K,ue,Oe,nt,ut=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(R=0,ue=this._parts.length;R<ue;R++)for(nt=this._parts[R],U=0,Oe=nt.length,K=Oe-1;U<Oe;K=U++)if(!(!x&&U===0)&&Uu(f,nt[K],nt[U])<=ut)return!0;return!1}});function Xd(f,x){return new sl(f,x)}sl._flat=Ti;var Zl=sl.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return kl(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(f){var x=sl.prototype._convertLatLngs.call(this,f),R=x.length;return R>=2&&x[0]instanceof Jt&&x[0].equals(x[R-1])&&x.pop(),x},_setLatLngs:function(f){sl.prototype._setLatLngs.call(this,f),Xn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Xn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var f=this._renderer._bounds,x=this.options.weight,R=new bt(x,x);if(f=new ke(f.min.subtract(R),f.max.add(R)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}for(var U=0,K=this._rings.length,ue;U<K;U++)ue=ws(this._rings[U],f,!0),ue.length&&this._parts.push(ue)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(f){var x=!1,R,U,K,ue,Oe,nt,ut,Mt;if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(ue=0,ut=this._parts.length;ue<ut;ue++)for(R=this._parts[ue],Oe=0,Mt=R.length,nt=Mt-1;Oe<Mt;nt=Oe++)U=R[Oe],K=R[nt],U.y>f.y!=K.y>f.y&&f.x<(K.x-U.x)*(f.y-U.y)/(K.y-U.y)+U.x&&(x=!x);return x||sl.prototype._containsPoint.call(this,f,!0)}});function ed(f,x){return new Zl(f,x)}var ol=uo.extend({initialize:function(f,x){be(this,x),this._layers={},f&&this.addData(f)},addData:function(f){var x=Xe(f)?f:f.features,R,U,K;if(x){for(R=0,U=x.length;R<U;R++)K=x[R],(K.geometries||K.geometry||K.features||K.coordinates)&&this.addData(K);return this}var ue=this.options;if(ue.filter&&!ue.filter(f))return this;var Oe=ra(f,ue);return Oe?(Oe.feature=ul(f),Oe.defaultOptions=Oe.options,this.resetStyle(Oe),ue.onEachFeature&&ue.onEachFeature(f,Oe),this.addLayer(Oe)):this},resetStyle:function(f){return f===void 0?this.eachLayer(this.resetStyle,this):(f.options=d({},f.defaultOptions),this._setLayerStyle(f,this.options.style),this)},setStyle:function(f){return this.eachLayer(function(x){this._setLayerStyle(x,f)},this)},_setLayerStyle:function(f,x){f.setStyle&&(typeof x=="function"&&(x=x(f.feature)),f.setStyle(x))}});function ra(f,x){var R=f.type==="Feature"?f.geometry:f,U=R?R.coordinates:null,K=[],ue=x&&x.pointToLayer,Oe=x&&x.coordsToLatLng||li,nt,ut,Mt,Kt;if(!U&&!R)return null;switch(R.type){case"Point":return nt=Oe(U),Es(ue,f,nt,x);case"MultiPoint":for(Mt=0,Kt=U.length;Mt<Kt;Mt++)nt=Oe(U[Mt]),K.push(Es(ue,f,nt,x));return new uo(K);case"LineString":case"MultiLineString":return ut=pu(U,R.type==="LineString"?0:1,Oe),new sl(ut,x);case"Polygon":case"MultiPolygon":return ut=pu(U,R.type==="Polygon"?1:2,Oe),new Zl(ut,x);case"GeometryCollection":for(Mt=0,Kt=R.geometries.length;Mt<Kt;Mt++){var pn=ra({geometry:R.geometries[Mt],type:"Feature",properties:f.properties},x);pn&&K.push(pn)}return new uo(K);case"FeatureCollection":for(Mt=0,Kt=R.features.length;Mt<Kt;Mt++){var Yn=ra(R.features[Mt],x);Yn&&K.push(Yn)}return new uo(K);default:throw new Error("Invalid GeoJSON object.")}}function Es(f,x,R,U){return f?f(x,R):new fu(R,U&&U.markersInheritOptions&&U)}function li(f){return new Jt(f[1],f[0],f[2])}function pu(f,x,R){for(var U=[],K=0,ue=f.length,Oe;K<ue;K++)Oe=x?pu(f[K],x-1,R):(R||li)(f[K]),U.push(Oe);return U}function Hu(f,x){return f=Wt(f),f.alt!==void 0?[ee(f.lng,x),ee(f.lat,x),ee(f.alt,x)]:[ee(f.lng,x),ee(f.lat,x)]}function Wu(f,x,R,U){for(var K=[],ue=0,Oe=f.length;ue<Oe;ue++)K.push(x?Wu(f[ue],Xn(f[ue])?0:x-1,R,U):Hu(f[ue],U));return!x&&R&&K.length>0&&K.push(K[0].slice()),K}function ll(f,x){return f.feature?d({},f.feature,{geometry:x}):ul(x)}function ul(f){return f.type==="Feature"||f.type==="FeatureCollection"?f:{type:"Feature",properties:{},geometry:f}}var cl={toGeoJSON:function(f){return ll(this,{type:"Point",coordinates:Hu(this.getLatLng(),f)})}};fu.include(cl),Lc.include(cl),Gu.include(cl),sl.include({toGeoJSON:function(f){var x=!Xn(this._latlngs),R=Wu(this._latlngs,x?1:0,!1,f);return ll(this,{type:(x?"Multi":"")+"LineString",coordinates:R})}}),Zl.include({toGeoJSON:function(f){var x=!Xn(this._latlngs),R=x&&!Xn(this._latlngs[0]),U=Wu(this._latlngs,R?2:x?1:0,!0,f);return x||(U=[U]),ll(this,{type:(R?"Multi":"")+"Polygon",coordinates:U})}}),ju.include({toMultiPoint:function(f){var x=[];return this.eachLayer(function(R){x.push(R.toGeoJSON(f).geometry.coordinates)}),ll(this,{type:"MultiPoint",coordinates:x})},toGeoJSON:function(f){var x=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(x==="MultiPoint")return this.toMultiPoint(f);var R=x==="GeometryCollection",U=[];return this.eachLayer(function(K){if(K.toGeoJSON){var ue=K.toGeoJSON(f);if(R)U.push(ue.geometry);else{var Oe=ul(ue);Oe.type==="FeatureCollection"?U.push.apply(U,Oe.features):U.push(Oe)}}}),R?ll(this,{geometries:U,type:"GeometryCollection"}):{type:"FeatureCollection",features:U}}});function dh(f,x){return new ol(f,x)}var kc=dh,Xu=Ks.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(f,x,R){this._url=f,this._bounds=Ut(x),be(this,R)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(on(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){hi(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(f){return this.options.opacity=f,this._image&&this._updateOpacity(),this},setStyle:function(f){return f.opacity&&this.setOpacity(f.opacity),this},bringToFront:function(){return this._map&&xr(this._image),this},bringToBack:function(){return this._map&&$s(this._image),this},setUrl:function(f){return this._url=f,this._image&&(this._image.src=f),this},setBounds:function(f){return this._bounds=Ut(f),this._map&&this._reset(),this},getEvents:function(){var f={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var f=this._url.tagName==="IMG",x=this._image=f?this._url:ii("img");if(on(x,"leaflet-image-layer"),this._zoomAnimated&&on(x,"leaflet-zoom-animated"),this.options.className&&on(x,this.options.className),x.onselectstart=G,x.onmousemove=G,x.onload=_(this.fire,this,"load"),x.onerror=_(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(x.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),f){this._url=x.src;return}x.src=this._url,x.alt=this.options.alt},_animateZoom:function(f){var x=this._map.getZoomScale(f.zoom),R=this._map._latLngBoundsToNewLayerBounds(this._bounds,f.zoom,f.center).min;Gs(this._image,R,x)},_reset:function(){var f=this._image,x=new ke(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),R=x.getSize();ar(f,x.min),f.style.width=R.x+"px",f.style.height=R.y+"px"},_updateOpacity:function(){rr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var f=this.options.errorOverlayUrl;f&&this._url!==f&&(this._url=f,this._image.src=f)},getCenter:function(){return this._bounds.getCenter()}}),Kd=function(f,x,R){return new Xu(f,x,R)},zl=Xu.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var f=this._url.tagName==="VIDEO",x=this._image=f?this._url:ii("video");if(on(x,"leaflet-image-layer"),this._zoomAnimated&&on(x,"leaflet-zoom-animated"),this.options.className&&on(x,this.options.className),x.onselectstart=G,x.onmousemove=G,x.onloadeddata=_(this.fire,this,"load"),f){for(var R=x.getElementsByTagName("source"),U=[],K=0;K<R.length;K++)U.push(R[K].src);this._url=R.length>0?U:[x.src];return}Xe(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(x.style,"objectFit")&&(x.style.objectFit="fill"),x.autoplay=!!this.options.autoplay,x.loop=!!this.options.loop,x.muted=!!this.options.muted,x.playsInline=!!this.options.playsInline;for(var ue=0;ue<this._url.length;ue++){var Oe=ii("source");Oe.src=this._url[ue],x.appendChild(Oe)}}});function Ku(f,x,R){return new zl(f,x,R)}var Dc=Xu.extend({_initImage:function(){var f=this._image=this._url;on(f,"leaflet-image-layer"),this._zoomAnimated&&on(f,"leaflet-zoom-animated"),this.options.className&&on(f,this.options.className),f.onselectstart=G,f.onmousemove=G}});function zc(f,x,R){return new Dc(f,x,R)}var aa=Ks.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(f,x){f&&(f instanceof Jt||Xe(f))?(this._latlng=Wt(f),be(this,x)):(be(this,f),this._source=x),this.options.content&&(this._content=this.options.content)},openOn:function(f){return f=arguments.length?f:this._source._map,f.hasLayer(this)||f.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(f){return this._map?this.close():(arguments.length?this._source=f:f=this._source,this._prepareOpen(),this.openOn(f._map)),this},onAdd:function(f){this._zoomAnimated=f._zoomAnimated,this._container||this._initLayout(),f._fadeAnimated&&rr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),f._fadeAnimated&&rr(this._container,1),this.bringToFront(),this.options.interactive&&(on(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(f){f._fadeAnimated?(rr(this._container,0),this._removeTimeout=setTimeout(_(hi,void 0,this._container),200)):hi(this._container),this.options.interactive&&(Ui(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(f){return this._latlng=Wt(f),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(f){return this._content=f,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var f={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&xr(this._container),this},bringToBack:function(){return this._map&&$s(this._container),this},_prepareOpen:function(f){var x=this._source;if(!x._map)return!1;if(x instanceof uo){x=null;var R=this._source._layers;for(var U in R)if(R[U]._map){x=R[U];break}if(!x)return!1;this._source=x}if(!f)if(x.getCenter)f=x.getCenter();else if(x.getLatLng)f=x.getLatLng();else if(x.getBounds)f=x.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(f),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var f=this._contentNode,x=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof x=="string")f.innerHTML=x;else{for(;f.hasChildNodes();)f.removeChild(f.firstChild);f.appendChild(x)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var f=this._map.latLngToLayerPoint(this._latlng),x=Vt(this.options.offset),R=this._getAnchor();this._zoomAnimated?ar(this._container,f.add(R)):x=x.add(f).add(R);var U=this._containerBottom=-x.y,K=this._containerLeft=-Math.round(this._containerWidth/2)+x.x;this._container.style.bottom=U+"px",this._container.style.left=K+"px"}},_getAnchor:function(){return[0,0]}});Wn.include({_initOverlay:function(f,x,R,U){var K=x;return K instanceof f||(K=new f(U).setContent(x)),R&&K.setLatLng(R),K}}),Ks.include({_initOverlay:function(f,x,R,U){var K=R;return K instanceof f?(be(K,U),K._source=this):(K=x&&!U?x:new f(U,this),K.setContent(R)),K}});var Hl=aa.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(f){return f=arguments.length?f:this._source._map,!f.hasLayer(this)&&f._popup&&f._popup.options.autoClose&&f.removeLayer(f._popup),f._popup=this,aa.prototype.openOn.call(this,f)},onAdd:function(f){aa.prototype.onAdd.call(this,f),f.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ss||this._source.on("preclick",bn))},onRemove:function(f){aa.prototype.onRemove.call(this,f),f.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ss||this._source.off("preclick",bn))},getEvents:function(){var f=aa.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(f.preclick=this.close),this.options.keepInView&&(f.moveend=this._adjustPan),f},_initLayout:function(){var f="leaflet-popup",x=this._container=ii("div",f+" "+(this.options.className||"")+" leaflet-zoom-animated"),R=this._wrapper=ii("div",f+"-content-wrapper",x);if(this._contentNode=ii("div",f+"-content",R),fn(x),fa(this._contentNode),hn(x,"contextmenu",bn),this._tipContainer=ii("div",f+"-tip-container",x),this._tip=ii("div",f+"-tip",this._tipContainer),this.options.closeButton){var U=this._closeButton=ii("a",f+"-close-button",x);U.setAttribute("role","button"),U.setAttribute("aria-label","Close popup"),U.href="#close",U.innerHTML='<span aria-hidden="true">&#215;</span>',hn(U,"click",function(K){sn(K),this.close()},this)}},_updateLayout:function(){var f=this._contentNode,x=f.style;x.width="",x.whiteSpace="nowrap";var R=f.offsetWidth;R=Math.min(R,this.options.maxWidth),R=Math.max(R,this.options.minWidth),x.width=R+1+"px",x.whiteSpace="",x.height="";var U=f.offsetHeight,K=this.options.maxHeight,ue="leaflet-popup-scrolled";K&&U>K?(x.height=K+"px",on(f,ue)):Ui(f,ue),this._containerWidth=this._container.offsetWidth},_animateZoom:function(f){var x=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center),R=this._getAnchor();ar(this._container,x.add(R))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var f=this._map,x=parseInt(nl(this._container,"marginBottom"),10)||0,R=this._container.offsetHeight+x,U=this._containerWidth,K=new bt(this._containerLeft,-R-this._containerBottom);K._add(Qa(this._container));var ue=f.layerPointToContainerPoint(K),Oe=Vt(this.options.autoPanPadding),nt=Vt(this.options.autoPanPaddingTopLeft||Oe),ut=Vt(this.options.autoPanPaddingBottomRight||Oe),Mt=f.getSize(),Kt=0,pn=0;ue.x+U+ut.x>Mt.x&&(Kt=ue.x+U-Mt.x+ut.x),ue.x-Kt-nt.x<0&&(Kt=ue.x-nt.x),ue.y+R+ut.y>Mt.y&&(pn=ue.y+R-Mt.y+ut.y),ue.y-pn-nt.y<0&&(pn=ue.y-nt.y),(Kt||pn)&&(this.options.keepInView&&(this._autopanning=!0),f.fire("autopanstart").panBy([Kt,pn]))}},_getAnchor:function(){return Vt(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),fh=function(f,x){return new Hl(f,x)};Wn.mergeOptions({closePopupOnClick:!0}),Wn.include({openPopup:function(f,x,R){return this._initOverlay(Hl,f,x,R).openOn(this),this},closePopup:function(f){return f=arguments.length?f:this._popup,f&&f.close(),this}}),Ks.include({bindPopup:function(f,x){return this._popup=this._initOverlay(Hl,this._popup,f,x),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(f){return this._popup&&(this instanceof uo||(this._popup._source=this),this._popup._prepareOpen(f||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(f){return this._popup&&this._popup.setContent(f),this},getPopup:function(){return this._popup},_openPopup:function(f){if(!(!this._popup||!this._map)){na(f);var x=f.layer||f.target;if(this._popup._source===x&&!(x instanceof Ss)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(f.latlng);return}this._popup._source=x,this.openPopup(f.latlng)}},_movePopup:function(f){this._popup.setLatLng(f.latlng)},_onKeyPress:function(f){f.originalEvent.keyCode===13&&this._openPopup(f)}});var Po=aa.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(f){aa.prototype.onAdd.call(this,f),this.setOpacity(this.options.opacity),f.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(f){aa.prototype.onRemove.call(this,f),f.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var f=aa.prototype.getEvents.call(this);return this.options.permanent||(f.preclick=this.close),f},_initLayout:function(){var f="leaflet-tooltip",x=f+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ii("div",x),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+C(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(f){var x,R,U=this._map,K=this._container,ue=U.latLngToContainerPoint(U.getCenter()),Oe=U.layerPointToContainerPoint(f),nt=this.options.direction,ut=K.offsetWidth,Mt=K.offsetHeight,Kt=Vt(this.options.offset),pn=this._getAnchor();nt==="top"?(x=ut/2,R=Mt):nt==="bottom"?(x=ut/2,R=0):nt==="center"?(x=ut/2,R=Mt/2):nt==="right"?(x=0,R=Mt/2):nt==="left"?(x=ut,R=Mt/2):Oe.x<ue.x?(nt="right",x=0,R=Mt/2):(nt="left",x=ut+(Kt.x+pn.x)*2,R=Mt/2),f=f.subtract(Vt(x,R,!0)).add(Kt).add(pn),Ui(K,"leaflet-tooltip-right"),Ui(K,"leaflet-tooltip-left"),Ui(K,"leaflet-tooltip-top"),Ui(K,"leaflet-tooltip-bottom"),on(K,"leaflet-tooltip-"+nt),ar(K,f)},_updatePosition:function(){var f=this._map.latLngToLayerPoint(this._latlng);this._setPosition(f)},setOpacity:function(f){this.options.opacity=f,this._container&&rr(this._container,f)},_animateZoom:function(f){var x=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center);this._setPosition(x)},_getAnchor:function(){return Vt(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Oc=function(f,x){return new Po(f,x)};Wn.include({openTooltip:function(f,x,R){return this._initOverlay(Po,f,x,R).openOn(this),this},closeTooltip:function(f){return f.close(),this}}),Ks.include({bindTooltip:function(f,x){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Po,this._tooltip,f,x),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(f){if(!(!f&&this._tooltipHandlersAdded)){var x=f?"off":"on",R={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?R.add=this._openTooltip:(R.mouseover=this._openTooltip,R.mouseout=this.closeTooltip,R.click=this._openTooltip,this._map?this._addFocusListeners():R.add=this._addFocusListeners),this._tooltip.options.sticky&&(R.mousemove=this._moveTooltip),this[x](R),this._tooltipHandlersAdded=!f}},openTooltip:function(f){return this._tooltip&&(this instanceof uo||(this._tooltip._source=this),this._tooltip._prepareOpen(f)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(f){return this._tooltip&&this._tooltip.setContent(f),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(f){var x=typeof f.getElement=="function"&&f.getElement();x&&(hn(x,"focus",function(){this._tooltip._source=f,this.openTooltip()},this),hn(x,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(f){var x=typeof f.getElement=="function"&&f.getElement();x&&x.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(f){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var x=this;this._map.once("moveend",function(){x._openOnceFlag=!1,x._openTooltip(f)});return}this._tooltip._source=f.layer||f.target,this.openTooltip(this._tooltip.options.sticky?f.latlng:void 0)}},_moveTooltip:function(f){var x=f.latlng,R,U;this._tooltip.options.sticky&&f.originalEvent&&(R=this._map.mouseEventToContainerPoint(f.originalEvent),U=this._map.containerPointToLayerPoint(R),x=this._map.layerPointToLatLng(U)),this._tooltip.setLatLng(x)}});var mu=Ys.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(f){var x=f&&f.tagName==="DIV"?f:document.createElement("div"),R=this.options;if(R.html instanceof Element?(Zi(x),x.appendChild(R.html)):x.innerHTML=R.html!==!1?R.html:"",R.bgPos){var U=Vt(R.bgPos);x.style.backgroundPosition=-U.x+"px "+-U.y+"px"}return this._setIconStyles(x,"icon"),x},createShadow:function(){return null}});function co(f){return new mu(f)}Ys.Default=$u;var gu=Ks.extend({options:{tileSize:256,opacity:1,updateWhenIdle:en.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(f){be(this,f)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(f){f._addZoomLimit(this)},onRemove:function(f){this._removeAllTiles(),hi(this._container),f._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(xr(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&($s(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(f){return this.options.opacity=f,this._updateOpacity(),this},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var f=this._clampZoom(this._map.getZoom());f!==this._tileZoom&&(this._tileZoom=f,this._updateLevels()),this._update()}return this},getEvents:function(){var f={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=k(this._onMoveEnd,this.options.updateInterval,this)),f.move=this._onMove),this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},createTile:function(){return document.createElement("div")},getTileSize:function(){var f=this.options.tileSize;return f instanceof bt?f:new bt(f,f)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(f){for(var x=this.getPane().children,R=-f(-1/0,1/0),U=0,K=x.length,ue;U<K;U++)ue=x[U].style.zIndex,x[U]!==this._container&&ue&&(R=f(R,+ue));isFinite(R)&&(this.options.zIndex=R+f(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!en.ielt9){rr(this._container,this.options.opacity);var f=+new Date,x=!1,R=!1;for(var U in this._tiles){var K=this._tiles[U];if(!(!K.current||!K.loaded)){var ue=Math.min(1,(f-K.loaded)/200);rr(K.el,ue),ue<1?x=!0:(K.active?R=!0:this._onOpaqueTile(K),K.active=!0)}}R&&!this._noPrune&&this._pruneTiles(),x&&(je(this._fadeFrame),this._fadeFrame=Re(this._updateOpacity,this))}},_onOpaqueTile:G,_initContainer:function(){this._container||(this._container=ii("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var f=this._tileZoom,x=this.options.maxZoom;if(f!==void 0){for(var R in this._levels)R=Number(R),this._levels[R].el.children.length||R===f?(this._levels[R].el.style.zIndex=x-Math.abs(f-R),this._onUpdateLevel(R)):(hi(this._levels[R].el),this._removeTilesAtZoom(R),this._onRemoveLevel(R),delete this._levels[R]);var U=this._levels[f],K=this._map;return U||(U=this._levels[f]={},U.el=ii("div","leaflet-tile-container leaflet-zoom-animated",this._container),U.el.style.zIndex=x,U.origin=K.project(K.unproject(K.getPixelOrigin()),f).round(),U.zoom=f,this._setZoomTransform(U,K.getCenter(),K.getZoom()),G(U.el.offsetWidth),this._onCreateLevel(U)),this._level=U,U}},_onUpdateLevel:G,_onRemoveLevel:G,_onCreateLevel:G,_pruneTiles:function(){if(this._map){var f,x,R=this._map.getZoom();if(R>this.options.maxZoom||R<this.options.minZoom){this._removeAllTiles();return}for(f in this._tiles)x=this._tiles[f],x.retain=x.current;for(f in this._tiles)if(x=this._tiles[f],x.current&&!x.active){var U=x.coords;this._retainParent(U.x,U.y,U.z,U.z-5)||this._retainChildren(U.x,U.y,U.z,U.z+2)}for(f in this._tiles)this._tiles[f].retain||this._removeTile(f)}},_removeTilesAtZoom:function(f){for(var x in this._tiles)this._tiles[x].coords.z===f&&this._removeTile(x)},_removeAllTiles:function(){for(var f in this._tiles)this._removeTile(f)},_invalidateAll:function(){for(var f in this._levels)hi(this._levels[f].el),this._onRemoveLevel(Number(f)),delete this._levels[f];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(f,x,R,U){var K=Math.floor(f/2),ue=Math.floor(x/2),Oe=R-1,nt=new bt(+K,+ue);nt.z=+Oe;var ut=this._tileCoordsToKey(nt),Mt=this._tiles[ut];return Mt&&Mt.active?(Mt.retain=!0,!0):(Mt&&Mt.loaded&&(Mt.retain=!0),Oe>U?this._retainParent(K,ue,Oe,U):!1)},_retainChildren:function(f,x,R,U){for(var K=2*f;K<2*f+2;K++)for(var ue=2*x;ue<2*x+2;ue++){var Oe=new bt(K,ue);Oe.z=R+1;var nt=this._tileCoordsToKey(Oe),ut=this._tiles[nt];if(ut&&ut.active){ut.retain=!0;continue}else ut&&ut.loaded&&(ut.retain=!0);R+1<U&&this._retainChildren(K,ue,R+1,U)}},_resetView:function(f){var x=f&&(f.pinch||f.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),x,x)},_animateZoom:function(f){this._setView(f.center,f.zoom,!0,f.noUpdate)},_clampZoom:function(f){var x=this.options;return x.minNativeZoom!==void 0&&f<x.minNativeZoom?x.minNativeZoom:x.maxNativeZoom!==void 0&&x.maxNativeZoom<f?x.maxNativeZoom:f},_setView:function(f,x,R,U){var K=Math.round(x);this.options.maxZoom!==void 0&&K>this.options.maxZoom||this.options.minZoom!==void 0&&K<this.options.minZoom?K=void 0:K=this._clampZoom(K);var ue=this.options.updateWhenZooming&&K!==this._tileZoom;(!U||ue)&&(this._tileZoom=K,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),K!==void 0&&this._update(f),R||this._pruneTiles(),this._noPrune=!!R),this._setZoomTransforms(f,x)},_setZoomTransforms:function(f,x){for(var R in this._levels)this._setZoomTransform(this._levels[R],f,x)},_setZoomTransform:function(f,x,R){var U=this._map.getZoomScale(R,f.zoom),K=f.origin.multiplyBy(U).subtract(this._map._getNewPixelOrigin(x,R)).round();en.any3d?Gs(f.el,K,U):ar(f.el,K)},_resetGrid:function(){var f=this._map,x=f.options.crs,R=this._tileSize=this.getTileSize(),U=this._tileZoom,K=this._map.getPixelWorldBounds(this._tileZoom);K&&(this._globalTileRange=this._pxBoundsToTileRange(K)),this._wrapX=x.wrapLng&&!this.options.noWrap&&[Math.floor(f.project([0,x.wrapLng[0]],U).x/R.x),Math.ceil(f.project([0,x.wrapLng[1]],U).x/R.y)],this._wrapY=x.wrapLat&&!this.options.noWrap&&[Math.floor(f.project([x.wrapLat[0],0],U).y/R.x),Math.ceil(f.project([x.wrapLat[1],0],U).y/R.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(f){var x=this._map,R=x._animatingZoom?Math.max(x._animateToZoom,x.getZoom()):x.getZoom(),U=x.getZoomScale(R,this._tileZoom),K=x.project(f,this._tileZoom).floor(),ue=x.getSize().divideBy(U*2);return new ke(K.subtract(ue),K.add(ue))},_update:function(f){var x=this._map;if(x){var R=this._clampZoom(x.getZoom());if(f===void 0&&(f=x.getCenter()),this._tileZoom!==void 0){var U=this._getTiledPixelBounds(f),K=this._pxBoundsToTileRange(U),ue=K.getCenter(),Oe=[],nt=this.options.keepBuffer,ut=new ke(K.getBottomLeft().subtract([nt,-nt]),K.getTopRight().add([nt,-nt]));if(!(isFinite(K.min.x)&&isFinite(K.min.y)&&isFinite(K.max.x)&&isFinite(K.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Mt in this._tiles){var Kt=this._tiles[Mt].coords;(Kt.z!==this._tileZoom||!ut.contains(new bt(Kt.x,Kt.y)))&&(this._tiles[Mt].current=!1)}if(Math.abs(R-this._tileZoom)>1){this._setView(f,R);return}for(var pn=K.min.y;pn<=K.max.y;pn++)for(var Yn=K.min.x;Yn<=K.max.x;Yn++){var ga=new bt(Yn,pn);if(ga.z=this._tileZoom,!!this._isValidTile(ga)){var Zr=this._tiles[this._tileCoordsToKey(ga)];Zr?Zr.current=!0:Oe.push(ga)}}if(Oe.sort(function(Si,Li){return Si.distanceTo(ue)-Li.distanceTo(ue)}),Oe.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Za=document.createDocumentFragment();for(Yn=0;Yn<Oe.length;Yn++)this._addTile(Oe[Yn],Za);this._level.el.appendChild(Za)}}}},_isValidTile:function(f){var x=this._map.options.crs;if(!x.infinite){var R=this._globalTileRange;if(!x.wrapLng&&(f.x<R.min.x||f.x>R.max.x)||!x.wrapLat&&(f.y<R.min.y||f.y>R.max.y))return!1}if(!this.options.bounds)return!0;var U=this._tileCoordsToBounds(f);return Ut(this.options.bounds).overlaps(U)},_keyToBounds:function(f){return this._tileCoordsToBounds(this._keyToTileCoords(f))},_tileCoordsToNwSe:function(f){var x=this._map,R=this.getTileSize(),U=f.scaleBy(R),K=U.add(R),ue=x.unproject(U,f.z),Oe=x.unproject(K,f.z);return[ue,Oe]},_tileCoordsToBounds:function(f){var x=this._tileCoordsToNwSe(f),R=new Ot(x[0],x[1]);return this.options.noWrap||(R=this._map.wrapLatLngBounds(R)),R},_tileCoordsToKey:function(f){return f.x+":"+f.y+":"+f.z},_keyToTileCoords:function(f){var x=f.split(":"),R=new bt(+x[0],+x[1]);return R.z=+x[2],R},_removeTile:function(f){var x=this._tiles[f];x&&(hi(x.el),delete this._tiles[f],this.fire("tileunload",{tile:x.el,coords:this._keyToTileCoords(f)}))},_initTile:function(f){on(f,"leaflet-tile");var x=this.getTileSize();f.style.width=x.x+"px",f.style.height=x.y+"px",f.onselectstart=G,f.onmousemove=G,en.ielt9&&this.options.opacity<1&&rr(f,this.options.opacity)},_addTile:function(f,x){var R=this._getTilePos(f),U=this._tileCoordsToKey(f),K=this.createTile(this._wrapCoords(f),_(this._tileReady,this,f));this._initTile(K),this.createTile.length<2&&Re(_(this._tileReady,this,f,null,K)),ar(K,R),this._tiles[U]={el:K,coords:f,current:!0},x.appendChild(K),this.fire("tileloadstart",{tile:K,coords:f})},_tileReady:function(f,x,R){x&&this.fire("tileerror",{error:x,tile:R,coords:f});var U=this._tileCoordsToKey(f);R=this._tiles[U],R&&(R.loaded=+new Date,this._map._fadeAnimated?(rr(R.el,0),je(this._fadeFrame),this._fadeFrame=Re(this._updateOpacity,this)):(R.active=!0,this._pruneTiles()),x||(on(R.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:R.el,coords:f})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),en.ielt9||!this._map._fadeAnimated?Re(this._pruneTiles,this):setTimeout(_(this._pruneTiles,this),250)))},_getTilePos:function(f){return f.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(f){var x=new bt(this._wrapX?V(f.x,this._wrapX):f.x,this._wrapY?V(f.y,this._wrapY):f.y);return x.z=f.z,x},_pxBoundsToTileRange:function(f){var x=this.getTileSize();return new ke(f.min.unscaleBy(x).floor(),f.max.unscaleBy(x).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var f in this._tiles)if(!this._tiles[f].loaded)return!1;return!0}});function td(f){return new gu(f)}var hl=gu.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(f,x){this._url=f,x=be(this,x),x.detectRetina&&en.retina&&x.maxZoom>0?(x.tileSize=Math.floor(x.tileSize/2),x.zoomReverse?(x.zoomOffset--,x.minZoom=Math.min(x.maxZoom,x.minZoom+1)):(x.zoomOffset++,x.maxZoom=Math.max(x.minZoom,x.maxZoom-1)),x.minZoom=Math.max(0,x.minZoom)):x.zoomReverse?x.minZoom=Math.min(x.maxZoom,x.minZoom):x.maxZoom=Math.max(x.minZoom,x.maxZoom),typeof x.subdomains=="string"&&(x.subdomains=x.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(f,x){return this._url===f&&x===void 0&&(x=!0),this._url=f,x||this.redraw(),this},createTile:function(f,x){var R=document.createElement("img");return hn(R,"load",_(this._tileOnLoad,this,x,R)),hn(R,"error",_(this._tileOnError,this,x,R)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(R.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(R.referrerPolicy=this.options.referrerPolicy),R.alt="",R.src=this.getTileUrl(f),R},getTileUrl:function(f){var x={r:en.retina?"@2x":"",s:this._getSubdomain(f),x:f.x,y:f.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var R=this._globalTileRange.max.y-f.y;this.options.tms&&(x.y=R),x["-y"]=R}return Je(this._url,d(x,this.options))},_tileOnLoad:function(f,x){en.ielt9?setTimeout(_(f,this,null,x),0):f(null,x)},_tileOnError:function(f,x,R){var U=this.options.errorTileUrl;U&&x.getAttribute("src")!==U&&(x.src=U),f(R,x)},_onTileRemove:function(f){f.tile.onload=null},_getZoomForUrl:function(){var f=this._tileZoom,x=this.options.maxZoom,R=this.options.zoomReverse,U=this.options.zoomOffset;return R&&(f=x-f),f+U},_getSubdomain:function(f){var x=Math.abs(f.x+f.y)%this.options.subdomains.length;return this.options.subdomains[x]},_abortLoading:function(){var f,x;for(f in this._tiles)if(this._tiles[f].coords.z!==this._tileZoom&&(x=this._tiles[f].el,x.onload=G,x.onerror=G,!x.complete)){x.src=Ge;var R=this._tiles[f].coords;hi(x),delete this._tiles[f],this.fire("tileabort",{tile:x,coords:R})}},_removeTile:function(f){var x=this._tiles[f];if(x)return x.el.setAttribute("src",Ge),gu.prototype._removeTile.call(this,f)},_tileReady:function(f,x,R){if(!(!this._map||R&&R.getAttribute("src")===Ge))return gu.prototype._tileReady.call(this,f,x,R)}});function pa(f,x){return new hl(f,x)}var Wl=hl.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(f,x){this._url=f;var R=d({},this.defaultWmsParams);for(var U in x)U in this.options||(R[U]=x[U]);x=be(this,x);var K=x.detectRetina&&en.retina?2:1,ue=this.getTileSize();R.width=ue.x*K,R.height=ue.y*K,this.wmsParams=R},onAdd:function(f){this._crs=this.options.crs||f.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var x=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[x]=this._crs.code,hl.prototype.onAdd.call(this,f)},getTileUrl:function(f){var x=this._tileCoordsToNwSe(f),R=this._crs,U=xt(R.project(x[0]),R.project(x[1])),K=U.min,ue=U.max,Oe=(this._wmsVersion>=1.3&&this._crs===Xs?[K.y,K.x,ue.y,ue.x]:[K.x,K.y,ue.x,ue.y]).join(","),nt=hl.prototype.getTileUrl.call(this,f);return nt+Ne(this.wmsParams,nt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Oe},setParams:function(f,x){return d(this.wmsParams,f),x||this.redraw(),this}});function ts(f,x){return new Wl(f,x)}hl.WMS=Wl,pa.wms=ts;var ma=Ks.extend({options:{padding:.1},initialize:function(f){be(this,f),C(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),on(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var f={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(f.zoomanim=this._onAnimZoom),f},_onAnimZoom:function(f){this._updateTransform(f.center,f.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(f,x){var R=this._map.getZoomScale(x,this._zoom),U=this._map.getSize().multiplyBy(.5+this.options.padding),K=this._map.project(this._center,x),ue=U.multiplyBy(-R).add(K).subtract(this._map._getNewPixelOrigin(f,x));en.any3d?Gs(this._container,ue,R):ar(this._container,ue)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var f in this._layers)this._layers[f]._reset()},_onZoomEnd:function(){for(var f in this._layers)this._layers[f]._project()},_updatePaths:function(){for(var f in this._layers)this._layers[f]._update()},_update:function(){var f=this.options.padding,x=this._map.getSize(),R=this._map.containerPointToLayerPoint(x.multiplyBy(-f)).round();this._bounds=new ke(R,R.add(x.multiplyBy(1+f*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),_u=ma.extend({options:{tolerance:0},getEvents:function(){var f=ma.prototype.getEvents.call(this);return f.viewprereset=this._onViewPreReset,f},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ma.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var f=this._container=document.createElement("canvas");hn(f,"mousemove",this._onMouseMove,this),hn(f,"click dblclick mousedown mouseup contextmenu",this._onClick,this),hn(f,"mouseout",this._handleMouseOut,this),f._leaflet_disable_events=!0,this._ctx=f.getContext("2d")},_destroyContainer:function(){je(this._redrawRequest),delete this._ctx,hi(this._container),xn(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var f;this._redrawBounds=null;for(var x in this._layers)f=this._layers[x],f._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ma.prototype._update.call(this);var f=this._bounds,x=this._container,R=f.getSize(),U=en.retina?2:1;ar(x,f.min),x.width=U*R.x,x.height=U*R.y,x.style.width=R.x+"px",x.style.height=R.y+"px",en.retina&&this._ctx.scale(2,2),this._ctx.translate(-f.min.x,-f.min.y),this.fire("update")}},_reset:function(){ma.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(f){this._updateDashArray(f),this._layers[C(f)]=f;var x=f._order={layer:f,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=x),this._drawLast=x,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(f){this._requestRedraw(f)},_removePath:function(f){var x=f._order,R=x.next,U=x.prev;R?R.prev=U:this._drawLast=U,U?U.next=R:this._drawFirst=R,delete f._order,delete this._layers[C(f)],this._requestRedraw(f)},_updatePath:function(f){this._extendRedrawBounds(f),f._project(),f._update(),this._requestRedraw(f)},_updateStyle:function(f){this._updateDashArray(f),this._requestRedraw(f)},_updateDashArray:function(f){if(typeof f.options.dashArray=="string"){var x=f.options.dashArray.split(/[, ]+/),R=[],U,K;for(K=0;K<x.length;K++){if(U=Number(x[K]),isNaN(U))return;R.push(U)}f.options._dashArray=R}else f.options._dashArray=f.options.dashArray},_requestRedraw:function(f){this._map&&(this._extendRedrawBounds(f),this._redrawRequest=this._redrawRequest||Re(this._redraw,this))},_extendRedrawBounds:function(f){if(f._pxBounds){var x=(f.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ke,this._redrawBounds.extend(f._pxBounds.min.subtract([x,x])),this._redrawBounds.extend(f._pxBounds.max.add([x,x]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var f=this._redrawBounds;if(f){var x=f.getSize();this._ctx.clearRect(f.min.x,f.min.y,x.x,x.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var f,x=this._redrawBounds;if(this._ctx.save(),x){var R=x.getSize();this._ctx.beginPath(),this._ctx.rect(x.min.x,x.min.y,R.x,R.y),this._ctx.clip()}this._drawing=!0;for(var U=this._drawFirst;U;U=U.next)f=U.layer,(!x||f._pxBounds&&f._pxBounds.intersects(x))&&f._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(f,x){if(this._drawing){var R,U,K,ue,Oe=f._parts,nt=Oe.length,ut=this._ctx;if(nt){for(ut.beginPath(),R=0;R<nt;R++){for(U=0,K=Oe[R].length;U<K;U++)ue=Oe[R][U],ut[U?"lineTo":"moveTo"](ue.x,ue.y);x&&ut.closePath()}this._fillStroke(ut,f)}}},_updateCircle:function(f){if(!(!this._drawing||f._empty())){var x=f._point,R=this._ctx,U=Math.max(Math.round(f._radius),1),K=(Math.max(Math.round(f._radiusY),1)||U)/U;K!==1&&(R.save(),R.scale(1,K)),R.beginPath(),R.arc(x.x,x.y/K,U,0,Math.PI*2,!1),K!==1&&R.restore(),this._fillStroke(R,f)}},_fillStroke:function(f,x){var R=x.options;R.fill&&(f.globalAlpha=R.fillOpacity,f.fillStyle=R.fillColor||R.color,f.fill(R.fillRule||"evenodd")),R.stroke&&R.weight!==0&&(f.setLineDash&&f.setLineDash(x.options&&x.options._dashArray||[]),f.globalAlpha=R.opacity,f.lineWidth=R.weight,f.strokeStyle=R.color,f.lineCap=R.lineCap,f.lineJoin=R.lineJoin,f.stroke())},_onClick:function(f){for(var x=this._map.mouseEventToLayerPoint(f),R,U,K=this._drawFirst;K;K=K.next)R=K.layer,R.options.interactive&&R._containsPoint(x)&&(!(f.type==="click"||f.type==="preclick")||!this._map._draggableMoved(R))&&(U=R);this._fireEvent(U?[U]:!1,f)},_onMouseMove:function(f){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var x=this._map.mouseEventToLayerPoint(f);this._handleMouseHover(f,x)}},_handleMouseOut:function(f){var x=this._hoveredLayer;x&&(Ui(this._container,"leaflet-interactive"),this._fireEvent([x],f,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(f,x){if(!this._mouseHoverThrottled){for(var R,U,K=this._drawFirst;K;K=K.next)R=K.layer,R.options.interactive&&R._containsPoint(x)&&(U=R);U!==this._hoveredLayer&&(this._handleMouseOut(f),U&&(on(this._container,"leaflet-interactive"),this._fireEvent([U],f,"mouseover"),this._hoveredLayer=U)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,f),this._mouseHoverThrottled=!0,setTimeout(_(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(f,x,R){this._map._fireDOMEvent(x,R||x.type,f)},_bringToFront:function(f){var x=f._order;if(x){var R=x.next,U=x.prev;if(R)R.prev=U;else return;U?U.next=R:R&&(this._drawFirst=R),x.prev=this._drawLast,this._drawLast.next=x,x.next=null,this._drawLast=x,this._requestRedraw(f)}},_bringToBack:function(f){var x=f._order;if(x){var R=x.next,U=x.prev;if(U)U.next=R;else return;R?R.prev=U:U&&(this._drawLast=U),x.prev=null,x.next=this._drawFirst,this._drawFirst.prev=x,this._drawFirst=x,this._requestRedraw(f)}}});function Yu(f){return en.canvas?new _u(f):null}var Qs=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(f){return document.createElement("<lvml:"+f+' class="lvml">')}}catch{}return function(f){return document.createElement("<"+f+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),dl={_initContainer:function(){this._container=ii("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ma.prototype._update.call(this),this.fire("update"))},_initPath:function(f){var x=f._container=Qs("shape");on(x,"leaflet-vml-shape "+(this.options.className||"")),x.coordsize="1 1",f._path=Qs("path"),x.appendChild(f._path),this._updateStyle(f),this._layers[C(f)]=f},_addPath:function(f){var x=f._container;this._container.appendChild(x),f.options.interactive&&f.addInteractiveTarget(x)},_removePath:function(f){var x=f._container;hi(x),f.removeInteractiveTarget(x),delete this._layers[C(f)]},_updateStyle:function(f){var x=f._stroke,R=f._fill,U=f.options,K=f._container;K.stroked=!!U.stroke,K.filled=!!U.fill,U.stroke?(x||(x=f._stroke=Qs("stroke")),K.appendChild(x),x.weight=U.weight+"px",x.color=U.color,x.opacity=U.opacity,U.dashArray?x.dashStyle=Xe(U.dashArray)?U.dashArray.join(" "):U.dashArray.replace(/( *, *)/g," "):x.dashStyle="",x.endcap=U.lineCap.replace("butt","flat"),x.joinstyle=U.lineJoin):x&&(K.removeChild(x),f._stroke=null),U.fill?(R||(R=f._fill=Qs("fill")),K.appendChild(R),R.color=U.fillColor||U.color,R.opacity=U.fillOpacity):R&&(K.removeChild(R),f._fill=null)},_updateCircle:function(f){var x=f._point.round(),R=Math.round(f._radius),U=Math.round(f._radiusY||R);this._setPath(f,f._empty()?"M0 0":"AL "+x.x+","+x.y+" "+R+","+U+" 0,"+65535*360)},_setPath:function(f,x){f._path.v=x},_bringToFront:function(f){xr(f._container)},_bringToBack:function(f){$s(f._container)}},Ro=en.vml?Qs:Va,Xl=ma.extend({_initContainer:function(){this._container=Ro("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Ro("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){hi(this._container),xn(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ma.prototype._update.call(this);var f=this._bounds,x=f.getSize(),R=this._container;(!this._svgSize||!this._svgSize.equals(x))&&(this._svgSize=x,R.setAttribute("width",x.x),R.setAttribute("height",x.y)),ar(R,f.min),R.setAttribute("viewBox",[f.min.x,f.min.y,x.x,x.y].join(" ")),this.fire("update")}},_initPath:function(f){var x=f._path=Ro("path");f.options.className&&on(x,f.options.className),f.options.interactive&&on(x,"leaflet-interactive"),this._updateStyle(f),this._layers[C(f)]=f},_addPath:function(f){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(f._path),f.addInteractiveTarget(f._path)},_removePath:function(f){hi(f._path),f.removeInteractiveTarget(f._path),delete this._layers[C(f)]},_updatePath:function(f){f._project(),f._update()},_updateStyle:function(f){var x=f._path,R=f.options;x&&(R.stroke?(x.setAttribute("stroke",R.color),x.setAttribute("stroke-opacity",R.opacity),x.setAttribute("stroke-width",R.weight),x.setAttribute("stroke-linecap",R.lineCap),x.setAttribute("stroke-linejoin",R.lineJoin),R.dashArray?x.setAttribute("stroke-dasharray",R.dashArray):x.removeAttribute("stroke-dasharray"),R.dashOffset?x.setAttribute("stroke-dashoffset",R.dashOffset):x.removeAttribute("stroke-dashoffset")):x.setAttribute("stroke","none"),R.fill?(x.setAttribute("fill",R.fillColor||R.color),x.setAttribute("fill-opacity",R.fillOpacity),x.setAttribute("fill-rule",R.fillRule||"evenodd")):x.setAttribute("fill","none"))},_updatePoly:function(f,x){this._setPath(f,Ta(f._parts,x))},_updateCircle:function(f){var x=f._point,R=Math.max(Math.round(f._radius),1),U=Math.max(Math.round(f._radiusY),1)||R,K="a"+R+","+U+" 0 1,0 ",ue=f._empty()?"M0 0":"M"+(x.x-R)+","+x.y+K+R*2+",0 "+K+-R*2+",0 ";this._setPath(f,ue)},_setPath:function(f,x){f._path.setAttribute("d",x)},_bringToFront:function(f){xr(f._path)},_bringToBack:function(f){$s(f._path)}});en.vml&&Xl.include(dl);function $n(f){return en.svg||en.vml?new Xl(f):null}Wn.include({getRenderer:function(f){var x=f.options.renderer||this._getPaneRenderer(f.options.pane)||this.options.renderer||this._renderer;return x||(x=this._renderer=this._createRenderer()),this.hasLayer(x)||this.addLayer(x),x},_getPaneRenderer:function(f){if(f==="overlayPane"||f===void 0)return!1;var x=this._paneRenderers[f];return x===void 0&&(x=this._createRenderer({pane:f}),this._paneRenderers[f]=x),x},_createRenderer:function(f){return this.options.preferCanvas&&Yu(f)||$n(f)}});var Lo=Zl.extend({initialize:function(f,x){Zl.prototype.initialize.call(this,this._boundsToLatLngs(f),x)},setBounds:function(f){return this.setLatLngs(this._boundsToLatLngs(f))},_boundsToLatLngs:function(f){return f=Ut(f),[f.getSouthWest(),f.getNorthWest(),f.getNorthEast(),f.getSouthEast()]}});function Gf(f,x){return new Lo(f,x)}Xl.create=Ro,Xl.pointsToPath=Ta,ol.geometryToLayer=ra,ol.coordsToLatLng=li,ol.coordsToLatLngs=pu,ol.latLngToCoords=Hu,ol.latLngsToCoords=Wu,ol.getFeature=ll,ol.asFeature=ul,Wn.mergeOptions({boxZoom:!0});var ns=Hs.extend({initialize:function(f){this._map=f,this._container=f._container,this._pane=f._panes.overlayPane,this._resetStateTimeout=0,f.on("unload",this._destroy,this)},addHooks:function(){hn(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){xn(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){hi(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(f){if(!f.shiftKey||f.which!==1&&f.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),ja(),_s(),this._startPoint=this._map.mouseEventToContainerPoint(f),hn(document,{contextmenu:na,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(f){this._moved||(this._moved=!0,this._box=ii("div","leaflet-zoom-box",this._container),on(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(f);var x=new ke(this._point,this._startPoint),R=x.getSize();ar(this._box,x.min),this._box.style.width=R.x+"px",this._box.style.height=R.y+"px"},_finish:function(){this._moved&&(hi(this._box),Ui(this._container,"leaflet-crosshair")),Hi(),qa(),xn(document,{contextmenu:na,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(f){if(!(f.which!==1&&f.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(_(this._resetState,this),0);var x=new Ot(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(x).fire("boxzoomend",{boxZoomBounds:x})}},_onKeyDown:function(f){f.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Wn.addInitHook("addHandler","boxZoom",ns),Wn.mergeOptions({doubleClickZoom:!0});var ko=Hs.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(f){var x=this._map,R=x.getZoom(),U=x.options.zoomDelta,K=f.originalEvent.shiftKey?R-U:R+U;x.options.doubleClickZoom==="center"?x.setZoom(K):x.setZoomAround(f.containerPoint,K)}});Wn.addInitHook("addHandler","doubleClickZoom",ko),Wn.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Do=Hs.extend({addHooks:function(){if(!this._draggable){var f=this._map;this._draggable=new es(f._mapPane,f._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),f.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),f.on("zoomend",this._onZoomEnd,this),f.whenReady(this._onZoomEnd,this))}on(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Ui(this._map._container,"leaflet-grab"),Ui(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var f=this._map;if(f._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var x=Ut(this._map.options.maxBounds);this._offsetLimit=xt(this._map.latLngToContainerPoint(x.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(x.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;f.fire("movestart").fire("dragstart"),f.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(f){if(this._map.options.inertia){var x=this._lastTime=+new Date,R=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(R),this._times.push(x),this._prunePositions(x)}this._map.fire("move",f).fire("drag",f)},_prunePositions:function(f){for(;this._positions.length>1&&f-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var f=this._map.getSize().divideBy(2),x=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=x.subtract(f).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(f,x){return f-(f-x)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var f=this._draggable._newPos.subtract(this._draggable._startPos),x=this._offsetLimit;f.x<x.min.x&&(f.x=this._viscousLimit(f.x,x.min.x)),f.y<x.min.y&&(f.y=this._viscousLimit(f.y,x.min.y)),f.x>x.max.x&&(f.x=this._viscousLimit(f.x,x.max.x)),f.y>x.max.y&&(f.y=this._viscousLimit(f.y,x.max.y)),this._draggable._newPos=this._draggable._startPos.add(f)}},_onPreDragWrap:function(){var f=this._worldWidth,x=Math.round(f/2),R=this._initialWorldOffset,U=this._draggable._newPos.x,K=(U-x+R)%f+x-R,ue=(U+x+R)%f-x-R,Oe=Math.abs(K+R)<Math.abs(ue+R)?K:ue;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Oe},_onDragEnd:function(f){var x=this._map,R=x.options,U=!R.inertia||f.noInertia||this._times.length<2;if(x.fire("dragend",f),U)x.fire("moveend");else{this._prunePositions(+new Date);var K=this._lastPos.subtract(this._positions[0]),ue=(this._lastTime-this._times[0])/1e3,Oe=R.easeLinearity,nt=K.multiplyBy(Oe/ue),ut=nt.distanceTo([0,0]),Mt=Math.min(R.inertiaMaxSpeed,ut),Kt=nt.multiplyBy(Mt/ut),pn=Mt/(R.inertiaDeceleration*Oe),Yn=Kt.multiplyBy(-pn/2).round();!Yn.x&&!Yn.y?x.fire("moveend"):(Yn=x._limitOffset(Yn,x.options.maxBounds),Re(function(){x.panBy(Yn,{duration:pn,easeLinearity:Oe,noMoveStart:!0,animate:!0})}))}}});Wn.addInitHook("addHandler","dragging",Do),Wn.mergeOptions({keyboard:!0,keyboardPanDelta:80});var nd=Hs.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(f){this._map=f,this._setPanDelta(f.options.keyboardPanDelta),this._setZoomDelta(f.options.zoomDelta)},addHooks:function(){var f=this._map._container;f.tabIndex<=0&&(f.tabIndex="0"),hn(f,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),xn(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var f=document.body,x=document.documentElement,R=f.scrollTop||x.scrollTop,U=f.scrollLeft||x.scrollLeft;this._map._container.focus(),window.scrollTo(U,R)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(f){var x=this._panKeys={},R=this.keyCodes,U,K;for(U=0,K=R.left.length;U<K;U++)x[R.left[U]]=[-1*f,0];for(U=0,K=R.right.length;U<K;U++)x[R.right[U]]=[f,0];for(U=0,K=R.down.length;U<K;U++)x[R.down[U]]=[0,f];for(U=0,K=R.up.length;U<K;U++)x[R.up[U]]=[0,-1*f]},_setZoomDelta:function(f){var x=this._zoomKeys={},R=this.keyCodes,U,K;for(U=0,K=R.zoomIn.length;U<K;U++)x[R.zoomIn[U]]=f;for(U=0,K=R.zoomOut.length;U<K;U++)x[R.zoomOut[U]]=-f},_addHooks:function(){hn(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){xn(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(f){if(!(f.altKey||f.ctrlKey||f.metaKey)){var x=f.keyCode,R=this._map,U;if(x in this._panKeys){if(!R._panAnim||!R._panAnim._inProgress)if(U=this._panKeys[x],f.shiftKey&&(U=Vt(U).multiplyBy(3)),R.options.maxBounds&&(U=R._limitOffset(Vt(U),R.options.maxBounds)),R.options.worldCopyJump){var K=R.wrapLatLng(R.unproject(R.project(R.getCenter()).add(U)));R.panTo(K)}else R.panBy(U)}else if(x in this._zoomKeys)R.setZoom(R.getZoom()+(f.shiftKey?3:1)*this._zoomKeys[x]);else if(x===27&&R._popup&&R._popup.options.closeOnEscapeKey)R.closePopup();else return;na(f)}}});Wn.addInitHook("addHandler","keyboard",nd),Wn.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Qu=Hs.extend({addHooks:function(){hn(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){xn(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(f){var x=or(f),R=this._map.options.wheelDebounceTime;this._delta+=x,this._lastMousePos=this._map.mouseEventToContainerPoint(f),this._startTime||(this._startTime=+new Date);var U=Math.max(R-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(_(this._performZoom,this),U),na(f)},_performZoom:function(){var f=this._map,x=f.getZoom(),R=this._map.options.zoomSnap||0;f._stop();var U=this._delta/(this._map.options.wheelPxPerZoomLevel*4),K=4*Math.log(2/(1+Math.exp(-Math.abs(U))))/Math.LN2,ue=R?Math.ceil(K/R)*R:K,Oe=f._limitZoom(x+(this._delta>0?ue:-ue))-x;this._delta=0,this._startTime=null,Oe&&(f.options.scrollWheelZoom==="center"?f.setZoom(x+Oe):f.setZoomAround(this._lastMousePos,x+Oe))}});Wn.addInitHook("addHandler","scrollWheelZoom",Qu);var yu=600;Wn.mergeOptions({tapHold:en.touchNative&&en.safari&&en.mobile,tapTolerance:15});var Ju=Hs.extend({addHooks:function(){hn(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){xn(this._map._container,"touchstart",this._onDown,this)},_onDown:function(f){if(clearTimeout(this._holdTimeout),f.touches.length===1){var x=f.touches[0];this._startPos=this._newPos=new bt(x.clientX,x.clientY),this._holdTimeout=setTimeout(_(function(){this._cancel(),this._isTapValid()&&(hn(document,"touchend",sn),hn(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",x))},this),yu),hn(document,"touchend touchcancel contextmenu",this._cancel,this),hn(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function f(){xn(document,"touchend",sn),xn(document,"touchend touchcancel",f)},_cancel:function(){clearTimeout(this._holdTimeout),xn(document,"touchend touchcancel contextmenu",this._cancel,this),xn(document,"touchmove",this._onMove,this)},_onMove:function(f){var x=f.touches[0];this._newPos=new bt(x.clientX,x.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(f,x){var R=new MouseEvent(f,{bubbles:!0,cancelable:!0,view:window,screenX:x.screenX,screenY:x.screenY,clientX:x.clientX,clientY:x.clientY});R._simulated=!0,x.target.dispatchEvent(R)}});Wn.addInitHook("addHandler","tapHold",Ju),Wn.mergeOptions({touchZoom:en.touch,bounceAtZoomLimits:!0});var ec=Hs.extend({addHooks:function(){on(this._map._container,"leaflet-touch-zoom"),hn(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Ui(this._map._container,"leaflet-touch-zoom"),xn(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(f){var x=this._map;if(!(!f.touches||f.touches.length!==2||x._animatingZoom||this._zooming)){var R=x.mouseEventToContainerPoint(f.touches[0]),U=x.mouseEventToContainerPoint(f.touches[1]);this._centerPoint=x.getSize()._divideBy(2),this._startLatLng=x.containerPointToLatLng(this._centerPoint),x.options.touchZoom!=="center"&&(this._pinchStartLatLng=x.containerPointToLatLng(R.add(U)._divideBy(2))),this._startDist=R.distanceTo(U),this._startZoom=x.getZoom(),this._moved=!1,this._zooming=!0,x._stop(),hn(document,"touchmove",this._onTouchMove,this),hn(document,"touchend touchcancel",this._onTouchEnd,this),sn(f)}},_onTouchMove:function(f){if(!(!f.touches||f.touches.length!==2||!this._zooming)){var x=this._map,R=x.mouseEventToContainerPoint(f.touches[0]),U=x.mouseEventToContainerPoint(f.touches[1]),K=R.distanceTo(U)/this._startDist;if(this._zoom=x.getScaleZoom(K,this._startZoom),!x.options.bounceAtZoomLimits&&(this._zoom<x.getMinZoom()&&K<1||this._zoom>x.getMaxZoom()&&K>1)&&(this._zoom=x._limitZoom(this._zoom)),x.options.touchZoom==="center"){if(this._center=this._startLatLng,K===1)return}else{var ue=R._add(U)._divideBy(2)._subtract(this._centerPoint);if(K===1&&ue.x===0&&ue.y===0)return;this._center=x.unproject(x.project(this._pinchStartLatLng,this._zoom).subtract(ue),this._zoom)}this._moved||(x._moveStart(!0,!1),this._moved=!0),je(this._animRequest);var Oe=_(x._move,x,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=Re(Oe,this,!0),sn(f)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,je(this._animRequest),xn(document,"touchmove",this._onTouchMove,this),xn(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Wn.addInitHook("addHandler","touchZoom",ec),Wn.BoxZoom=ns,Wn.DoubleClickZoom=ko,Wn.Drag=Do,Wn.Keyboard=nd,Wn.ScrollWheelZoom=Qu,Wn.TapHold=Ju,Wn.TouchZoom=ec,t.Bounds=ke,t.Browser=en,t.CRS=Fn,t.Canvas=_u,t.Circle=Lc,t.CircleMarker=Gu,t.Class=Mn,t.Control=ia,t.DivIcon=mu,t.DivOverlay=aa,t.DomEvent=oo,t.DomUtil=mr,t.Draggable=es,t.Evented=At,t.FeatureGroup=uo,t.GeoJSON=ol,t.GridLayer=gu,t.Handler=Hs,t.Icon=Ys,t.ImageOverlay=Xu,t.LatLng=Jt,t.LatLngBounds=Ot,t.Layer=Ks,t.LayerGroup=ju,t.LineUtil=$a,t.Map=Wn,t.Marker=fu,t.Mixin=Ll,t.Path=Ss,t.Point=bt,t.PolyUtil=lo,t.Polygon=Zl,t.Polyline=sl,t.Popup=Hl,t.PosAnimation=bs,t.Projection=Ts,t.Rectangle=Lo,t.Renderer=ma,t.SVG=Xl,t.SVGOverlay=Dc,t.TileLayer=hl,t.Tooltip=Po,t.Transformation=Ns,t.Util=Pe,t.VideoOverlay=zl,t.bind=_,t.bounds=xt,t.canvas=Yu,t.circle=Wd,t.circleMarker=Zu,t.control=Ma,t.divIcon=co,t.extend=d,t.featureGroup=Jh,t.geoJSON=dh,t.geoJson=kc,t.gridLayer=td,t.icon=qu,t.imageOverlay=Kd,t.latLng=Wt,t.latLngBounds=Ut,t.layerGroup=Hd,t.map=Co,t.marker=hh,t.point=Vt,t.polygon=ed,t.polyline=Xd,t.popup=fh,t.rectangle=Gf,t.setOptions=be,t.stamp=C,t.svg=$n,t.svgOverlay=zc,t.tileLayer=pa,t.tooltip=Oc,t.transformation=Dr,t.version=a,t.videoOverlay=Ku;var vu=window.L;t.noConflict=function(){return window.L=vu,this},window.L=t}))})(F_,F_.exports)),F_.exports}var vN=yN();const kr=wy(vN);var r0={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.6.2/LICENSE.txt
 */var bN=r0.exports,oS;function xN(){return oS||(oS=1,(function(i,e){(function(t,a){i.exports=a()})(bN,(function(){var t={},a={};function d(_,c,C){if(a[_]=C,_==="index"){var k="var sharedModule = {}; ("+a.shared+")(sharedModule); ("+a.worker+")(sharedModule);",V={};return a.shared(V),a.index(t,V),typeof window<"u"&&t.setWorkerUrl(window.URL.createObjectURL(new Blob([k],{type:"text/javascript"}))),t}}d("shared",["exports"],(function(_){function c(l,r,o,p){return new(o||(o=Promise))((function(v,E){function A(F){try{z(p.next(F))}catch(q){E(q)}}function M(F){try{z(p.throw(F))}catch(q){E(q)}}function z(F){var q;F.done?v(F.value):(q=F.value,q instanceof o?q:new o((function(W){W(q)}))).then(A,M)}z((p=p.apply(l,r||[])).next())}))}function C(l,r){this.x=l,this.y=r}function k(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var V,G;typeof SuppressedError=="function"&&SuppressedError,C.prototype={clone(){return new C(this.x,this.y)},add(l){return this.clone()._add(l)},sub(l){return this.clone()._sub(l)},multByPoint(l){return this.clone()._multByPoint(l)},divByPoint(l){return this.clone()._divByPoint(l)},mult(l){return this.clone()._mult(l)},div(l){return this.clone()._div(l)},rotate(l){return this.clone()._rotate(l)},rotateAround(l,r){return this.clone()._rotateAround(l,r)},matMult(l){return this.clone()._matMult(l)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(l){return this.x===l.x&&this.y===l.y},dist(l){return Math.sqrt(this.distSqr(l))},distSqr(l){const r=l.x-this.x,o=l.y-this.y;return r*r+o*o},angle(){return Math.atan2(this.y,this.x)},angleTo(l){return Math.atan2(this.y-l.y,this.x-l.x)},angleWith(l){return this.angleWithSep(l.x,l.y)},angleWithSep(l,r){return Math.atan2(this.x*r-this.y*l,this.x*l+this.y*r)},_matMult(l){const r=l[2]*this.x+l[3]*this.y;return this.x=l[0]*this.x+l[1]*this.y,this.y=r,this},_add(l){return this.x+=l.x,this.y+=l.y,this},_sub(l){return this.x-=l.x,this.y-=l.y,this},_mult(l){return this.x*=l,this.y*=l,this},_div(l){return this.x/=l,this.y/=l,this},_multByPoint(l){return this.x*=l.x,this.y*=l.y,this},_divByPoint(l){return this.x/=l.x,this.y/=l.y,this},_unit(){return this._div(this.mag()),this},_perp(){const l=this.y;return this.y=this.x,this.x=-l,this},_rotate(l){const r=Math.cos(l),o=Math.sin(l),p=o*this.x+r*this.y;return this.x=r*this.x-o*this.y,this.y=p,this},_rotateAround(l,r){const o=Math.cos(l),p=Math.sin(l),v=r.y+p*(this.x-r.x)+o*(this.y-r.y);return this.x=r.x+o*(this.x-r.x)-p*(this.y-r.y),this.y=v,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:C},C.convert=function(l){if(l instanceof C)return l;if(Array.isArray(l))return new C(+l[0],+l[1]);if(l.x!==void 0&&l.y!==void 0)return new C(+l.x,+l.y);throw new Error("Expected [x, y] or {x, y} point format")};var ee=(function(){if(G)return V;function l(r,o,p,v){this.cx=3*r,this.bx=3*(p-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(v-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=o,this.p2x=p,this.p2y=v}return G=1,V=l,l.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,o){if(o===void 0&&(o=1e-6),r<0)return 0;if(r>1)return 1;for(var p=r,v=0;v<8;v++){var E=this.sampleCurveX(p)-r;if(Math.abs(E)<o)return p;var A=this.sampleCurveDerivativeX(p);if(Math.abs(A)<1e-6)break;p-=E/A}var M=0,z=1;for(p=r,v=0;v<20&&(E=this.sampleCurveX(p),!(Math.abs(E-r)<o));v++)r>E?M=p:z=p,p=.5*(z-M)+M;return p},solve:function(r,o){return this.sampleCurveY(this.solveCurveX(r,o))}},V})(),Y=k(ee);let xe,be;function Ne(){return xe==null&&(xe=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),xe}function tt(){if(be==null&&(be=!1,Ne())){const r=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(r){for(let p=0;p<25;p++){const v=4*p;r.fillStyle=`rgb(${v},${v+1},${v+2})`,r.fillRect(p%5,Math.floor(p/5),1,1)}const o=r.getImageData(0,0,5,5).data;for(let p=0;p<100;p++)if(p%4!=3&&o[p]!==p){be=!0;break}}}return be||!1}var Je=1e-6,Xe=typeof Float32Array<"u"?Float32Array:Array;function Ke(){var l=new Xe(9);return Xe!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[5]=0,l[6]=0,l[7]=0),l[0]=1,l[4]=1,l[8]=1,l}function Ge(l){return l[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function Fe(){var l=new Xe(3);return Xe!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l}function de(l){return Math.hypot(l[0],l[1],l[2])}function ce(l,r,o){var p=new Xe(3);return p[0]=l,p[1]=r,p[2]=o,p}function ge(l,r,o){return l[0]=r[0]+o[0],l[1]=r[1]+o[1],l[2]=r[2]+o[2],l}function Ae(l,r,o){return l[0]=r[0]*o,l[1]=r[1]*o,l[2]=r[2]*o,l}function Re(l,r,o){var p=r[0],v=r[1],E=r[2],A=o[0],M=o[1],z=o[2];return l[0]=v*z-E*M,l[1]=E*A-p*z,l[2]=p*M-v*A,l}Math.hypot||(Math.hypot=function(){for(var l=0,r=arguments.length;r--;)l+=arguments[r]*arguments[r];return Math.sqrt(l)});var je,Pe=de;function Mn(l,r,o){var p=r[0],v=r[1],E=r[2],A=r[3];return l[0]=o[0]*p+o[4]*v+o[8]*E+o[12]*A,l[1]=o[1]*p+o[5]*v+o[9]*E+o[13]*A,l[2]=o[2]*p+o[6]*v+o[10]*E+o[14]*A,l[3]=o[3]*p+o[7]*v+o[11]*E+o[15]*A,l}function ni(){var l=new Xe(4);return Xe!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l[3]=1,l}function mt(l,r,o,p){var v=.5*Math.PI/180;r*=v,o*=v,p*=v;var E=Math.sin(r),A=Math.cos(r),M=Math.sin(o),z=Math.cos(o),F=Math.sin(p),q=Math.cos(p);return l[0]=E*z*q-A*M*F,l[1]=A*M*q+E*z*F,l[2]=A*z*F-E*M*q,l[3]=A*z*q+E*M*F,l}function At(){var l=new Xe(2);return Xe!=Float32Array&&(l[0]=0,l[1]=0),l}function bt(l,r){var o=new Xe(2);return o[0]=l,o[1]=r,o}Fe(),je=new Xe(4),Xe!=Float32Array&&(je[0]=0,je[1]=0,je[2]=0,je[3]=0),Fe(),ce(1,0,0),ce(0,1,0),ni(),ni(),Ke(),At();const Zt=8192;function Vt(l,r,o){return r*(Zt/(l.tileSize*Math.pow(2,o-l.tileID.overscaledZ)))}function ke(l,r){return(l%r+r)%r}function xt(l,r,o){return l*(1-o)+r*o}function Ot(l){if(l<=0)return 0;if(l>=1)return 1;const r=l*l,o=r*l;return 4*(l<.5?o:3*(l-r)+o-.75)}function Ut(l,r,o,p){const v=new Y(l,r,o,p);return E=>v.solve(E)}const Jt=Ut(.25,.1,.25,1);function Wt(l,r,o){return Math.min(o,Math.max(r,l))}function Fn(l,r,o){const p=o-r,v=((l-r)%p+p)%p+r;return v===r?o:v}function oi(l,...r){for(const o of r)for(const p in o)l[p]=o[p];return l}let fi=1;function ds(l,r,o){const p={};for(const v in l)p[v]=r.call(this,l[v],v,l);return p}function Ns(l,r,o){const p={};for(const v in l)r.call(this,l[v],v,l)&&(p[v]=l[v]);return p}function Dr(l){return Array.isArray(l)?l.map(Dr):typeof l=="object"&&l?ds(l,Dr):l}const Fi={};function Pi(l){Fi[l]||(typeof console<"u"&&console.warn(l),Fi[l]=!0)}function Va(l,r,o){return(o.y-l.y)*(r.x-l.x)>(r.y-l.y)*(o.x-l.x)}function Ta(l){return typeof WorkerGlobalScope<"u"&&l!==void 0&&l instanceof WorkerGlobalScope}let Bs=null;function Sa(l){return typeof ImageBitmap<"u"&&l instanceof ImageBitmap}const Vi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function pr(l,r,o,p,v){return c(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const E=new VideoFrame(l,{timestamp:0});try{const A=E==null?void 0:E.format;if(!A||!A.startsWith("BGR")&&!A.startsWith("RGB"))throw new Error(`Unrecognized format ${A}`);const M=A.startsWith("BGR"),z=new Uint8ClampedArray(p*v*4);if(yield E.copyTo(z,(function(F,q,W,te,ie){const re=4*Math.max(-q,0),oe=(Math.max(0,W)-W)*te*4+re,pe=4*te,Te=Math.max(0,q),He=Math.max(0,W);return{rect:{x:Te,y:He,width:Math.min(F.width,q+te)-Te,height:Math.min(F.height,W+ie)-He},layout:[{offset:oe,stride:pe}]}})(l,r,o,p,v)),M)for(let F=0;F<z.length;F+=4){const q=z[F];z[F]=z[F+2],z[F+2]=q}return z}finally{E.close()}}))}let Ea,wo;function ao(l,r,o,p){return l.addEventListener(r,o,p),{unsubscribe:()=>{l.removeEventListener(r,o,p)}}}function qr(l){return l*Math.PI/180}function fs(l){return l/Math.PI*180}const ps={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Fs={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},ms="AbortError";function We(){return new Error(ms)}const se={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function le(l){return se.REGISTERED_PROTOCOLS[l.substring(0,l.indexOf("://"))]}const fe="global-dispatcher";class Se extends Error{constructor(r,o,p,v){super(`AJAXError: ${o} (${r}): ${p}`),this.status=r,this.statusText=o,this.url=p,this.body=v}}const De=()=>Ta(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,$e=function(l,r){if(/:\/\//.test(l.url)&&!/^https?:|^file:/.test(l.url)){const p=le(l.url);if(p)return p(l,r);if(Ta(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:l,targetMapId:fe},r)}if(!(/^file:/.test(o=l.url)||/^file:/.test(De())&&!/^\w+:/.test(o))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(p,v){return c(this,void 0,void 0,(function*(){const E=new Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,cache:p.cache,referrer:De(),signal:v.signal});let A,M;p.type!=="json"||E.headers.has("Accept")||E.headers.set("Accept","application/json");try{A=yield fetch(E)}catch(F){throw new Se(0,F.message,p.url,new Blob)}if(!A.ok){const F=yield A.blob();throw new Se(A.status,A.statusText,p.url,F)}M=p.type==="arrayBuffer"||p.type==="image"?A.arrayBuffer():p.type==="json"?A.json():A.text();const z=yield M;if(v.signal.aborted)throw We();return{data:z,cacheControl:A.headers.get("Cache-Control"),expires:A.headers.get("Expires")}}))})(l,r);if(Ta(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:l,mustQueue:!0,targetMapId:fe},r)}var o;return(function(p,v){return new Promise(((E,A)=>{var M;const z=new XMLHttpRequest;z.open(p.method||"GET",p.url,!0),p.type!=="arrayBuffer"&&p.type!=="image"||(z.responseType="arraybuffer");for(const F in p.headers)z.setRequestHeader(F,p.headers[F]);p.type==="json"&&(z.responseType="text",!((M=p.headers)===null||M===void 0)&&M.Accept||z.setRequestHeader("Accept","application/json")),z.withCredentials=p.credentials==="include",z.onerror=()=>{A(new Error(z.statusText))},z.onload=()=>{if(!v.signal.aborted)if((z.status>=200&&z.status<300||z.status===0)&&z.response!==null){let F=z.response;if(p.type==="json")try{F=JSON.parse(z.response)}catch(q){return void A(q)}E({data:F,cacheControl:z.getResponseHeader("Cache-Control"),expires:z.getResponseHeader("Expires")})}else{const F=new Blob([z.response],{type:z.getResponseHeader("Content-Type")});A(new Se(z.status,z.statusText,p.url,F))}},v.signal.addEventListener("abort",(()=>{z.abort(),A(We())})),z.send(p.body)}))})(l,r)};function et(l){if(!l||l.indexOf("://")<=0||l.indexOf("data:image/")===0||l.indexOf("blob:")===0)return!0;const r=new URL(l),o=window.location;return r.protocol===o.protocol&&r.host===o.host}function Ze(l,r,o){o[l]&&o[l].indexOf(r)!==-1||(o[l]=o[l]||[],o[l].push(r))}function _t(l,r,o){if(o&&o[l]){const p=o[l].indexOf(r);p!==-1&&o[l].splice(p,1)}}class Pt{constructor(r,o={}){oi(this,o),this.type=r}}class wt extends Pt{constructor(r,o={}){super("error",oi({error:r},o))}}class tn{on(r,o){return this._listeners=this._listeners||{},Ze(r,o,this._listeners),{unsubscribe:()=>{this.off(r,o)}}}off(r,o){return _t(r,o,this._listeners),_t(r,o,this._oneTimeListeners),this}once(r,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},Ze(r,o,this._oneTimeListeners),this):new Promise((p=>this.once(r,p)))}fire(r,o){typeof r=="string"&&(r=new Pt(r,o||{}));const p=r.type;if(this.listens(p)){r.target=this;const v=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const M of v)M.call(this,r);const E=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const M of E)_t(p,M,this._oneTimeListeners),M.call(this,r);const A=this._eventedParent;A&&(oi(r,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),A.fire(r))}else r instanceof wt&&console.error(r.error);return this}listens(r){return this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r)}setEventedParent(r,o){return this._eventedParent=r,this._eventedParentData=o,this}}var qe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const vn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Rn(l,r){const o={};for(const p in l)p!=="ref"&&(o[p]=l[p]);return vn.forEach((p=>{p in r&&(o[p]=r[p])})),o}function nn(l,r){if(Array.isArray(l)){if(!Array.isArray(r)||l.length!==r.length)return!1;for(let o=0;o<l.length;o++)if(!nn(l[o],r[o]))return!1;return!0}if(typeof l=="object"&&l!==null&&r!==null){if(typeof r!="object"||Object.keys(l).length!==Object.keys(r).length)return!1;for(const o in l)if(!nn(l[o],r[o]))return!1;return!0}return l===r}function Nn(l,r){l.push(r)}function Ri(l,r,o){Nn(o,{command:"addSource",args:[l,r[l]]})}function Gi(l,r,o){Nn(r,{command:"removeSource",args:[l]}),o[l]=!0}function tr(l,r,o,p){Gi(l,o,p),Ri(l,r,o)}function Ir(l,r,o){let p;for(p in l[o])if(Object.prototype.hasOwnProperty.call(l[o],p)&&p!=="data"&&!nn(l[o][p],r[o][p]))return!1;for(p in r[o])if(Object.prototype.hasOwnProperty.call(r[o],p)&&p!=="data"&&!nn(l[o][p],r[o][p]))return!1;return!0}function Vn(l,r,o,p,v,E){l=l||{},r=r||{};for(const A in l)Object.prototype.hasOwnProperty.call(l,A)&&(nn(l[A],r[A])||o.push({command:E,args:[p,A,r[A],v]}));for(const A in r)Object.prototype.hasOwnProperty.call(r,A)&&!Object.prototype.hasOwnProperty.call(l,A)&&(nn(l[A],r[A])||o.push({command:E,args:[p,A,r[A],v]}))}function Kn(l){return l.id}function br(l,r){return l[r.id]=r,l}class Rt{constructor(r,o,p,v){this.message=(r?`${r}: `:"")+p,v&&(this.identifier=v),o!=null&&o.__line__&&(this.line=o.__line__)}}function en(l,...r){for(const o of r)for(const p in o)l[p]=o[p];return l}class nr extends Error{constructor(r,o){super(o),this.message=o,this.key=r}}class ta{constructor(r,o=[]){this.parent=r,this.bindings={};for(const[p,v]of o)this.bindings[p]=v}concat(r){return new ta(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}const Aa={kind:"null"},kt={kind:"number"},yn={kind:"string"},In={kind:"boolean"},ir={kind:"color"},tl={kind:"projectionDefinition"},To={kind:"object"},Bn={kind:"value"},Vs={kind:"collator"},Us={kind:"formatted"},gs={kind:"padding"},$r={kind:"colorArray"},Gr={kind:"numberArray"},Ei={kind:"resolvedImage"},Mr={kind:"variableAnchorOffsetCollection"};function da(l,r){return{kind:"array",itemType:l,N:r}}function wi(l){if(l.kind==="array"){const r=wi(l.itemType);return typeof l.N=="number"?`array<${r}, ${l.N}>`:l.itemType.kind==="value"?"array":`array<${r}>`}return l.kind}const So=[Aa,kt,yn,In,ir,tl,Us,To,da(Bn),gs,Gr,$r,Ei,Mr];function Ua(l,r){if(r.kind==="error")return null;if(l.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!Ua(l.itemType,r.itemType))&&(typeof l.N!="number"||l.N===r.N))return null}else{if(l.kind===r.kind)return null;if(l.kind==="value"){for(const o of So)if(!Ua(o,r))return null}}return`Expected ${wi(l)} but found ${wi(r)} instead.`}function Eo(l,r){return r.some((o=>o.kind===l.kind))}function js(l,r){return r.some((o=>o==="null"?l===null:o==="array"?Array.isArray(l):o==="object"?l&&!Array.isArray(l)&&typeof l=="object":o===typeof l))}function qs(l,r){return l.kind==="array"&&r.kind==="array"?l.itemType.kind===r.itemType.kind&&typeof l.N=="number":l.kind===r.kind}const nl=.96422,ii=.82521,hi=4/29,Zi=6/29,xr=3*Zi*Zi,$s=Zi*Zi*Zi,uu=Math.PI/180,on=180/Math.PI;function Ui(l){return(l%=360)<0&&(l+=360),l}function Ca([l,r,o,p]){let v,E;const A=rr((.2225045*(l=so(l))+.7168786*(r=so(r))+.0606169*(o=so(o)))/1);l===r&&r===o?v=E=A:(v=rr((.4360747*l+.3850649*r+.1430804*o)/nl),E=rr((.0139322*l+.0971045*r+.7141733*o)/ii));const M=116*A-16;return[M<0?0:M,500*(v-A),200*(A-E),p]}function so(l){return l<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function rr(l){return l>$s?Math.pow(l,1/3):l/xr+hi}function Ao([l,r,o,p]){let v=(l+16)/116,E=isNaN(r)?v:v+r/500,A=isNaN(o)?v:v-o/200;return v=1*Gs(v),E=nl*Gs(E),A=ii*Gs(A),[Pl(3.1338561*E-1.6168667*v-.4906146*A),Pl(-.9787684*E+1.9161415*v+.033454*A),Pl(.0719453*E-.2289914*v+1.4052427*A),p]}function Pl(l){return(l=l<=.00304?12.92*l:1.055*Math.pow(l,1/2.4)-.055)<0?0:l>1?1:l}function Gs(l){return l>Zi?l*l*l:xr*(l-hi)}const ar=Object.hasOwn||function(l,r){return Object.prototype.hasOwnProperty.call(l,r)};function Qa(l,r){return ar(l,r)?l[r]:void 0}function ja(l){return parseInt(l.padEnd(2,l),16)/255}function Hi(l,r){return Un(r?l/100:l,0,1)}function Un(l,r,o){return Math.min(Math.max(r,l),o)}function Ja(l){return!l.some(Number.isNaN)}const _s={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function qa(l,r,o){return l+o*(r-l)}function Zs(l,r,o){return l.map(((p,v)=>qa(p,r[v],o)))}class Ln{constructor(r,o,p,v=1,E=!0){this.r=r,this.g=o,this.b=p,this.a=v,E||(this.r*=v,this.g*=v,this.b*=v,v||this.overwriteGetter("rgb",[r,o,p,v]))}static parse(r){if(r instanceof Ln)return r;if(typeof r!="string")return;const o=(function(p){if((p=p.toLowerCase().trim())==="transparent")return[0,0,0,0];const v=Qa(_s,p);if(v){const[A,M,z]=v;return[A/255,M/255,z/255,1]}if(p.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(p)){const A=p.length<6?1:2;let M=1;return[ja(p.slice(M,M+=A)),ja(p.slice(M,M+=A)),ja(p.slice(M,M+=A)),ja(p.slice(M,M+A)||"ff")]}if(p.startsWith("rgb")){const A=p.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(A){const[M,z,F,q,W,te,ie,re,oe,pe,Te,He]=A,Le=[q||" ",ie||" ",pe].join("");if(Le==="  "||Le==="  /"||Le===",,"||Le===",,,"){const Be=[F,te,oe].join(""),ot=Be==="%%%"?100:Be===""?255:0;if(ot){const gt=[Un(+z/ot,0,1),Un(+W/ot,0,1),Un(+re/ot,0,1),Te?Hi(+Te,He):1];if(Ja(gt))return gt}}return}}const E=p.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(E){const[A,M,z,F,q,W,te,ie,re]=E,oe=[z||" ",q||" ",te].join("");if(oe==="  "||oe==="  /"||oe===",,"||oe===",,,"){const pe=[+M,Un(+F,0,100),Un(+W,0,100),ie?Hi(+ie,re):1];if(Ja(pe))return(function([Te,He,Le,Be]){function ot(gt){const It=(gt+Te/30)%12,$t=He*Math.min(Le,1-Le);return Le-$t*Math.max(-1,Math.min(It-3,9-It,1))}return Te=Ui(Te),He/=100,Le/=100,[ot(0),ot(8),ot(4),Be]})(pe)}}})(r);return o?new Ln(...o,!1):void 0}get rgb(){const{r,g:o,b:p,a:v}=this,E=v||1/0;return this.overwriteGetter("rgb",[r/E,o/E,p/E,v])}get hcl(){return this.overwriteGetter("hcl",(function(r){const[o,p,v,E]=Ca(r),A=Math.sqrt(p*p+v*v);return[Math.round(1e4*A)?Ui(Math.atan2(v,p)*on):NaN,A,o,E]})(this.rgb))}get lab(){return this.overwriteGetter("lab",Ca(this.rgb))}overwriteGetter(r,o){return Object.defineProperty(this,r,{value:o}),o}toString(){const[r,o,p,v]=this.rgb;return`rgba(${[r,o,p].map((E=>Math.round(255*E))).join(",")},${v})`}static interpolate(r,o,p,v="rgb"){switch(v){case"rgb":{const[E,A,M,z]=Zs(r.rgb,o.rgb,p);return new Ln(E,A,M,z,!1)}case"hcl":{const[E,A,M,z]=r.hcl,[F,q,W,te]=o.hcl;let ie,re;if(isNaN(E)||isNaN(F))isNaN(E)?isNaN(F)?ie=NaN:(ie=F,M!==1&&M!==0||(re=q)):(ie=E,W!==1&&W!==0||(re=A));else{let Le=F-E;F>E&&Le>180?Le-=360:F<E&&E-F>180&&(Le+=360),ie=E+p*Le}const[oe,pe,Te,He]=(function([Le,Be,ot,gt]){return Le=isNaN(Le)?0:Le*uu,Ao([ot,Math.cos(Le)*Be,Math.sin(Le)*Be,gt])})([ie,re??qa(A,q,p),qa(M,W,p),qa(z,te,p)]);return new Ln(oe,pe,Te,He,!1)}case"lab":{const[E,A,M,z]=Ao(Zs(r.lab,o.lab,p));return new Ln(E,A,M,z,!1)}}}}Ln.black=new Ln(0,0,0,1),Ln.white=new Ln(1,1,1,1),Ln.transparent=new Ln(0,0,0,0),Ln.red=new Ln(1,0,0,1);class ys{constructor(r,o,p){this.sensitivity=r?o?"variant":"case":o?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,o){return this.collator.compare(r,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Ia=["bottom","center","top"];class Rl{constructor(r,o,p,v,E,A){this.text=r,this.image=o,this.scale=p,this.fontStack=v,this.textColor=E,this.verticalAlign=A}}class Wi{constructor(r){this.sections=r}static fromString(r){return new Wi([new Rl(r,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((r=>r.text.length!==0||r.image&&r.image.name.length!==0))}static factory(r){return r instanceof Wi?r:Wi.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map((r=>r.text)).join("")}}class mr{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof mr)return r;if(typeof r=="number")return new mr([r,r,r,r]);if(Array.isArray(r)&&!(r.length<1||r.length>4)){for(const o of r)if(typeof o!="number")return;switch(r.length){case 1:r=[r[0],r[0],r[0],r[0]];break;case 2:r=[r[0],r[1],r[0],r[1]];break;case 3:r=[r[0],r[1],r[2],r[1]]}return new mr(r)}}toString(){return JSON.stringify(this.values)}static interpolate(r,o,p){return new mr(Zs(r.values,o.values,p))}}class hn{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof hn)return r;if(typeof r=="number")return new hn([r]);if(Array.isArray(r)){for(const o of r)if(typeof o!="number")return;return new hn(r)}}toString(){return JSON.stringify(this.values)}static interpolate(r,o,p){return new hn(Zs(r.values,o.values,p))}}class pi{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof pi)return r;if(typeof r=="string"){const p=Ln.parse(r);return p?new pi([p]):void 0}if(!Array.isArray(r))return;const o=[];for(const p of r){if(typeof p!="string")return;const v=Ln.parse(p);if(!v)return;o.push(v)}return new pi(o)}toString(){return JSON.stringify(this.values)}static interpolate(r,o,p,v="rgb"){const E=[];if(r.values.length!=o.values.length)throw new Error(`colorArray: Arrays have mismatched length (${r.values.length} vs. ${o.values.length}), cannot interpolate.`);for(let A=0;A<r.values.length;A++)E.push(Ln.interpolate(r.values[A],o.values[A],p,v));return new pi(E)}}class xn extends Error{constructor(r){super(r),this.name="RuntimeError"}toJSON(){return this.message}}const il=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class sr{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof sr)return r;if(Array.isArray(r)&&!(r.length<1)&&r.length%2==0){for(let o=0;o<r.length;o+=2){const p=r[o],v=r[o+1];if(typeof p!="string"||!il.has(p)||!Array.isArray(v)||v.length!==2||typeof v[0]!="number"||typeof v[1]!="number")return}return new sr(r)}}toString(){return JSON.stringify(this.values)}static interpolate(r,o,p){const v=r.values,E=o.values;if(v.length!==E.length)throw new xn(`Cannot interpolate values of different length. from: ${r.toString()}, to: ${o.toString()}`);const A=[];for(let M=0;M<v.length;M+=2){if(v[M]!==E[M])throw new xn(`Cannot interpolate values containing mismatched anchors. from[${M}]: ${v[M]}, to[${M}]: ${E[M]}`);A.push(v[M]);const[z,F]=v[M+1],[q,W]=E[M+1];A.push([qa(z,q,p),qa(F,W,p)])}return new sr(A)}}class cr{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new cr({name:r,available:!1}):null}}class wr{constructor(r,o,p){this.from=r,this.to=o,this.transition=p}static interpolate(r,o,p){return new wr(r,o,p)}static parse(r){return r instanceof wr?r:Array.isArray(r)&&r.length===3&&typeof r[0]=="string"&&typeof r[1]=="string"&&typeof r[2]=="number"?new wr(r[0],r[1],r[2]):typeof r=="object"&&typeof r.from=="string"&&typeof r.to=="string"&&typeof r.transition=="number"?new wr(r.from,r.to,r.transition):typeof r=="string"?new wr(r,r,1):void 0}}function bn(l,r,o,p){return typeof l=="number"&&l>=0&&l<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof o=="number"&&o>=0&&o<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[l,r,o,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[l,r,o,p]:[l,r,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function fa(l){if(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number"||l instanceof wr||l instanceof Ln||l instanceof ys||l instanceof Wi||l instanceof mr||l instanceof hn||l instanceof pi||l instanceof sr||l instanceof cr)return!0;if(Array.isArray(l)){for(const r of l)if(!fa(r))return!1;return!0}if(typeof l=="object"){for(const r in l)if(!fa(l[r]))return!1;return!0}return!1}function fn(l){if(l===null)return Aa;if(typeof l=="string")return yn;if(typeof l=="boolean")return In;if(typeof l=="number")return kt;if(l instanceof Ln)return ir;if(l instanceof wr)return tl;if(l instanceof ys)return Vs;if(l instanceof Wi)return Us;if(l instanceof mr)return gs;if(l instanceof hn)return Gr;if(l instanceof pi)return $r;if(l instanceof sr)return Mr;if(l instanceof cr)return Ei;if(Array.isArray(l)){const r=l.length;let o;for(const p of l){const v=fn(p);if(o){if(o===v)continue;o=Bn;break}o=v}return da(o||Bn,r)}return To}function sn(l){const r=typeof l;return l===null?"":r==="string"||r==="number"||r==="boolean"?String(l):l instanceof Ln||l instanceof wr||l instanceof Wi||l instanceof mr||l instanceof hn||l instanceof pi||l instanceof sr||l instanceof cr?l.toString():JSON.stringify(l)}class na{constructor(r,o){this.type=r,this.value=o}static parse(r,o){if(r.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!fa(r[1]))return o.error("invalid value");const p=r[1];let v=fn(p);const E=o.expectedType;return v.kind!=="array"||v.N!==0||!E||E.kind!=="array"||typeof E.N=="number"&&E.N!==0||(v=E),new na(v,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const qn={string:yn,number:kt,boolean:In,object:To};class zr{constructor(r,o){this.type=r,this.args=o}static parse(r,o){if(r.length<2)return o.error("Expected at least one argument.");let p,v=1;const E=r[0];if(E==="array"){let M,z;if(r.length>2){const F=r[1];if(typeof F!="string"||!(F in qn)||F==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);M=qn[F],v++}else M=Bn;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return o.error('The length argument to "array" must be a positive integer literal',2);z=r[2],v++}p=da(M,z)}else{if(!qn[E])throw new Error(`Types doesn't contain name = ${E}`);p=qn[E]}const A=[];for(;v<r.length;v++){const M=o.parse(r[v],v,Bn);if(!M)return null;A.push(M)}return new zr(p,A)}evaluate(r){for(let o=0;o<this.args.length;o++){const p=this.args[o].evaluate(r);if(!Ua(this.type,fn(p)))return p;if(o===this.args.length-1)throw new xn(`Expected value to be of type ${wi(this.type)}, but found ${wi(fn(p))} instead.`)}throw new Error}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every((r=>r.outputDefined()))}}const Yr={"to-boolean":In,"to-color":ir,"to-number":kt,"to-string":yn};class or{constructor(r,o){this.type=r,this.args=o}static parse(r,o){if(r.length<2)return o.error("Expected at least one argument.");const p=r[0];if(!Yr[p])throw new Error(`Can't parse ${p} as it is not part of the known types`);if((p==="to-boolean"||p==="to-string")&&r.length!==2)return o.error("Expected one argument.");const v=Yr[p],E=[];for(let A=1;A<r.length;A++){const M=o.parse(r[A],A,Bn);if(!M)return null;E.push(M)}return new or(v,E)}evaluate(r){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(r);case"color":{let o,p;for(const v of this.args){if(o=v.evaluate(r),p=null,o instanceof Ln)return o;if(typeof o=="string"){const E=r.parseColor(o);if(E)return E}else if(Array.isArray(o)&&(p=o.length<3||o.length>4?`Invalid rgba value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:bn(o[0],o[1],o[2],o[3]),!p))return new Ln(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new xn(p||`Could not parse color from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"padding":{let o;for(const p of this.args){o=p.evaluate(r);const v=mr.parse(o);if(v)return v}throw new xn(`Could not parse padding from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"numberArray":{let o;for(const p of this.args){o=p.evaluate(r);const v=hn.parse(o);if(v)return v}throw new xn(`Could not parse numberArray from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"colorArray":{let o;for(const p of this.args){o=p.evaluate(r);const v=pi.parse(o);if(v)return v}throw new xn(`Could not parse colorArray from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"variableAnchorOffsetCollection":{let o;for(const p of this.args){o=p.evaluate(r);const v=sr.parse(o);if(v)return v}throw new xn(`Could not parse variableAnchorOffsetCollection from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"number":{let o=null;for(const p of this.args){if(o=p.evaluate(r),o===null)return 0;const v=Number(o);if(!isNaN(v))return v}throw new xn(`Could not convert ${JSON.stringify(o)} to number.`)}case"formatted":return Wi.fromString(sn(this.args[0].evaluate(r)));case"resolvedImage":return cr.fromString(sn(this.args[0].evaluate(r)));case"projectionDefinition":return this.args[0].evaluate(r);default:return sn(this.args[0].evaluate(r))}}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every((r=>r.outputDefined()))}}const vs=["Unknown","Point","LineString","Polygon"];class oo{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?vs[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(r){let o=this._parseColorCache.get(r);return o||(o=Ln.parse(r),this._parseColorCache.set(r,o)),o}}class bs{constructor(r,o,p=[],v,E=new ta,A=[]){this.registry=r,this.path=p,this.key=p.map((M=>`[${M}]`)).join(""),this.scope=E,this.errors=A,this.expectedType=v,this._isConstant=o}parse(r,o,p,v,E={}){return o?this.concat(o,p,v)._parse(r,E):this._parse(r,E)}_parse(r,o){function p(v,E,A){return A==="assert"?new zr(E,[v]):A==="coerce"?new or(E,[v]):v}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const v=r[0];if(typeof v!="string")return this.error(`Expression name must be a string, but found ${typeof v} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const E=this.registry[v];if(E){let A=E.parse(r,this);if(!A)return null;if(this.expectedType){const M=this.expectedType,z=A.type;if(M.kind!=="string"&&M.kind!=="number"&&M.kind!=="boolean"&&M.kind!=="object"&&M.kind!=="array"||z.kind!=="value"){if(M.kind==="projectionDefinition"&&["string","array"].includes(z.kind)||["color","formatted","resolvedImage"].includes(M.kind)&&["value","string"].includes(z.kind)||["padding","numberArray"].includes(M.kind)&&["value","number","array"].includes(z.kind)||M.kind==="colorArray"&&["value","string","array"].includes(z.kind)||M.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(z.kind))A=p(A,M,o.typeAnnotation||"coerce");else if(this.checkSubtype(M,z))return null}else A=p(A,M,o.typeAnnotation||"assert")}if(!(A instanceof na)&&A.type.kind!=="resolvedImage"&&this._isConstant(A)){const M=new oo;try{A=new na(A.type,A.evaluate(M))}catch(z){return this.error(z.message),null}}return A}return this.error(`Unknown expression "${v}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,o,p){const v=typeof r=="number"?this.path.concat(r):this.path,E=p?this.scope.concat(p):this.scope;return new bs(this.registry,this._isConstant,v,o||null,E,this.errors)}error(r,...o){const p=`${this.key}${o.map((v=>`[${v}]`)).join("")}`;this.errors.push(new nr(p,r))}checkSubtype(r,o){const p=Ua(r,o);return p&&this.error(p),p}}class Wn{constructor(r,o){this.type=o.type,this.bindings=[].concat(r),this.result=o}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const o of this.bindings)r(o[1]);r(this.result)}static parse(r,o){if(r.length<4)return o.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const p=[];for(let E=1;E<r.length-1;E+=2){const A=r[E];if(typeof A!="string")return o.error(`Expected string, but found ${typeof A} instead.`,E);if(/[^a-zA-Z0-9_]/.test(A))return o.error("Variable names must contain only alphanumeric characters or '_'.",E);const M=o.parse(r[E+1],E+1);if(!M)return null;p.push([A,M])}const v=o.parse(r[r.length-1],r.length-1,o.expectedType,p);return v?new Wn(p,v):null}outputDefined(){return this.result.outputDefined()}}class Co{constructor(r,o){this.type=o.type,this.name=r,this.boundExpression=o}static parse(r,o){if(r.length!==2||typeof r[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const p=r[1];return o.scope.has(p)?new Co(p,o.scope.get(p)):o.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}}class ia{constructor(r,o,p){this.type=r,this.index=o,this.input=p}static parse(r,o){if(r.length!==3)return o.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const p=o.parse(r[1],1,kt),v=o.parse(r[2],2,da(o.expectedType||Bn));return p&&v?new ia(v.type.itemType,p,v):null}evaluate(r){const o=this.index.evaluate(r),p=this.input.evaluate(r);if(o<0)throw new xn(`Array index out of bounds: ${o} < 0.`);if(o>=p.length)throw new xn(`Array index out of bounds: ${o} > ${p.length-1}.`);if(o!==Math.floor(o))throw new xn(`Array index must be an integer, but found ${o} instead.`);return p[o]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}}class Ma{constructor(r,o){this.type=In,this.needle=r,this.haystack=o}static parse(r,o){if(r.length!==3)return o.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const p=o.parse(r[1],1,Bn),v=o.parse(r[2],2,Bn);return p&&v?Eo(p.type,[In,yn,kt,Aa,Bn])?new Ma(p,v):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${wi(p.type)} instead`):null}evaluate(r){const o=this.needle.evaluate(r),p=this.haystack.evaluate(r);if(!p)return!1;if(!js(o,["boolean","string","number","null"]))throw new xn(`Expected first argument to be of type boolean, string, number or null, but found ${wi(fn(o))} instead.`);if(!js(p,["string","array"]))throw new xn(`Expected second argument to be of type array or string, but found ${wi(fn(p))} instead.`);return p.indexOf(o)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}}class Pa{constructor(r,o,p){this.type=kt,this.needle=r,this.haystack=o,this.fromIndex=p}static parse(r,o){if(r.length<=2||r.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const p=o.parse(r[1],1,Bn),v=o.parse(r[2],2,Bn);if(!p||!v)return null;if(!Eo(p.type,[In,yn,kt,Aa,Bn]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${wi(p.type)} instead`);if(r.length===4){const E=o.parse(r[3],3,kt);return E?new Pa(p,v,E):null}return new Pa(p,v)}evaluate(r){const o=this.needle.evaluate(r),p=this.haystack.evaluate(r);if(!js(o,["boolean","string","number","null"]))throw new xn(`Expected first argument to be of type boolean, string, number or null, but found ${wi(fn(o))} instead.`);let v;if(this.fromIndex&&(v=this.fromIndex.evaluate(r)),js(p,["string"])){const E=p.indexOf(o,v);return E===-1?-1:[...p.slice(0,E)].length}if(js(p,["array"]))return p.indexOf(o,v);throw new xn(`Expected second argument to be of type array or string, but found ${wi(fn(p))} instead.`)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}}class Or{constructor(r,o,p,v,E,A){this.inputType=r,this.type=o,this.input=p,this.cases=v,this.outputs=E,this.otherwise=A}static parse(r,o){if(r.length<5)return o.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return o.error("Expected an even number of arguments.");let p,v;o.expectedType&&o.expectedType.kind!=="value"&&(v=o.expectedType);const E={},A=[];for(let F=2;F<r.length-1;F+=2){let q=r[F];const W=r[F+1];Array.isArray(q)||(q=[q]);const te=o.concat(F);if(q.length===0)return te.error("Expected at least one branch label.");for(const re of q){if(typeof re!="number"&&typeof re!="string")return te.error("Branch labels must be numbers or strings.");if(typeof re=="number"&&Math.abs(re)>Number.MAX_SAFE_INTEGER)return te.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof re=="number"&&Math.floor(re)!==re)return te.error("Numeric branch labels must be integer values.");if(p){if(te.checkSubtype(p,fn(re)))return null}else p=fn(re);if(E[String(re)]!==void 0)return te.error("Branch labels must be unique.");E[String(re)]=A.length}const ie=o.parse(W,F,v);if(!ie)return null;v=v||ie.type,A.push(ie)}const M=o.parse(r[1],1,Bn);if(!M)return null;const z=o.parse(r[r.length-1],r.length-1,v);return z?M.type.kind!=="value"&&o.concat(1).checkSubtype(p,M.type)?null:new Or(p,v,M,E,A,z):null}evaluate(r){const o=this.input.evaluate(r);return(fn(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every((r=>r.outputDefined()))&&this.otherwise.outputDefined()}}class xs{constructor(r,o,p){this.type=r,this.branches=o,this.otherwise=p}static parse(r,o){if(r.length<4)return o.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return o.error("Expected an odd number of arguments.");let p;o.expectedType&&o.expectedType.kind!=="value"&&(p=o.expectedType);const v=[];for(let A=1;A<r.length-1;A+=2){const M=o.parse(r[A],A,In);if(!M)return null;const z=o.parse(r[A+1],A+1,p);if(!z)return null;v.push([M,z]),p=p||z.type}const E=o.parse(r[r.length-1],r.length-1,p);if(!E)return null;if(!p)throw new Error("Can't infer output type");return new xs(p,v,E)}evaluate(r){for(const[o,p]of this.branches)if(o.evaluate(r))return p.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[o,p]of this.branches)r(o),r(p);r(this.otherwise)}outputDefined(){return this.branches.every((([r,o])=>o.outputDefined()))&&this.otherwise.outputDefined()}}class $l{constructor(r,o,p,v){this.type=r,this.input=o,this.beginIndex=p,this.endIndex=v}static parse(r,o){if(r.length<=2||r.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const p=o.parse(r[1],1,Bn),v=o.parse(r[2],2,kt);if(!p||!v)return null;if(!Eo(p.type,[da(Bn),yn,Bn]))return o.error(`Expected first argument to be of type array or string, but found ${wi(p.type)} instead`);if(r.length===4){const E=o.parse(r[3],3,kt);return E?new $l(p.type,p,v,E):null}return new $l(p.type,p,v)}evaluate(r){const o=this.input.evaluate(r),p=this.beginIndex.evaluate(r);let v;if(this.endIndex&&(v=this.endIndex.evaluate(r)),js(o,["string"]))return[...o].slice(p,v).join("");if(js(o,["array"]))return o.slice(p,v);throw new xn(`Expected first argument to be of type array or string, but found ${wi(fn(o))} instead.`)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}}function Io(l,r){const o=l.length-1;let p,v,E=0,A=o,M=0;for(;E<=A;)if(M=Math.floor((E+A)/2),p=l[M],v=l[M+1],p<=r){if(M===o||r<v)return M;E=M+1}else{if(!(p>r))throw new xn("Input is not a number.");A=M-1}return 0}class Xi{constructor(r,o,p){this.type=r,this.input=o,this.labels=[],this.outputs=[];for(const[v,E]of p)this.labels.push(v),this.outputs.push(E)}static parse(r,o){if(r.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return o.error("Expected an even number of arguments.");const p=o.parse(r[1],1,kt);if(!p)return null;const v=[];let E=null;o.expectedType&&o.expectedType.kind!=="value"&&(E=o.expectedType);for(let A=1;A<r.length;A+=2){const M=A===1?-1/0:r[A],z=r[A+1],F=A,q=A+1;if(typeof M!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(v.length&&v[v.length-1][0]>=M)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',F);const W=o.parse(z,q,E);if(!W)return null;E=E||W.type,v.push([M,W])}return new Xi(E,p,v)}evaluate(r){const o=this.labels,p=this.outputs;if(o.length===1)return p[0].evaluate(r);const v=this.input.evaluate(r);if(v<=o[0])return p[0].evaluate(r);const E=o.length;return v>=o[E-1]?p[E-1].evaluate(r):p[Io(o,v)].evaluate(r)}eachChild(r){r(this.input);for(const o of this.outputs)r(o)}outputDefined(){return this.outputs.every((r=>r.outputDefined()))}}function Vu(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var rl,Gl,Hs=(function(){if(Gl)return rl;function l(r,o,p,v){this.cx=3*r,this.bx=3*(p-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(v-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=o,this.p2x=p,this.p2y=v}return Gl=1,rl=l,l.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,o){if(o===void 0&&(o=1e-6),r<0)return 0;if(r>1)return 1;for(var p=r,v=0;v<8;v++){var E=this.sampleCurveX(p)-r;if(Math.abs(E)<o)return p;var A=this.sampleCurveDerivativeX(p);if(Math.abs(A)<1e-6)break;p-=E/A}var M=0,z=1;for(p=r,v=0;v<20&&(E=this.sampleCurveX(p),!(Math.abs(E-r)<o));v++)r>E?M=p:z=p,p=.5*(z-M)+M;return p},solve:function(r,o){return this.sampleCurveY(this.solveCurveX(r,o))}},rl})(),Ll=Vu(Hs);class lr{constructor(r,o,p,v,E){this.type=r,this.operator=o,this.interpolation=p,this.input=v,this.labels=[],this.outputs=[];for(const[A,M]of E)this.labels.push(A),this.outputs.push(M)}static interpolationFactor(r,o,p,v){let E=0;if(r.name==="exponential")E=es(o,r.base,p,v);else if(r.name==="linear")E=es(o,1,p,v);else if(r.name==="cubic-bezier"){const A=r.controlPoints;E=new Ll(A[0],A[1],A[2],A[3]).solve(es(o,1,p,v))}return E}static parse(r,o){let[p,v,E,...A]=r;if(!Array.isArray(v)||v.length===0)return o.error("Expected an interpolation type expression.",1);if(v[0]==="linear")v={name:"linear"};else if(v[0]==="exponential"){const F=v[1];if(typeof F!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);v={name:"exponential",base:F}}else{if(v[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(v[0])}`,1,0);{const F=v.slice(1);if(F.length!==4||F.some((q=>typeof q!="number"||q<0||q>1)))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);v={name:"cubic-bezier",controlPoints:F}}}if(r.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(E=o.parse(E,2,kt),!E)return null;const M=[];let z=null;p!=="interpolate-hcl"&&p!=="interpolate-lab"||o.expectedType==$r?o.expectedType&&o.expectedType.kind!=="value"&&(z=o.expectedType):z=ir;for(let F=0;F<A.length;F+=2){const q=A[F],W=A[F+1],te=F+3,ie=F+4;if(typeof q!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',te);if(M.length&&M[M.length-1][0]>=q)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',te);const re=o.parse(W,ie,z);if(!re)return null;z=z||re.type,M.push([q,re])}return qs(z,kt)||qs(z,tl)||qs(z,ir)||qs(z,gs)||qs(z,Gr)||qs(z,$r)||qs(z,Mr)||qs(z,da(kt))?new lr(z,p,v,E,M):o.error(`Type ${wi(z)} is not interpolatable.`)}evaluate(r){const o=this.labels,p=this.outputs;if(o.length===1)return p[0].evaluate(r);const v=this.input.evaluate(r);if(v<=o[0])return p[0].evaluate(r);const E=o.length;if(v>=o[E-1])return p[E-1].evaluate(r);const A=Io(o,v),M=lr.interpolationFactor(this.interpolation,v,o[A],o[A+1]),z=p[A].evaluate(r),F=p[A+1].evaluate(r);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return qa(z,F,M);case"color":return Ln.interpolate(z,F,M);case"padding":return mr.interpolate(z,F,M);case"colorArray":return pi.interpolate(z,F,M);case"numberArray":return hn.interpolate(z,F,M);case"variableAnchorOffsetCollection":return sr.interpolate(z,F,M);case"array":return Zs(z,F,M);case"projectionDefinition":return wr.interpolate(z,F,M)}case"interpolate-hcl":switch(this.type.kind){case"color":return Ln.interpolate(z,F,M,"hcl");case"colorArray":return pi.interpolate(z,F,M,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Ln.interpolate(z,F,M,"lab");case"colorArray":return pi.interpolate(z,F,M,"lab")}}}eachChild(r){r(this.input);for(const o of this.outputs)r(o)}outputDefined(){return this.outputs.every((r=>r.outputDefined()))}}function es(l,r,o,p){const v=p-o,E=l-o;return v===0?0:r===1?E/v:(Math.pow(r,E)-1)/(Math.pow(r,v)-1)}const ws={color:Ln.interpolate,number:qa,padding:mr.interpolate,numberArray:hn.interpolate,colorArray:pi.interpolate,variableAnchorOffsetCollection:sr.interpolate,array:Zs};class kl{constructor(r,o){this.type=r,this.args=o}static parse(r,o){if(r.length<2)return o.error("Expected at least one argument.");let p=null;const v=o.expectedType;v&&v.kind!=="value"&&(p=v);const E=[];for(const M of r.slice(1)){const z=o.parse(M,1+E.length,p,void 0,{typeAnnotation:"omit"});if(!z)return null;p=p||z.type,E.push(z)}if(!p)throw new Error("No output type");const A=v&&E.some((M=>Ua(v,M.type)));return new kl(A?Bn:p,E)}evaluate(r){let o,p=null,v=0;for(const E of this.args)if(v++,p=E.evaluate(r),p&&p instanceof cr&&!p.available&&(o||(o=p.name),p=null,v===this.args.length&&(p=o)),p!==null)break;return p}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every((r=>r.outputDefined()))}}function al(l,r){return l==="=="||l==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function lo(l,r,o,p){return p.compare(r,o)===0}function Ai(l,r,o){const p=l!=="=="&&l!=="!=";return class II{constructor(E,A,M){this.type=In,this.lhs=E,this.rhs=A,this.collator=M,this.hasUntypedArgument=E.type.kind==="value"||A.type.kind==="value"}static parse(E,A){if(E.length!==3&&E.length!==4)return A.error("Expected two or three arguments.");const M=E[0];let z=A.parse(E[1],1,Bn);if(!z)return null;if(!al(M,z.type))return A.concat(1).error(`"${M}" comparisons are not supported for type '${wi(z.type)}'.`);let F=A.parse(E[2],2,Bn);if(!F)return null;if(!al(M,F.type))return A.concat(2).error(`"${M}" comparisons are not supported for type '${wi(F.type)}'.`);if(z.type.kind!==F.type.kind&&z.type.kind!=="value"&&F.type.kind!=="value")return A.error(`Cannot compare types '${wi(z.type)}' and '${wi(F.type)}'.`);p&&(z.type.kind==="value"&&F.type.kind!=="value"?z=new zr(F.type,[z]):z.type.kind!=="value"&&F.type.kind==="value"&&(F=new zr(z.type,[F])));let q=null;if(E.length===4){if(z.type.kind!=="string"&&F.type.kind!=="string"&&z.type.kind!=="value"&&F.type.kind!=="value")return A.error("Cannot use collator to compare non-string types.");if(q=A.parse(E[3],3,Vs),!q)return null}return new II(z,F,q)}evaluate(E){const A=this.lhs.evaluate(E),M=this.rhs.evaluate(E);if(p&&this.hasUntypedArgument){const z=fn(A),F=fn(M);if(z.kind!==F.kind||z.kind!=="string"&&z.kind!=="number")throw new xn(`Expected arguments for "${l}" to be (string, string) or (number, number), but found (${z.kind}, ${F.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const z=fn(A),F=fn(M);if(z.kind!=="string"||F.kind!=="string")return r(E,A,M)}return this.collator?o(E,A,M,this.collator.evaluate(E)):r(E,A,M)}eachChild(E){E(this.lhs),E(this.rhs),this.collator&&E(this.collator)}outputDefined(){return!0}}}const Uu=Ai("==",(function(l,r,o){return r===o}),lo),cu=Ai("!=",(function(l,r,o){return r!==o}),(function(l,r,o,p){return!lo(0,r,o,p)})),Dl=Ai("<",(function(l,r,o){return r<o}),(function(l,r,o,p){return p.compare(r,o)<0})),P=Ai(">",(function(l,r,o){return r>o}),(function(l,r,o,p){return p.compare(r,o)>0})),Z=Ai("<=",(function(l,r,o){return r<=o}),(function(l,r,o,p){return p.compare(r,o)<=0})),ne=Ai(">=",(function(l,r,o){return r>=o}),(function(l,r,o,p){return p.compare(r,o)>=0}));class ye{constructor(r,o,p){this.type=Vs,this.locale=p,this.caseSensitive=r,this.diacriticSensitive=o}static parse(r,o){if(r.length!==2)return o.error("Expected one argument.");const p=r[1];if(typeof p!="object"||Array.isArray(p))return o.error("Collator options argument must be an object.");const v=o.parse(p["case-sensitive"]!==void 0&&p["case-sensitive"],1,In);if(!v)return null;const E=o.parse(p["diacritic-sensitive"]!==void 0&&p["diacritic-sensitive"],1,In);if(!E)return null;let A=null;return p.locale&&(A=o.parse(p.locale,1,yn),!A)?null:new ye(v,E,A)}evaluate(r){return new ys(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}}class at{constructor(r,o,p,v,E){this.type=yn,this.number=r,this.locale=o,this.currency=p,this.minFractionDigits=v,this.maxFractionDigits=E}static parse(r,o){if(r.length!==3)return o.error("Expected two arguments.");const p=o.parse(r[1],1,kt);if(!p)return null;const v=r[2];if(typeof v!="object"||Array.isArray(v))return o.error("NumberFormat options argument must be an object.");let E=null;if(v.locale&&(E=o.parse(v.locale,1,yn),!E))return null;let A=null;if(v.currency&&(A=o.parse(v.currency,1,yn),!A))return null;let M=null;if(v["min-fraction-digits"]&&(M=o.parse(v["min-fraction-digits"],1,kt),!M))return null;let z=null;return v["max-fraction-digits"]&&(z=o.parse(v["max-fraction-digits"],1,kt),!z)?null:new at(p,E,A,M,z)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}}class ht{constructor(r){this.type=Us,this.sections=r}static parse(r,o){if(r.length<2)return o.error("Expected at least one argument.");const p=r[1];if(!Array.isArray(p)&&typeof p=="object")return o.error("First argument must be an image or text section.");const v=[];let E=!1;for(let A=1;A<=r.length-1;++A){const M=r[A];if(E&&typeof M=="object"&&!Array.isArray(M)){E=!1;let z=null;if(M["font-scale"]&&(z=o.parse(M["font-scale"],1,kt),!z))return null;let F=null;if(M["text-font"]&&(F=o.parse(M["text-font"],1,da(yn)),!F))return null;let q=null;if(M["text-color"]&&(q=o.parse(M["text-color"],1,ir),!q))return null;let W=null;if(M["vertical-align"]){if(typeof M["vertical-align"]=="string"&&!Ia.includes(M["vertical-align"]))return o.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${M["vertical-align"]}' instead.`);if(W=o.parse(M["vertical-align"],1,yn),!W)return null}const te=v[v.length-1];te.scale=z,te.font=F,te.textColor=q,te.verticalAlign=W}else{const z=o.parse(r[A],1,Bn);if(!z)return null;const F=z.type.kind;if(F!=="string"&&F!=="value"&&F!=="null"&&F!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");E=!0,v.push({content:z,scale:null,font:null,textColor:null,verticalAlign:null})}}return new ht(v)}evaluate(r){return new Wi(this.sections.map((o=>{const p=o.content.evaluate(r);return fn(p)===Ei?new Rl("",p,null,null,null,o.verticalAlign?o.verticalAlign.evaluate(r):null):new Rl(sn(p),null,o.scale?o.scale.evaluate(r):null,o.font?o.font.evaluate(r).join(","):null,o.textColor?o.textColor.evaluate(r):null,o.verticalAlign?o.verticalAlign.evaluate(r):null)})))}eachChild(r){for(const o of this.sections)r(o.content),o.scale&&r(o.scale),o.font&&r(o.font),o.textColor&&r(o.textColor),o.verticalAlign&&r(o.verticalAlign)}outputDefined(){return!1}}class Xt{constructor(r){this.type=Ei,this.input=r}static parse(r,o){if(r.length!==2)return o.error("Expected two arguments.");const p=o.parse(r[1],1,yn);return p?new Xt(p):o.error("No image name provided.")}evaluate(r){const o=this.input.evaluate(r),p=cr.fromString(o);return p&&r.availableImages&&(p.available=r.availableImages.indexOf(o)>-1),p}eachChild(r){r(this.input)}outputDefined(){return!1}}class kn{constructor(r){this.type=kt,this.input=r}static parse(r,o){if(r.length!==2)return o.error(`Expected 1 argument, but found ${r.length-1} instead.`);const p=o.parse(r[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${wi(p.type)} instead.`):new kn(p):null}evaluate(r){const o=this.input.evaluate(r);if(typeof o=="string")return[...o].length;if(Array.isArray(o))return o.length;throw new xn(`Expected value to be of type string or array, but found ${wi(fn(o))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}}const Xn=8192;function Ti(l,r){const o=(180+l[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,v=Math.pow(2,r.z);return[Math.round(o*v*Xn),Math.round(p*v*Xn)]}function Ki(l,r){const o=Math.pow(2,r.z);return[(v=(l[0]/Xn+r.x)/o,360*v-180),(p=(l[1]/Xn+r.y)/o,360/Math.PI*Math.atan(Math.exp((180-360*p)*Math.PI/180))-90)];var p,v}function $a(l,r){l[0]=Math.min(l[0],r[0]),l[1]=Math.min(l[1],r[1]),l[2]=Math.max(l[2],r[0]),l[3]=Math.max(l[3],r[1])}function Ga(l,r){return!(l[0]<=r[0]||l[2]>=r[2]||l[1]<=r[1]||l[3]>=r[3])}function Ws(l,r,o){const p=l[0]-r[0],v=l[1]-r[1],E=l[0]-o[0],A=l[1]-o[1];return p*A-E*v==0&&p*E<=0&&v*A<=0}function Ts(l,r,o,p){return(v=[p[0]-o[0],p[1]-o[1]])[0]*(E=[r[0]-l[0],r[1]-l[1]])[1]-v[1]*E[0]!=0&&!(!Hd(l,r,o,p)||!Hd(o,p,l,r));var v,E}function hu(l,r,o){for(const p of o)for(let v=0;v<p.length-1;++v)if(Ts(l,r,p[v],p[v+1]))return!0;return!1}function Xs(l,r,o=!1){let p=!1;for(const M of r)for(let z=0;z<M.length-1;z++){if(Ws(l,M[z],M[z+1]))return o;(E=M[z])[1]>(v=l)[1]!=(A=M[z+1])[1]>v[1]&&v[0]<(A[0]-E[0])*(v[1]-E[1])/(A[1]-E[1])+E[0]&&(p=!p)}var v,E,A;return p}function du(l,r){for(const o of r)if(Xs(l,o))return!0;return!1}function Ks(l,r){for(const o of l)if(!Xs(o,r))return!1;for(let o=0;o<l.length-1;++o)if(hu(l[o],l[o+1],r))return!1;return!0}function ju(l,r){for(const o of r)if(Ks(l,o))return!0;return!1}function Hd(l,r,o,p){const v=p[0]-o[0],E=p[1]-o[1],A=(l[0]-o[0])*E-v*(l[1]-o[1]),M=(r[0]-o[0])*E-v*(r[1]-o[1]);return A>0&&M<0||A<0&&M>0}function uo(l,r,o){const p=[];for(let v=0;v<l.length;v++){const E=[];for(let A=0;A<l[v].length;A++){const M=Ti(l[v][A],o);$a(r,M),E.push(M)}p.push(E)}return p}function Jh(l,r,o){const p=[];for(let v=0;v<l.length;v++){const E=uo(l[v],r,o);p.push(E)}return p}function Ys(l,r,o,p){if(l[0]<o[0]||l[0]>o[2]){const v=.5*p;let E=l[0]-o[0]>v?-p:o[0]-l[0]>v?p:0;E===0&&(E=l[0]-o[2]>v?-p:o[2]-l[0]>v?p:0),l[0]+=E}$a(r,l)}function qu(l,r,o,p){const v=Math.pow(2,p.z)*Xn,E=[p.x*Xn,p.y*Xn],A=[];for(const M of l)for(const z of M){const F=[z.x+E[0],z.y+E[1]];Ys(F,r,o,v),A.push(F)}return A}function $u(l,r,o,p){const v=Math.pow(2,p.z)*Xn,E=[p.x*Xn,p.y*Xn],A=[];for(const z of l){const F=[];for(const q of z){const W=[q.x+E[0],q.y+E[1]];$a(r,W),F.push(W)}A.push(F)}if(r[2]-r[0]<=v/2){(M=r)[0]=M[1]=1/0,M[2]=M[3]=-1/0;for(const z of A)for(const F of z)Ys(F,r,o,v)}var M;return A}class Mo{constructor(r,o){this.type=In,this.geojson=r,this.geometries=o}static parse(r,o){if(r.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(fa(r[1])){const p=r[1];if(p.type==="FeatureCollection"){const v=[];for(const E of p.features){const{type:A,coordinates:M}=E.geometry;A==="Polygon"&&v.push(M),A==="MultiPolygon"&&v.push(...M)}if(v.length)return new Mo(p,{type:"MultiPolygon",coordinates:v})}else if(p.type==="Feature"){const v=p.geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new Mo(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new Mo(p,p)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return(function(o,p){const v=[1/0,1/0,-1/0,-1/0],E=[1/0,1/0,-1/0,-1/0],A=o.canonicalID();if(p.type==="Polygon"){const M=uo(p.coordinates,E,A),z=qu(o.geometry(),v,E,A);if(!Ga(v,E))return!1;for(const F of z)if(!Xs(F,M))return!1}if(p.type==="MultiPolygon"){const M=Jh(p.coordinates,E,A),z=qu(o.geometry(),v,E,A);if(!Ga(v,E))return!1;for(const F of z)if(!du(F,M))return!1}return!0})(r,this.geometries);if(r.geometryType()==="LineString")return(function(o,p){const v=[1/0,1/0,-1/0,-1/0],E=[1/0,1/0,-1/0,-1/0],A=o.canonicalID();if(p.type==="Polygon"){const M=uo(p.coordinates,E,A),z=$u(o.geometry(),v,E,A);if(!Ga(v,E))return!1;for(const F of z)if(!Ks(F,M))return!1}if(p.type==="MultiPolygon"){const M=Jh(p.coordinates,E,A),z=$u(o.geometry(),v,E,A);if(!Ga(v,E))return!1;for(const F of z)if(!ju(F,M))return!1}return!0})(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let fu=class{constructor(l=[],r=(o,p)=>o<p?-1:o>p?1:0){if(this.data=l,this.length=this.data.length,this.compare=r,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(l){this.data.push(l),this._up(this.length++)}pop(){if(this.length===0)return;const l=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),l}peek(){return this.data[0]}_up(l){const{data:r,compare:o}=this,p=r[l];for(;l>0;){const v=l-1>>1,E=r[v];if(o(p,E)>=0)break;r[l]=E,l=v}r[l]=p}_down(l){const{data:r,compare:o}=this,p=this.length>>1,v=r[l];for(;l<p;){let E=1+(l<<1);const A=E+1;if(A<this.length&&o(r[A],r[E])<0&&(E=A),o(r[E],v)>=0)break;r[l]=r[E],l=E}r[l]=v}};function hh(l,r,o=0,p=l.length-1,v=Gu){for(;p>o;){if(p-o>600){const z=p-o+1,F=r-o+1,q=Math.log(z),W=.5*Math.exp(2*q/3),te=.5*Math.sqrt(q*W*(z-W)/z)*(F-z/2<0?-1:1);hh(l,r,Math.max(o,Math.floor(r-F*W/z+te)),Math.min(p,Math.floor(r+(z-F)*W/z+te)),v)}const E=l[r];let A=o,M=p;for(Ss(l,o,r),v(l[p],E)>0&&Ss(l,o,p);A<M;){for(Ss(l,A,M),A++,M--;v(l[A],E)<0;)A++;for(;v(l[M],E)>0;)M--}v(l[o],E)===0?Ss(l,o,M):(M++,Ss(l,M,p)),M<=r&&(o=M+1),r<=M&&(p=M-1)}}function Ss(l,r,o){const p=l[r];l[r]=l[o],l[o]=p}function Gu(l,r){return l<r?-1:l>r?1:0}function Zu(l,r){if(l.length<=1)return[l];const o=[];let p,v;for(const E of l){const A=Wd(E);A!==0&&(E.area=Math.abs(A),v===void 0&&(v=A<0),v===A<0?(p&&o.push(p),p=[E]):p.push(E))}if(p&&o.push(p),r>1)for(let E=0;E<o.length;E++)o[E].length<=r||(hh(o[E],r,1,o[E].length-1,Lc),o[E]=o[E].slice(0,r));return o}function Lc(l,r){return r.area-l.area}function Wd(l){let r=0;for(let o,p,v=0,E=l.length,A=E-1;v<E;A=v++)o=l[v],p=l[A],r+=(p.x-o.x)*(o.y+p.y);return r}const sl=1/298.257223563,Xd=sl*(2-sl),Zl=Math.PI/180;class ed{constructor(r){const o=6378.137*Zl*1e3,p=Math.cos(r*Zl),v=1/(1-Xd*(1-p*p)),E=Math.sqrt(v);this.kx=o*E*p,this.ky=o*E*v*(1-Xd)}distance(r,o){const p=this.wrap(r[0]-o[0])*this.kx,v=(r[1]-o[1])*this.ky;return Math.sqrt(p*p+v*v)}pointOnLine(r,o){let p,v,E,A,M=1/0;for(let z=0;z<r.length-1;z++){let F=r[z][0],q=r[z][1],W=this.wrap(r[z+1][0]-F)*this.kx,te=(r[z+1][1]-q)*this.ky,ie=0;W===0&&te===0||(ie=(this.wrap(o[0]-F)*this.kx*W+(o[1]-q)*this.ky*te)/(W*W+te*te),ie>1?(F=r[z+1][0],q=r[z+1][1]):ie>0&&(F+=W/this.kx*ie,q+=te/this.ky*ie)),W=this.wrap(o[0]-F)*this.kx,te=(o[1]-q)*this.ky;const re=W*W+te*te;re<M&&(M=re,p=F,v=q,E=z,A=ie)}return{point:[p,v],index:E,t:Math.max(0,Math.min(1,A))}}wrap(r){for(;r<-180;)r+=360;for(;r>180;)r-=360;return r}}function ol(l,r){return r[0]-l[0]}function ra(l){return l[1]-l[0]+1}function Es(l,r){return l[1]>=l[0]&&l[1]<r}function li(l,r){if(l[0]>l[1])return[null,null];const o=ra(l);if(r){if(o===2)return[l,null];const v=Math.floor(o/2);return[[l[0],l[0]+v],[l[0]+v,l[1]]]}if(o===1)return[l,null];const p=Math.floor(o/2)-1;return[[l[0],l[0]+p],[l[0]+p+1,l[1]]]}function pu(l,r){if(!Es(r,l.length))return[1/0,1/0,-1/0,-1/0];const o=[1/0,1/0,-1/0,-1/0];for(let p=r[0];p<=r[1];++p)$a(o,l[p]);return o}function Hu(l){const r=[1/0,1/0,-1/0,-1/0];for(const o of l)for(const p of o)$a(r,p);return r}function Wu(l){return l[0]!==-1/0&&l[1]!==-1/0&&l[2]!==1/0&&l[3]!==1/0}function ll(l,r,o){if(!Wu(l)||!Wu(r))return NaN;let p=0,v=0;return l[2]<r[0]&&(p=r[0]-l[2]),l[0]>r[2]&&(p=l[0]-r[2]),l[1]>r[3]&&(v=l[1]-r[3]),l[3]<r[1]&&(v=r[1]-l[3]),o.distance([0,0],[p,v])}function ul(l,r,o){const p=o.pointOnLine(r,l);return o.distance(l,p.point)}function cl(l,r,o,p,v){const E=Math.min(ul(l,[o,p],v),ul(r,[o,p],v)),A=Math.min(ul(o,[l,r],v),ul(p,[l,r],v));return Math.min(E,A)}function dh(l,r,o,p,v){if(!Es(r,l.length)||!Es(p,o.length))return 1/0;let E=1/0;for(let A=r[0];A<r[1];++A){const M=l[A],z=l[A+1];for(let F=p[0];F<p[1];++F){const q=o[F],W=o[F+1];if(Ts(M,z,q,W))return 0;E=Math.min(E,cl(M,z,q,W,v))}}return E}function kc(l,r,o,p,v){if(!Es(r,l.length)||!Es(p,o.length))return NaN;let E=1/0;for(let A=r[0];A<=r[1];++A)for(let M=p[0];M<=p[1];++M)if(E=Math.min(E,v.distance(l[A],o[M])),E===0)return E;return E}function Xu(l,r,o){if(Xs(l,r,!0))return 0;let p=1/0;for(const v of r){const E=v[0],A=v[v.length-1];if(E!==A&&(p=Math.min(p,ul(l,[A,E],o)),p===0))return p;const M=o.pointOnLine(v,l);if(p=Math.min(p,o.distance(l,M.point)),p===0)return p}return p}function Kd(l,r,o,p){if(!Es(r,l.length))return NaN;for(let E=r[0];E<=r[1];++E)if(Xs(l[E],o,!0))return 0;let v=1/0;for(let E=r[0];E<r[1];++E){const A=l[E],M=l[E+1];for(const z of o)for(let F=0,q=z.length,W=q-1;F<q;W=F++){const te=z[W],ie=z[F];if(Ts(A,M,te,ie))return 0;v=Math.min(v,cl(A,M,te,ie,p))}}return v}function zl(l,r){for(const o of l)for(const p of o)if(Xs(p,r,!0))return!0;return!1}function Ku(l,r,o,p=1/0){const v=Hu(l),E=Hu(r);if(p!==1/0&&ll(v,E,o)>=p)return p;if(Ga(v,E)){if(zl(l,r))return 0}else if(zl(r,l))return 0;let A=1/0;for(const M of l)for(let z=0,F=M.length,q=F-1;z<F;q=z++){const W=M[q],te=M[z];for(const ie of r)for(let re=0,oe=ie.length,pe=oe-1;re<oe;pe=re++){const Te=ie[pe],He=ie[re];if(Ts(W,te,Te,He))return 0;A=Math.min(A,cl(W,te,Te,He,o))}}return A}function Dc(l,r,o,p,v,E){if(!E)return;const A=ll(pu(p,E),v,o);A<r&&l.push([A,E,[0,0]])}function zc(l,r,o,p,v,E,A){if(!E||!A)return;const M=ll(pu(p,E),pu(v,A),o);M<r&&l.push([M,E,A])}function aa(l,r,o,p,v=1/0){let E=Math.min(p.distance(l[0],o[0][0]),v);if(E===0)return E;const A=new fu([[0,[0,l.length-1],[0,0]]],ol),M=Hu(o);for(;A.length>0;){const z=A.pop();if(z[0]>=E)continue;const F=z[1],q=r?50:100;if(ra(F)<=q){if(!Es(F,l.length))return NaN;if(r){const W=Kd(l,F,o,p);if(isNaN(W)||W===0)return W;E=Math.min(E,W)}else for(let W=F[0];W<=F[1];++W){const te=Xu(l[W],o,p);if(E=Math.min(E,te),E===0)return 0}}else{const W=li(F,r);Dc(A,E,p,l,M,W[0]),Dc(A,E,p,l,M,W[1])}}return E}function Hl(l,r,o,p,v,E=1/0){let A=Math.min(E,v.distance(l[0],o[0]));if(A===0)return A;const M=new fu([[0,[0,l.length-1],[0,o.length-1]]],ol);for(;M.length>0;){const z=M.pop();if(z[0]>=A)continue;const F=z[1],q=z[2],W=r?50:100,te=p?50:100;if(ra(F)<=W&&ra(q)<=te){if(!Es(F,l.length)&&Es(q,o.length))return NaN;let ie;if(r&&p)ie=dh(l,F,o,q,v),A=Math.min(A,ie);else if(r&&!p){const re=l.slice(F[0],F[1]+1);for(let oe=q[0];oe<=q[1];++oe)if(ie=ul(o[oe],re,v),A=Math.min(A,ie),A===0)return A}else if(!r&&p){const re=o.slice(q[0],q[1]+1);for(let oe=F[0];oe<=F[1];++oe)if(ie=ul(l[oe],re,v),A=Math.min(A,ie),A===0)return A}else ie=kc(l,F,o,q,v),A=Math.min(A,ie)}else{const ie=li(F,r),re=li(q,p);zc(M,A,v,l,o,ie[0],re[0]),zc(M,A,v,l,o,ie[0],re[1]),zc(M,A,v,l,o,ie[1],re[0]),zc(M,A,v,l,o,ie[1],re[1])}}return A}function fh(l){return l.type==="MultiPolygon"?l.coordinates.map((r=>({type:"Polygon",coordinates:r}))):l.type==="MultiLineString"?l.coordinates.map((r=>({type:"LineString",coordinates:r}))):l.type==="MultiPoint"?l.coordinates.map((r=>({type:"Point",coordinates:r}))):[l]}class Po{constructor(r,o){this.type=kt,this.geojson=r,this.geometries=o}static parse(r,o){if(r.length!==2)return o.error(`'distance' expression requires exactly one argument, but found ${r.length-1} instead.`);if(fa(r[1])){const p=r[1];if(p.type==="FeatureCollection")return new Po(p,p.features.map((v=>fh(v.geometry))).flat());if(p.type==="Feature")return new Po(p,fh(p.geometry));if("type"in p&&"coordinates"in p)return new Po(p,fh(p))}return o.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return(function(o,p){const v=o.geometry(),E=v.flat().map((z=>Ki([z.x,z.y],o.canonical)));if(v.length===0)return NaN;const A=new ed(E[0][1]);let M=1/0;for(const z of p){switch(z.type){case"Point":M=Math.min(M,Hl(E,!1,[z.coordinates],!1,A,M));break;case"LineString":M=Math.min(M,Hl(E,!1,z.coordinates,!0,A,M));break;case"Polygon":M=Math.min(M,aa(E,!1,z.coordinates,A,M))}if(M===0)return M}return M})(r,this.geometries);if(r.geometryType()==="LineString")return(function(o,p){const v=o.geometry(),E=v.flat().map((z=>Ki([z.x,z.y],o.canonical)));if(v.length===0)return NaN;const A=new ed(E[0][1]);let M=1/0;for(const z of p){switch(z.type){case"Point":M=Math.min(M,Hl(E,!0,[z.coordinates],!1,A,M));break;case"LineString":M=Math.min(M,Hl(E,!0,z.coordinates,!0,A,M));break;case"Polygon":M=Math.min(M,aa(E,!0,z.coordinates,A,M))}if(M===0)return M}return M})(r,this.geometries);if(r.geometryType()==="Polygon")return(function(o,p){const v=o.geometry();if(v.length===0||v[0].length===0)return NaN;const E=Zu(v,0).map((z=>z.map((F=>F.map((q=>Ki([q.x,q.y],o.canonical))))))),A=new ed(E[0][0][0][1]);let M=1/0;for(const z of p)for(const F of E){switch(z.type){case"Point":M=Math.min(M,aa([z.coordinates],!1,F,A,M));break;case"LineString":M=Math.min(M,aa(z.coordinates,!0,F,A,M));break;case"Polygon":M=Math.min(M,Ku(F,z.coordinates,A,M))}if(M===0)return M}return M})(r,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Oc{constructor(r){this.type=Bn,this.key=r}static parse(r,o){if(r.length!==2)return o.error(`Expected 1 argument, but found ${r.length-1} instead.`);const p=r[1];return p==null?o.error("Global state property must be defined."):typeof p!="string"?o.error(`Global state property must be string, but found ${typeof r[1]} instead.`):new Oc(p)}evaluate(r){var o;const p=(o=r.globals)===null||o===void 0?void 0:o.globalState;return p&&Object.keys(p).length!==0?Qa(p,this.key):null}eachChild(){}outputDefined(){return!1}}const mu={"==":Uu,"!=":cu,">":P,"<":Dl,">=":ne,"<=":Z,array:zr,at:ia,boolean:zr,case:xs,coalesce:kl,collator:ye,format:ht,image:Xt,in:Ma,"index-of":Pa,interpolate:lr,"interpolate-hcl":lr,"interpolate-lab":lr,length:kn,let:Wn,literal:na,match:Or,number:zr,"number-format":at,object:zr,slice:$l,step:Xi,string:zr,"to-boolean":or,"to-color":or,"to-number":or,"to-string":or,var:Co,within:Mo,distance:Po,"global-state":Oc};class co{constructor(r,o,p,v){this.name=r,this.type=o,this._evaluate=p,this.args=v}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}static parse(r,o){const p=r[0],v=co.definitions[p];if(!v)return o.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const E=Array.isArray(v)?v[0]:v.type,A=Array.isArray(v)?[[v[1],v[2]]]:v.overloads,M=A.filter((([F])=>!Array.isArray(F)||F.length===r.length-1));let z=null;for(const[F,q]of M){z=new bs(o.registry,Wl,o.path,null,o.scope);const W=[];let te=!1;for(let ie=1;ie<r.length;ie++){const re=r[ie],oe=Array.isArray(F)?F[ie-1]:F.type,pe=z.parse(re,1+W.length,oe);if(!pe){te=!0;break}W.push(pe)}if(!te)if(Array.isArray(F)&&F.length!==W.length)z.error(`Expected ${F.length} arguments, but found ${W.length} instead.`);else{for(let ie=0;ie<W.length;ie++){const re=Array.isArray(F)?F[ie]:F.type,oe=W[ie];z.concat(ie+1).checkSubtype(re,oe.type)}if(z.errors.length===0)return new co(p,E,q,W)}}if(M.length===1)o.errors.push(...z.errors);else{const F=(M.length?M:A).map((([W])=>{return te=W,Array.isArray(te)?`(${te.map(wi).join(", ")})`:`(${wi(te.type)}...)`;var te})).join(" | "),q=[];for(let W=1;W<r.length;W++){const te=o.parse(r[W],1+q.length);if(!te)return null;q.push(wi(te.type))}o.error(`Expected arguments of type ${F}, but found (${q.join(", ")}) instead.`)}return null}static register(r,o){co.definitions=o;for(const p in o)r[p]=co}}function gu(l,[r,o,p,v]){r=r.evaluate(l),o=o.evaluate(l),p=p.evaluate(l);const E=v?v.evaluate(l):1,A=bn(r,o,p,E);if(A)throw new xn(A);return new Ln(r/255,o/255,p/255,E,!1)}function td(l,r){return l in r}function hl(l,r){const o=r[l];return o===void 0?null:o}function pa(l){return{type:l}}function Wl(l){if(l instanceof Co)return Wl(l.boundExpression);if(l instanceof co&&l.name==="error"||l instanceof ye||l instanceof Mo||l instanceof Po||l instanceof Oc)return!1;const r=l instanceof or||l instanceof zr;let o=!0;return l.eachChild((p=>{o=r?o&&Wl(p):o&&p instanceof na})),!!o&&ts(l)&&_u(l,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function ts(l){if(l instanceof co&&(l.name==="get"&&l.args.length===1||l.name==="feature-state"||l.name==="has"&&l.args.length===1||l.name==="properties"||l.name==="geometry-type"||l.name==="id"||/^filter-/.test(l.name))||l instanceof Mo||l instanceof Po)return!1;let r=!0;return l.eachChild((o=>{r&&!ts(o)&&(r=!1)})),r}function ma(l){if(l instanceof co&&l.name==="feature-state")return!1;let r=!0;return l.eachChild((o=>{r&&!ma(o)&&(r=!1)})),r}function _u(l,r){if(l instanceof co&&r.indexOf(l.name)>=0)return!1;let o=!0;return l.eachChild((p=>{o&&!_u(p,r)&&(o=!1)})),o}function Yu(l){return{result:"success",value:l}}function Qs(l){return{result:"error",value:l}}function dl(l){return l["property-type"]==="data-driven"||l["property-type"]==="cross-faded-data-driven"}function Ro(l){return!!l.expression&&l.expression.parameters.indexOf("zoom")>-1}function Xl(l){return!!l.expression&&l.expression.interpolated}function $n(l){return l instanceof Number?"number":l instanceof String?"string":l instanceof Boolean?"boolean":Array.isArray(l)?"array":l===null?"null":typeof l}function Lo(l){return typeof l=="object"&&l!==null&&!Array.isArray(l)&&fn(l)===To}function Gf(l){return l}function ns(l,r){const o=l.stops&&typeof l.stops[0][0]=="object",p=o||!(o||l.property!==void 0),v=l.type||(Xl(r)?"exponential":"interval"),E=(function(q){switch(q.type){case"color":return Ln.parse;case"padding":return mr.parse;case"numberArray":return hn.parse;case"colorArray":return pi.parse;default:return null}})(r);if(E&&((l=en({},l)).stops&&(l.stops=l.stops.map((q=>[q[0],E(q[1])]))),l.default=E(l.default?l.default:r.default)),l.colorSpace&&(A=l.colorSpace)!=="rgb"&&A!=="hcl"&&A!=="lab")throw new Error(`Unknown color space: "${l.colorSpace}"`);var A;const M=(function(q){switch(q){case"exponential":return Qu;case"interval":return nd;case"categorical":return Do;case"identity":return yu;default:throw new Error(`Unknown function type "${q}"`)}})(v);let z,F;if(v==="categorical"){z=Object.create(null);for(const q of l.stops)z[q[0]]=q[1];F=typeof l.stops[0][0]}if(o){const q={},W=[];for(let re=0;re<l.stops.length;re++){const oe=l.stops[re],pe=oe[0].zoom;q[pe]===void 0&&(q[pe]={zoom:pe,type:l.type,property:l.property,default:l.default,stops:[]},W.push(pe)),q[pe].stops.push([oe[0].value,oe[1]])}const te=[];for(const re of W)te.push([q[re].zoom,ns(q[re],r)]);const ie={name:"linear"};return{kind:"composite",interpolationType:ie,interpolationFactor:lr.interpolationFactor.bind(void 0,ie),zoomStops:te.map((re=>re[0])),evaluate:({zoom:re},oe)=>Qu({stops:te,base:l.base},r,re).evaluate(re,oe)}}if(p){const q=v==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:q,interpolationFactor:lr.interpolationFactor.bind(void 0,q),zoomStops:l.stops.map((W=>W[0])),evaluate:({zoom:W})=>M(l,r,W,z,F)}}return{kind:"source",evaluate(q,W){const te=W&&W.properties?W.properties[l.property]:void 0;return te===void 0?ko(l.default,r.default):M(l,r,te,z,F)}}}function ko(l,r,o){return l!==void 0?l:r!==void 0?r:o!==void 0?o:void 0}function Do(l,r,o,p,v){return ko(typeof o===v?p[o]:void 0,l.default,r.default)}function nd(l,r,o){if($n(o)!=="number")return ko(l.default,r.default);const p=l.stops.length;if(p===1||o<=l.stops[0][0])return l.stops[0][1];if(o>=l.stops[p-1][0])return l.stops[p-1][1];const v=Io(l.stops.map((E=>E[0])),o);return l.stops[v][1]}function Qu(l,r,o){const p=l.base!==void 0?l.base:1;if($n(o)!=="number")return ko(l.default,r.default);const v=l.stops.length;if(v===1||o<=l.stops[0][0])return l.stops[0][1];if(o>=l.stops[v-1][0])return l.stops[v-1][1];const E=Io(l.stops.map((q=>q[0])),o),A=(function(q,W,te,ie){const re=ie-te,oe=q-te;return re===0?0:W===1?oe/re:(Math.pow(W,oe)-1)/(Math.pow(W,re)-1)})(o,p,l.stops[E][0],l.stops[E+1][0]),M=l.stops[E][1],z=l.stops[E+1][1],F=ws[r.type]||Gf;return typeof M.evaluate=="function"?{evaluate(...q){const W=M.evaluate.apply(void 0,q),te=z.evaluate.apply(void 0,q);if(W!==void 0&&te!==void 0)return F(W,te,A,l.colorSpace)}}:F(M,z,A,l.colorSpace)}function yu(l,r,o){switch(r.type){case"color":o=Ln.parse(o);break;case"formatted":o=Wi.fromString(o.toString());break;case"resolvedImage":o=cr.fromString(o.toString());break;case"padding":o=mr.parse(o);break;case"colorArray":o=pi.parse(o);break;case"numberArray":o=hn.parse(o);break;default:$n(o)===r.type||r.type==="enum"&&r.values[o]||(o=void 0)}return ko(o,l.default,r.default)}co.register(mu,{error:[{kind:"error"},[yn],(l,[r])=>{throw new xn(r.evaluate(l))}],typeof:[yn,[Bn],(l,[r])=>wi(fn(r.evaluate(l)))],"to-rgba":[da(kt,4),[ir],(l,[r])=>{const[o,p,v,E]=r.evaluate(l).rgb;return[255*o,255*p,255*v,E]}],rgb:[ir,[kt,kt,kt],gu],rgba:[ir,[kt,kt,kt,kt],gu],has:{type:In,overloads:[[[yn],(l,[r])=>td(r.evaluate(l),l.properties())],[[yn,To],(l,[r,o])=>td(r.evaluate(l),o.evaluate(l))]]},get:{type:Bn,overloads:[[[yn],(l,[r])=>hl(r.evaluate(l),l.properties())],[[yn,To],(l,[r,o])=>hl(r.evaluate(l),o.evaluate(l))]]},"feature-state":[Bn,[yn],(l,[r])=>hl(r.evaluate(l),l.featureState||{})],properties:[To,[],l=>l.properties()],"geometry-type":[yn,[],l=>l.geometryType()],id:[Bn,[],l=>l.id()],zoom:[kt,[],l=>l.globals.zoom],"heatmap-density":[kt,[],l=>l.globals.heatmapDensity||0],elevation:[kt,[],l=>l.globals.elevation||0],"line-progress":[kt,[],l=>l.globals.lineProgress||0],accumulated:[Bn,[],l=>l.globals.accumulated===void 0?null:l.globals.accumulated],"+":[kt,pa(kt),(l,r)=>{let o=0;for(const p of r)o+=p.evaluate(l);return o}],"*":[kt,pa(kt),(l,r)=>{let o=1;for(const p of r)o*=p.evaluate(l);return o}],"-":{type:kt,overloads:[[[kt,kt],(l,[r,o])=>r.evaluate(l)-o.evaluate(l)],[[kt],(l,[r])=>-r.evaluate(l)]]},"/":[kt,[kt,kt],(l,[r,o])=>r.evaluate(l)/o.evaluate(l)],"%":[kt,[kt,kt],(l,[r,o])=>r.evaluate(l)%o.evaluate(l)],ln2:[kt,[],()=>Math.LN2],pi:[kt,[],()=>Math.PI],e:[kt,[],()=>Math.E],"^":[kt,[kt,kt],(l,[r,o])=>Math.pow(r.evaluate(l),o.evaluate(l))],sqrt:[kt,[kt],(l,[r])=>Math.sqrt(r.evaluate(l))],log10:[kt,[kt],(l,[r])=>Math.log(r.evaluate(l))/Math.LN10],ln:[kt,[kt],(l,[r])=>Math.log(r.evaluate(l))],log2:[kt,[kt],(l,[r])=>Math.log(r.evaluate(l))/Math.LN2],sin:[kt,[kt],(l,[r])=>Math.sin(r.evaluate(l))],cos:[kt,[kt],(l,[r])=>Math.cos(r.evaluate(l))],tan:[kt,[kt],(l,[r])=>Math.tan(r.evaluate(l))],asin:[kt,[kt],(l,[r])=>Math.asin(r.evaluate(l))],acos:[kt,[kt],(l,[r])=>Math.acos(r.evaluate(l))],atan:[kt,[kt],(l,[r])=>Math.atan(r.evaluate(l))],min:[kt,pa(kt),(l,r)=>Math.min(...r.map((o=>o.evaluate(l))))],max:[kt,pa(kt),(l,r)=>Math.max(...r.map((o=>o.evaluate(l))))],abs:[kt,[kt],(l,[r])=>Math.abs(r.evaluate(l))],round:[kt,[kt],(l,[r])=>{const o=r.evaluate(l);return o<0?-Math.round(-o):Math.round(o)}],floor:[kt,[kt],(l,[r])=>Math.floor(r.evaluate(l))],ceil:[kt,[kt],(l,[r])=>Math.ceil(r.evaluate(l))],"filter-==":[In,[yn,Bn],(l,[r,o])=>l.properties()[r.value]===o.value],"filter-id-==":[In,[Bn],(l,[r])=>l.id()===r.value],"filter-type-==":[In,[yn],(l,[r])=>l.geometryType()===r.value],"filter-<":[In,[yn,Bn],(l,[r,o])=>{const p=l.properties()[r.value],v=o.value;return typeof p==typeof v&&p<v}],"filter-id-<":[In,[Bn],(l,[r])=>{const o=l.id(),p=r.value;return typeof o==typeof p&&o<p}],"filter->":[In,[yn,Bn],(l,[r,o])=>{const p=l.properties()[r.value],v=o.value;return typeof p==typeof v&&p>v}],"filter-id->":[In,[Bn],(l,[r])=>{const o=l.id(),p=r.value;return typeof o==typeof p&&o>p}],"filter-<=":[In,[yn,Bn],(l,[r,o])=>{const p=l.properties()[r.value],v=o.value;return typeof p==typeof v&&p<=v}],"filter-id-<=":[In,[Bn],(l,[r])=>{const o=l.id(),p=r.value;return typeof o==typeof p&&o<=p}],"filter->=":[In,[yn,Bn],(l,[r,o])=>{const p=l.properties()[r.value],v=o.value;return typeof p==typeof v&&p>=v}],"filter-id->=":[In,[Bn],(l,[r])=>{const o=l.id(),p=r.value;return typeof o==typeof p&&o>=p}],"filter-has":[In,[Bn],(l,[r])=>r.value in l.properties()],"filter-has-id":[In,[],l=>l.id()!==null&&l.id()!==void 0],"filter-type-in":[In,[da(yn)],(l,[r])=>r.value.indexOf(l.geometryType())>=0],"filter-id-in":[In,[da(Bn)],(l,[r])=>r.value.indexOf(l.id())>=0],"filter-in-small":[In,[yn,da(Bn)],(l,[r,o])=>o.value.indexOf(l.properties()[r.value])>=0],"filter-in-large":[In,[yn,da(Bn)],(l,[r,o])=>(function(p,v,E,A){for(;E<=A;){const M=E+A>>1;if(v[M]===p)return!0;v[M]>p?A=M-1:E=M+1}return!1})(l.properties()[r.value],o.value,0,o.value.length-1)],all:{type:In,overloads:[[[In,In],(l,[r,o])=>r.evaluate(l)&&o.evaluate(l)],[pa(In),(l,r)=>{for(const o of r)if(!o.evaluate(l))return!1;return!0}]]},any:{type:In,overloads:[[[In,In],(l,[r,o])=>r.evaluate(l)||o.evaluate(l)],[pa(In),(l,r)=>{for(const o of r)if(o.evaluate(l))return!0;return!1}]]},"!":[In,[In],(l,[r])=>!r.evaluate(l)],"is-supported-script":[In,[yn],(l,[r])=>{const o=l.globals&&l.globals.isSupportedScript;return!o||o(r.evaluate(l))}],upcase:[yn,[yn],(l,[r])=>r.evaluate(l).toUpperCase()],downcase:[yn,[yn],(l,[r])=>r.evaluate(l).toLowerCase()],concat:[yn,pa(Bn),(l,r)=>r.map((o=>sn(o.evaluate(l)))).join("")],"resolved-locale":[yn,[Vs],(l,[r])=>r.evaluate(l).resolvedLocale()]});class Ju{constructor(r,o){this.expression=r,this._warningHistory={},this._evaluator=new oo,this._defaultValue=o?(function(p){if(p.type==="color"&&Lo(p.default))return new Ln(0,0,0,0);switch(p.type){case"color":return Ln.parse(p.default)||null;case"padding":return mr.parse(p.default)||null;case"numberArray":return hn.parse(p.default)||null;case"colorArray":return pi.parse(p.default)||null;case"variableAnchorOffsetCollection":return sr.parse(p.default)||null;case"projectionDefinition":return wr.parse(p.default)||null;default:return p.default===void 0?null:p.default}})(o):null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(r,o,p,v,E,A){return this._evaluator.globals=r,this._evaluator.feature=o,this._evaluator.featureState=p,this._evaluator.canonical=v,this._evaluator.availableImages=E||null,this._evaluator.formattedSection=A,this.expression.evaluate(this._evaluator)}evaluate(r,o,p,v,E,A){this._evaluator.globals=r,this._evaluator.feature=o||null,this._evaluator.featureState=p||null,this._evaluator.canonical=v,this._evaluator.availableImages=E||null,this._evaluator.formattedSection=A||null;try{const M=this.expression.evaluate(this._evaluator);if(M==null||typeof M=="number"&&M!=M)return this._defaultValue;if(this._enumValues&&!(M in this._enumValues))throw new xn(`Expected value to be one of ${Object.keys(this._enumValues).map((z=>JSON.stringify(z))).join(", ")}, but found ${JSON.stringify(M)} instead.`);return M}catch(M){return this._warningHistory[M.message]||(this._warningHistory[M.message]=!0,typeof console<"u"&&console.warn(M.message)),this._defaultValue}}}function ec(l){return Array.isArray(l)&&l.length>0&&typeof l[0]=="string"&&l[0]in mu}function vu(l,r){const o=new bs(mu,Wl,[],r?(function(v){const E={color:ir,string:yn,number:kt,enum:yn,boolean:In,formatted:Us,padding:gs,numberArray:Gr,colorArray:$r,projectionDefinition:tl,resolvedImage:Ei,variableAnchorOffsetCollection:Mr};return v.type==="array"?da(E[v.value]||Bn,v.length):E[v.type]})(r):void 0),p=o.parse(l,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?Yu(new Ju(p,r)):Qs(o.errors)}class f{constructor(r,o){this.kind=r,this._styleExpression=o,this.isStateDependent=r!=="constant"&&!ma(o.expression),this.globalStateRefs=ue(o.expression)}evaluateWithoutErrorHandling(r,o,p,v,E,A){return this._styleExpression.evaluateWithoutErrorHandling(r,o,p,v,E,A)}evaluate(r,o,p,v,E,A){return this._styleExpression.evaluate(r,o,p,v,E,A)}}class x{constructor(r,o,p,v){this.kind=r,this.zoomStops=p,this._styleExpression=o,this.isStateDependent=r!=="camera"&&!ma(o.expression),this.globalStateRefs=ue(o.expression),this.interpolationType=v}evaluateWithoutErrorHandling(r,o,p,v,E,A){return this._styleExpression.evaluateWithoutErrorHandling(r,o,p,v,E,A)}evaluate(r,o,p,v,E,A){return this._styleExpression.evaluate(r,o,p,v,E,A)}interpolationFactor(r,o,p){return this.interpolationType?lr.interpolationFactor(this.interpolationType,r,o,p):0}}function R(l,r){const o=vu(l,r);if(o.result==="error")return o;const p=o.value.expression,v=ts(p);if(!v&&!dl(r))return Qs([new nr("","data expressions not supported")]);const E=_u(p,["zoom"]);if(!E&&!Ro(r))return Qs([new nr("","zoom expressions not supported")]);const A=K(p);return A||E?A instanceof nr?Qs([A]):A instanceof lr&&!Xl(r)?Qs([new nr("",'"interpolate" expressions cannot be used with this property')]):Yu(A?new x(v?"camera":"composite",o.value,A.labels,A instanceof lr?A.interpolation:void 0):new f(v?"constant":"source",o.value)):Qs([new nr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class U{constructor(r,o){this._parameters=r,this._specification=o,en(this,ns(this._parameters,this._specification))}static deserialize(r){return new U(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function K(l){let r=null;if(l instanceof Wn)r=K(l.result);else if(l instanceof kl){for(const o of l.args)if(r=K(o),r)break}else(l instanceof Xi||l instanceof lr)&&l.input instanceof co&&l.input.name==="zoom"&&(r=l);return r instanceof nr||l.eachChild((o=>{const p=K(o);p instanceof nr?r=p:!r&&p?r=new nr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&p&&r!==p&&(r=new nr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),r}function ue(l,r=new Set){return l instanceof Oc&&r.add(l.key),l.eachChild((o=>{ue(o,r)})),r}function Oe(l){if(l===!0||l===!1)return!0;if(!Array.isArray(l)||l.length===0)return!1;switch(l[0]){case"has":return l.length>=2&&l[1]!=="$id"&&l[1]!=="$type";case"in":return l.length>=3&&(typeof l[1]!="string"||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return l.length!==3||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(const r of l.slice(1))if(!Oe(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}const nt={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ut(l){if(l==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Oe(l)||(l=pn(l));const r=vu(l,nt);if(r.result==="error")throw new Error(r.value.map((o=>`${o.key}: ${o.message}`)).join(", "));return{filter:(o,p,v)=>r.value.evaluate(o,p,{},v),needGeometry:Kt(l),getGlobalStateRefs:()=>ue(r.value.expression)}}function Mt(l,r){return l<r?-1:l>r?1:0}function Kt(l){if(!Array.isArray(l))return!1;if(l[0]==="within"||l[0]==="distance")return!0;for(let r=1;r<l.length;r++)if(Kt(l[r]))return!0;return!1}function pn(l){if(!l)return!0;const r=l[0];return l.length<=1?r!=="any":r==="=="?Yn(l[1],l[2],"=="):r==="!="?Za(Yn(l[1],l[2],"==")):r==="<"||r===">"||r==="<="||r===">="?Yn(l[1],l[2],r):r==="any"?(o=l.slice(1),["any"].concat(o.map(pn))):r==="all"?["all"].concat(l.slice(1).map(pn)):r==="none"?["all"].concat(l.slice(1).map(pn).map(Za)):r==="in"?ga(l[1],l.slice(2)):r==="!in"?Za(ga(l[1],l.slice(2))):r==="has"?Zr(l[1]):r!=="!has"||Za(Zr(l[1]));var o}function Yn(l,r,o){switch(l){case"$type":return[`filter-type-${o}`,r];case"$id":return[`filter-id-${o}`,r];default:return[`filter-${o}`,l,r]}}function ga(l,r){if(r.length===0)return!1;switch(l){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some((o=>typeof o!=typeof r[0]))?["filter-in-large",l,["literal",r.sort(Mt)]]:["filter-in-small",l,["literal",r]]}}function Zr(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function Za(l){return["!",l]}function Si(l){const r=typeof l;if(r==="number"||r==="boolean"||r==="string"||l==null)return JSON.stringify(l);if(Array.isArray(l)){let v="[";for(const E of l)v+=`${Si(E)},`;return`${v}]`}const o=Object.keys(l).sort();let p="{";for(let v=0;v<o.length;v++)p+=`${JSON.stringify(o[v])}:${Si(l[o[v]])},`;return`${p}}`}function Li(l){let r="";for(const o of vn)r+=`/${Si(l[o])}`;return r}function ui(l){const r=l.value;return r?[new Rt(l.key,r,"constants have been deprecated as of v8")]:[]}function ki(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function Hr(l){if(Array.isArray(l))return l.map(Hr);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){const r={};for(const o in l)r[o]=Hr(l[o]);return r}return ki(l)}function is(l){const r=l.key,o=l.value,p=l.valueSpec||{},v=l.objectElementValidators||{},E=l.style,A=l.styleSpec,M=l.validateSpec;let z=[];const F=$n(o);if(F!=="object")return[new Rt(r,o,`object expected, ${F} found`)];for(const q in o){const W=q.split(".")[0],te=Qa(p,W)||p["*"];let ie;if(Qa(v,W))ie=v[W];else if(Qa(p,W))ie=M;else if(v["*"])ie=v["*"];else{if(!p["*"]){z.push(new Rt(r,o[q],`unknown property "${q}"`));continue}ie=M}z=z.concat(ie({key:(r&&`${r}.`)+q,value:o[q],valueSpec:te,style:E,styleSpec:A,object:o,objectKey:q,validateSpec:M},o))}for(const q in p)v[q]||p[q].required&&p[q].default===void 0&&o[q]===void 0&&z.push(new Rt(r,o,`missing required property "${q}"`));return z}function zo(l){const r=l.value,o=l.valueSpec,p=l.style,v=l.styleSpec,E=l.key,A=l.arrayElementValidator||l.validateSpec;if($n(r)!=="array")return[new Rt(E,r,`array expected, ${$n(r)} found`)];if(o.length&&r.length!==o.length)return[new Rt(E,r,`array length ${o.length} expected, length ${r.length} found`)];if(o["min-length"]&&r.length<o["min-length"])return[new Rt(E,r,`array length at least ${o["min-length"]} expected, length ${r.length} found`)];let M={type:o.value,values:o.values};v.$version<7&&(M.function=o.function),$n(o.value)==="object"&&(M=o.value);let z=[];for(let F=0;F<r.length;F++)z=z.concat(A({array:r,arrayIndex:F,value:r[F],valueSpec:M,validateSpec:l.validateSpec,style:p,styleSpec:v,key:`${E}[${F}]`}));return z}function bu(l){const r=l.key,o=l.value,p=l.valueSpec;let v=$n(o);return v==="number"&&o!=o&&(v="NaN"),v!=="number"?[new Rt(r,o,`number expected, ${v} found`)]:"minimum"in p&&o<p.minimum?[new Rt(r,o,`${o} is less than the minimum value ${p.minimum}`)]:"maximum"in p&&o>p.maximum?[new Rt(r,o,`${o} is greater than the maximum value ${p.maximum}`)]:[]}function Nr(l){const r=l.valueSpec,o=ki(l.value.type);let p,v,E,A={};const M=o!=="categorical"&&l.value.property===void 0,z=!M,F=$n(l.value.stops)==="array"&&$n(l.value.stops[0])==="array"&&$n(l.value.stops[0][0])==="object",q=is({key:l.key,value:l.value,valueSpec:l.styleSpec.function,validateSpec:l.validateSpec,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{stops:function(ie){if(o==="identity")return[new Rt(ie.key,ie.value,'identity function may not have a "stops" property')];let re=[];const oe=ie.value;return re=re.concat(zo({key:ie.key,value:oe,valueSpec:ie.valueSpec,validateSpec:ie.validateSpec,style:ie.style,styleSpec:ie.styleSpec,arrayElementValidator:W})),$n(oe)==="array"&&oe.length===0&&re.push(new Rt(ie.key,oe,"array must have at least one stop")),re},default:function(ie){return ie.validateSpec({key:ie.key,value:ie.value,valueSpec:r,validateSpec:ie.validateSpec,style:ie.style,styleSpec:ie.styleSpec})}}});return o==="identity"&&M&&q.push(new Rt(l.key,l.value,'missing required property "property"')),o==="identity"||l.value.stops||q.push(new Rt(l.key,l.value,'missing required property "stops"')),o==="exponential"&&l.valueSpec.expression&&!Xl(l.valueSpec)&&q.push(new Rt(l.key,l.value,"exponential functions not supported")),l.styleSpec.$version>=8&&(z&&!dl(l.valueSpec)?q.push(new Rt(l.key,l.value,"property functions not supported")):M&&!Ro(l.valueSpec)&&q.push(new Rt(l.key,l.value,"zoom functions not supported"))),o!=="categorical"&&!F||l.value.property!==void 0||q.push(new Rt(l.key,l.value,'"property" property is required')),q;function W(ie){let re=[];const oe=ie.value,pe=ie.key;if($n(oe)!=="array")return[new Rt(pe,oe,`array expected, ${$n(oe)} found`)];if(oe.length!==2)return[new Rt(pe,oe,`array length 2 expected, length ${oe.length} found`)];if(F){if($n(oe[0])!=="object")return[new Rt(pe,oe,`object expected, ${$n(oe[0])} found`)];if(oe[0].zoom===void 0)return[new Rt(pe,oe,"object stop key must have zoom")];if(oe[0].value===void 0)return[new Rt(pe,oe,"object stop key must have value")];if(E&&E>ki(oe[0].zoom))return[new Rt(pe,oe[0].zoom,"stop zoom values must appear in ascending order")];ki(oe[0].zoom)!==E&&(E=ki(oe[0].zoom),v=void 0,A={}),re=re.concat(is({key:`${pe}[0]`,value:oe[0],valueSpec:{zoom:{}},validateSpec:ie.validateSpec,style:ie.style,styleSpec:ie.styleSpec,objectElementValidators:{zoom:bu,value:te}}))}else re=re.concat(te({key:`${pe}[0]`,value:oe[0],validateSpec:ie.validateSpec,style:ie.style,styleSpec:ie.styleSpec},oe));return ec(Hr(oe[1]))?re.concat([new Rt(`${pe}[1]`,oe[1],"expressions are not allowed in function stops.")]):re.concat(ie.validateSpec({key:`${pe}[1]`,value:oe[1],valueSpec:r,validateSpec:ie.validateSpec,style:ie.style,styleSpec:ie.styleSpec}))}function te(ie,re){const oe=$n(ie.value),pe=ki(ie.value),Te=ie.value!==null?ie.value:re;if(p){if(oe!==p)return[new Rt(ie.key,Te,`${oe} stop domain type must match previous stop domain type ${p}`)]}else p=oe;if(oe!=="number"&&oe!=="string"&&oe!=="boolean")return[new Rt(ie.key,Te,"stop domain value must be a number, string, or boolean")];if(oe!=="number"&&o!=="categorical"){let He=`number expected, ${oe} found`;return dl(r)&&o===void 0&&(He+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Rt(ie.key,Te,He)]}return o!=="categorical"||oe!=="number"||isFinite(pe)&&Math.floor(pe)===pe?o!=="categorical"&&oe==="number"&&v!==void 0&&pe<v?[new Rt(ie.key,Te,"stop domain values must appear in ascending order")]:(v=pe,o==="categorical"&&pe in A?[new Rt(ie.key,Te,"stop domain values must be unique")]:(A[pe]=!0,[])):[new Rt(ie.key,Te,`integer expected, found ${pe}`)]}}function rs(l){const r=(l.expressionContext==="property"?R:vu)(Hr(l.value),l.valueSpec);if(r.result==="error")return r.value.map((p=>new Rt(`${l.key}${p.key}`,l.value,p.message)));const o=r.value.expression||r.value._styleExpression.expression;if(l.expressionContext==="property"&&l.propertyKey==="text-font"&&!o.outputDefined())return[new Rt(l.key,l.value,`Invalid data expression for "${l.propertyKey}". Output values must be contained as literals within the expression.`)];if(l.expressionContext==="property"&&l.propertyType==="layout"&&!ma(o))return[new Rt(l.key,l.value,'"feature-state" data expressions are not supported with layout properties.')];if(l.expressionContext==="filter"&&!ma(o))return[new Rt(l.key,l.value,'"feature-state" data expressions are not supported with filters.')];if(l.expressionContext&&l.expressionContext.indexOf("cluster")===0){if(!_u(o,["zoom","feature-state"]))return[new Rt(l.key,l.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(l.expressionContext==="cluster-initial"&&!ts(o))return[new Rt(l.key,l.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function fl(l){const r=l.key,o=l.value,p=$n(o);return p!=="string"?[new Rt(r,o,`color expected, ${p} found`)]:Ln.parse(String(o))?[]:[new Rt(r,o,`color expected, "${o}" found`)]}function Oo(l){const r=l.key,o=l.value,p=l.valueSpec,v=[];return Array.isArray(p.values)?p.values.indexOf(ki(o))===-1&&v.push(new Rt(r,o,`expected one of [${p.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(p.values).indexOf(ki(o))===-1&&v.push(new Rt(r,o,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(o)} found`)),v}function xu(l){return Oe(Hr(l.value))?rs(en({},l,{expressionContext:"filter",valueSpec:{value:"boolean"}})):tc(l)}function tc(l){const r=l.value,o=l.key;if($n(r)!=="array")return[new Rt(o,r,`array expected, ${$n(r)} found`)];const p=l.styleSpec;let v,E=[];if(r.length<1)return[new Rt(o,r,"filter array must have at least 1 element")];switch(E=E.concat(Oo({key:`${o}[0]`,value:r[0],valueSpec:p.filter_operator,style:l.style,styleSpec:l.styleSpec})),ki(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&ki(r[1])==="$type"&&E.push(new Rt(o,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&E.push(new Rt(o,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(v=$n(r[1]),v!=="string"&&E.push(new Rt(`${o}[1]`,r[1],`string expected, ${v} found`)));for(let A=2;A<r.length;A++)v=$n(r[A]),ki(r[1])==="$type"?E=E.concat(Oo({key:`${o}[${A}]`,value:r[A],valueSpec:p.geometry_type,style:l.style,styleSpec:l.styleSpec})):v!=="string"&&v!=="number"&&v!=="boolean"&&E.push(new Rt(`${o}[${A}]`,r[A],`string, number, or boolean expected, ${v} found`));break;case"any":case"all":case"none":for(let A=1;A<r.length;A++)E=E.concat(tc({key:`${o}[${A}]`,value:r[A],style:l.style,styleSpec:l.styleSpec}));break;case"has":case"!has":v=$n(r[1]),r.length!==2?E.push(new Rt(o,r,`filter array for "${r[0]}" operator must have 2 elements`)):v!=="string"&&E.push(new Rt(`${o}[1]`,r[1],`string expected, ${v} found`))}return E}function Ol(l,r){const o=l.key,p=l.validateSpec,v=l.style,E=l.styleSpec,A=l.value,M=l.objectKey,z=E[`${r}_${l.layerType}`];if(!z)return[];const F=M.match(/^(.*)-transition$/);if(r==="paint"&&F&&z[F[1]]&&z[F[1]].transition)return p({key:o,value:A,valueSpec:E.transition,style:v,styleSpec:E});const q=l.valueSpec||z[M];if(!q)return[new Rt(o,A,`unknown property "${M}"`)];let W;if($n(A)==="string"&&dl(q)&&!q.tokens&&(W=/^{([^}]+)}$/.exec(A)))return[new Rt(o,A,`"${M}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(W[1])} }\`.`)];const te=[];return l.layerType==="symbol"&&(M==="text-field"&&v&&!v.glyphs&&te.push(new Rt(o,A,'use of "text-field" requires a style "glyphs" property')),M==="text-font"&&Lo(Hr(A))&&ki(A.type)==="identity"&&te.push(new Rt(o,A,'"text-font" does not support identity functions'))),te.concat(p({key:l.key,value:A,valueSpec:q,style:v,styleSpec:E,expressionContext:"property",propertyType:r,propertyKey:M}))}function pl(l){return Ol(l,"paint")}function wu(l){return Ol(l,"layout")}function Kl(l){let r=[];const o=l.value,p=l.key,v=l.style,E=l.styleSpec;if($n(o)!=="object")return[new Rt(p,o,`object expected, ${$n(o)} found`)];o.type||o.ref||r.push(new Rt(p,o,'either "type" or "ref" is required'));let A=ki(o.type);const M=ki(o.ref);if(o.id){const z=ki(o.id);for(let F=0;F<l.arrayIndex;F++){const q=v.layers[F];ki(q.id)===z&&r.push(new Rt(p,o.id,`duplicate layer id "${o.id}", previously used at line ${q.id.__line__}`))}}if("ref"in o){let z;["type","source","source-layer","filter","layout"].forEach((F=>{F in o&&r.push(new Rt(p,o[F],`"${F}" is prohibited for ref layers`))})),v.layers.forEach((F=>{ki(F.id)===M&&(z=F)})),z?z.ref?r.push(new Rt(p,o.ref,"ref cannot reference another ref layer")):A=ki(z.type):r.push(new Rt(p,o.ref,`ref layer "${M}" not found`))}else if(A!=="background")if(o.source){const z=v.sources&&v.sources[o.source],F=z&&ki(z.type);z?F==="vector"&&A==="raster"?r.push(new Rt(p,o.source,`layer "${o.id}" requires a raster source`)):F!=="raster-dem"&&A==="hillshade"||F!=="raster-dem"&&A==="color-relief"?r.push(new Rt(p,o.source,`layer "${o.id}" requires a raster-dem source`)):F==="raster"&&A!=="raster"?r.push(new Rt(p,o.source,`layer "${o.id}" requires a vector source`)):F!=="vector"||o["source-layer"]?F==="raster-dem"&&A!=="hillshade"&&A!=="color-relief"?r.push(new Rt(p,o.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):A!=="line"||!o.paint||!o.paint["line-gradient"]||F==="geojson"&&z.lineMetrics||r.push(new Rt(p,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new Rt(p,o,`layer "${o.id}" must specify a "source-layer"`)):r.push(new Rt(p,o.source,`source "${o.source}" not found`))}else r.push(new Rt(p,o,'missing required property "source"'));return r=r.concat(is({key:p,value:o,valueSpec:E.layer,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*":()=>[],type:()=>l.validateSpec({key:`${p}.type`,value:o.type,valueSpec:E.layer.type,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,object:o,objectKey:"type"}),filter:xu,layout:z=>is({layer:o,key:z.key,value:z.value,style:z.style,styleSpec:z.styleSpec,validateSpec:z.validateSpec,objectElementValidators:{"*":F=>wu(en({layerType:A},F))}}),paint:z=>is({layer:o,key:z.key,value:z.value,style:z.style,styleSpec:z.styleSpec,validateSpec:z.validateSpec,objectElementValidators:{"*":F=>pl(en({layerType:A},F))}})}})),r}function No(l){const r=l.value,o=l.key,p=$n(r);return p!=="string"?[new Rt(o,r,`string expected, ${p} found`)]:[]}const nc={promoteId:function({key:l,value:r}){if($n(r)==="string")return No({key:l,value:r});{const o=[];for(const p in r)o.push(...No({key:`${l}.${p}`,value:r[p]}));return o}}};function Ra(l){const r=l.value,o=l.key,p=l.styleSpec,v=l.style,E=l.validateSpec;if(!r.type)return[new Rt(o,r,'"type" is required')];const A=ki(r.type);let M;switch(A){case"vector":case"raster":return M=is({key:o,value:r,valueSpec:p[`source_${A.replace("-","_")}`],style:l.style,styleSpec:p,objectElementValidators:nc,validateSpec:E}),M;case"raster-dem":return M=(function(z){var F;const q=(F=z.sourceName)!==null&&F!==void 0?F:"",W=z.value,te=z.styleSpec,ie=te.source_raster_dem,re=z.style;let oe=[];const pe=$n(W);if(W===void 0)return oe;if(pe!=="object")return oe.push(new Rt("source_raster_dem",W,`object expected, ${pe} found`)),oe;const Te=ki(W.encoding)==="custom",He=["redFactor","greenFactor","blueFactor","baseShift"],Le=z.value.encoding?`"${z.value.encoding}"`:"Default";for(const Be in W)!Te&&He.includes(Be)?oe.push(new Rt(Be,W[Be],`In "${q}": "${Be}" is only valid when "encoding" is set to "custom". ${Le} encoding found`)):ie[Be]?oe=oe.concat(z.validateSpec({key:Be,value:W[Be],valueSpec:ie[Be],validateSpec:z.validateSpec,style:re,styleSpec:te})):oe.push(new Rt(Be,W[Be],`unknown property "${Be}"`));return oe})({sourceName:o,value:r,style:l.style,styleSpec:p,validateSpec:E}),M;case"geojson":if(M=is({key:o,value:r,valueSpec:p.source_geojson,style:v,styleSpec:p,validateSpec:E,objectElementValidators:nc}),r.cluster)for(const z in r.clusterProperties){const[F,q]=r.clusterProperties[z],W=typeof F=="string"?[F,["accumulated"],["get",z]]:F;M.push(...rs({key:`${o}.${z}.map`,value:q,expressionContext:"cluster-map"})),M.push(...rs({key:`${o}.${z}.reduce`,value:W,expressionContext:"cluster-reduce"}))}return M;case"video":return is({key:o,value:r,valueSpec:p.source_video,style:v,validateSpec:E,styleSpec:p});case"image":return is({key:o,value:r,valueSpec:p.source_image,style:v,validateSpec:E,styleSpec:p});case"canvas":return[new Rt(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Oo({key:`${o}.type`,value:r.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Tu(l){const r=l.value,o=l.styleSpec,p=o.light,v=l.style;let E=[];const A=$n(r);if(r===void 0)return E;if(A!=="object")return E=E.concat([new Rt("light",r,`object expected, ${A} found`)]),E;for(const M in r){const z=M.match(/^(.*)-transition$/);E=E.concat(z&&p[z[1]]&&p[z[1]].transition?l.validateSpec({key:M,value:r[M],valueSpec:o.transition,validateSpec:l.validateSpec,style:v,styleSpec:o}):p[M]?l.validateSpec({key:M,value:r[M],valueSpec:p[M],validateSpec:l.validateSpec,style:v,styleSpec:o}):[new Rt(M,r[M],`unknown property "${M}"`)])}return E}function Su(l){const r=l.value,o=l.styleSpec,p=o.sky,v=l.style,E=$n(r);if(r===void 0)return[];if(E!=="object")return[new Rt("sky",r,`object expected, ${E} found`)];let A=[];for(const M in r)A=A.concat(p[M]?l.validateSpec({key:M,value:r[M],valueSpec:p[M],style:v,styleSpec:o}):[new Rt(M,r[M],`unknown property "${M}"`)]);return A}function Ha(l){const r=l.value,o=l.styleSpec,p=o.terrain,v=l.style;let E=[];const A=$n(r);if(r===void 0)return E;if(A!=="object")return E=E.concat([new Rt("terrain",r,`object expected, ${A} found`)]),E;for(const M in r)E=E.concat(p[M]?l.validateSpec({key:M,value:r[M],valueSpec:p[M],validateSpec:l.validateSpec,style:v,styleSpec:o}):[new Rt(M,r[M],`unknown property "${M}"`)]);return E}function id(l){let r=[];const o=l.value,p=l.key;if(Array.isArray(o)){const v=[],E=[];for(const A in o)o[A].id&&v.includes(o[A].id)&&r.push(new Rt(p,o,`all the sprites' ids must be unique, but ${o[A].id} is duplicated`)),v.push(o[A].id),o[A].url&&E.includes(o[A].url)&&r.push(new Rt(p,o,`all the sprites' URLs must be unique, but ${o[A].url} is duplicated`)),E.push(o[A].url),r=r.concat(is({key:`${p}[${A}]`,value:o[A],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:l.validateSpec}));return r}return No({key:p,value:o})}function Nc(l){return r=l.value,r&&r.constructor===Object?[]:[new Rt(l.key,l.value,`object expected, ${$n(l.value)} found`)];var r}const Zf={"*":()=>[],array:zo,boolean:function(l){const r=l.value,o=l.key,p=$n(r);return p!=="boolean"?[new Rt(o,r,`boolean expected, ${p} found`)]:[]},number:bu,color:fl,constants:ui,enum:Oo,filter:xu,function:Nr,layer:Kl,object:is,source:Ra,light:Tu,sky:Su,terrain:Ha,projection:function(l){const r=l.value,o=l.styleSpec,p=o.projection,v=l.style,E=$n(r);if(r===void 0)return[];if(E!=="object")return[new Rt("projection",r,`object expected, ${E} found`)];let A=[];for(const M in r)A=A.concat(p[M]?l.validateSpec({key:M,value:r[M],valueSpec:p[M],style:v,styleSpec:o}):[new Rt(M,r[M],`unknown property "${M}"`)]);return A},projectionDefinition:function(l){const r=l.key;let o=l.value;o=o instanceof String?o.valueOf():o;const p=$n(o);return p!=="array"||(function(v){return Array.isArray(v)&&v.length===3&&typeof v[0]=="string"&&typeof v[1]=="string"&&typeof v[2]=="number"})(o)||(function(v){return!!["interpolate","step","literal"].includes(v[0])})(o)?["array","string"].includes(p)?[]:[new Rt(r,o,`projection expected, invalid type "${p}" found`)]:[new Rt(r,o,`projection expected, invalid array ${JSON.stringify(o)} found`)]},string:No,formatted:function(l){return No(l).length===0?[]:rs(l)},resolvedImage:function(l){return No(l).length===0?[]:rs(l)},padding:function(l){const r=l.key,o=l.value;if($n(o)==="array"){if(o.length<1||o.length>4)return[new Rt(r,o,`padding requires 1 to 4 values; ${o.length} values found`)];const p={type:"number"};let v=[];for(let E=0;E<o.length;E++)v=v.concat(l.validateSpec({key:`${r}[${E}]`,value:o[E],validateSpec:l.validateSpec,valueSpec:p}));return v}return bu({key:r,value:o,valueSpec:{}})},numberArray:function(l){const r=l.key,o=l.value;if($n(o)==="array"){const p={type:"number"};if(o.length<1)return[new Rt(r,o,"array length at least 1 expected, length 0 found")];let v=[];for(let E=0;E<o.length;E++)v=v.concat(l.validateSpec({key:`${r}[${E}]`,value:o[E],validateSpec:l.validateSpec,valueSpec:p}));return v}return bu({key:r,value:o,valueSpec:{}})},colorArray:function(l){const r=l.key,o=l.value;if($n(o)==="array"){if(o.length<1)return[new Rt(r,o,"array length at least 1 expected, length 0 found")];let p=[];for(let v=0;v<o.length;v++)p=p.concat(fl({key:`${r}[${v}]`,value:o[v]}));return p}return fl({key:r,value:o})},variableAnchorOffsetCollection:function(l){const r=l.key,o=l.value,p=$n(o),v=l.styleSpec;if(p!=="array"||o.length<1||o.length%2!=0)return[new Rt(r,o,"variableAnchorOffsetCollection requires a non-empty array of even length")];let E=[];for(let A=0;A<o.length;A+=2)E=E.concat(Oo({key:`${r}[${A}]`,value:o[A],valueSpec:v.layout_symbol["text-anchor"]})),E=E.concat(zo({key:`${r}[${A+1}]`,value:o[A+1],valueSpec:{length:2,value:"number"},validateSpec:l.validateSpec,style:l.style,styleSpec:v}));return E},sprite:id,state:Nc};function ph(l){const r=l.value,o=l.valueSpec,p=l.styleSpec;return l.validateSpec=ph,o.expression&&Lo(ki(r))?Nr(l):o.expression&&ec(Hr(r))?rs(l):o.type&&Zf[o.type]?Zf[o.type](l):is(en({},l,{valueSpec:o.type?p[o.type]:o}))}function rm(l){const r=l.value,o=l.key,p=No(l);return p.length||(r.indexOf("{fontstack}")===-1&&p.push(new Rt(o,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&p.push(new Rt(o,r,'"glyphs" url must include a "{range}" token'))),p}function Ci(l,r=qe){let o=[];return o=o.concat(ph({key:"",value:l,valueSpec:r.$root,styleSpec:r,style:l,validateSpec:ph,objectElementValidators:{glyphs:rm,"*":()=>[]}})),l.constants&&(o=o.concat(ui({key:"constants",value:l.constants}))),Yl(o)}function Bo(l){return function(r){return l({...r,validateSpec:ph})}}function Yl(l){return[].concat(l).sort(((r,o)=>r.line-o.line))}function Js(l){return function(...r){return Yl(l.apply(this,r))}}Ci.source=Js(Bo(Ra)),Ci.sprite=Js(Bo(id)),Ci.glyphs=Js(Bo(rm)),Ci.light=Js(Bo(Tu)),Ci.sky=Js(Bo(Su)),Ci.terrain=Js(Bo(Ha)),Ci.state=Js(Bo(Nc)),Ci.layer=Js(Bo(Kl)),Ci.filter=Js(Bo(xu)),Ci.paintProperty=Js(Bo(pl)),Ci.layoutProperty=Js(Bo(wu));const ic=Ci,mh=ic.light,Ql=ic.sky,Rg=ic.paintProperty,am=ic.layoutProperty;function rd(l,r){let o=!1;if(r&&r.length)for(const p of r)l.fire(new wt(new Error(p.message))),o=!0;return o}class gh{constructor(r,o,p){const v=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;const A=new Int32Array(this.arrayBuffer);r=A[0],this.d=(o=A[1])+2*(p=A[2]);for(let z=0;z<this.d*this.d;z++){const F=A[3+z],q=A[3+z+1];v.push(F===q?null:A.subarray(F,q))}const M=A[3+v.length+1];this.keys=A.subarray(A[3+v.length],M),this.bboxes=A.subarray(M),this.insert=this._insertReadonly}else{this.d=o+2*p;for(let A=0;A<this.d*this.d;A++)v.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=r,this.padding=p,this.scale=o/r,this.uid=0;const E=p/o*r;this.min=-E,this.max=r+E}insert(r,o,p,v,E){this._forEachCell(o,p,v,E,this._insertCell,this.uid++,void 0,void 0),this.keys.push(r),this.bboxes.push(o),this.bboxes.push(p),this.bboxes.push(v),this.bboxes.push(E)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(r,o,p,v,E,A){this.cells[E].push(A)}query(r,o,p,v,E){const A=this.min,M=this.max;if(r<=A&&o<=A&&M<=p&&M<=v&&!E)return Array.prototype.slice.call(this.keys);{const z=[];return this._forEachCell(r,o,p,v,this._queryCell,z,{},E),z}}_queryCell(r,o,p,v,E,A,M,z){const F=this.cells[E];if(F!==null){const q=this.keys,W=this.bboxes;for(let te=0;te<F.length;te++){const ie=F[te];if(M[ie]===void 0){const re=4*ie;(z?z(W[re+0],W[re+1],W[re+2],W[re+3]):r<=W[re+2]&&o<=W[re+3]&&p>=W[re+0]&&v>=W[re+1])?(M[ie]=!0,A.push(q[ie])):M[ie]=!1}}}}_forEachCell(r,o,p,v,E,A,M,z){const F=this._convertToCellCoord(r),q=this._convertToCellCoord(o),W=this._convertToCellCoord(p),te=this._convertToCellCoord(v);for(let ie=F;ie<=W;ie++)for(let re=q;re<=te;re++){const oe=this.d*re+ie;if((!z||z(this._convertFromCellCoord(ie),this._convertFromCellCoord(re),this._convertFromCellCoord(ie+1),this._convertFromCellCoord(re+1)))&&E.call(this,r,o,p,v,oe,A,M,z))return}}_convertFromCellCoord(r){return(r-this.padding)/this.scale}_convertToCellCoord(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const r=this.cells,o=3+this.cells.length+1+1;let p=0;for(let A=0;A<this.cells.length;A++)p+=this.cells[A].length;const v=new Int32Array(o+p+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;let E=o;for(let A=0;A<r.length;A++){const M=r[A];v[3+A]=E,v.set(M,E),E+=M.length}return v[3+r.length]=E,v.set(this.keys,E),E+=this.keys.length,v[3+r.length+1]=E,v.set(this.bboxes,E),E+=this.bboxes.length,v.buffer}static serialize(r,o){const p=r.toArrayBuffer();return o&&o.push(p),{buffer:p}}static deserialize(r){return new gh(r.buffer)}}const as={};function Yt(l,r,o={}){if(as[l])throw new Error(`${l} is already registered.`);Object.defineProperty(r,"_classRegistryKey",{value:l,writeable:!1}),as[l]={klass:r,omit:o.omit||[],shallow:o.shallow||[]}}Yt("Object",Object),Yt("Set",Set),Yt("TransferableGridIndex",gh),Yt("Color",Ln),Yt("Error",Error),Yt("AJAXError",Se),Yt("ResolvedImage",cr),Yt("StylePropertyFunction",U),Yt("StyleExpression",Ju,{omit:["_evaluator"]}),Yt("ZoomDependentExpression",x),Yt("ZoomConstantExpression",f),Yt("CompoundExpression",co,{omit:["_evaluate"]});for(const l in mu)mu[l]._classRegistryKey||Yt(`Expression_${l}`,mu[l]);function _h(l){return l&&typeof ArrayBuffer<"u"&&(l instanceof ArrayBuffer||l.constructor&&l.constructor.name==="ArrayBuffer")}function ad(l){return l.$name||l.constructor._classRegistryKey}function rc(l){return!(function(r){if(r===null||typeof r!="object")return!1;const o=ad(r);return!(!o||o==="Object")})(l)&&(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||l instanceof Blob||l instanceof Error||_h(l)||Sa(l)||ArrayBuffer.isView(l)||l instanceof ImageData)}function ac(l,r){if(rc(l))return(_h(l)||Sa(l))&&r&&r.push(l),ArrayBuffer.isView(l)&&r&&r.push(l.buffer),l instanceof ImageData&&r&&r.push(l.data.buffer),l;if(Array.isArray(l)){const E=[];for(const A of l)E.push(ac(A,r));return E}if(typeof l!="object")throw new Error("can't serialize object of type "+typeof l);const o=ad(l);if(!o)throw new Error(`can't serialize object of unregistered class ${l.constructor.name}`);if(!as[o])throw new Error(`${o} is not registered.`);const{klass:p}=as[o],v=p.serialize?p.serialize(l,r):{};if(p.serialize){if(r&&v===r[r.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const E in l){if(!l.hasOwnProperty(E)||as[o].omit.indexOf(E)>=0)continue;const A=l[E];v[E]=as[o].shallow.indexOf(E)>=0?A:ac(A,r)}l instanceof Error&&(v.message=l.message)}if(v.$name)throw new Error("$name property is reserved for worker serialization logic.");return o!=="Object"&&(v.$name=o),v}function Jl(l){if(rc(l))return l;if(Array.isArray(l))return l.map(Jl);if(typeof l!="object")throw new Error("can't deserialize object of type "+typeof l);const r=ad(l)||"Object";if(!as[r])throw new Error(`can't deserialize unregistered class ${r}`);const{klass:o}=as[r];if(!o)throw new Error(`can't deserialize unregistered class ${r}`);if(o.deserialize)return o.deserialize(l);const p=Object.create(o.prototype);for(const v of Object.keys(l)){if(v==="$name")continue;const E=l[v];p[v]=as[r].shallow.indexOf(v)>=0?E:Jl(E)}return p}class Bc{constructor(){this.first=!0}update(r,o){const p=Math.floor(r);return this.first?(this.first=!1,this.lastIntegerZoom=p,this.lastIntegerZoomTime=0,this.lastZoom=r,this.lastFloorZoom=p,!0):(this.lastFloorZoom>p?(this.lastIntegerZoom=p+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<p&&(this.lastIntegerZoom=p,this.lastIntegerZoomTime=o),r!==this.lastZoom&&(this.lastZoom=r,this.lastFloorZoom=p,!0))}}const ri={"Latin-1 Supplement":l=>l>=128&&l<=255,"Hangul Jamo":l=>l>=4352&&l<=4607,Khmer:l=>l>=6016&&l<=6143,"General Punctuation":l=>l>=8192&&l<=8303,"Letterlike Symbols":l=>l>=8448&&l<=8527,"Number Forms":l=>l>=8528&&l<=8591,"Miscellaneous Technical":l=>l>=8960&&l<=9215,"Control Pictures":l=>l>=9216&&l<=9279,"Optical Character Recognition":l=>l>=9280&&l<=9311,"Enclosed Alphanumerics":l=>l>=9312&&l<=9471,"Geometric Shapes":l=>l>=9632&&l<=9727,"Miscellaneous Symbols":l=>l>=9728&&l<=9983,"Miscellaneous Symbols and Arrows":l=>l>=11008&&l<=11263,"Ideographic Description Characters":l=>l>=12272&&l<=12287,"CJK Symbols and Punctuation":l=>l>=12288&&l<=12351,Hiragana:l=>l>=12352&&l<=12447,Katakana:l=>l>=12448&&l<=12543,Kanbun:l=>l>=12688&&l<=12703,"CJK Strokes":l=>l>=12736&&l<=12783,"Enclosed CJK Letters and Months":l=>l>=12800&&l<=13055,"CJK Compatibility":l=>l>=13056&&l<=13311,"Yijing Hexagram Symbols":l=>l>=19904&&l<=19967,"CJK Unified Ideographs":l=>l>=19968&&l<=40959,"Hangul Syllables":l=>l>=44032&&l<=55215,"Private Use Area":l=>l>=57344&&l<=63743,"Vertical Forms":l=>l>=65040&&l<=65055,"CJK Compatibility Forms":l=>l>=65072&&l<=65103,"Small Form Variants":l=>l>=65104&&l<=65135,"Halfwidth and Fullwidth Forms":l=>l>=65280&&l<=65519};function sd(l){for(const r of l)if(Vc(r.charCodeAt(0)))return!0;return!1}function Fc(l){for(const r of l)if(!Hf(r.charCodeAt(0)))return!1;return!0}function eu(l){const r=l.map((o=>{try{return new RegExp(`\\p{sc=${o}}`,"u").source}catch{return null}})).filter((o=>o));return new RegExp(r.join("|"),"u")}const sm=eu(["Arab","Dupl","Mong","Ougr","Syrc"]);function Hf(l){return!sm.test(String.fromCodePoint(l))}const sc=eu(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Vc(l){return!(l!==746&&l!==747&&(l<4352||!(ri["CJK Compatibility Forms"](l)&&!(l>=65097&&l<=65103)||ri["CJK Compatibility"](l)||ri["CJK Strokes"](l)||!(!ri["CJK Symbols and Punctuation"](l)||l>=12296&&l<=12305||l>=12308&&l<=12319||l===12336)||ri["Enclosed CJK Letters and Months"](l)||ri["Ideographic Description Characters"](l)||ri.Kanbun(l)||ri.Katakana(l)&&l!==12540||!(!ri["Halfwidth and Fullwidth Forms"](l)||l===65288||l===65289||l===65293||l>=65306&&l<=65310||l===65339||l===65341||l===65343||l>=65371&&l<=65503||l===65507||l>=65512&&l<=65519)||!(!ri["Small Form Variants"](l)||l>=65112&&l<=65118||l>=65123&&l<=65126)||ri["Vertical Forms"](l)||ri["Yijing Hexagram Symbols"](l)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(l))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(l))||sc.test(String.fromCodePoint(l)))))}function od(l){return!(Vc(l)||(function(r){return!!(ri["Latin-1 Supplement"](r)&&(r===167||r===169||r===174||r===177||r===188||r===189||r===190||r===215||r===247)||ri["General Punctuation"](r)&&(r===8214||r===8224||r===8225||r===8240||r===8241||r===8251||r===8252||r===8258||r===8263||r===8264||r===8265||r===8273)||ri["Letterlike Symbols"](r)||ri["Number Forms"](r)||ri["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||r===9003||r>=9085&&r<=9114||r>=9150&&r<=9165||r===9167||r>=9169&&r<=9179||r>=9186&&r<=9215)||ri["Control Pictures"](r)&&r!==9251||ri["Optical Character Recognition"](r)||ri["Enclosed Alphanumerics"](r)||ri["Geometric Shapes"](r)||ri["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||ri["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||ri["CJK Symbols and Punctuation"](r)||ri.Katakana(r)||ri["Private Use Area"](r)||ri["CJK Compatibility Forms"](r)||ri["Small Form Variants"](r)||ri["Halfwidth and Fullwidth Forms"](r)||r===8734||r===8756||r===8757||r>=9984&&r<=10087||r>=10102&&r<=10131||r===65532||r===65533)})(l))}const yh=eu(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function vh(l){return yh.test(String.fromCodePoint(l))}function Wf(l,r){return!(!r&&vh(l)||l>=2304&&l<=3583||l>=3840&&l<=4255||ri.Khmer(l))}function oc(l){for(const r of l)if(vh(r.charCodeAt(0)))return!0;return!1}const ml=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(l){this.pluginStatus=l.pluginStatus,this.pluginURL=l.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(l){if(ml.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=l.applyArabicShaping,this.processBidirectionalText=l.processBidirectionalText,this.processStyledBidirectionalText=l.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(l,r){return c(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(l.pluginStatus!=="loading")return this.setState(l),l;const o=l.pluginURL,p=new Promise((E=>{this.loadScriptResolve=E}));r(o);const v=new Promise((E=>setTimeout((()=>E()),this.TIMEOUT)));if(yield Promise.race([p,v]),this.isParsed()){const E={pluginStatus:"loaded",pluginURL:o};return this.setState(E),E}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${o}`)}))}};class Di{constructor(r,o){this.zoom=r,o?(this.now=o.now||0,this.fadeDuration=o.fadeDuration||0,this.zoomHistory=o.zoomHistory||new Bc,this.transition=o.transition||{},this.globalState=o.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Bc,this.transition={},this.globalState={})}isSupportedScript(r){return(function(o,p){for(const v of o)if(!Wf(v.charCodeAt(0),p))return!1;return!0})(r,ml.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const r=this.zoom,o=r-Math.floor(r),p=this.crossFadingFactor();return r>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*p}:{fromScale:.5,toScale:1,t:1-(1-p)*o}}}class lc{constructor(r,o){this.property=r,this.value=o,this.expression=(function(p,v){if(Lo(p))return new U(p,v);if(ec(p)){const E=R(p,v);if(E.result==="error")throw new Error(E.value.map((A=>`${A.key}: ${A.message}`)).join(", "));return E.value}{let E=p;return v.type==="color"&&typeof p=="string"?E=Ln.parse(p):v.type!=="padding"||typeof p!="number"&&!Array.isArray(p)?v.type!=="numberArray"||typeof p!="number"&&!Array.isArray(p)?v.type!=="colorArray"||typeof p!="string"&&!Array.isArray(p)?v.type==="variableAnchorOffsetCollection"&&Array.isArray(p)?E=sr.parse(p):v.type==="projectionDefinition"&&typeof p=="string"&&(E=wr.parse(p)):E=pi.parse(p):E=hn.parse(p):E=mr.parse(p),{globalStateRefs:new Set,kind:"constant",evaluate:()=>E}}})(o===void 0?r.specification.default:o,r.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(r,o,p){return this.property.possiblyEvaluate(this,r,o,p)}}class ld{constructor(r){this.property=r,this.value=new lc(r,void 0)}transitioned(r,o){return new tu(this.property,this.value,o,oi({},r.transition,this.transition),r.now)}untransitioned(){return new tu(this.property,this.value,null,{},0)}}class Eu{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)}getValue(r){return Dr(this._values[r].value.value)}setValue(r,o){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new ld(this._values[r].property)),this._values[r].value=new lc(this._values[r].property,o===null?void 0:Dr(o))}getTransition(r){return Dr(this._values[r].transition)}setTransition(r,o){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new ld(this._values[r].property)),this._values[r].transition=Dr(o)||void 0}serialize(){const r={};for(const o of Object.keys(this._values)){const p=this.getValue(o);p!==void 0&&(r[o]=p);const v=this.getTransition(o);v!==void 0&&(r[`${o}-transition`]=v)}return r}transitioned(r,o){const p=new Uc(this._properties);for(const v of Object.keys(this._values))p._values[v]=this._values[v].transitioned(r,o._values[v]);return p}untransitioned(){const r=new Uc(this._properties);for(const o of Object.keys(this._values))r._values[o]=this._values[o].untransitioned();return r}}class tu{constructor(r,o,p,v,E){this.property=r,this.value=o,this.begin=E+v.delay||0,this.end=this.begin+v.duration||0,r.specification.transition&&(v.delay||v.duration)&&(this.prior=p)}possiblyEvaluate(r,o,p){const v=r.now||0,E=this.value.possiblyEvaluate(r,o,p),A=this.prior;if(A){if(v>this.end)return this.prior=null,E;if(this.value.isDataDriven())return this.prior=null,E;if(v<this.begin)return A.possiblyEvaluate(r,o,p);{const M=(v-this.begin)/(this.end-this.begin);return this.property.interpolate(A.possiblyEvaluate(r,o,p),E,Ot(M))}}return E}}class Uc{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,o,p){const v=new uc(this._properties);for(const E of Object.keys(this._values))v._values[E]=this._values[E].possiblyEvaluate(r,o,p);return v}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class Yd{constructor(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)}hasValue(r){return this._values[r].value!==void 0}getValue(r){return Dr(this._values[r].value)}setValue(r,o){this._values[r]=new lc(this._values[r].property,o===null?void 0:Dr(o))}serialize(){const r={};for(const o of Object.keys(this._values)){const p=this.getValue(o);p!==void 0&&(r[o]=p)}return r}possiblyEvaluate(r,o,p){const v=new uc(this._properties);for(const E of Object.keys(this._values))v._values[E]=this._values[E].possiblyEvaluate(r,o,p);return v}}class gl{constructor(r,o,p){this.property=r,this.value=o,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(r){return this.value.kind==="constant"?this.value.value:r}evaluate(r,o,p,v){return this.property.evaluate(this.value,this.parameters,r,o,p,v)}}class uc{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class an{constructor(r){this.specification=r}possiblyEvaluate(r,o){if(r.isDataDriven())throw new Error("Value should not be data driven");return r.expression.evaluate(o)}interpolate(r,o,p){const v=ws[this.specification.type];return v?v(r,o,p):r}}class Tn{constructor(r,o){this.specification=r,this.overrides=o}possiblyEvaluate(r,o,p,v){return new gl(this,r.expression.kind==="constant"||r.expression.kind==="camera"?{kind:"constant",value:r.expression.evaluate(o,null,{},p,v)}:r.expression,o)}interpolate(r,o,p){if(r.value.kind!=="constant"||o.value.kind!=="constant")return r;if(r.value.value===void 0||o.value.value===void 0)return new gl(this,{kind:"constant",value:void 0},r.parameters);const v=ws[this.specification.type];if(v){const E=v(r.value.value,o.value.value,p);return new gl(this,{kind:"constant",value:E},r.parameters)}return r}evaluate(r,o,p,v,E,A){return r.kind==="constant"?r.value:r.evaluate(o,p,v,E,A)}}class ud extends Tn{possiblyEvaluate(r,o,p,v){if(r.value===void 0)return new gl(this,{kind:"constant",value:void 0},o);if(r.expression.kind==="constant"){const E=r.expression.evaluate(o,null,{},p,v),A=r.property.specification.type==="resolvedImage"&&typeof E!="string"?E.name:E,M=this._calculate(A,A,A,o);return new gl(this,{kind:"constant",value:M},o)}if(r.expression.kind==="camera"){const E=this._calculate(r.expression.evaluate({zoom:o.zoom-1}),r.expression.evaluate({zoom:o.zoom}),r.expression.evaluate({zoom:o.zoom+1}),o);return new gl(this,{kind:"constant",value:E},o)}return new gl(this,r.expression,o)}evaluate(r,o,p,v,E,A){if(r.kind==="source"){const M=r.evaluate(o,p,v,E,A);return this._calculate(M,M,M,o)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(o.zoom)-1},p,v),r.evaluate({zoom:Math.floor(o.zoom)},p,v),r.evaluate({zoom:Math.floor(o.zoom)+1},p,v),o):r.value}_calculate(r,o,p,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:r,to:o}:{from:p,to:o}}interpolate(r){return r}}class Fo{constructor(r){this.specification=r}possiblyEvaluate(r,o,p,v){if(r.value!==void 0){if(r.expression.kind==="constant"){const E=r.expression.evaluate(o,null,{},p,v);return this._calculate(E,E,E,o)}return this._calculate(r.expression.evaluate(new Di(Math.floor(o.zoom-1),o)),r.expression.evaluate(new Di(Math.floor(o.zoom),o)),r.expression.evaluate(new Di(Math.floor(o.zoom+1),o)),o)}}_calculate(r,o,p,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:r,to:o}:{from:p,to:o}}interpolate(r){return r}}class jc{constructor(r){this.specification=r}possiblyEvaluate(r,o,p,v){return!!r.expression.evaluate(o,null,{},p,v)}interpolate(){return!1}}class As{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const o in r){const p=r[o];p.specification.overridable&&this.overridableProperties.push(o);const v=this.defaultPropertyValues[o]=new lc(p,void 0),E=this.defaultTransitionablePropertyValues[o]=new ld(p);this.defaultTransitioningPropertyValues[o]=E.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=v.possiblyEvaluate({})}}}Yt("DataDrivenProperty",Tn),Yt("DataConstantProperty",an),Yt("CrossFadedDataDrivenProperty",ud),Yt("CrossFadedProperty",Fo),Yt("ColorRampProperty",jc);const Qd="-transition";class ho extends tn{constructor(r,o){if(super(),this.id=r.id,this.type=r.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},r.type!=="custom"&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter,this._featureFilter=ut(r.filter)),o.layout&&(this._unevaluatedLayout=new Yd(o.layout)),o.paint)){this._transitionablePaint=new Eu(o.paint);for(const p in r.paint)this.setPaintProperty(p,r.paint[p],{validate:!1});for(const p in r.layout)this.setLayoutProperty(p,r.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new uc(o.paint)}}setFilter(r){this.filter=r,this._featureFilter=ut(r)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)}getLayoutAffectingGlobalStateRefs(){const r=new Set;if(this._unevaluatedLayout)for(const o in this._unevaluatedLayout._values){const p=this._unevaluatedLayout._values[o];for(const v of p.getGlobalStateRefs())r.add(v)}for(const o of this._featureFilter.getGlobalStateRefs())r.add(o);return r}setLayoutProperty(r,o,p={}){o!=null&&this._validate(am,`layers.${this.id}.layout.${r}`,r,o,p)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,o):this.visibility=o)}getPaintProperty(r){return r.endsWith(Qd)?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)}setPaintProperty(r,o,p={}){if(o!=null&&this._validate(Rg,`layers.${this.id}.paint.${r}`,r,o,p))return!1;if(r.endsWith(Qd))return this._transitionablePaint.setTransition(r.slice(0,-11),o||void 0),!1;{const v=this._transitionablePaint._values[r],E=v.property.specification["property-type"]==="cross-faded-data-driven",A=v.value.isDataDriven(),M=v.value;this._transitionablePaint.setValue(r,o),this._handleSpecialPaintPropertyUpdate(r);const z=this._transitionablePaint._values[r].value;return z.isDataDriven()||A||E||this._handleOverridablePaintPropertyUpdate(r,M,z)}}_handleSpecialPaintPropertyUpdate(r){}_handleOverridablePaintPropertyUpdate(r,o,p){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,o){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,o)}serialize(){const r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),Ns(r,((o,p)=>!(o===void 0||p==="layout"&&!Object.keys(o).length||p==="paint"&&!Object.keys(o).length)))}_validate(r,o,p,v,E={}){return(!E||E.validate!==!1)&&rd(this,r.call(ic,{key:o,layerType:this.type,objectKey:p,value:v,styleSpec:qe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const r in this.paint._values){const o=this.paint.get(r);if(o instanceof gl&&dl(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}}const Vo={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Cs{constructor(r,o){this._structArray=r,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class gi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,o){return r._trim(),o&&(r.isTransferred=!0,o.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const o=Object.create(this.prototype);return o.arrayBuffer=r.arrayBuffer,o.length=r.length,o.capacity=r.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Br(l,r=1){let o=0,p=0;return{members:l.map((v=>{const E=Vo[v.type].BYTES_PER_ELEMENT,A=o=cd(o,Math.max(r,E)),M=v.components||1;return p=Math.max(p,E),o+=E*M,{name:v.name,type:v.type,components:M,offset:A}})),size:cd(o,Math.max(p,r)),alignment:r}}function cd(l,r){return Math.ceil(l/r)*r}class Uo extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o){const p=this.length;return this.resize(p+1),this.emplace(p,r,o)}emplace(r,o,p){const v=2*r;return this.int16[v+0]=o,this.int16[v+1]=p,r}}Uo.prototype.bytesPerElement=4,Yt("StructArrayLayout2i4",Uo);class Wa extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,p){const v=this.length;return this.resize(v+1),this.emplace(v,r,o,p)}emplace(r,o,p,v){const E=3*r;return this.int16[E+0]=o,this.int16[E+1]=p,this.int16[E+2]=v,r}}Wa.prototype.bytesPerElement=6,Yt("StructArrayLayout3i6",Wa);class Wr extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,p,v){const E=this.length;return this.resize(E+1),this.emplace(E,r,o,p,v)}emplace(r,o,p,v,E){const A=4*r;return this.int16[A+0]=o,this.int16[A+1]=p,this.int16[A+2]=v,this.int16[A+3]=E,r}}Wr.prototype.bytesPerElement=8,Yt("StructArrayLayout4i8",Wr);class Au extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,p,v,E,A){const M=this.length;return this.resize(M+1),this.emplace(M,r,o,p,v,E,A)}emplace(r,o,p,v,E,A,M){const z=6*r;return this.int16[z+0]=o,this.int16[z+1]=p,this.int16[z+2]=v,this.int16[z+3]=E,this.int16[z+4]=A,this.int16[z+5]=M,r}}Au.prototype.bytesPerElement=12,Yt("StructArrayLayout2i4i12",Au);class eo extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,p,v,E,A){const M=this.length;return this.resize(M+1),this.emplace(M,r,o,p,v,E,A)}emplace(r,o,p,v,E,A,M){const z=4*r,F=8*r;return this.int16[z+0]=o,this.int16[z+1]=p,this.uint8[F+4]=v,this.uint8[F+5]=E,this.uint8[F+6]=A,this.uint8[F+7]=M,r}}eo.prototype.bytesPerElement=8,Yt("StructArrayLayout2i4ub8",eo);class Gn extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o){const p=this.length;return this.resize(p+1),this.emplace(p,r,o)}emplace(r,o,p){const v=2*r;return this.float32[v+0]=o,this.float32[v+1]=p,r}}Gn.prototype.bytesPerElement=8,Yt("StructArrayLayout2f8",Gn);class ji extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,p,v,E,A,M,z,F,q){const W=this.length;return this.resize(W+1),this.emplace(W,r,o,p,v,E,A,M,z,F,q)}emplace(r,o,p,v,E,A,M,z,F,q,W){const te=10*r;return this.uint16[te+0]=o,this.uint16[te+1]=p,this.uint16[te+2]=v,this.uint16[te+3]=E,this.uint16[te+4]=A,this.uint16[te+5]=M,this.uint16[te+6]=z,this.uint16[te+7]=F,this.uint16[te+8]=q,this.uint16[te+9]=W,r}}ji.prototype.bytesPerElement=20,Yt("StructArrayLayout10ui20",ji);class Tr extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,p,v,E,A,M,z,F,q,W,te){const ie=this.length;return this.resize(ie+1),this.emplace(ie,r,o,p,v,E,A,M,z,F,q,W,te)}emplace(r,o,p,v,E,A,M,z,F,q,W,te,ie){const re=12*r;return this.int16[re+0]=o,this.int16[re+1]=p,this.int16[re+2]=v,this.int16[re+3]=E,this.uint16[re+4]=A,this.uint16[re+5]=M,this.uint16[re+6]=z,this.uint16[re+7]=F,this.int16[re+8]=q,this.int16[re+9]=W,this.int16[re+10]=te,this.int16[re+11]=ie,r}}Tr.prototype.bytesPerElement=24,Yt("StructArrayLayout4i4ui4i24",Tr);class bh extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,p){const v=this.length;return this.resize(v+1),this.emplace(v,r,o,p)}emplace(r,o,p,v){const E=3*r;return this.float32[E+0]=o,this.float32[E+1]=p,this.float32[E+2]=v,r}}bh.prototype.bytesPerElement=12,Yt("StructArrayLayout3f12",bh);class cc extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const o=this.length;return this.resize(o+1),this.emplace(o,r)}emplace(r,o){return this.uint32[1*r+0]=o,r}}cc.prototype.bytesPerElement=4,Yt("StructArrayLayout1ul4",cc);class nu extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,p,v,E,A,M,z,F){const q=this.length;return this.resize(q+1),this.emplace(q,r,o,p,v,E,A,M,z,F)}emplace(r,o,p,v,E,A,M,z,F,q){const W=10*r,te=5*r;return this.int16[W+0]=o,this.int16[W+1]=p,this.int16[W+2]=v,this.int16[W+3]=E,this.int16[W+4]=A,this.int16[W+5]=M,this.uint32[te+3]=z,this.uint16[W+8]=F,this.uint16[W+9]=q,r}}nu.prototype.bytesPerElement=20,Yt("StructArrayLayout6i1ul2ui20",nu);class xh extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,p,v,E,A){const M=this.length;return this.resize(M+1),this.emplace(M,r,o,p,v,E,A)}emplace(r,o,p,v,E,A,M){const z=6*r;return this.int16[z+0]=o,this.int16[z+1]=p,this.int16[z+2]=v,this.int16[z+3]=E,this.int16[z+4]=A,this.int16[z+5]=M,r}}xh.prototype.bytesPerElement=12,Yt("StructArrayLayout2i2i2i12",xh);class T extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,p,v,E){const A=this.length;return this.resize(A+1),this.emplace(A,r,o,p,v,E)}emplace(r,o,p,v,E,A){const M=4*r,z=8*r;return this.float32[M+0]=o,this.float32[M+1]=p,this.float32[M+2]=v,this.int16[z+6]=E,this.int16[z+7]=A,r}}T.prototype.bytesPerElement=16,Yt("StructArrayLayout2f1f2i16",T);class n extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,p,v,E,A){const M=this.length;return this.resize(M+1),this.emplace(M,r,o,p,v,E,A)}emplace(r,o,p,v,E,A,M){const z=16*r,F=4*r,q=8*r;return this.uint8[z+0]=o,this.uint8[z+1]=p,this.float32[F+1]=v,this.float32[F+2]=E,this.int16[q+6]=A,this.int16[q+7]=M,r}}n.prototype.bytesPerElement=16,Yt("StructArrayLayout2ub2f2i16",n);class u extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,p){const v=this.length;return this.resize(v+1),this.emplace(v,r,o,p)}emplace(r,o,p,v){const E=3*r;return this.uint16[E+0]=o,this.uint16[E+1]=p,this.uint16[E+2]=v,r}}u.prototype.bytesPerElement=6,Yt("StructArrayLayout3ui6",u);class g extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,p,v,E,A,M,z,F,q,W,te,ie,re,oe,pe,Te){const He=this.length;return this.resize(He+1),this.emplace(He,r,o,p,v,E,A,M,z,F,q,W,te,ie,re,oe,pe,Te)}emplace(r,o,p,v,E,A,M,z,F,q,W,te,ie,re,oe,pe,Te,He){const Le=24*r,Be=12*r,ot=48*r;return this.int16[Le+0]=o,this.int16[Le+1]=p,this.uint16[Le+2]=v,this.uint16[Le+3]=E,this.uint32[Be+2]=A,this.uint32[Be+3]=M,this.uint32[Be+4]=z,this.uint16[Le+10]=F,this.uint16[Le+11]=q,this.uint16[Le+12]=W,this.float32[Be+7]=te,this.float32[Be+8]=ie,this.uint8[ot+36]=re,this.uint8[ot+37]=oe,this.uint8[ot+38]=pe,this.uint32[Be+10]=Te,this.int16[Le+22]=He,r}}g.prototype.bytesPerElement=48,Yt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",g);class b extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,p,v,E,A,M,z,F,q,W,te,ie,re,oe,pe,Te,He,Le,Be,ot,gt,It,$t,Bt,Gt,dn,qt){const jt=this.length;return this.resize(jt+1),this.emplace(jt,r,o,p,v,E,A,M,z,F,q,W,te,ie,re,oe,pe,Te,He,Le,Be,ot,gt,It,$t,Bt,Gt,dn,qt)}emplace(r,o,p,v,E,A,M,z,F,q,W,te,ie,re,oe,pe,Te,He,Le,Be,ot,gt,It,$t,Bt,Gt,dn,qt,jt){const St=32*r,Sn=16*r;return this.int16[St+0]=o,this.int16[St+1]=p,this.int16[St+2]=v,this.int16[St+3]=E,this.int16[St+4]=A,this.int16[St+5]=M,this.int16[St+6]=z,this.int16[St+7]=F,this.uint16[St+8]=q,this.uint16[St+9]=W,this.uint16[St+10]=te,this.uint16[St+11]=ie,this.uint16[St+12]=re,this.uint16[St+13]=oe,this.uint16[St+14]=pe,this.uint16[St+15]=Te,this.uint16[St+16]=He,this.uint16[St+17]=Le,this.uint16[St+18]=Be,this.uint16[St+19]=ot,this.uint16[St+20]=gt,this.uint16[St+21]=It,this.uint16[St+22]=$t,this.uint32[Sn+12]=Bt,this.float32[Sn+13]=Gt,this.float32[Sn+14]=dn,this.uint16[St+30]=qt,this.uint16[St+31]=jt,r}}b.prototype.bytesPerElement=64,Yt("StructArrayLayout8i15ui1ul2f2ui64",b);class S extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const o=this.length;return this.resize(o+1),this.emplace(o,r)}emplace(r,o){return this.float32[1*r+0]=o,r}}S.prototype.bytesPerElement=4,Yt("StructArrayLayout1f4",S);class I extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,p){const v=this.length;return this.resize(v+1),this.emplace(v,r,o,p)}emplace(r,o,p,v){const E=3*r;return this.uint16[6*r+0]=o,this.float32[E+1]=p,this.float32[E+2]=v,r}}I.prototype.bytesPerElement=12,Yt("StructArrayLayout1ui2f12",I);class O extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,p){const v=this.length;return this.resize(v+1),this.emplace(v,r,o,p)}emplace(r,o,p,v){const E=4*r;return this.uint32[2*r+0]=o,this.uint16[E+2]=p,this.uint16[E+3]=v,r}}O.prototype.bytesPerElement=8,Yt("StructArrayLayout1ul2ui8",O);class N extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o){const p=this.length;return this.resize(p+1),this.emplace(p,r,o)}emplace(r,o,p){const v=2*r;return this.uint16[v+0]=o,this.uint16[v+1]=p,r}}N.prototype.bytesPerElement=4,Yt("StructArrayLayout2ui4",N);class j extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const o=this.length;return this.resize(o+1),this.emplace(o,r)}emplace(r,o){return this.uint16[1*r+0]=o,r}}j.prototype.bytesPerElement=2,Yt("StructArrayLayout1ui2",j);class $ extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,p,v){const E=this.length;return this.resize(E+1),this.emplace(E,r,o,p,v)}emplace(r,o,p,v,E){const A=4*r;return this.float32[A+0]=o,this.float32[A+1]=p,this.float32[A+2]=v,this.float32[A+3]=E,r}}$.prototype.bytesPerElement=16,Yt("StructArrayLayout4f16",$);class X extends Cs{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new C(this.anchorPointX,this.anchorPointY)}}X.prototype.size=20;class H extends nu{get(r){return new X(this,r)}}Yt("CollisionBoxArray",H);class J extends Cs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(r){this._structArray.uint8[this._pos1+37]=r}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(r){this._structArray.uint8[this._pos1+38]=r}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(r){this._structArray.uint32[this._pos4+10]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}J.prototype.size=48;class ae extends g{get(r){return new J(this,r)}}Yt("PlacedSymbolArray",ae);class _e extends Cs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(r){this._structArray.uint32[this._pos4+12]=r}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}_e.prototype.size=64;class me extends b{get(r){return new _e(this,r)}}Yt("SymbolInstanceArray",me);class ve extends S{getoffsetX(r){return this.float32[1*r+0]}}Yt("GlyphOffsetArray",ve);class we extends Wa{getx(r){return this.int16[3*r+0]}gety(r){return this.int16[3*r+1]}gettileUnitDistanceFromAnchor(r){return this.int16[3*r+2]}}Yt("SymbolLineVertexArray",we);class Me extends Cs{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Me.prototype.size=12;class Ee extends I{get(r){return new Me(this,r)}}Yt("TextAnchorOffsetArray",Ee);class ze extends Cs{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ze.prototype.size=8;class Ve extends O{get(r){return new ze(this,r)}}Yt("FeatureIndexArray",Ve);class Ie extends Uo{}class Ye extends Uo{}class ct extends Uo{}class rt extends Au{}class st extends eo{}class lt extends Gn{}class Nt extends ji{}class Ft extends Tr{}class Ct extends bh{}class ln extends cc{}class Zn extends xh{}class bi extends n{}class Yi extends u{}class qi extends N{}const Pr=Br([{name:"a_pos",components:2,type:"Int16"}],4),{members:Fr}=Pr;class jn{constructor(r=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=r}prepareSegment(r,o,p,v){const E=this.segments[this.segments.length-1];return r>jn.MAX_VERTEX_ARRAY_LENGTH&&Pi(`Max vertices per segment is ${jn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${jn.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!E||E.vertexLength+r>jn.MAX_VERTEX_ARRAY_LENGTH||E.sortKey!==v?this.createNewSegment(o,p,v):E}createNewSegment(r,o,p){const v={vertexOffset:r.length,primitiveOffset:o.length,vertexLength:0,primitiveLength:0,vaos:{}};return p!==void 0&&(v.sortKey=p),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(v),v}getOrCreateLatestSegment(r,o,p){return this.prepareSegment(0,r,o,p)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const r of this.segments)for(const o in r.vaos)r.vaos[o].destroy()}static simpleSegment(r,o,p,v){return new jn([{vertexOffset:r,primitiveOffset:o,vertexLength:p,primitiveLength:v,vaos:{},sortKey:0}])}}function ur(l,r){return 256*(l=Wt(Math.floor(l),0,255))+Wt(Math.floor(r),0,255)}jn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Yt("SegmentVector",jn);const sa=Br([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Vr,La,Xa,fo={exports:{}},Cu={exports:{}},iu={exports:{}},wh=(function(){if(Xa)return fo.exports;Xa=1;var l=(Vr||(Vr=1,Cu.exports=function(o,p){var v,E,A,M,z,F,q,W;for(E=o.length-(v=3&o.length),A=p,z=3432918353,F=461845907,W=0;W<E;)q=255&o.charCodeAt(W)|(255&o.charCodeAt(++W))<<8|(255&o.charCodeAt(++W))<<16|(255&o.charCodeAt(++W))<<24,++W,A=27492+(65535&(M=5*(65535&(A=(A^=q=(65535&(q=(q=(65535&q)*z+(((q>>>16)*z&65535)<<16)&4294967295)<<15|q>>>17))*F+(((q>>>16)*F&65535)<<16)&4294967295)<<13|A>>>19))+((5*(A>>>16)&65535)<<16)&4294967295))+((58964+(M>>>16)&65535)<<16);switch(q=0,v){case 3:q^=(255&o.charCodeAt(W+2))<<16;case 2:q^=(255&o.charCodeAt(W+1))<<8;case 1:A^=q=(65535&(q=(q=(65535&(q^=255&o.charCodeAt(W)))*z+(((q>>>16)*z&65535)<<16)&4294967295)<<15|q>>>17))*F+(((q>>>16)*F&65535)<<16)&4294967295}return A^=o.length,A=2246822507*(65535&(A^=A>>>16))+((2246822507*(A>>>16)&65535)<<16)&4294967295,A=3266489909*(65535&(A^=A>>>13))+((3266489909*(A>>>16)&65535)<<16)&4294967295,(A^=A>>>16)>>>0}),Cu.exports),r=(La||(La=1,iu.exports=function(o,p){for(var v,E=o.length,A=p^E,M=0;E>=4;)v=1540483477*(65535&(v=255&o.charCodeAt(M)|(255&o.charCodeAt(++M))<<8|(255&o.charCodeAt(++M))<<16|(255&o.charCodeAt(++M))<<24))+((1540483477*(v>>>16)&65535)<<16),A=1540483477*(65535&A)+((1540483477*(A>>>16)&65535)<<16)^(v=1540483477*(65535&(v^=v>>>24))+((1540483477*(v>>>16)&65535)<<16)),E-=4,++M;switch(E){case 3:A^=(255&o.charCodeAt(M+2))<<16;case 2:A^=(255&o.charCodeAt(M+1))<<8;case 1:A=1540483477*(65535&(A^=255&o.charCodeAt(M)))+((1540483477*(A>>>16)&65535)<<16)}return A=1540483477*(65535&(A^=A>>>13))+((1540483477*(A>>>16)&65535)<<16),(A^=A>>>15)>>>0}),iu.exports);return fo.exports=l,fo.exports.murmur3=l,fo.exports.murmur2=r,fo.exports})(),qc=k(wh);class hc{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(r,o,p,v){this.ids.push(dc(r)),this.positions.push(o,p,v)}getPositions(r){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const o=dc(r);let p=0,v=this.ids.length-1;for(;p<v;){const A=p+v>>1;this.ids[A]>=o?v=A:p=A+1}const E=[];for(;this.ids[p]===o;)E.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return E}static serialize(r,o){const p=new Float64Array(r.ids),v=new Uint32Array(r.positions);return to(p,v,0,p.length-1),o&&o.push(p.buffer,v.buffer),{ids:p,positions:v}}static deserialize(r){const o=new hc;return o.ids=r.ids,o.positions=r.positions,o.indexed=!0,o}}function dc(l){const r=+l;return!isNaN(r)&&r<=Number.MAX_SAFE_INTEGER?r:qc(String(l))}function to(l,r,o,p){for(;o<p;){const v=l[o+p>>1];let E=o-1,A=p+1;for(;;){do E++;while(l[E]<v);do A--;while(l[A]>v);if(E>=A)break;_l(l,E,A),_l(r,3*E,3*A),_l(r,3*E+1,3*A+1),_l(r,3*E+2,3*A+2)}A-o<p-A?(to(l,r,o,A),o=A+1):(to(l,r,A+1,p),p=A)}}function _l(l,r,o){const p=l[r];l[r]=l[o],l[o]=p}Yt("FeaturePositionMap",hc);class ss{constructor(r,o){this.gl=r.gl,this.location=o}}class Iu extends ss{constructor(r,o){super(r,o),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))}}class oa extends ss{constructor(r,o){super(r,o),this.current=[0,0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))}}class la extends ss{constructor(r,o){super(r,o),this.current=Ln.transparent}set(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))}}const jo=new Float32Array(16);function ua(l){return[ur(255*l.r,255*l.g),ur(255*l.b,255*l.a)]}class hd{constructor(r,o,p){this.value=r,this.uniformNames=o.map((v=>`u_${v}`)),this.type=p}setUniform(r,o,p){r.set(p.constantOr(this.value))}getBinding(r,o,p){return this.type==="color"?new la(r,o):new Iu(r,o)}}class fc{constructor(r,o){this.uniformNames=o.map((p=>`u_${p}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(r,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=r.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=r.tlbr}setUniform(r,o,p,v){const E=v==="u_pattern_to"?this.patternTo:v==="u_pattern_from"?this.patternFrom:v==="u_pixel_ratio_to"?this.pixelRatioTo:v==="u_pixel_ratio_from"?this.pixelRatioFrom:null;E&&r.set(E)}getBinding(r,o,p){return p.substr(0,9)==="u_pattern"?new oa(r,o):new Iu(r,o)}}class ru{constructor(r,o,p,v){this.expression=r,this.type=p,this.maxValue=0,this.paintVertexAttributes=o.map((E=>({name:`a_${E}`,type:"Float32",components:p==="color"?2:1,offset:0}))),this.paintVertexArray=new v}populatePaintArray(r,o,p,v,E){const A=this.paintVertexArray.length,M=this.expression.evaluate(new Di(0),o,{},v,[],E);this.paintVertexArray.resize(r),this._setPaintValue(A,r,M)}updatePaintArray(r,o,p,v){const E=this.expression.evaluate({zoom:0},p,v);this._setPaintValue(r,o,E)}_setPaintValue(r,o,p){if(this.type==="color"){const v=ua(p);for(let E=r;E<o;E++)this.paintVertexArray.emplace(E,v[0],v[1])}else{for(let v=r;v<o;v++)this.paintVertexArray.emplace(v,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class yl{constructor(r,o,p,v,E,A){this.expression=r,this.uniformNames=o.map((M=>`u_${M}_t`)),this.type=p,this.useIntegerZoom=v,this.zoom=E,this.maxValue=0,this.paintVertexAttributes=o.map((M=>({name:`a_${M}`,type:"Float32",components:p==="color"?4:2,offset:0}))),this.paintVertexArray=new A}populatePaintArray(r,o,p,v,E){const A=this.expression.evaluate(new Di(this.zoom),o,{},v,[],E),M=this.expression.evaluate(new Di(this.zoom+1),o,{},v,[],E),z=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(z,r,A,M)}updatePaintArray(r,o,p,v){const E=this.expression.evaluate({zoom:this.zoom},p,v),A=this.expression.evaluate({zoom:this.zoom+1},p,v);this._setPaintValue(r,o,E,A)}_setPaintValue(r,o,p,v){if(this.type==="color"){const E=ua(p),A=ua(v);for(let M=r;M<o;M++)this.paintVertexArray.emplace(M,E[0],E[1],A[0],A[1])}else{for(let E=r;E<o;E++)this.paintVertexArray.emplace(E,p,v);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(v))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,o){const p=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,v=Wt(this.expression.interpolationFactor(p,this.zoom,this.zoom+1),0,1);r.set(v)}getBinding(r,o,p){return new Iu(r,o)}}class au{constructor(r,o,p,v,E,A){this.expression=r,this.type=o,this.useIntegerZoom=p,this.zoom=v,this.layerId=A,this.zoomInPaintVertexArray=new E,this.zoomOutPaintVertexArray=new E}populatePaintArray(r,o,p){const v=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(r),this.zoomOutPaintVertexArray.resize(r),this._setPaintValues(v,r,o.patterns&&o.patterns[this.layerId],p)}updatePaintArray(r,o,p,v,E){this._setPaintValues(r,o,p.patterns&&p.patterns[this.layerId],E)}_setPaintValues(r,o,p,v){if(!v||!p)return;const{min:E,mid:A,max:M}=p,z=v[E],F=v[A],q=v[M];if(z&&F&&q)for(let W=r;W<o;W++)this.zoomInPaintVertexArray.emplace(W,F.tl[0],F.tl[1],F.br[0],F.br[1],z.tl[0],z.tl[1],z.br[0],z.br[1],F.pixelRatio,z.pixelRatio),this.zoomOutPaintVertexArray.emplace(W,F.tl[0],F.tl[1],F.br[0],F.br[1],q.tl[0],q.tl[1],q.br[0],q.br[1],F.pixelRatio,q.pixelRatio)}upload(r){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=r.createVertexBuffer(this.zoomInPaintVertexArray,sa.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=r.createVertexBuffer(this.zoomOutPaintVertexArray,sa.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Xf{constructor(r,o,p){this.binders={},this._buffers=[];const v=[];for(const E in r.paint._values){if(!p(E))continue;const A=r.paint.get(E);if(!(A instanceof gl&&dl(A.property.specification)))continue;const M=om(E,r.type),z=A.value,F=A.property.specification.type,q=A.property.useIntegerZoom,W=A.property.specification["property-type"],te=W==="cross-faded"||W==="cross-faded-data-driven";if(z.kind==="constant")this.binders[E]=te?new fc(z.value,M):new hd(z.value,M,F),v.push(`/u_${E}`);else if(z.kind==="source"||te){const ie=Kf(E,F,"source");this.binders[E]=te?new au(z,F,q,o,ie,r.id):new ru(z,M,F,ie),v.push(`/a_${E}`)}else{const ie=Kf(E,F,"composite");this.binders[E]=new yl(z,M,F,q,o,ie),v.push(`/z_${E}`)}}this.cacheKey=v.sort().join("")}getMaxValue(r){const o=this.binders[r];return o instanceof ru||o instanceof yl?o.maxValue:0}populatePaintArrays(r,o,p,v,E){for(const A in this.binders){const M=this.binders[A];(M instanceof ru||M instanceof yl||M instanceof au)&&M.populatePaintArray(r,o,p,v,E)}}setConstantPatternPositions(r,o){for(const p in this.binders){const v=this.binders[p];v instanceof fc&&v.setConstantPatternPositions(r,o)}}updatePaintArrays(r,o,p,v,E){let A=!1;for(const M in r){const z=o.getPositions(M);for(const F of z){const q=p.feature(F.index);for(const W in this.binders){const te=this.binders[W];if((te instanceof ru||te instanceof yl||te instanceof au)&&te.expression.isStateDependent===!0){const ie=v.paint.get(W);te.expression=ie.value,te.updatePaintArray(F.start,F.end,q,r[M],E),A=!0}}}}return A}defines(){const r=[];for(const o in this.binders){const p=this.binders[o];(p instanceof hd||p instanceof fc)&&r.push(...p.uniformNames.map((v=>`#define HAS_UNIFORM_${v}`)))}return r}getBinderAttributes(){const r=[];for(const o in this.binders){const p=this.binders[o];if(p instanceof ru||p instanceof yl)for(let v=0;v<p.paintVertexAttributes.length;v++)r.push(p.paintVertexAttributes[v].name);else if(p instanceof au)for(let v=0;v<sa.members.length;v++)r.push(sa.members[v].name)}return r}getBinderUniforms(){const r=[];for(const o in this.binders){const p=this.binders[o];if(p instanceof hd||p instanceof fc||p instanceof yl)for(const v of p.uniformNames)r.push(v)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r,o){const p=[];for(const v in this.binders){const E=this.binders[v];if(E instanceof hd||E instanceof fc||E instanceof yl){for(const A of E.uniformNames)if(o[A]){const M=E.getBinding(r,o[A],A);p.push({name:A,property:v,binding:M})}}}return p}setUniforms(r,o,p,v){for(const{name:E,property:A,binding:M}of o)this.binders[A].setUniform(M,v,p.get(A),E)}updatePaintBuffers(r){this._buffers=[];for(const o in this.binders){const p=this.binders[o];if(r&&p instanceof au){const v=r.fromScale===2?p.zoomInPaintVertexBuffer:p.zoomOutPaintVertexBuffer;v&&this._buffers.push(v)}else(p instanceof ru||p instanceof yl)&&p.paintVertexBuffer&&this._buffers.push(p.paintVertexBuffer)}}upload(r){for(const o in this.binders){const p=this.binders[o];(p instanceof ru||p instanceof yl||p instanceof au)&&p.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const o=this.binders[r];(o instanceof ru||o instanceof yl||o instanceof au)&&o.destroy()}}}class po{constructor(r,o,p=()=>!0){this.programConfigurations={};for(const v of r)this.programConfigurations[v.id]=new Xf(v,o,p);this.needsUpload=!1,this._featureMap=new hc,this._bufferOffset=0}populatePaintArrays(r,o,p,v,E,A){for(const M in this.programConfigurations)this.programConfigurations[M].populatePaintArrays(r,o,v,E,A);o.id!==void 0&&this._featureMap.add(o.id,p,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,o,p,v){for(const E of p)this.needsUpload=this.programConfigurations[E.id].updatePaintArrays(r,this._featureMap,o,E,v)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}function om(l,r){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[l]||[l.replace(`${r}-`,"").replace(/-/g,"_")]}function Kf(l,r,o){const p={color:{source:Gn,composite:$},number:{source:S,composite:Gn}},v=(function(E){return{"line-pattern":{source:Nt,composite:Nt},"fill-pattern":{source:Nt,composite:Nt},"fill-extrusion-pattern":{source:Nt,composite:Nt}}[E]})(l);return v&&v[o]||p[r][o]}Yt("ConstantBinder",hd),Yt("CrossFadedConstantBinder",fc),Yt("SourceExpressionBinder",ru),Yt("CrossFadedCompositeBinder",au),Yt("CompositeExpressionBinder",yl),Yt("ProgramConfiguration",Xf,{omit:["_buffers"]}),Yt("ProgramConfigurationSet",po);const dd=Math.pow(2,14)-1,pc=-dd-1;function su(l){const r=Zt/l.extent,o=l.loadGeometry();for(let p=0;p<o.length;p++){const v=o[p];for(let E=0;E<v.length;E++){const A=v[E],M=Math.round(A.x*r),z=Math.round(A.y*r);A.x=Wt(M,pc,dd),A.y=Wt(z,pc,dd),(M<A.x||M>A.x+1||z<A.y||z>A.y+1)&&Pi("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return o}function vl(l,r){return{type:l.type,id:l.id,properties:l.properties,geometry:r?su(l):[]}}const Lg=-32768;function jy(l,r,o,p,v){l.emplaceBack(Lg+8*r+p,Lg+8*o+v)}class fd{constructor(r){this.zoom=r.zoom,this.globalState=r.globalState,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((o=>o.id)),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new Ye,this.indexArray=new Yi,this.segments=new jn,this.programConfigurations=new po(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id))}populate(r,o,p){const v=this.layers[0],E=[];let A=null,M=!1,z=v.type==="heatmap";if(v.type==="circle"){const q=v;A=q.layout.get("circle-sort-key"),M=!A.isConstant(),z=z||q.paint.get("circle-pitch-alignment")==="map"}const F=z?o.subdivisionGranularity.circle:1;for(const{feature:q,id:W,index:te,sourceLayerIndex:ie}of r){const re=this.layers[0]._featureFilter.needGeometry,oe=vl(q,re);if(!this.layers[0]._featureFilter.filter(new Di(this.zoom,{globalState:this.globalState}),oe,p))continue;const pe=M?A.evaluate(oe,{},p):void 0,Te={id:W,properties:q.properties,type:q.type,sourceLayerIndex:ie,index:te,geometry:re?oe.geometry:su(q),patterns:{},sortKey:pe};E.push(Te)}M&&E.sort(((q,W)=>q.sortKey-W.sortKey));for(const q of E){const{geometry:W,index:te,sourceLayerIndex:ie}=q,re=r[te].feature;this.addFeature(q,W,te,p,F),o.featureIndex.insert(re,W,te,ie,this.index)}}update(r,o,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,o,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Fr),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,o,p,v,E=1){let A;switch(E){case 1:A=[0,7];break;case 3:A=[0,2,5,7];break;case 5:A=[0,1,3,4,6,7];break;case 7:A=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${E}; valid values are 1, 3, 5, 7.`)}const M=A.length;for(const z of o)for(const F of z){const q=F.x,W=F.y;if(q<0||q>=Zt||W<0||W>=Zt)continue;const te=this.segments.prepareSegment(M*M,this.layoutVertexArray,this.indexArray,r.sortKey),ie=te.vertexLength;for(let re=0;re<M;re++)for(let oe=0;oe<M;oe++)jy(this.layoutVertexArray,q,W,A[oe],A[re]);for(let re=0;re<M-1;re++)for(let oe=0;oe<M-1;oe++){const pe=ie+re*M+oe,Te=ie+(re+1)*M+oe;this.indexArray.emplaceBack(pe,Te+1,pe+1),this.indexArray.emplaceBack(pe,Te,Te+1)}te.vertexLength+=M*M,te.primitiveLength+=(M-1)*(M-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,p,{},v)}}function kg(l,r){for(let o=0;o<l.length;o++)if(pd(r,l[o]))return!0;for(let o=0;o<r.length;o++)if(pd(l,r[o]))return!0;return!!Yf(l,r)}function Dg(l,r,o){return!!pd(l,r)||!!lm(r,l,o)}function zg(l,r){if(l.length===1)return Ng(r,l[0]);for(let o=0;o<r.length;o++){const p=r[o];for(let v=0;v<p.length;v++)if(pd(l,p[v]))return!0}for(let o=0;o<l.length;o++)if(Ng(r,l[o]))return!0;for(let o=0;o<r.length;o++)if(Yf(l,r[o]))return!0;return!1}function Og(l,r,o){if(l.length>1){if(Yf(l,r))return!0;for(let p=0;p<r.length;p++)if(lm(r[p],l,o))return!0}for(let p=0;p<l.length;p++)if(lm(l[p],r,o))return!0;return!1}function Yf(l,r){if(l.length===0||r.length===0)return!1;for(let o=0;o<l.length-1;o++){const p=l[o],v=l[o+1];for(let E=0;E<r.length-1;E++)if(qy(p,v,r[E],r[E+1]))return!0}return!1}function qy(l,r,o,p){return Va(l,o,p)!==Va(r,o,p)&&Va(l,r,o)!==Va(l,r,p)}function lm(l,r,o){const p=o*o;if(r.length===1)return l.distSqr(r[0])<p;for(let v=1;v<r.length;v++)if(Th(l,r[v-1],r[v])<p)return!0;return!1}function Th(l,r,o){const p=r.distSqr(o);if(p===0)return l.distSqr(r);const v=((l.x-r.x)*(o.x-r.x)+(l.y-r.y)*(o.y-r.y))/p;return l.distSqr(v<0?r:v>1?o:o.sub(r)._mult(v)._add(r))}function Ng(l,r){let o,p,v,E=!1;for(let A=0;A<l.length;A++){o=l[A];for(let M=0,z=o.length-1;M<o.length;z=M++)p=o[M],v=o[z],p.y>r.y!=v.y>r.y&&r.x<(v.x-p.x)*(r.y-p.y)/(v.y-p.y)+p.x&&(E=!E)}return E}function pd(l,r){let o=!1;for(let p=0,v=l.length-1;p<l.length;v=p++){const E=l[p],A=l[v];E.y>r.y!=A.y>r.y&&r.x<(A.x-E.x)*(r.y-E.y)/(A.y-E.y)+E.x&&(o=!o)}return o}function $y(l,r,o){const p=o[0],v=o[2];if(l.x<p.x&&r.x<p.x||l.x>v.x&&r.x>v.x||l.y<p.y&&r.y<p.y||l.y>v.y&&r.y>v.y)return!1;const E=Va(l,r,o[0]);return E!==Va(l,r,o[1])||E!==Va(l,r,o[2])||E!==Va(l,r,o[3])}function Sh(l,r,o){const p=r.paint.get(l).value;return p.kind==="constant"?p.value:o.programConfigurations.get(r.id).getMaxValue(l)}function Qf(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function Jd(l,r,o,p,v){if(!r[0]&&!r[1])return l;const E=C.convert(r)._mult(v);o==="viewport"&&E._rotate(-p);const A=[];for(let M=0;M<l.length;M++)A.push(l[M].sub(E));return A}let Bg,Fg;Yt("CircleBucket",fd,{omit:["layers"]});var Mb={get paint(){return Fg=Fg||new As({"circle-radius":new Tn(qe.paint_circle["circle-radius"]),"circle-color":new Tn(qe.paint_circle["circle-color"]),"circle-blur":new Tn(qe.paint_circle["circle-blur"]),"circle-opacity":new Tn(qe.paint_circle["circle-opacity"]),"circle-translate":new an(qe.paint_circle["circle-translate"]),"circle-translate-anchor":new an(qe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new an(qe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new an(qe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Tn(qe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Tn(qe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Tn(qe.paint_circle["circle-stroke-opacity"])})},get layout(){return Bg=Bg||new As({"circle-sort-key":new Tn(qe.layout_circle["circle-sort-key"])})}};class Vg extends ho{constructor(r){super(r,Mb)}createBucket(r){return new fd(r)}queryRadius(r){const o=r;return Sh("circle-radius",this,o)+Sh("circle-stroke-width",this,o)+Qf(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:r,feature:o,featureState:p,geometry:v,transform:E,pixelsToTileUnits:A,unwrappedTileID:M,getElevation:z}){const F=Jd(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-E.bearingInRadians,A),q=this.paint.get("circle-radius").evaluate(o,p)+this.paint.get("circle-stroke-width").evaluate(o,p),W=this.paint.get("circle-pitch-alignment")==="map",te=W?F:(function(re,oe,pe,Te){return re.map((He=>ka(He,oe,pe,Te)))})(F,E,M,z),ie=W?q*A:q;for(const re of v)for(const oe of re){const pe=W?oe:ka(oe,E,M,z);let Te=ie;const He=E.projectTileCoordinates(oe.x,oe.y,M,z).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Te*=He/E.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Te*=E.cameraToCenterDistance/He),Dg(te,pe,Te))return!0}return!1}}function ka(l,r,o,p){const v=r.projectTileCoordinates(l.x,l.y,o,p).point;return new C((.5*v.x+.5)*r.width,(.5*-v.y+.5)*r.height)}class Is extends fd{}let Ug;Yt("HeatmapBucket",Is,{omit:["layers"]});var Gy={get paint(){return Ug=Ug||new As({"heatmap-radius":new Tn(qe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Tn(qe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new an(qe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new jc(qe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new an(qe.paint_heatmap["heatmap-opacity"])})}};function um(l,{width:r,height:o},p,v){if(v){if(v instanceof Uint8ClampedArray)v=new Uint8Array(v.buffer);else if(v.length!==r*o*p)throw new RangeError(`mismatched image size. expected: ${v.length} but got: ${r*o*p}`)}else v=new Uint8Array(r*o*p);return l.width=r,l.height=o,l.data=v,l}function jg(l,{width:r,height:o},p){if(r===l.width&&o===l.height)return;const v=um({},{width:r,height:o},p);md(l,v,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,r),height:Math.min(l.height,o)},p),l.width=r,l.height=o,l.data=v.data}function md(l,r,o,p,v,E){if(v.width===0||v.height===0)return r;if(v.width>l.width||v.height>l.height||o.x>l.width-v.width||o.y>l.height-v.height)throw new RangeError("out of range source coordinates for image copy");if(v.width>r.width||v.height>r.height||p.x>r.width-v.width||p.y>r.height-v.height)throw new RangeError("out of range destination coordinates for image copy");const A=l.data,M=r.data;if(A===M)throw new Error("srcData equals dstData, so image is already copied");for(let z=0;z<v.height;z++){const F=((o.y+z)*l.width+o.x)*E,q=((p.y+z)*r.width+p.x)*E;for(let W=0;W<v.width*E;W++)M[q+W]=A[F+W]}return r}class ef{constructor(r,o){um(this,r,1,o)}resize(r){jg(this,r,1)}clone(){return new ef({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,o,p,v,E){md(r,o,p,v,E,1)}}class Ms{constructor(r,o){um(this,r,4,o)}resize(r){jg(this,r,4)}replace(r,o){o?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new Ms({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,o,p,v,E){md(r,o,p,v,E,4)}setPixel(r,o,p){const v=4*(r*this.width+o);this.data[v+0]=Math.round(255*p.r/p.a),this.data[v+1]=Math.round(255*p.g/p.a),this.data[v+2]=Math.round(255*p.b/p.a),this.data[v+3]=Math.round(255*p.a)}}function qg(l){const r={},o=l.resolution||256,p=l.clips?l.clips.length:1,v=l.image||new Ms({width:o,height:p});if(Math.log(o)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${o}`);const E=(A,M,z)=>{r[l.evaluationKey]=z;const F=l.expression.evaluate(r);v.setPixel(A/4/o,M/4,F)};if(l.clips)for(let A=0,M=0;A<p;++A,M+=4*o)for(let z=0,F=0;z<o;z++,F+=4){const q=z/(o-1),{start:W,end:te}=l.clips[A];E(M,F,W*(1-q)+te*q)}else for(let A=0,M=0;A<o;A++,M+=4)E(0,M,A/(o-1));return v}Yt("AlphaImage",ef),Yt("RGBAImage",Ms);const $g="big-fb";class cm extends ho{createBucket(r){return new Is(r)}constructor(r){super(r,Gy),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=qg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has($g)&&this.heatmapFbos.delete($g)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let hm;var Zy={get paint(){return hm=hm||new As({"hillshade-illumination-direction":new an(qe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new an(qe.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new an(qe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new an(qe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new an(qe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new an(qe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new an(qe.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new an(qe.paint_hillshade["hillshade-method"])})}};class Hy extends ho{constructor(r){super(r,Zy),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let r=this.paint.get("hillshade-illumination-direction").values,o=this.paint.get("hillshade-illumination-altitude").values,p=this.paint.get("hillshade-highlight-color").values,v=this.paint.get("hillshade-shadow-color").values;const E=Math.max(r.length,o.length,p.length,v.length);r=r.concat(Array(E-r.length).fill(r.at(-1))),o=o.concat(Array(E-o.length).fill(o.at(-1))),p=p.concat(Array(E-p.length).fill(p.at(-1))),v=v.concat(Array(E-v.length).fill(v.at(-1)));const A=o.map(qr);return{directionRadians:r.map(qr),altitudeRadians:A,shadowColor:v,highlightColor:p}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let Gg;var Zg={get paint(){return Gg=Gg||new As({"color-relief-opacity":new an(qe["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new jc(qe["paint_color-relief"]["color-relief-color"])})}};class Jf{constructor(r,o,p,v){this.context=r,this.format=p,this.texture=r.gl.createTexture(),this.update(o,v)}update(r,o,p){const{width:v,height:E}=r,A=!(this.size&&this.size[0]===v&&this.size[1]===E||p),{context:M}=this,{gl:z}=M;if(this.useMipmap=!!(o&&o.useMipmap),z.bindTexture(z.TEXTURE_2D,this.texture),M.pixelStoreUnpackFlipY.set(!1),M.pixelStoreUnpack.set(1),M.pixelStoreUnpackPremultiplyAlpha.set(this.format===z.RGBA&&(!o||o.premultiply!==!1)),A)this.size=[v,E],r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||Sa(r)?z.texImage2D(z.TEXTURE_2D,0,this.format,this.format,z.UNSIGNED_BYTE,r):z.texImage2D(z.TEXTURE_2D,0,this.format,v,E,0,this.format,z.UNSIGNED_BYTE,r.data);else{const{x:F,y:q}=p||{x:0,y:0};r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||Sa(r)?z.texSubImage2D(z.TEXTURE_2D,0,F,q,z.RGBA,z.UNSIGNED_BYTE,r):z.texSubImage2D(z.TEXTURE_2D,0,F,q,v,E,z.RGBA,z.UNSIGNED_BYTE,r.data)}this.useMipmap&&this.isSizePowerOfTwo()&&z.generateMipmap(z.TEXTURE_2D),M.pixelStoreUnpackFlipY.setDefault(),M.pixelStoreUnpack.setDefault(),M.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(r,o,p){const{context:v}=this,{gl:E}=v;E.bindTexture(E.TEXTURE_2D,this.texture),p!==E.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(p=E.LINEAR),r!==this.filter&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,r),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,p||r),this.filter=r),o!==this.wrap&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_S,o),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}class dm{constructor(r,o,p,v=1,E=1,A=1,M=0){if(this.uid=r,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(p&&!["mapbox","terrarium","custom"].includes(p))return void Pi(`"${p}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=o.height;const z=this.dim=o.height-2;switch(this.data=new Uint32Array(o.data.buffer),p){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=v,this.greenFactor=E,this.blueFactor=A,this.baseShift=M;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let F=0;F<z;F++)this.data[this._idx(-1,F)]=this.data[this._idx(0,F)],this.data[this._idx(z,F)]=this.data[this._idx(z-1,F)],this.data[this._idx(F,-1)]=this.data[this._idx(F,0)],this.data[this._idx(F,z)]=this.data[this._idx(F,z-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(z,-1)]=this.data[this._idx(z-1,0)],this.data[this._idx(-1,z)]=this.data[this._idx(0,z-1)],this.data[this._idx(z,z)]=this.data[this._idx(z-1,z-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let F=0;F<z;F++)for(let q=0;q<z;q++){const W=this.get(F,q);W>this.max&&(this.max=W),W<this.min&&(this.min=W)}}get(r,o){const p=new Uint8Array(this.data.buffer),v=4*this._idx(r,o);return this.unpack(p[v],p[v+1],p[v+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(r,o){if(r<-1||r>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(r+1)}unpack(r,o,p){return r*this.redFactor+o*this.greenFactor+p*this.blueFactor-this.baseShift}pack(r){return Hg(r,this.getUnpackVector())}getPixels(){return new Ms({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(r,o,p){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let v=o*this.dim,E=o*this.dim+this.dim,A=p*this.dim,M=p*this.dim+this.dim;switch(o){case-1:v=E-1;break;case 1:E=v+1}switch(p){case-1:A=M-1;break;case 1:M=A+1}const z=-o*this.dim,F=-p*this.dim;for(let q=A;q<M;q++)for(let W=v;W<E;W++)this.data[this._idx(W,q)]=r.data[this._idx(W+z,q+F)]}}function Hg(l,r){const o=r[0],p=r[1],v=r[2],E=r[3],A=Math.min(o,p,v),M=Math.round((l+E)/A);return{r:Math.floor(M*A/o)%256,g:Math.floor(M*A/p)%256,b:Math.floor(M*A/v)%256}}Yt("DEMData",dm);class Wg extends ho{constructor(r){super(r,Zg)}_createColorRamp(r){const o={elevationStops:[],colorStops:[]},p=this._transitionablePaint._values["color-relief-color"].value.expression;if(p instanceof f&&p._styleExpression.expression instanceof lr){this.colorRampExpression=p;const A=p._styleExpression.expression;o.elevationStops=A.labels,o.colorStops=[];for(const M of o.elevationStops)o.colorStops.push(A.evaluate({globals:{elevation:M}}))}if(o.elevationStops.length<1&&(o.elevationStops=[0],o.colorStops=[Ln.transparent]),o.elevationStops.length<2&&(o.elevationStops.push(o.elevationStops[0]+1),o.colorStops.push(o.colorStops[0])),o.elevationStops.length<=r)return o;const v={elevationStops:[],colorStops:[]},E=(o.elevationStops.length-1)/(r-1);for(let A=0;A<o.elevationStops.length-.5;A+=E)v.elevationStops.push(o.elevationStops[Math.round(A)]),v.colorStops.push(o.colorStops[Math.round(A)]);return Pi(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),v}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(r,o,p){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const v=this._createColorRamp(o),E=new Ms({width:v.colorStops.length,height:1}),A=new Ms({width:v.colorStops.length,height:1});for(let M=0;M<v.elevationStops.length;M++){const z=Hg(v.elevationStops[M],p);A.setPixel(0,M,new Ln(z.r/255,z.g/255,z.b/255,1)),E.setPixel(0,M,v.colorStops[M])}return this.colorRampTextures={elevationTexture:new Jf(r,A,r.gl.RGBA),colorTexture:new Jf(r,E,r.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const fm=Br([{name:"a_pos",components:2,type:"Int16"}],4),{members:Xg}=fm;function pm(l,r,o){const p=o.patternDependencies;let v=!1;for(const E of r){const A=E.paint.get(`${l}-pattern`);A.isConstant()||(v=!0);const M=A.constantOr(null);M&&(v=!0,p[M.to]=!0,p[M.from]=!0)}return v}function ep(l,r,o,p,v){const E=v.patternDependencies;for(const A of r){const M=A.paint.get(`${l}-pattern`).value;if(M.kind!=="constant"){let z=M.evaluate({zoom:p-1},o,{},v.availableImages),F=M.evaluate({zoom:p},o,{},v.availableImages),q=M.evaluate({zoom:p+1},o,{},v.availableImages);z=z&&z.name?z.name:z,F=F&&F.name?F.name:F,q=q&&q.name?q.name:q,E[z]=!0,E[F]=!0,E[q]=!0,o.patterns[A.id]={min:z,mid:F,max:q}}}return o}function Kg(l,r,o,p,v){let E;if(v===(function(A,M,z,F){let q=0;for(let W=M,te=z-F;W<z;W+=F)q+=(A[te]-A[W])*(A[W+1]+A[te+1]),te=W;return q})(l,r,o,p)>0)for(let A=r;A<o;A+=p)E=Jg(A/p|0,l[A],l[A+1],E);else for(let A=o-p;A>=r;A-=p)E=Jg(A/p|0,l[A],l[A+1],E);return E&&_d(E,E.next)&&(yd(E),E=E.next),E}function qo(l,r){if(!l)return l;r||(r=l);let o,p=l;do if(o=!1,p.steiner||!_d(p,p.next)&&hr(p.prev,p,p.next)!==0)p=p.next;else{if(yd(p),p=r=p.prev,p===p.next)break;o=!0}while(o||p!==r);return r}function gd(l,r,o,p,v,E,A){if(!l)return;!A&&E&&(function(z,F,q,W){let te=z;do te.z===0&&(te.z=Rr(te.x,te.y,F,q,W)),te.prevZ=te.prev,te.nextZ=te.next,te=te.next;while(te!==z);te.prevZ.nextZ=null,te.prevZ=null,(function(ie){let re,oe=1;do{let pe,Te=ie;ie=null;let He=null;for(re=0;Te;){re++;let Le=Te,Be=0;for(let gt=0;gt<oe&&(Be++,Le=Le.nextZ,Le);gt++);let ot=oe;for(;Be>0||ot>0&&Le;)Be!==0&&(ot===0||!Le||Te.z<=Le.z)?(pe=Te,Te=Te.nextZ,Be--):(pe=Le,Le=Le.nextZ,ot--),He?He.nextZ=pe:ie=pe,pe.prevZ=He,He=pe;Te=Le}He.nextZ=null,oe*=2}while(re>1)})(te)})(l,p,v,E);let M=l;for(;l.prev!==l.next;){const z=l.prev,F=l.next;if(E?Wy(l,p,v,E):Pb(l))r.push(z.i,l.i,F.i),yd(l),l=F.next,M=F.next;else if((l=F)===M){A?A===1?gd(l=$c(qo(l),r),r,o,p,v,E,2):A===2&&Yg(l,r,o,p,v,E):gd(qo(l),r,o,p,v,E,1);break}}}function Pb(l){const r=l.prev,o=l,p=l.next;if(hr(r,o,p)>=0)return!1;const v=r.x,E=o.x,A=p.x,M=r.y,z=o.y,F=p.y,q=Math.min(v,E,A),W=Math.min(M,z,F),te=Math.max(v,E,A),ie=Math.max(M,z,F);let re=p.next;for(;re!==r;){if(re.x>=q&&re.x<=te&&re.y>=W&&re.y<=ie&&tf(v,M,E,z,A,F,re.x,re.y)&&hr(re.prev,re,re.next)>=0)return!1;re=re.next}return!0}function Wy(l,r,o,p){const v=l.prev,E=l,A=l.next;if(hr(v,E,A)>=0)return!1;const M=v.x,z=E.x,F=A.x,q=v.y,W=E.y,te=A.y,ie=Math.min(M,z,F),re=Math.min(q,W,te),oe=Math.max(M,z,F),pe=Math.max(q,W,te),Te=Rr(ie,re,r,o,p),He=Rr(oe,pe,r,o,p);let Le=l.prevZ,Be=l.nextZ;for(;Le&&Le.z>=Te&&Be&&Be.z<=He;){if(Le.x>=ie&&Le.x<=oe&&Le.y>=re&&Le.y<=pe&&Le!==v&&Le!==A&&tf(M,q,z,W,F,te,Le.x,Le.y)&&hr(Le.prev,Le,Le.next)>=0||(Le=Le.prevZ,Be.x>=ie&&Be.x<=oe&&Be.y>=re&&Be.y<=pe&&Be!==v&&Be!==A&&tf(M,q,z,W,F,te,Be.x,Be.y)&&hr(Be.prev,Be,Be.next)>=0))return!1;Be=Be.nextZ}for(;Le&&Le.z>=Te;){if(Le.x>=ie&&Le.x<=oe&&Le.y>=re&&Le.y<=pe&&Le!==v&&Le!==A&&tf(M,q,z,W,F,te,Le.x,Le.y)&&hr(Le.prev,Le,Le.next)>=0)return!1;Le=Le.prevZ}for(;Be&&Be.z<=He;){if(Be.x>=ie&&Be.x<=oe&&Be.y>=re&&Be.y<=pe&&Be!==v&&Be!==A&&tf(M,q,z,W,F,te,Be.x,Be.y)&&hr(Be.prev,Be,Be.next)>=0)return!1;Be=Be.nextZ}return!0}function $c(l,r){let o=l;do{const p=o.prev,v=o.next.next;!_d(p,v)&&Qg(p,o,o.next,v)&&nf(p,v)&&nf(v,p)&&(r.push(p.i,o.i,v.i),yd(o),yd(o.next),o=l=v),o=o.next}while(o!==l);return qo(o)}function Yg(l,r,o,p,v,E){let A=l;do{let M=A.next.next;for(;M!==A.prev;){if(A.i!==M.i&&np(A,M)){let z=gm(A,M);return A=qo(A,A.next),z=qo(z,z.next),gd(A,r,o,p,v,E,0),void gd(z,r,o,p,v,E,0)}M=M.next}A=A.next}while(A!==l)}function Xy(l,r){let o=l.x-r.x;return o===0&&(o=l.y-r.y,o===0)&&(o=(l.next.y-l.y)/(l.next.x-l.x)-(r.next.y-r.y)/(r.next.x-r.x)),o}function mm(l,r){const o=(function(v,E){let A=E;const M=v.x,z=v.y;let F,q=-1/0;if(_d(v,A))return A;do{if(_d(v,A.next))return A.next;if(z<=A.y&&z>=A.next.y&&A.next.y!==A.y){const oe=A.x+(z-A.y)*(A.next.x-A.x)/(A.next.y-A.y);if(oe<=M&&oe>q&&(q=oe,F=A.x<A.next.x?A:A.next,oe===M))return F}A=A.next}while(A!==E);if(!F)return null;const W=F,te=F.x,ie=F.y;let re=1/0;A=F;do{if(M>=A.x&&A.x>=te&&M!==A.x&&Ky(z<ie?M:q,z,te,ie,z<ie?q:M,z,A.x,A.y)){const oe=Math.abs(z-A.y)/(M-A.x);nf(A,v)&&(oe<re||oe===re&&(A.x>F.x||A.x===F.x&&tp(F,A)))&&(F=A,re=oe)}A=A.next}while(A!==W);return F})(l,r);if(!o)return r;const p=gm(o,l);return qo(p,p.next),qo(o,o.next)}function tp(l,r){return hr(l.prev,l,r.prev)<0&&hr(r.next,l,l.next)<0}function Rr(l,r,o,p,v){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-o)*v|0)|l<<8))|l<<4))|l<<2))|l<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-p)*v|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function Rb(l){let r=l,o=l;do(r.x<o.x||r.x===o.x&&r.y<o.y)&&(o=r),r=r.next;while(r!==l);return o}function Ky(l,r,o,p,v,E,A,M){return(v-A)*(r-M)>=(l-A)*(E-M)&&(l-A)*(p-M)>=(o-A)*(r-M)&&(o-A)*(E-M)>=(v-A)*(p-M)}function tf(l,r,o,p,v,E,A,M){return!(l===A&&r===M)&&Ky(l,r,o,p,v,E,A,M)}function np(l,r){return l.next.i!==r.i&&l.prev.i!==r.i&&!(function(o,p){let v=o;do{if(v.i!==o.i&&v.next.i!==o.i&&v.i!==p.i&&v.next.i!==p.i&&Qg(v,v.next,o,p))return!0;v=v.next}while(v!==o);return!1})(l,r)&&(nf(l,r)&&nf(r,l)&&(function(o,p){let v=o,E=!1;const A=(o.x+p.x)/2,M=(o.y+p.y)/2;do v.y>M!=v.next.y>M&&v.next.y!==v.y&&A<(v.next.x-v.x)*(M-v.y)/(v.next.y-v.y)+v.x&&(E=!E),v=v.next;while(v!==o);return E})(l,r)&&(hr(l.prev,l,r.prev)||hr(l,r.prev,r))||_d(l,r)&&hr(l.prev,l,l.next)>0&&hr(r.prev,r,r.next)>0)}function hr(l,r,o){return(r.y-l.y)*(o.x-r.x)-(r.x-l.x)*(o.y-r.y)}function _d(l,r){return l.x===r.x&&l.y===r.y}function Qg(l,r,o,p){const v=Nl(hr(l,r,o)),E=Nl(hr(l,r,p)),A=Nl(hr(o,p,l)),M=Nl(hr(o,p,r));return v!==E&&A!==M||!(v!==0||!Eh(l,o,r))||!(E!==0||!Eh(l,p,r))||!(A!==0||!Eh(o,l,p))||!(M!==0||!Eh(o,r,p))}function Eh(l,r,o){return r.x<=Math.max(l.x,o.x)&&r.x>=Math.min(l.x,o.x)&&r.y<=Math.max(l.y,o.y)&&r.y>=Math.min(l.y,o.y)}function Nl(l){return l>0?1:l<0?-1:0}function nf(l,r){return hr(l.prev,l,l.next)<0?hr(l,r,l.next)>=0&&hr(l,l.prev,r)>=0:hr(l,r,l.prev)<0||hr(l,l.next,r)<0}function gm(l,r){const o=ip(l.i,l.x,l.y),p=ip(r.i,r.x,r.y),v=l.next,E=r.prev;return l.next=r,r.prev=l,o.next=v,v.prev=o,p.next=o,o.prev=p,E.next=p,p.prev=E,p}function Jg(l,r,o,p){const v=ip(l,r,o);return p?(v.next=p.next,v.prev=p,p.next.prev=v,p.next=v):(v.prev=v,v.next=v),v}function yd(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function ip(l,r,o){return{i:l,x:r,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Gc{constructor(r,o){if(o>r)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=r,this._minGranularity=o}getGranularityForZoomLevel(r){return Math.max(Math.floor(this._baseZoomGranularity/(1<<r)),this._minGranularity,1)}}class rp{constructor(r){this.fill=r.fill,this.line=r.line,this.tile=r.tile,this.stencil=r.stencil,this.circle=r.circle}}rp.noSubdivision=new rp({fill:new Gc(0,0),line:new Gc(0,0),tile:new Gc(0,0),stencil:new Gc(0,0),circle:1}),Yt("SubdivisionGranularityExpression",Gc),Yt("SubdivisionGranularitySetting",rp);const bl=-32768,Qr=32767;class e_{constructor(r,o){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=r,this._granularityCellSize=Zt/r,this._canonical=o}_getKey(r,o){return(r+=32768)<<16|o+32768}_vertexToIndex(r,o){if(r<-32768||o<-32768||r>32767||o>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const p=0|Math.round(r),v=0|Math.round(o),E=this._getKey(p,v);if(this._vertexDictionary.has(E))return this._vertexDictionary.get(E);const A=this._vertexBuffer.length/2;return this._vertexDictionary.set(E,A),this._vertexBuffer.push(p,v),A}_subdivideTrianglesScanline(r){if(this._granularity<2)return(function(v,E){const A=[];for(let M=0;M<E.length;M+=3){const z=E[M],F=E[M+1],q=E[M+2],W=v[2*z],te=v[2*z+1];(v[2*F]-W)*(v[2*q+1]-te)-(v[2*F+1]-te)*(v[2*q]-W)>0?(A.push(z),A.push(q),A.push(F)):(A.push(z),A.push(F),A.push(q))}return A})(this._vertexBuffer,r);const o=[],p=r.length;for(let v=0;v<p;v+=3){const E=[r[v+0],r[v+1],r[v+2]],A=[this._vertexBuffer[2*r[v+0]+0],this._vertexBuffer[2*r[v+0]+1],this._vertexBuffer[2*r[v+1]+0],this._vertexBuffer[2*r[v+1]+1],this._vertexBuffer[2*r[v+2]+0],this._vertexBuffer[2*r[v+2]+1]];let M=1/0,z=1/0,F=-1/0,q=-1/0;for(let oe=0;oe<3;oe++){const pe=A[2*oe],Te=A[2*oe+1];M=Math.min(M,pe),F=Math.max(F,pe),z=Math.min(z,Te),q=Math.max(q,Te)}if(M===F||z===q)continue;const W=Math.floor(M/this._granularityCellSize),te=Math.ceil(F/this._granularityCellSize),ie=Math.floor(z/this._granularityCellSize),re=Math.ceil(q/this._granularityCellSize);if(W!==te||ie!==re)for(let oe=ie;oe<re;oe++){const pe=this._scanlineGenerateVertexRingForCellRow(oe,A,E);Lb(this._vertexBuffer,pe,o)}else o.push(...E)}return o}_scanlineGenerateVertexRingForCellRow(r,o,p){const v=r*this._granularityCellSize,E=v+this._granularityCellSize,A=[];for(let M=0;M<3;M++){const z=o[2*M],F=o[2*M+1],q=o[2*(M+1)%6],W=o[(2*(M+1)+1)%6],te=o[2*(M+2)%6],ie=o[(2*(M+2)+1)%6],re=q-z,oe=W-F,pe=re===0,Te=oe===0,He=(v-F)/oe,Le=(E-F)/oe,Be=Math.min(He,Le),ot=Math.max(He,Le);if(!Te&&(Be>=1||ot<=0)||Te&&(F<v||F>E)){W>=v&&W<=E&&A.push(p[(M+1)%3]);continue}!Te&&Be>0&&A.push(this._vertexToIndex(z+re*Be,F+oe*Be));const gt=z+re*Math.max(Be,0),It=z+re*Math.min(ot,1);pe||this._generateIntraEdgeVertices(A,z,F,q,W,gt,It),!Te&&ot<1&&A.push(this._vertexToIndex(z+re*ot,F+oe*ot)),(Te||W>=v&&W<=E)&&A.push(p[(M+1)%3]),!Te&&(W<=v||W>=E)&&this._generateInterEdgeVertices(A,z,F,q,W,te,ie,It,v,E)}return A}_generateIntraEdgeVertices(r,o,p,v,E,A,M){const z=v-o,F=E-p,q=F===0,W=q?Math.min(o,v):Math.min(A,M),te=q?Math.max(o,v):Math.max(A,M),ie=Math.floor(W/this._granularityCellSize)+1,re=Math.ceil(te/this._granularityCellSize)-1;if(q?o<v:A<M)for(let oe=ie;oe<=re;oe++){const pe=oe*this._granularityCellSize;r.push(this._vertexToIndex(pe,p+F*(pe-o)/z))}else for(let oe=re;oe>=ie;oe--){const pe=oe*this._granularityCellSize;r.push(this._vertexToIndex(pe,p+F*(pe-o)/z))}}_generateInterEdgeVertices(r,o,p,v,E,A,M,z,F,q){const W=E-p,te=A-v,ie=M-E,re=(F-E)/ie,oe=(q-E)/ie,pe=Math.min(re,oe),Te=Math.max(re,oe),He=v+te*pe;let Le=Math.floor(Math.min(He,z)/this._granularityCellSize)+1,Be=Math.ceil(Math.max(He,z)/this._granularityCellSize)-1,ot=z<He;const gt=ie===0;if(gt&&(M===F||M===q))return;if(gt||pe>=1||Te<=0){const $t=p-M,Bt=A+(o-A)*Math.min((F-M)/$t,(q-M)/$t);Le=Math.floor(Math.min(Bt,z)/this._granularityCellSize)+1,Be=Math.ceil(Math.max(Bt,z)/this._granularityCellSize)-1,ot=z<Bt}const It=W>0?q:F;if(ot)for(let $t=Le;$t<=Be;$t++)r.push(this._vertexToIndex($t*this._granularityCellSize,It));else for(let $t=Be;$t>=Le;$t--)r.push(this._vertexToIndex($t*this._granularityCellSize,It))}_generateOutline(r){const o=[];for(const p of r){const v=Jr(p,this._granularity,!0),E=this._pointArrayToIndices(v),A=[];for(let M=1;M<E.length;M++)A.push(E[M-1]),A.push(E[M]);o.push(A)}return o}_handlePoles(r){let o=!1,p=!1;this._canonical&&(this._canonical.y===0&&(o=!0),this._canonical.y===(1<<this._canonical.z)-1&&(p=!0)),(o||p)&&this._fillPoles(r,o,p)}_ensureNoPoleVertices(){const r=this._vertexBuffer;for(let o=0;o<r.length;o+=2){const p=r[o+1];p===bl&&(r[o+1]=-32767),p===Qr&&(r[o+1]=32766)}}_generatePoleQuad(r,o,p,v,E,A){v>E!=(A===bl)?(r.push(o),r.push(p),r.push(this._vertexToIndex(v,A)),r.push(p),r.push(this._vertexToIndex(E,A)),r.push(this._vertexToIndex(v,A))):(r.push(p),r.push(o),r.push(this._vertexToIndex(v,A)),r.push(this._vertexToIndex(E,A)),r.push(p),r.push(this._vertexToIndex(v,A)))}_fillPoles(r,o,p){const v=this._vertexBuffer,E=Zt,A=r.length;for(let M=2;M<A;M+=3){const z=r[M-2],F=r[M-1],q=r[M],W=v[2*z],te=v[2*z+1],ie=v[2*F],re=v[2*F+1],oe=v[2*q],pe=v[2*q+1];o&&(te===0&&re===0&&this._generatePoleQuad(r,z,F,W,ie,bl),re===0&&pe===0&&this._generatePoleQuad(r,F,q,ie,oe,bl),pe===0&&te===0&&this._generatePoleQuad(r,q,z,oe,W,bl)),p&&(te===E&&re===E&&this._generatePoleQuad(r,z,F,W,ie,Qr),re===E&&pe===E&&this._generatePoleQuad(r,F,q,ie,oe,Qr),pe===E&&te===E&&this._generatePoleQuad(r,q,z,oe,W,Qr))}}_initializeVertices(r){for(let o=0;o<r.length;o+=2)this._vertexToIndex(r[o],r[o+1])}subdividePolygonInternal(r,o){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:p,holeIndices:v}=(function(M){const z=[],F=[];for(const q of M)if(q.length!==0){q!==M[0]&&z.push(F.length/2);for(let W=0;W<q.length;W++)F.push(q[W].x),F.push(q[W].y)}return{flattened:F,holeIndices:z}})(r);let E;this._initializeVertices(p);try{const M=(function(F,q,W=2){const te=q&&q.length,ie=te?q[0]*W:F.length;let re=Kg(F,0,ie,W,!0);const oe=[];if(!re||re.next===re.prev)return oe;let pe,Te,He;if(te&&(re=(function(Le,Be,ot,gt){const It=[];for(let $t=0,Bt=Be.length;$t<Bt;$t++){const Gt=Kg(Le,Be[$t]*gt,$t<Bt-1?Be[$t+1]*gt:Le.length,gt,!1);Gt===Gt.next&&(Gt.steiner=!0),It.push(Rb(Gt))}It.sort(Xy);for(let $t=0;$t<It.length;$t++)ot=mm(It[$t],ot);return ot})(F,q,re,W)),F.length>80*W){pe=F[0],Te=F[1];let Le=pe,Be=Te;for(let ot=W;ot<ie;ot+=W){const gt=F[ot],It=F[ot+1];gt<pe&&(pe=gt),It<Te&&(Te=It),gt>Le&&(Le=gt),It>Be&&(Be=It)}He=Math.max(Le-pe,Be-Te),He=He!==0?32767/He:0}return gd(re,oe,W,pe,Te,He,0),oe})(p,v),z=this._convertIndices(p,M);E=this._subdivideTrianglesScanline(z)}catch(M){console.error(M)}let A=[];return o&&(A=this._generateOutline(r)),this._ensureNoPoleVertices(),this._handlePoles(E),{verticesFlattened:this._vertexBuffer,indicesTriangles:E,indicesLineList:A}}_convertIndices(r,o){const p=[];for(let v=0;v<o.length;v++)p.push(this._vertexToIndex(r[2*o[v]],r[2*o[v]+1]));return p}_pointArrayToIndices(r){const o=[];for(let p=0;p<r.length;p++){const v=r[p];o.push(this._vertexToIndex(v.x,v.y))}return o}}function t_(l,r,o,p=!0){return new e_(o,r).subdividePolygonInternal(l,p)}function Jr(l,r,o=!1){if(!l||l.length<1)return[];if(l.length<2)return[];const p=l[0],v=l[l.length-1],E=o&&(p.x!==v.x||p.y!==v.y);if(r<2)return E?[...l,l[0]]:[...l];const A=Math.floor(Zt/r),M=[];M.push(new C(l[0].x,l[0].y));const z=l.length,F=E?z:z-1;for(let q=0;q<F;q++){const W=l[q],te=q<z-1?l[q+1]:l[0],ie=W.x,re=W.y,oe=te.x,pe=te.y,Te=ie!==oe,He=re!==pe;if(!Te&&!He)continue;const Le=oe-ie,Be=pe-re,ot=Math.abs(Le),gt=Math.abs(Be);let It=ie,$t=re;for(;;){const Gt=Le>0?(Math.floor(It/A)+1)*A:(Math.ceil(It/A)-1)*A,dn=Be>0?(Math.floor($t/A)+1)*A:(Math.ceil($t/A)-1)*A,qt=Math.abs(It-Gt),jt=Math.abs($t-dn),St=Math.abs(It-oe),Sn=Math.abs($t-pe),Pn=Te?qt/ot:Number.POSITIVE_INFINITY,mn=He?jt/gt:Number.POSITIVE_INFINITY;if((St<=qt||!Te)&&(Sn<=jt||!He))break;if(Pn<mn&&Te||!He){It=Gt,$t+=Be*Pn;const un=new C(It,Math.round($t));M[M.length-1].x===un.x&&M[M.length-1].y===un.y||M.push(un)}else{It+=Le*mn,$t=dn;const un=new C(Math.round(It),$t);M[M.length-1].x===un.x&&M[M.length-1].y===un.y||M.push(un)}}const Bt=new C(oe,pe);M[M.length-1].x===Bt.x&&M[M.length-1].y===Bt.y||M.push(Bt)}return M}function Lb(l,r,o){if(r.length===0)throw new Error("Subdivision vertex ring is empty.");let p=0,v=l[2*r[0]];for(let z=1;z<r.length;z++){const F=l[2*r[z]];F<v&&(v=F,p=z)}const E=r.length;let A=p,M=(A+1)%E;for(;;){const z=A-1>=0?A-1:E-1,F=(M+1)%E,q=l[2*r[z]],W=l[2*r[F]],te=l[2*r[A]],ie=l[2*r[A]+1],re=l[2*r[M]+1];let oe=!1;if(q<W)oe=!0;else if(q>W)oe=!1;else{const pe=re-ie,Te=-(l[2*r[M]]-te),He=ie<re?1:-1;((q-te)*pe+(l[2*r[z]+1]-ie)*Te)*He>((W-te)*pe+(l[2*r[F]+1]-ie)*Te)*He&&(oe=!0)}if(oe){const pe=r[z],Te=r[A],He=r[M];pe!==Te&&pe!==He&&Te!==He&&o.push(He,Te,pe),A--,A<0&&(A=E-1)}else{const pe=r[F],Te=r[A],He=r[M];pe!==Te&&pe!==He&&Te!==He&&o.push(He,Te,pe),M++,M>=E&&(M=0)}if(z===F)break}}function n_(l,r,o,p,v,E,A,M,z){const F=v.length/2,q=A&&M&&z;if(F<jn.MAX_VERTEX_ARRAY_LENGTH){const W=r.prepareSegment(F,o,p),te=W.vertexLength;for(let oe=0;oe<E.length;oe+=3)p.emplaceBack(te+E[oe],te+E[oe+1],te+E[oe+2]);let ie,re;W.vertexLength+=F,W.primitiveLength+=E.length/3,q&&(re=A.prepareSegment(F,o,M),ie=re.vertexLength,re.vertexLength+=F);for(let oe=0;oe<v.length;oe+=2)l(v[oe],v[oe+1]);if(q)for(let oe=0;oe<z.length;oe++){const pe=z[oe];for(let Te=1;Te<pe.length;Te+=2)M.emplaceBack(ie+pe[Te-1],ie+pe[Te]);re.primitiveLength+=pe.length/2}}else(function(W,te,ie,re,oe,pe){const Te=[];for(let gt=0;gt<re.length/2;gt++)Te.push(-1);const He={count:0};let Le=0,Be=W.getOrCreateLatestSegment(te,ie),ot=Be.vertexLength;for(let gt=2;gt<oe.length;gt+=3){const It=oe[gt-2],$t=oe[gt-1],Bt=oe[gt];let Gt=Te[It]<Le,dn=Te[$t]<Le,qt=Te[Bt]<Le;Be.vertexLength+((Gt?1:0)+(dn?1:0)+(qt?1:0))>jn.MAX_VERTEX_ARRAY_LENGTH&&(Be=W.createNewSegment(te,ie),Le=He.count,Gt=!0,dn=!0,qt=!0,ot=0);const jt=rf(Te,re,pe,He,It,Gt,Be),St=rf(Te,re,pe,He,$t,dn,Be),Sn=rf(Te,re,pe,He,Bt,qt,Be);ie.emplaceBack(ot+jt-Le,ot+St-Le,ot+Sn-Le),Be.primitiveLength++}})(r,o,p,v,E,l),q&&(function(W,te,ie,re,oe,pe){const Te=[];for(let gt=0;gt<re.length/2;gt++)Te.push(-1);const He={count:0};let Le=0,Be=W.getOrCreateLatestSegment(te,ie),ot=Be.vertexLength;for(let gt=0;gt<oe.length;gt++){const It=oe[gt];for(let $t=1;$t<oe[gt].length;$t+=2){const Bt=It[$t-1],Gt=It[$t];let dn=Te[Bt]<Le,qt=Te[Gt]<Le;Be.vertexLength+((dn?1:0)+(qt?1:0))>jn.MAX_VERTEX_ARRAY_LENGTH&&(Be=W.createNewSegment(te,ie),Le=He.count,dn=!0,qt=!0,ot=0);const jt=rf(Te,re,pe,He,Bt,dn,Be),St=rf(Te,re,pe,He,Gt,qt,Be);ie.emplaceBack(ot+jt-Le,ot+St-Le),Be.primitiveLength++}}})(A,o,M,v,z,l),r.forceNewSegmentOnNextPrepare(),A==null||A.forceNewSegmentOnNextPrepare()}function rf(l,r,o,p,v,E,A){if(E){const M=p.count;return o(r[2*v],r[2*v+1]),l[v]=p.count,p.count++,A.vertexLength++,M}return l[v]}class Ur{constructor(r){this.zoom=r.zoom,this.globalState=r.globalState,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((o=>o.id)),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ct,this.indexArray=new Yi,this.indexArray2=new qi,this.programConfigurations=new po(r.layers,r.zoom),this.segments=new jn,this.segments2=new jn,this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id))}populate(r,o,p){this.hasPattern=pm("fill",this.layers,o);const v=this.layers[0].layout.get("fill-sort-key"),E=!v.isConstant(),A=[];for(const{feature:M,id:z,index:F,sourceLayerIndex:q}of r){const W=this.layers[0]._featureFilter.needGeometry,te=vl(M,W);if(!this.layers[0]._featureFilter.filter(new Di(this.zoom,{globalState:this.globalState}),te,p))continue;const ie=E?v.evaluate(te,{},p,o.availableImages):void 0,re={id:z,properties:M.properties,type:M.type,sourceLayerIndex:q,index:F,geometry:W?te.geometry:su(M),patterns:{},sortKey:ie};A.push(re)}E&&A.sort(((M,z)=>M.sortKey-z.sortKey));for(const M of A){const{geometry:z,index:F,sourceLayerIndex:q}=M;if(this.hasPattern){const W=ep("fill",this.layers,M,this.zoom,o);this.patternFeatures.push(W)}else this.addFeature(M,z,F,p,{},o.subdivisionGranularity);o.featureIndex.insert(r[F].feature,z,F,q,this.index)}}update(r,o,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,o,this.stateDependentLayers,p)}addFeatures(r,o,p){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,o,p,r.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Xg),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,o,p,v,E,A){for(const M of Zu(o,500)){const z=t_(M,v,A.fill.getGranularityForZoomLevel(v.z)),F=this.layoutVertexArray;n_(((q,W)=>{F.emplaceBack(q,W)}),this.segments,this.layoutVertexArray,this.indexArray,z.verticesFlattened,z.indicesTriangles,this.segments2,this.indexArray2,z.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,p,E,v)}}let $o,mc;Yt("FillBucket",Ur,{omit:["layers","patternFeatures"]});var Yy={get paint(){return mc=mc||new As({"fill-antialias":new an(qe.paint_fill["fill-antialias"]),"fill-opacity":new Tn(qe.paint_fill["fill-opacity"]),"fill-color":new Tn(qe.paint_fill["fill-color"]),"fill-outline-color":new Tn(qe.paint_fill["fill-outline-color"]),"fill-translate":new an(qe.paint_fill["fill-translate"]),"fill-translate-anchor":new an(qe.paint_fill["fill-translate-anchor"]),"fill-pattern":new ud(qe.paint_fill["fill-pattern"])})},get layout(){return $o=$o||new As({"fill-sort-key":new Tn(qe.layout_fill["fill-sort-key"])})}};class Qy extends ho{constructor(r){super(r,Yy)}recalculate(r,o){super.recalculate(r,o);const p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new Ur(r)}queryRadius(){return Qf(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:r,geometry:o,transform:p,pixelsToTileUnits:v}){return zg(Jd(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-p.bearingInRadians,v),o)}isTileClipped(){return!0}}const Jy=Br([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),kb=Br([{name:"a_centroid",components:2,type:"Int16"}],4),{members:_m}=Jy;class os{constructor(r,o,p,v,E){this.properties={},this.extent=p,this.type=0,this.id=void 0,this._pbf=r,this._geometry=-1,this._keys=v,this._values=E,r.readFields(Mu,this,o)}loadGeometry(){const r=this._pbf;r.pos=this._geometry;const o=r.readVarint()+r.pos,p=[];let v,E=1,A=0,M=0,z=0;for(;r.pos<o;){if(A<=0){const F=r.readVarint();E=7&F,A=F>>3}if(A--,E===1||E===2)M+=r.readSVarint(),z+=r.readSVarint(),E===1&&(v&&p.push(v),v=[]),v&&v.push(new C(M,z));else{if(E!==7)throw new Error(`unknown command ${E}`);v&&v.push(v[0].clone())}}return v&&p.push(v),p}bbox(){const r=this._pbf;r.pos=this._geometry;const o=r.readVarint()+r.pos;let p=1,v=0,E=0,A=0,M=1/0,z=-1/0,F=1/0,q=-1/0;for(;r.pos<o;){if(v<=0){const W=r.readVarint();p=7&W,v=W>>3}if(v--,p===1||p===2)E+=r.readSVarint(),A+=r.readSVarint(),E<M&&(M=E),E>z&&(z=E),A<F&&(F=A),A>q&&(q=A);else if(p!==7)throw new Error(`unknown command ${p}`)}return[M,F,z,q]}toGeoJSON(r,o,p){const v=this.extent*Math.pow(2,p),E=this.extent*r,A=this.extent*o,M=this.loadGeometry();function z(te){return[360*(te.x+E)/v-180,360/Math.PI*Math.atan(Math.exp((1-2*(te.y+A)/v)*Math.PI))-90]}function F(te){return te.map(z)}let q;if(this.type===1){const te=[];for(const re of M)te.push(re[0]);const ie=F(te);q=te.length===1?{type:"Point",coordinates:ie[0]}:{type:"MultiPoint",coordinates:ie}}else if(this.type===2){const te=M.map(F);q=te.length===1?{type:"LineString",coordinates:te[0]}:{type:"MultiLineString",coordinates:te}}else{if(this.type!==3)throw new Error("unknown feature type");{const te=(function(re){const oe=re.length;if(oe<=1)return[re];const pe=[];let Te,He;for(let Le=0;Le<oe;Le++){const Be=ev(re[Le]);Be!==0&&(He===void 0&&(He=Be<0),He===Be<0?(Te&&pe.push(Te),Te=[re[Le]]):Te&&Te.push(re[Le]))}return Te&&pe.push(Te),pe})(M),ie=[];for(const re of te)ie.push(re.map(F));q=ie.length===1?{type:"Polygon",coordinates:ie[0]}:{type:"MultiPolygon",coordinates:ie}}}const W={type:"Feature",geometry:q,properties:this.properties};return this.id!=null&&(W.id=this.id),W}}function Mu(l,r,o){l===1?r.id=o.readVarint():l===2?(function(p,v){const E=p.readVarint()+p.pos;for(;p.pos<E;){const A=v._keys[p.readVarint()],M=v._values[p.readVarint()];v.properties[A]=M}})(o,r):l===3?r.type=o.readVarint():l===4&&(r._geometry=o.pos)}function ev(l){let r=0;for(let o,p,v=0,E=l.length,A=E-1;v<E;A=v++)o=l[v],p=l[A],r+=(p.x-o.x)*(o.y+p.y);return r}os.types=["Unknown","Point","LineString","Polygon"];class Go{constructor(r,o){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(tv,this,o),this.length=this._features.length}feature(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];const o=this._pbf.readVarint()+this._pbf.pos;return new os(this._pbf,o,this.extent,this._keys,this._values)}}function tv(l,r,o){l===15?r.version=o.readVarint():l===1?r.name=o.readString():l===5?r.extent=o.readVarint():l===2?r._features.push(o.pos):l===3?r._keys.push(o.readString()):l===4&&r._values.push((function(p){let v=null;const E=p.readVarint()+p.pos;for(;p.pos<E;){const A=p.readVarint()>>3;v=A===1?p.readString():A===2?p.readFloat():A===3?p.readDouble():A===4?p.readVarint64():A===5?p.readVarint():A===6?p.readSVarint():A===7?p.readBoolean():null}if(v==null)throw new Error("unknown feature value");return v})(o))}class gc{constructor(r,o){this.layers=r.readFields(vd,{},o)}}function vd(l,r,o){if(l===3){const p=new Go(o,o.readVarint()+o.pos);p.length&&(r[p.name]=p)}}const Pu=Math.pow(2,13);function bd(l,r,o,p,v,E,A,M){l.emplaceBack(r,o,2*Math.floor(p*Pu)+A,v*Pu*2,E*Pu*2,Math.round(M))}class ap{constructor(r){this.zoom=r.zoom,this.globalState=r.globalState,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((o=>o.id)),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new rt,this.centroidVertexArray=new Ie,this.indexArray=new Yi,this.programConfigurations=new po(r.layers,r.zoom),this.segments=new jn,this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id))}populate(r,o,p){this.features=[],this.hasPattern=pm("fill-extrusion",this.layers,o);for(const{feature:v,id:E,index:A,sourceLayerIndex:M}of r){const z=this.layers[0]._featureFilter.needGeometry,F=vl(v,z);if(!this.layers[0]._featureFilter.filter(new Di(this.zoom,{globalState:this.globalState}),F,p))continue;const q={id:E,sourceLayerIndex:M,index:A,geometry:z?F.geometry:su(v),properties:v.properties,type:v.type,patterns:{}};this.hasPattern?this.features.push(ep("fill-extrusion",this.layers,q,this.zoom,o)):this.addFeature(q,q.geometry,A,p,{},o.subdivisionGranularity),o.featureIndex.insert(v,q.geometry,A,M,this.index,!0)}}addFeatures(r,o,p){for(const v of this.features){const{geometry:E}=v;this.addFeature(v,E,v.index,o,p,r.subdivisionGranularity)}}update(r,o,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,o,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,_m),this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,kb.members,!0),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(r,o,p,v,E,A){for(const M of Zu(o,500)){const z={x:0,y:0,sampleCount:0},F=this.layoutVertexArray.length;this.processPolygon(z,v,r,M,A);const q=this.layoutVertexArray.length-F,W=Math.floor(z.x/z.sampleCount),te=Math.floor(z.y/z.sampleCount);for(let ie=0;ie<q;ie++)this.centroidVertexArray.emplaceBack(W,te)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,p,E,v)}processPolygon(r,o,p,v,E){if(v.length<1||xd(v[0]))return;for(const W of v)W.length!==0&&Ru(r,W);const A={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},M=E.fill.getGranularityForZoomLevel(o.z),z=os.types[p.type]==="Polygon";for(const W of v){if(W.length===0||xd(W))continue;const te=Jr(W,M,z);this._generateSideFaces(te,A)}if(!z)return;const F=t_(v,o,M,!1),q=this.layoutVertexArray;n_(((W,te)=>{bd(q,W,te,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,F.verticesFlattened,F.indicesTriangles)}_generateSideFaces(r,o){let p=0;for(let v=1;v<r.length;v++){const E=r[v],A=r[v-1];if(nv(E,A))continue;o.segment.vertexLength+4>jn.MAX_VERTEX_ARRAY_LENGTH&&(o.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const M=E.sub(A)._perp()._unit(),z=A.dist(E);p+z>32768&&(p=0),bd(this.layoutVertexArray,E.x,E.y,M.x,M.y,0,0,p),bd(this.layoutVertexArray,E.x,E.y,M.x,M.y,0,1,p),p+=z,bd(this.layoutVertexArray,A.x,A.y,M.x,M.y,0,0,p),bd(this.layoutVertexArray,A.x,A.y,M.x,M.y,0,1,p);const F=o.segment.vertexLength;this.indexArray.emplaceBack(F,F+2,F+1),this.indexArray.emplaceBack(F+1,F+2,F+3),o.segment.vertexLength+=4,o.segment.primitiveLength+=2}}}function Ru(l,r){for(let o=0;o<r.length;o++){const p=r[o];o===r.length-1&&r[0].x===p.x&&r[0].y===p.y||(l.x+=p.x,l.y+=p.y,l.sampleCount++)}}function nv(l,r){return l.x===r.x&&(l.x<0||l.x>Zt)||l.y===r.y&&(l.y<0||l.y>Zt)}function xd(l){return l.every((r=>r.x<0))||l.every((r=>r.x>Zt))||l.every((r=>r.y<0))||l.every((r=>r.y>Zt))}let af;Yt("FillExtrusionBucket",ap,{omit:["layers","features"]});var sp={get paint(){return af=af||new As({"fill-extrusion-opacity":new an(qe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Tn(qe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new an(qe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new an(qe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ud(qe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Tn(qe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Tn(qe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new an(qe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class sf extends ho{constructor(r){super(r,sp)}createBucket(r){return new ap(r)}queryRadius(){return Qf(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:r,feature:o,featureState:p,geometry:v,transform:E,pixelsToTileUnits:A,pixelPosMatrix:M}){const z=Jd(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-E.bearingInRadians,A),F=this.paint.get("fill-extrusion-height").evaluate(o,p),q=this.paint.get("fill-extrusion-base").evaluate(o,p),W=(function(ie,re){const oe=[];for(const pe of ie){const Te=[pe.x,pe.y,0,1];Mn(Te,Te,re),oe.push(new C(Te[0]/Te[3],Te[1]/Te[3]))}return oe})(z,M),te=(function(ie,re,oe,pe){const Te=[],He=[],Le=pe[8]*re,Be=pe[9]*re,ot=pe[10]*re,gt=pe[11]*re,It=pe[8]*oe,$t=pe[9]*oe,Bt=pe[10]*oe,Gt=pe[11]*oe;for(const dn of ie){const qt=[],jt=[];for(const St of dn){const Sn=St.x,Pn=St.y,mn=pe[0]*Sn+pe[4]*Pn+pe[12],un=pe[1]*Sn+pe[5]*Pn+pe[13],Qn=pe[2]*Sn+pe[6]*Pn+pe[14],Kr=pe[3]*Sn+pe[7]*Pn+pe[15],ya=Qn+ot,us=Kr+gt,Tl=mn+It,_o=un+$t,Da=Qn+Bt,Lr=Kr+Gt,za=new C((mn+Le)/us,(un+Be)/us);za.z=ya/us,qt.push(za);const va=new C(Tl/Lr,_o/Lr);va.z=Da/Lr,jt.push(va)}Te.push(qt),He.push(jt)}return[Te,He]})(v,q,F,M);return(function(ie,re,oe){let pe=1/0;zg(oe,re)&&(pe=i_(oe,re[0]));for(let Te=0;Te<re.length;Te++){const He=re[Te],Le=ie[Te];for(let Be=0;Be<He.length-1;Be++){const ot=He[Be],gt=[ot,He[Be+1],Le[Be+1],Le[Be],ot];kg(oe,gt)&&(pe=Math.min(pe,i_(oe,gt)))}}return pe!==1/0&&pe})(te[0],te[1],W)}}function of(l,r){return l.x*r.x+l.y*r.y}function i_(l,r){if(l.length===1){let o=0;const p=r[o++];let v;for(;!v||p.equals(v);)if(v=r[o++],!v)return 1/0;for(;o<r.length;o++){const E=r[o],A=l[0],M=v.sub(p),z=E.sub(p),F=A.sub(p),q=of(M,M),W=of(M,z),te=of(z,z),ie=of(F,M),re=of(F,z),oe=q*te-W*W,pe=(te*ie-W*re)/oe,Te=(q*re-W*ie)/oe,He=p.z*(1-pe-Te)+v.z*pe+E.z*Te;if(isFinite(He))return He}return 1/0}{let o=1/0;for(const p of r)o=Math.min(o,p.z);return o}}const op=Br([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:iv}=op,ym=Br([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:rv}=ym,Db=Math.cos(Math.PI/180*37.5),av=Math.pow(2,14)/.5;class $i{constructor(r){this.zoom=r.zoom,this.globalState=r.globalState,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((o=>o.id)),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((o=>{this.gradients[o.id]={}})),this.layoutVertexArray=new st,this.layoutVertexArray2=new lt,this.indexArray=new Yi,this.programConfigurations=new po(r.layers,r.zoom),this.segments=new jn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id))}populate(r,o,p){this.hasPattern=pm("line",this.layers,o);const v=this.layers[0].layout.get("line-sort-key"),E=!v.isConstant(),A=[];for(const{feature:M,id:z,index:F,sourceLayerIndex:q}of r){const W=this.layers[0]._featureFilter.needGeometry,te=vl(M,W);if(!this.layers[0]._featureFilter.filter(new Di(this.zoom,{globalState:this.globalState}),te,p))continue;const ie=E?v.evaluate(te,{},p):void 0,re={id:z,properties:M.properties,type:M.type,sourceLayerIndex:q,index:F,geometry:W?te.geometry:su(M),patterns:{},sortKey:ie};A.push(re)}E&&A.sort(((M,z)=>M.sortKey-z.sortKey));for(const M of A){const{geometry:z,index:F,sourceLayerIndex:q}=M;if(this.hasPattern){const W=ep("line",this.layers,M,this.zoom,o);this.patternFeatures.push(W)}else this.addFeature(M,z,F,p,{},o.subdivisionGranularity);o.featureIndex.insert(r[F].feature,z,F,q,this.index)}}update(r,o,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,o,this.stateDependentLayers,p)}addFeatures(r,o,p){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,o,p,r.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,rv)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,iv),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,o,p,v,E,A){const M=this.layers[0].layout,z=M.get("line-join").evaluate(r,{}),F=M.get("line-cap"),q=M.get("line-miter-limit"),W=M.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const te of o)this.addLine(te,r,z,F,q,W,v,A);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,p,E,v)}addLine(r,o,p,v,E,A,M,z){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,r=Jr(r,M?z.line.getGranularityForZoomLevel(M.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Le=0;Le<r.length-1;Le++)this.totalDistance+=r[Le].dist(r[Le+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const F=os.types[o.type]==="Polygon";let q=r.length;for(;q>=2&&r[q-1].equals(r[q-2]);)q--;let W=0;for(;W<q-1&&r[W].equals(r[W+1]);)W++;if(q<(F?3:2))return;p==="bevel"&&(E=1.05);const te=this.overscaling<=16?122880/(512*this.overscaling):0,ie=this.segments.prepareSegment(10*q,this.layoutVertexArray,this.indexArray);let re,oe,pe,Te,He;this.e1=this.e2=-1,F&&(re=r[q-2],He=r[W].sub(re)._unit()._perp());for(let Le=W;Le<q;Le++){if(pe=Le===q-1?F?r[W+1]:void 0:r[Le+1],pe&&r[Le].equals(pe))continue;He&&(Te=He),re&&(oe=re),re=r[Le],He=pe?pe.sub(re)._unit()._perp():Te,Te=Te||He;let Be=Te.add(He);Be.x===0&&Be.y===0||Be._unit();const ot=Te.x*He.x+Te.y*He.y,gt=Be.x*He.x+Be.y*He.y,It=gt!==0?1/gt:1/0,$t=2*Math.sqrt(2-2*gt),Bt=gt<Db&&oe&&pe,Gt=Te.x*He.y-Te.y*He.x>0;if(Bt&&Le>W){const jt=re.dist(oe);if(jt>2*te){const St=re.sub(re.sub(oe)._mult(te/jt)._round());this.updateDistance(oe,St),this.addCurrentVertex(St,Te,0,0,ie),oe=St}}const dn=oe&&pe;let qt=dn?p:F?"butt":v;if(dn&&qt==="round"&&(It<A?qt="miter":It<=2&&(qt="fakeround")),qt==="miter"&&It>E&&(qt="bevel"),qt==="bevel"&&(It>2&&(qt="flipbevel"),It<E&&(qt="miter")),oe&&this.updateDistance(oe,re),qt==="miter")Be._mult(It),this.addCurrentVertex(re,Be,0,0,ie);else if(qt==="flipbevel"){if(It>100)Be=He.mult(-1);else{const jt=It*Te.add(He).mag()/Te.sub(He).mag();Be._perp()._mult(jt*(Gt?-1:1))}this.addCurrentVertex(re,Be,0,0,ie),this.addCurrentVertex(re,Be.mult(-1),0,0,ie)}else if(qt==="bevel"||qt==="fakeround"){const jt=-Math.sqrt(It*It-1),St=Gt?jt:0,Sn=Gt?0:jt;if(oe&&this.addCurrentVertex(re,Te,St,Sn,ie),qt==="fakeround"){const Pn=Math.round(180*$t/Math.PI/20);for(let mn=1;mn<Pn;mn++){let un=mn/Pn;if(un!==.5){const Kr=un-.5;un+=un*Kr*(un-1)*((1.0904+ot*(ot*(3.55645-1.43519*ot)-3.2452))*Kr*Kr+(.848013+ot*(.215638*ot-1.06021)))}const Qn=He.sub(Te)._mult(un)._add(Te)._unit()._mult(Gt?-1:1);this.addHalfVertex(re,Qn.x,Qn.y,!1,Gt,0,ie)}}pe&&this.addCurrentVertex(re,He,-St,-Sn,ie)}else if(qt==="butt")this.addCurrentVertex(re,Be,0,0,ie);else if(qt==="square"){const jt=oe?1:-1;this.addCurrentVertex(re,Be,jt,jt,ie)}else qt==="round"&&(oe&&(this.addCurrentVertex(re,Te,0,0,ie),this.addCurrentVertex(re,Te,1,1,ie,!0)),pe&&(this.addCurrentVertex(re,He,-1,-1,ie,!0),this.addCurrentVertex(re,He,0,0,ie)));if(Bt&&Le<q-1){const jt=re.dist(pe);if(jt>2*te){const St=re.add(pe.sub(re)._mult(te/jt)._round());this.updateDistance(re,St),this.addCurrentVertex(St,He,0,0,ie),re=St}}}}addCurrentVertex(r,o,p,v,E,A=!1){const M=o.y*v-o.x,z=-o.y-o.x*v;this.addHalfVertex(r,o.x+o.y*p,o.y-o.x*p,A,!1,p,E),this.addHalfVertex(r,M,z,A,!0,-v,E),this.distance>av/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(r,o,p,v,E,A))}addHalfVertex({x:r,y:o},p,v,E,A,M,z){const F=.5*(this.lineClips?this.scaledDistance*(av-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((r<<1)+(E?1:0),(o<<1)+(A?1:0),Math.round(63*p)+128,Math.round(63*v)+128,1+(M===0?0:M<0?-1:1)|(63&F)<<2,F>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const q=z.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,q,this.e2),z.primitiveLength++),A?this.e2=q:this.e1=q}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(r,o){this.distance+=r.dist(o),this.updateScaledDistance()}}let Sr,_i;Yt("LineBucket",$i,{omit:["layers","patternFeatures"]});var xi={get paint(){return _i=_i||new As({"line-opacity":new Tn(qe.paint_line["line-opacity"]),"line-color":new Tn(qe.paint_line["line-color"]),"line-translate":new an(qe.paint_line["line-translate"]),"line-translate-anchor":new an(qe.paint_line["line-translate-anchor"]),"line-width":new Tn(qe.paint_line["line-width"]),"line-gap-width":new Tn(qe.paint_line["line-gap-width"]),"line-offset":new Tn(qe.paint_line["line-offset"]),"line-blur":new Tn(qe.paint_line["line-blur"]),"line-dasharray":new Fo(qe.paint_line["line-dasharray"]),"line-pattern":new ud(qe.paint_line["line-pattern"]),"line-gradient":new jc(qe.paint_line["line-gradient"])})},get layout(){return Sr=Sr||new As({"line-cap":new an(qe.layout_line["line-cap"]),"line-join":new Tn(qe.layout_line["line-join"]),"line-miter-limit":new an(qe.layout_line["line-miter-limit"]),"line-round-limit":new an(qe.layout_line["line-round-limit"]),"line-sort-key":new Tn(qe.layout_line["line-sort-key"])})}};class gr extends Tn{possiblyEvaluate(r,o){return o=new Di(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,zoomHistory:o.zoomHistory,transition:o.transition}),super.possiblyEvaluate(r,o)}evaluate(r,o,p,v){return o=oi({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(r,o,p,v)}}let mo;class Ah extends ho{constructor(r){super(r,xi),this.gradientVersion=0,mo||(mo=new gr(xi.paint.properties["line-width"].specification),mo.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const o=this.gradientExpression();this.stepInterpolant=!!(function(p){return p._styleExpression!==void 0})(o)&&o._styleExpression.expression instanceof Xi,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,o){super.recalculate(r,o),this.paint._values["line-floorwidth"]=mo.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new $i(r)}queryRadius(r){const o=r,p=wd(Sh("line-width",this,o),Sh("line-gap-width",this,o)),v=Sh("line-offset",this,o);return p/2+Math.abs(v)+Qf(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:r,feature:o,featureState:p,geometry:v,transform:E,pixelsToTileUnits:A}){const M=Jd(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-E.bearingInRadians,A),z=A/2*wd(this.paint.get("line-width").evaluate(o,p),this.paint.get("line-gap-width").evaluate(o,p)),F=this.paint.get("line-offset").evaluate(o,p);return F&&(v=(function(q,W){const te=[];for(let ie=0;ie<q.length;ie++){const re=q[ie],oe=[];for(let pe=0;pe<re.length;pe++){const Te=re[pe-1],He=re[pe],Le=re[pe+1],Be=pe===0?new C(0,0):He.sub(Te)._unit()._perp(),ot=pe===re.length-1?new C(0,0):Le.sub(He)._unit()._perp(),gt=Be._add(ot)._unit(),It=gt.x*ot.x+gt.y*ot.y;It!==0&&gt._mult(1/It),oe.push(gt._mult(W)._add(He))}te.push(oe)}return te})(v,F*A)),(function(q,W,te){for(let ie=0;ie<W.length;ie++){const re=W[ie];if(q.length>=3){for(let oe=0;oe<re.length;oe++)if(pd(q,re[oe]))return!0}if(Og(q,re,te))return!0}return!1})(M,v,z)}isTileClipped(){return!0}}function wd(l,r){return r>0?r+2*l:l}const r_=Br([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Zc=Br([{name:"a_projected_pos",components:3,type:"Float32"}],4);Br([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const _a=Br([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Br([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Hc=Br([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Td=Br([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function a_(l,r,o){return l.sections.forEach((p=>{p.text=(function(v,E,A){const M=E.layout.get("text-transform").evaluate(A,{});return M==="uppercase"?v=v.toLocaleUpperCase():M==="lowercase"&&(v=v.toLocaleLowerCase()),ml.applyArabicShaping&&(v=ml.applyArabicShaping(v)),v})(p.text,r,o)})),l}Br([{name:"triangle",components:3,type:"Uint16"}]),Br([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Br([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Br([{type:"Float32",name:"offsetX"}]),Br([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Br([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const no={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Xr=24;const Sd=4294967296,Zo=1/Sd,vm=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class lf{constructor(r=new Uint8Array(16)){this.buf=ArrayBuffer.isView(r)?r:new Uint8Array(r),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(r,o,p=this.length){for(;this.pos<p;){const v=this.readVarint(),E=v>>3,A=this.pos;this.type=7&v,r(E,o,this),this.pos===A&&this.skip(v)}return o}readMessage(r,o){return this.readFields(r,o,this.readVarint()+this.pos)}readFixed32(){const r=this.dataView.getUint32(this.pos,!0);return this.pos+=4,r}readSFixed32(){const r=this.dataView.getInt32(this.pos,!0);return this.pos+=4,r}readFixed64(){const r=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Sd;return this.pos+=8,r}readSFixed64(){const r=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Sd;return this.pos+=8,r}readFloat(){const r=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,r}readDouble(){const r=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,r}readVarint(r){const o=this.buf;let p,v;return v=o[this.pos++],p=127&v,v<128?p:(v=o[this.pos++],p|=(127&v)<<7,v<128?p:(v=o[this.pos++],p|=(127&v)<<14,v<128?p:(v=o[this.pos++],p|=(127&v)<<21,v<128?p:(v=o[this.pos],p|=(15&v)<<28,(function(E,A,M){const z=M.buf;let F,q;if(q=z[M.pos++],F=(112&q)>>4,q<128||(q=z[M.pos++],F|=(127&q)<<3,q<128)||(q=z[M.pos++],F|=(127&q)<<10,q<128)||(q=z[M.pos++],F|=(127&q)<<17,q<128)||(q=z[M.pos++],F|=(127&q)<<24,q<128)||(q=z[M.pos++],F|=(1&q)<<31,q<128))return Ed(E,F,A);throw new Error("Expected varint not more than 10 bytes")})(p,r,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const r=this.readVarint();return r%2==1?(r+1)/-2:r/2}readBoolean(){return!!this.readVarint()}readString(){const r=this.readVarint()+this.pos,o=this.pos;return this.pos=r,r-o>=12&&vm?vm.decode(this.buf.subarray(o,r)):(function(p,v,E){let A="",M=v;for(;M<E;){const z=p[M];let F,q,W,te=null,ie=z>239?4:z>223?3:z>191?2:1;if(M+ie>E)break;ie===1?z<128&&(te=z):ie===2?(F=p[M+1],(192&F)==128&&(te=(31&z)<<6|63&F,te<=127&&(te=null))):ie===3?(F=p[M+1],q=p[M+2],(192&F)==128&&(192&q)==128&&(te=(15&z)<<12|(63&F)<<6|63&q,(te<=2047||te>=55296&&te<=57343)&&(te=null))):ie===4&&(F=p[M+1],q=p[M+2],W=p[M+3],(192&F)==128&&(192&q)==128&&(192&W)==128&&(te=(15&z)<<18|(63&F)<<12|(63&q)<<6|63&W,(te<=65535||te>=1114112)&&(te=null))),te===null?(te=65533,ie=1):te>65535&&(te-=65536,A+=String.fromCharCode(te>>>10&1023|55296),te=56320|1023&te),A+=String.fromCharCode(te),M+=ie}return A})(this.buf,o,r)}readBytes(){const r=this.readVarint()+this.pos,o=this.buf.subarray(this.pos,r);return this.pos=r,o}readPackedVarint(r=[],o){const p=this.readPackedEnd();for(;this.pos<p;)r.push(this.readVarint(o));return r}readPackedSVarint(r=[]){const o=this.readPackedEnd();for(;this.pos<o;)r.push(this.readSVarint());return r}readPackedBoolean(r=[]){const o=this.readPackedEnd();for(;this.pos<o;)r.push(this.readBoolean());return r}readPackedFloat(r=[]){const o=this.readPackedEnd();for(;this.pos<o;)r.push(this.readFloat());return r}readPackedDouble(r=[]){const o=this.readPackedEnd();for(;this.pos<o;)r.push(this.readDouble());return r}readPackedFixed32(r=[]){const o=this.readPackedEnd();for(;this.pos<o;)r.push(this.readFixed32());return r}readPackedSFixed32(r=[]){const o=this.readPackedEnd();for(;this.pos<o;)r.push(this.readSFixed32());return r}readPackedFixed64(r=[]){const o=this.readPackedEnd();for(;this.pos<o;)r.push(this.readFixed64());return r}readPackedSFixed64(r=[]){const o=this.readPackedEnd();for(;this.pos<o;)r.push(this.readSFixed64());return r}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(r){const o=7&r;if(o===0)for(;this.buf[this.pos++]>127;);else if(o===2)this.pos=this.readVarint()+this.pos;else if(o===5)this.pos+=4;else{if(o!==1)throw new Error(`Unimplemented type: ${o}`);this.pos+=8}}writeTag(r,o){this.writeVarint(r<<3|o)}realloc(r){let o=this.length||16;for(;o<this.pos+r;)o*=2;if(o!==this.length){const p=new Uint8Array(o);p.set(this.buf),this.buf=p,this.dataView=new DataView(p.buffer),this.length=o}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(r){this.realloc(4),this.dataView.setInt32(this.pos,r,!0),this.pos+=4}writeSFixed32(r){this.realloc(4),this.dataView.setInt32(this.pos,r,!0),this.pos+=4}writeFixed64(r){this.realloc(8),this.dataView.setInt32(this.pos,-1&r,!0),this.dataView.setInt32(this.pos+4,Math.floor(r*Zo),!0),this.pos+=8}writeSFixed64(r){this.realloc(8),this.dataView.setInt32(this.pos,-1&r,!0),this.dataView.setInt32(this.pos+4,Math.floor(r*Zo),!0),this.pos+=8}writeVarint(r){(r=+r||0)>268435455||r<0?(function(o,p){let v,E;if(o>=0?(v=o%4294967296|0,E=o/4294967296|0):(v=~(-o%4294967296),E=~(-o/4294967296),4294967295^v?v=v+1|0:(v=0,E=E+1|0)),o>=18446744073709552e3||o<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");p.realloc(10),(function(A,M,z){z.buf[z.pos++]=127&A|128,A>>>=7,z.buf[z.pos++]=127&A|128,A>>>=7,z.buf[z.pos++]=127&A|128,A>>>=7,z.buf[z.pos++]=127&A|128,z.buf[z.pos]=127&(A>>>=7)})(v,0,p),(function(A,M){const z=(7&A)<<4;M.buf[M.pos++]|=z|((A>>>=3)?128:0),A&&(M.buf[M.pos++]=127&A|((A>>>=7)?128:0),A&&(M.buf[M.pos++]=127&A|((A>>>=7)?128:0),A&&(M.buf[M.pos++]=127&A|((A>>>=7)?128:0),A&&(M.buf[M.pos++]=127&A|((A>>>=7)?128:0),A&&(M.buf[M.pos++]=127&A)))))})(E,p)})(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))}writeSVarint(r){this.writeVarint(r<0?2*-r-1:2*r)}writeBoolean(r){this.writeVarint(+r)}writeString(r){r=String(r),this.realloc(4*r.length),this.pos++;const o=this.pos;this.pos=(function(v,E,A){for(let M,z,F=0;F<E.length;F++){if(M=E.charCodeAt(F),M>55295&&M<57344){if(!z){M>56319||F+1===E.length?(v[A++]=239,v[A++]=191,v[A++]=189):z=M;continue}if(M<56320){v[A++]=239,v[A++]=191,v[A++]=189,z=M;continue}M=z-55296<<10|M-56320|65536,z=null}else z&&(v[A++]=239,v[A++]=191,v[A++]=189,z=null);M<128?v[A++]=M:(M<2048?v[A++]=M>>6|192:(M<65536?v[A++]=M>>12|224:(v[A++]=M>>18|240,v[A++]=M>>12&63|128),v[A++]=M>>6&63|128),v[A++]=63&M|128)}return A})(this.buf,r,this.pos);const p=this.pos-o;p>=128&&lp(o,p,this),this.pos=o-1,this.writeVarint(p),this.pos+=p}writeFloat(r){this.realloc(4),this.dataView.setFloat32(this.pos,r,!0),this.pos+=4}writeDouble(r){this.realloc(8),this.dataView.setFloat64(this.pos,r,!0),this.pos+=8}writeBytes(r){const o=r.length;this.writeVarint(o),this.realloc(o);for(let p=0;p<o;p++)this.buf[this.pos++]=r[p]}writeRawMessage(r,o){this.pos++;const p=this.pos;r(o,this);const v=this.pos-p;v>=128&&lp(p,v,this),this.pos=p-1,this.writeVarint(v),this.pos+=v}writeMessage(r,o,p){this.writeTag(r,2),this.writeRawMessage(o,p)}writePackedVarint(r,o){o.length&&this.writeMessage(r,bm,o)}writePackedSVarint(r,o){o.length&&this.writeMessage(r,Ch,o)}writePackedBoolean(r,o){o.length&&this.writeMessage(r,uf,o)}writePackedFloat(r,o){o.length&&this.writeMessage(r,ls,o)}writePackedDouble(r,o){o.length&&this.writeMessage(r,Ih,o)}writePackedFixed32(r,o){o.length&&this.writeMessage(r,Wc,o)}writePackedSFixed32(r,o){o.length&&this.writeMessage(r,s_,o)}writePackedFixed64(r,o){o.length&&this.writeMessage(r,o_,o)}writePackedSFixed64(r,o){o.length&&this.writeMessage(r,sv,o)}writeBytesField(r,o){this.writeTag(r,2),this.writeBytes(o)}writeFixed32Field(r,o){this.writeTag(r,5),this.writeFixed32(o)}writeSFixed32Field(r,o){this.writeTag(r,5),this.writeSFixed32(o)}writeFixed64Field(r,o){this.writeTag(r,1),this.writeFixed64(o)}writeSFixed64Field(r,o){this.writeTag(r,1),this.writeSFixed64(o)}writeVarintField(r,o){this.writeTag(r,0),this.writeVarint(o)}writeSVarintField(r,o){this.writeTag(r,0),this.writeSVarint(o)}writeStringField(r,o){this.writeTag(r,2),this.writeString(o)}writeFloatField(r,o){this.writeTag(r,5),this.writeFloat(o)}writeDoubleField(r,o){this.writeTag(r,1),this.writeDouble(o)}writeBooleanField(r,o){this.writeVarintField(r,+o)}}function Ed(l,r,o){return o?4294967296*r+(l>>>0):4294967296*(r>>>0)+(l>>>0)}function lp(l,r,o){const p=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));o.realloc(p);for(let v=o.pos-1;v>=l;v--)o.buf[v+p]=o.buf[v]}function bm(l,r){for(let o=0;o<l.length;o++)r.writeVarint(l[o])}function Ch(l,r){for(let o=0;o<l.length;o++)r.writeSVarint(l[o])}function ls(l,r){for(let o=0;o<l.length;o++)r.writeFloat(l[o])}function Ih(l,r){for(let o=0;o<l.length;o++)r.writeDouble(l[o])}function uf(l,r){for(let o=0;o<l.length;o++)r.writeBoolean(l[o])}function Wc(l,r){for(let o=0;o<l.length;o++)r.writeFixed32(l[o])}function s_(l,r){for(let o=0;o<l.length;o++)r.writeSFixed32(l[o])}function o_(l,r){for(let o=0;o<l.length;o++)r.writeFixed64(l[o])}function sv(l,r){for(let o=0;o<l.length;o++)r.writeSFixed64(l[o])}function up(l,r,o){l===1&&o.readMessage(l_,r)}function l_(l,r,o){if(l===3){const{id:p,bitmap:v,width:E,height:A,left:M,top:z,advance:F}=o.readMessage(Bl,{});r.push({id:p,bitmap:new ef({width:E+6,height:A+6},v),metrics:{width:E,height:A,left:M,top:z,advance:F}})}}function Bl(l,r,o){l===1?r.id=o.readVarint():l===2?r.bitmap=o.readBytes():l===3?r.width=o.readVarint():l===4?r.height=o.readVarint():l===5?r.left=o.readSVarint():l===6?r.top=o.readSVarint():l===7&&(r.advance=o.readVarint())}function u_(l){let r=0,o=0;for(const A of l)r+=A.w*A.h,o=Math.max(o,A.w);l.sort(((A,M)=>M.h-A.h));const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),o),h:1/0}];let v=0,E=0;for(const A of l)for(let M=p.length-1;M>=0;M--){const z=p[M];if(!(A.w>z.w||A.h>z.h)){if(A.x=z.x,A.y=z.y,E=Math.max(E,A.y+A.h),v=Math.max(v,A.x+A.w),A.w===z.w&&A.h===z.h){const F=p.pop();F&&M<p.length&&(p[M]=F)}else A.h===z.h?(z.x+=A.w,z.w-=A.w):A.w===z.w?(z.y+=A.h,z.h-=A.h):(p.push({x:z.x+A.w,y:z.y,w:z.w-A.w,h:A.h}),z.y+=A.h,z.h-=A.h);break}}return{w:v,h:E,fill:r/(v*E)||0}}class go{constructor(r,{pixelRatio:o,version:p,stretchX:v,stretchY:E,content:A,textFitWidth:M,textFitHeight:z}){this.paddedRect=r,this.pixelRatio=o,this.stretchX=v,this.stretchY=E,this.content=A,this.version=p,this.textFitWidth=M,this.textFitHeight=z}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class c_{constructor(r,o){const p={},v={};this.haveRenderCallbacks=[];const E=[];this.addImages(r,p,E),this.addImages(o,v,E);const{w:A,h:M}=u_(E),z=new Ms({width:A||1,height:M||1});for(const F in r){const q=r[F],W=p[F].paddedRect;Ms.copy(q.data,z,{x:0,y:0},{x:W.x+1,y:W.y+1},q.data)}for(const F in o){const q=o[F],W=v[F].paddedRect,te=W.x+1,ie=W.y+1,re=q.data.width,oe=q.data.height;Ms.copy(q.data,z,{x:0,y:0},{x:te,y:ie},q.data),Ms.copy(q.data,z,{x:0,y:oe-1},{x:te,y:ie-1},{width:re,height:1}),Ms.copy(q.data,z,{x:0,y:0},{x:te,y:ie+oe},{width:re,height:1}),Ms.copy(q.data,z,{x:re-1,y:0},{x:te-1,y:ie},{width:1,height:oe}),Ms.copy(q.data,z,{x:0,y:0},{x:te+re,y:ie},{width:1,height:oe})}this.image=z,this.iconPositions=p,this.patternPositions=v}addImages(r,o,p){for(const v in r){const E=r[v],A={x:0,y:0,w:E.data.width+2,h:E.data.height+2};p.push(A),o[v]=new go(A,E),E.hasRenderCallback&&this.haveRenderCallbacks.push(v)}}patchUpdatedImages(r,o){r.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in r.updatedImages)this.patchUpdatedImage(this.iconPositions[p],r.getImage(p),o),this.patchUpdatedImage(this.patternPositions[p],r.getImage(p),o)}patchUpdatedImage(r,o,p){if(!r||!o||r.version===o.version)return;r.version=o.version;const[v,E]=r.tl;p.update(o.data,void 0,{x:v,y:E})}}var Xc;Yt("ImagePosition",go),Yt("ImageAtlas",c_),_.ao=void 0,(Xc=_.ao||(_.ao={}))[Xc.none=0]="none",Xc[Xc.horizontal=1]="horizontal",Xc[Xc.vertical=2]="vertical",Xc[Xc.horizontalOnly=3]="horizontalOnly";class cp{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(r,o,p){const v=new cp;return v.scale=r||1,v.fontStack=o,v.verticalAlign=p||"bottom",v}static forImage(r,o){const p=new cp;return p.imageName=r,p.verticalAlign=o||"bottom",p}}class Fl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,o){const p=new Fl;for(let v=0;v<r.sections.length;v++){const E=r.sections[v];E.image?p.addImageSection(E):p.addTextSection(E,o)}return p}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSectionIndex(r){return this.sectionIndex[r]}getCharCode(r){return this.text.charCodeAt(r)}verticalizePunctuation(){this.text=(function(r){let o="";for(let p=0;p<r.length;p++){const v=r.charCodeAt(p+1)||null,E=r.charCodeAt(p-1)||null;o+=v&&od(v)&&!no[r[p+1]]||E&&od(E)&&!no[r[p-1]]||!no[r[p]]?r[p]:no[r[p]]}return o})(this.text)}trim(){let r=0;for(let p=0;p<this.text.length&&cf[this.text.charCodeAt(p)];p++)r++;let o=this.text.length;for(let p=this.text.length-1;p>=0&&p>=r&&cf[this.text.charCodeAt(p)];p--)o--;this.text=this.text.substring(r,o),this.sectionIndex=this.sectionIndex.slice(r,o)}substring(r,o){const p=new Fl;return p.text=this.text.substring(r,o),p.sectionIndex=this.sectionIndex.slice(r,o),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((r,o)=>Math.max(r,this.sections[o].scale)),0)}getMaxImageSize(r){let o=0,p=0;for(let v=0;v<this.length();v++){const E=this.getSection(v);if(E.imageName){const A=r[E.imageName];if(!A)continue;const M=A.displaySize;o=Math.max(o,M[0]),p=Math.max(p,M[1])}}return{maxImageWidth:o,maxImageHeight:p}}addTextSection(r,o){this.text+=r.text,this.sections.push(cp.forText(r.scale,r.fontStack||o,r.verticalAlign));const p=this.sections.length-1;for(let v=0;v<r.text.length;++v)this.sectionIndex.push(p)}addImageSection(r){const o=r.image?r.image.name:"";if(o.length===0)return void Pi("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push(cp.forImage(o,r.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Pi("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Ad(l,r,o,p,v,E,A,M,z,F,q,W,te,ie,re){const oe=Fl.fromFeature(l,v);let pe;W===_.ao.vertical&&oe.verticalizePunctuation();const{processBidirectionalText:Te,processStyledBidirectionalText:He}=ml;if(Te&&oe.sections.length===1){pe=[];const ot=Te(oe.toString(),f_(oe,F,E,r,p,ie));for(const gt of ot){const It=new Fl;It.text=gt,It.sections=oe.sections;for(let $t=0;$t<gt.length;$t++)It.sectionIndex.push(0);pe.push(It)}}else if(He){pe=[];const ot=He(oe.text,oe.sectionIndex,f_(oe,F,E,r,p,ie));for(const gt of ot){const It=new Fl;It.text=gt[0],It.sectionIndex=gt[1],It.sections=oe.sections,pe.push(It)}}else pe=(function(ot,gt){const It=[],$t=ot.text;let Bt=0;for(const Gt of gt)It.push(ot.substring(Bt,Gt)),Bt=Gt;return Bt<$t.length&&It.push(ot.substring(Bt,$t.length)),It})(oe,f_(oe,F,E,r,p,ie));const Le=[],Be={positionedLines:Le,text:oe.toString(),top:q[1],bottom:q[1],left:q[0],right:q[0],writingMode:W,iconsInText:!1,verticalizable:!1};return(function(ot,gt,It,$t,Bt,Gt,dn,qt,jt,St,Sn,Pn){let mn=0,un=0,Qn=0,Kr=0;const ya=qt==="right"?1:qt==="left"?0:.5,us=Xr/Pn;let Tl=0;for(const Lr of Bt){Lr.trim();const za=Lr.getMaxScale(),va={positionedGlyphs:[],lineOffset:0};ot.positionedLines[Tl]=va;const cs=va.positionedGlyphs;let yo=0;if(!Lr.length()){un+=Gt,++Tl;continue}const Wo=zb($t,Lr,us);for(let Rs=0;Rs<Lr.length();Rs++){const ca=Lr.getSection(Rs),Oa=Lr.getSectionIndex(Rs),xa=Lr.getCharCode(Rs),yr=uv(jt,Sn,xa);let Ii;if(ca.imageName){if(ot.iconsInText=!0,ca.scale=ca.scale*us,Ii=wm(ca,yr,za,Wo,$t),!Ii)continue;yo=Math.max(yo,Ii.imageOffset)}else if(Ii=df(ca,xa,yr,Wo,gt,It),!Ii)continue;const{rect:Ls,metrics:xc,baselineOffset:Xo}=Ii;cs.push({glyph:xa,imageName:ca.imageName,x:mn,y:un+Xo+-17,vertical:yr,scale:ca.scale,fontStack:ca.fontStack,sectionIndex:Oa,metrics:xc,rect:Ls}),yr?(ot.verticalizable=!0,mn+=(ca.imageName?xc.advance:Xr)*ca.scale+St):mn+=xc.advance*ca.scale+St}cs.length!==0&&(Qn=Math.max(mn-St,Qn),cv(cs,0,cs.length-1,ya)),mn=0,va.lineOffset=Math.max(yo,(za-1)*Xr);const ba=Gt*za+yo;un+=ba,Kr=Math.max(ba,Kr),++Tl}const{horizontalAlign:_o,verticalAlign:Da}=p_(dn);(function(Lr,za,va,cs,yo,Wo,ba,Rs,ca){const Oa=(za-va)*yo;let xa=0;xa=Wo!==ba?-Rs*cs- -17:-cs*ca*ba+.5*ba;for(const yr of Lr)for(const Ii of yr.positionedGlyphs)Ii.x+=Oa,Ii.y+=xa})(ot.positionedLines,ya,_o,Da,Qn,Kr,Gt,un,Bt.length),ot.top+=-Da*un,ot.bottom=ot.top+un,ot.left+=-_o*Qn,ot.right=ot.left+Qn})(Be,r,o,p,pe,A,M,z,W,F,te,re),!(function(ot){for(const gt of ot)if(gt.positionedGlyphs.length!==0)return!1;return!0})(Le)&&Be}const cf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},hf={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},ov={40:!0};function h_(l,r,o,p,v,E){if(r.imageName){const A=p[r.imageName];return A?A.displaySize[0]*r.scale*Xr/E+v:0}{const A=o[r.fontStack],M=A&&A[l];return M?M.metrics.advance*r.scale+v:0}}function d_(l,r,o,p){const v=Math.pow(l-r,2);return p?l<r?v/2:2*v:v+Math.abs(o)*o}function lv(l,r,o){let p=0;return l===10&&(p-=1e4),o&&(p+=150),l!==40&&l!==65288||(p+=50),r!==41&&r!==65289||(p+=50),p}function hp(l,r,o,p,v,E){let A=null,M=d_(r,o,v,E);for(const z of p){const F=d_(r-z.x,o,v,E)+z.badness;F<=M&&(A=z,M=F)}return{index:l,x:r,priorBreak:A,badness:M}}function xm(l){return l?xm(l.priorBreak).concat(l.index):[]}function f_(l,r,o,p,v,E){if(!l)return[];const A=[],M=(function(W,te,ie,re,oe,pe){let Te=0;for(let He=0;He<W.length();He++){const Le=W.getSection(He);Te+=h_(W.getCharCode(He),Le,re,oe,te,pe)}return Te/Math.max(1,Math.ceil(Te/ie))})(l,r,o,p,v,E),z=l.text.indexOf("")>=0;let F=0;for(let W=0;W<l.length();W++){const te=l.getSection(W),ie=l.getCharCode(W);if(cf[ie]||(F+=h_(ie,te,p,v,r,E)),W<l.length()-1){const re=!((q=ie)<11904)&&(!!ri["CJK Compatibility Forms"](q)||!!ri["CJK Compatibility"](q)||!!ri["CJK Strokes"](q)||!!ri["CJK Symbols and Punctuation"](q)||!!ri["Enclosed CJK Letters and Months"](q)||!!ri["Halfwidth and Fullwidth Forms"](q)||!!ri["Ideographic Description Characters"](q)||!!ri["Vertical Forms"](q)||sc.test(String.fromCodePoint(q)));(hf[ie]||re||te.imageName||W!==l.length()-2&&ov[l.getCharCode(W+1)])&&A.push(hp(W+1,F,M,A,lv(ie,l.getCharCode(W+1),re&&z),!1))}}var q;return xm(hp(l.length(),F,M,A,0,!0))}function p_(l){let r=.5,o=.5;switch(l){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:r,verticalAlign:o}}function zb(l,r,o){const p=r.getMaxScale()*Xr,{maxImageWidth:v,maxImageHeight:E}=r.getMaxImageSize(l),A=Math.max(p,E*o);return{verticalLineContentWidth:Math.max(p,v*o),horizontalLineContentHeight:A}}function m_(l){switch(l){case"top":return 0;case"center":return .5;default:return 1}}function uv(l,r,o){return!(l===_.ao.horizontal||!r&&!Vc(o)||r&&(cf[o]||(p=o,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(p)))));var p}function df(l,r,o,p,v,E){const A=E[l.fontStack],M=(function(F,q,W,te){if(F&&F.rect)return F;const ie=q[W.fontStack],re=ie&&ie[te];return re?{rect:null,metrics:re.metrics}:null})(A&&A[r],v,l,r);if(M===null)return null;let z;if(o)z=p.verticalLineContentWidth-l.scale*Xr;else{const F=m_(l.verticalAlign);z=(p.horizontalLineContentHeight-l.scale*Xr)*F}return{rect:M.rect,metrics:M.metrics,baselineOffset:z}}function wm(l,r,o,p,v){const E=v[l.imageName];if(!E)return null;const A=E.paddedRect,M=E.displaySize,z={width:M[0],height:M[1],left:1,top:-3,advance:r?M[1]:M[0]};let F;if(r)F=p.verticalLineContentWidth-M[1]*l.scale;else{const q=m_(l.verticalAlign);F=(p.horizontalLineContentHeight-M[1]*l.scale)*q}return{rect:A,metrics:z,baselineOffset:F,imageOffset:(r?M[0]:M[1])*l.scale-Xr*o}}function cv(l,r,o,p){if(p===0)return;const v=l[o],E=(l[o].x+v.metrics.advance*v.scale)*p;for(let A=r;A<=o;A++)l[A].x-=E}function hv(l,r,o){const{horizontalAlign:p,verticalAlign:v}=p_(o),E=r[0]-l.displaySize[0]*p,A=r[1]-l.displaySize[1]*v;return{image:l,top:A,bottom:A+l.displaySize[1],left:E,right:E+l.displaySize[0]}}function g_(l){var r,o;let p=l.left,v=l.top,E=l.right-p,A=l.bottom-v;const M=(r=l.image.textFitWidth)!==null&&r!==void 0?r:"stretchOrShrink",z=(o=l.image.textFitHeight)!==null&&o!==void 0?o:"stretchOrShrink",F=(l.image.content[2]-l.image.content[0])/(l.image.content[3]-l.image.content[1]);if(z==="proportional"){if(M==="stretchOnly"&&E/A<F||M==="proportional"){const q=Math.ceil(A*F);p*=q/E,E=q}}else if(M==="proportional"&&z==="stretchOnly"&&F!==0&&E/A>F){const q=Math.ceil(E/F);v*=q/A,A=q}return{x1:p,y1:v,x2:p+E,y2:v+A}}function __(l,r,o,p,v,E){const A=l.image;let M;if(A.content){const pe=A.content,Te=A.pixelRatio||1;M=[pe[0]/Te,pe[1]/Te,A.displaySize[0]-pe[2]/Te,A.displaySize[1]-pe[3]/Te]}const z=r.left*E,F=r.right*E;let q,W,te,ie;o==="width"||o==="both"?(ie=v[0]+z-p[3],W=v[0]+F+p[1]):(ie=v[0]+(z+F-A.displaySize[0])/2,W=ie+A.displaySize[0]);const re=r.top*E,oe=r.bottom*E;return o==="height"||o==="both"?(q=v[1]+re-p[0],te=v[1]+oe+p[2]):(q=v[1]+(re+oe-A.displaySize[1])/2,te=q+A.displaySize[1]),{image:A,top:q,right:W,bottom:te,left:ie,collisionPadding:M}}const _c=128,Kc=32640;function dp(l,r){const{expression:o}=r;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new Di(l+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:v}=o;let E=0;for(;E<p.length&&p[E]<=l;)E++;E=Math.max(0,E-1);let A=E;for(;A<p.length&&p[A]<l+1;)A++;A=Math.min(p.length-1,A);const M=p[E],z=p[A];return o.kind==="composite"?{kind:"composite",minZoom:M,maxZoom:z,interpolationType:v}:{kind:"camera",minZoom:M,maxZoom:z,minSize:o.evaluate(new Di(M)),maxSize:o.evaluate(new Di(z)),interpolationType:v}}}function Tm(l,r,o){let p="never";const v=l.get(r);return v?p=v:l.get(o)&&(p="always"),p}const dv=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Qi(l,r,o,p,v,E,A,M,z,F,q,W,te){const ie=M?Math.min(Kc,Math.round(M[0])):0,re=M?Math.min(Kc,Math.round(M[1])):0;l.emplaceBack(r,o,Math.round(32*p),Math.round(32*v),E,A,(ie<<1)+(z?1:0),re,16*F,16*q,256*W,256*te)}function fp(l,r,o){l.emplaceBack(r.x,r.y,o),l.emplaceBack(r.x,r.y,o),l.emplaceBack(r.x,r.y,o),l.emplaceBack(r.x,r.y,o)}function Ob(l){for(const r of l.sections)if(oc(r.text))return!0;return!1}class Sm{constructor(r){this.layoutVertexArray=new Ft,this.indexArray=new Yi,this.programConfigurations=r,this.segments=new jn,this.dynamicLayoutVertexArray=new Ct,this.opacityVertexArray=new ln,this.hasVisibleVertices=!1,this.placedSymbolArray=new ae}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(r,o,p,v){this.isEmpty()||(p&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,r_.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,Zc.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,dv,!0),this.opacityVertexBuffer.itemSize=1),(p||v)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Yt("SymbolBuffers",Sm);class y_{constructor(r,o,p){this.layoutVertexArray=new r,this.layoutAttributes=o,this.indexArray=new p,this.segments=new jn,this.collisionVertexArray=new bi}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,_a.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Yt("CollisionBuffers",y_);class ff{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.globalState=r.globalState,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((A=>A.id)),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=dp(this.zoom,o["text-size"]),this.iconSizeData=dp(this.zoom,o["icon-size"]);const p=this.layers[0].layout,v=p.get("symbol-sort-key"),E=p.get("symbol-z-order");this.canOverlap=Tm(p,"text-overlap","text-allow-overlap")!=="never"||Tm(p,"icon-overlap","icon-allow-overlap")!=="never"||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=E!=="viewport-y"&&!v.isConstant(),this.sortFeaturesByY=(E==="viewport-y"||E==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,p.get("symbol-placement")==="point"&&(this.writingModes=p.get("text-writing-mode").map((A=>_.ao[A]))),this.stateDependentLayerIds=this.layers.filter((A=>A.isStateDependent())).map((A=>A.id)),this.sourceID=r.sourceID}createArrays(){this.text=new Sm(new po(this.layers,this.zoom,(r=>/^text/.test(r)))),this.icon=new Sm(new po(this.layers,this.zoom,(r=>/^icon/.test(r)))),this.glyphOffsetArray=new ve,this.lineVertexArray=new we,this.symbolInstances=new me,this.textAnchorOffsets=new Ee}calculateGlyphDependencies(r,o,p,v,E){for(let A=0;A<r.length;A++)if(o[r.charCodeAt(A)]=!0,(p||v)&&E){const M=no[r.charAt(A)];M&&(o[M.charCodeAt(0)]=!0)}}populate(r,o,p){const v=this.layers[0],E=v.layout,A=E.get("text-font"),M=E.get("text-field"),z=E.get("icon-image"),F=(M.value.kind!=="constant"||M.value.value instanceof Wi&&!M.value.value.isEmpty()||M.value.value.toString().length>0)&&(A.value.kind!=="constant"||A.value.value.length>0),q=z.value.kind!=="constant"||!!z.value.value||Object.keys(z.parameters).length>0,W=E.get("symbol-sort-key");if(this.features=[],!F&&!q)return;const te=o.iconDependencies,ie=o.glyphDependencies,re=o.availableImages,oe=new Di(this.zoom,{globalState:this.globalState});for(const{feature:pe,id:Te,index:He,sourceLayerIndex:Le}of r){const Be=v._featureFilter.needGeometry,ot=vl(pe,Be);if(!v._featureFilter.filter(oe,ot,p))continue;let gt,It;if(Be||(ot.geometry=su(pe)),F){const Bt=v.getValueAndResolveTokens("text-field",ot,p,re),Gt=Wi.factory(Bt),dn=this.hasRTLText=this.hasRTLText||Ob(Gt);(!dn||ml.getRTLTextPluginStatus()==="unavailable"||dn&&ml.isParsed())&&(gt=a_(Gt,v,ot))}if(q){const Bt=v.getValueAndResolveTokens("icon-image",ot,p,re);It=Bt instanceof cr?Bt:cr.fromString(Bt)}if(!gt&&!It)continue;const $t=this.sortFeaturesByKey?W.evaluate(ot,{},p):void 0;if(this.features.push({id:Te,text:gt,icon:It,index:He,sourceLayerIndex:Le,geometry:ot.geometry,properties:pe.properties,type:os.types[pe.type],sortKey:$t}),It&&(te[It.name]=!0),gt){const Bt=A.evaluate(ot,{},p).join(","),Gt=E.get("text-rotation-alignment")!=="viewport"&&E.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(_.ao.vertical)>=0;for(const dn of gt.sections)if(dn.image)te[dn.image.name]=!0;else{const qt=sd(gt.toString()),jt=dn.fontStack||Bt,St=ie[jt]=ie[jt]||{};this.calculateGlyphDependencies(dn.text,St,Gt,this.allowVerticalPlacement,qt)}}}E.get("symbol-placement")==="line"&&(this.features=(function(pe){const Te={},He={},Le=[];let Be=0;function ot(Bt){Le.push(pe[Bt]),Be++}function gt(Bt,Gt,dn){const qt=He[Bt];return delete He[Bt],He[Gt]=qt,Le[qt].geometry[0].pop(),Le[qt].geometry[0]=Le[qt].geometry[0].concat(dn[0]),qt}function It(Bt,Gt,dn){const qt=Te[Gt];return delete Te[Gt],Te[Bt]=qt,Le[qt].geometry[0].shift(),Le[qt].geometry[0]=dn[0].concat(Le[qt].geometry[0]),qt}function $t(Bt,Gt,dn){const qt=dn?Gt[0][Gt[0].length-1]:Gt[0][0];return`${Bt}:${qt.x}:${qt.y}`}for(let Bt=0;Bt<pe.length;Bt++){const Gt=pe[Bt],dn=Gt.geometry,qt=Gt.text?Gt.text.toString():null;if(!qt){ot(Bt);continue}const jt=$t(qt,dn),St=$t(qt,dn,!0);if(jt in He&&St in Te&&He[jt]!==Te[St]){const Sn=It(jt,St,dn),Pn=gt(jt,St,Le[Sn].geometry);delete Te[jt],delete He[St],He[$t(qt,Le[Pn].geometry,!0)]=Pn,Le[Sn].geometry=null}else jt in He?gt(jt,St,dn):St in Te?It(jt,St,dn):(ot(Bt),Te[jt]=Be-1,He[St]=Be-1)}return Le.filter((Bt=>Bt.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((pe,Te)=>pe.sortKey-Te.sortKey))}update(r,o,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,o,this.layers,p),this.icon.programConfigurations.updatePaintArrays(r,o,this.layers,p))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,o){const p=this.lineVertexArray.length;if(r.segment!==void 0){let v=r.dist(o[r.segment+1]),E=r.dist(o[r.segment]);const A={};for(let M=r.segment+1;M<o.length;M++)A[M]={x:o[M].x,y:o[M].y,tileUnitDistanceFromAnchor:v},M<o.length-1&&(v+=o[M+1].dist(o[M]));for(let M=r.segment||0;M>=0;M--)A[M]={x:o[M].x,y:o[M].y,tileUnitDistanceFromAnchor:E},M>0&&(E+=o[M-1].dist(o[M]));for(let M=0;M<o.length;M++){const z=A[M];this.lineVertexArray.emplaceBack(z.x,z.y,z.tileUnitDistanceFromAnchor)}}return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(r,o,p,v,E,A,M,z,F,q,W,te){const ie=r.indexArray,re=r.layoutVertexArray,oe=r.segments.prepareSegment(4*o.length,re,ie,this.canOverlap?A.sortKey:void 0),pe=this.glyphOffsetArray.length,Te=oe.vertexLength,He=this.allowVerticalPlacement&&M===_.ao.vertical?Math.PI/2:0,Le=A.text&&A.text.sections;for(let Be=0;Be<o.length;Be++){const{tl:ot,tr:gt,bl:It,br:$t,tex:Bt,pixelOffsetTL:Gt,pixelOffsetBR:dn,minFontScaleX:qt,minFontScaleY:jt,glyphOffset:St,isSDF:Sn,sectionIndex:Pn}=o[Be],mn=oe.vertexLength,un=St[1];Qi(re,z.x,z.y,ot.x,un+ot.y,Bt.x,Bt.y,p,Sn,Gt.x,Gt.y,qt,jt),Qi(re,z.x,z.y,gt.x,un+gt.y,Bt.x+Bt.w,Bt.y,p,Sn,dn.x,Gt.y,qt,jt),Qi(re,z.x,z.y,It.x,un+It.y,Bt.x,Bt.y+Bt.h,p,Sn,Gt.x,dn.y,qt,jt),Qi(re,z.x,z.y,$t.x,un+$t.y,Bt.x+Bt.w,Bt.y+Bt.h,p,Sn,dn.x,dn.y,qt,jt),fp(r.dynamicLayoutVertexArray,z,He),ie.emplaceBack(mn,mn+2,mn+1),ie.emplaceBack(mn+1,mn+2,mn+3),oe.vertexLength+=4,oe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(St[0]),Be!==o.length-1&&Pn===o[Be+1].sectionIndex||r.programConfigurations.populatePaintArrays(re.length,A,A.index,{},te,Le&&Le[Pn])}r.placedSymbolArray.emplaceBack(z.x,z.y,pe,this.glyphOffsetArray.length-pe,Te,F,q,z.segment,p?p[0]:0,p?p[1]:0,v[0],v[1],M,0,!1,0,W)}_addCollisionDebugVertex(r,o,p,v,E,A){return o.emplaceBack(0,0),r.emplaceBack(p.x,p.y,v,E,Math.round(A.x),Math.round(A.y))}addCollisionDebugVertices(r,o,p,v,E,A,M){const z=E.segments.prepareSegment(4,E.layoutVertexArray,E.indexArray),F=z.vertexLength,q=E.layoutVertexArray,W=E.collisionVertexArray,te=M.anchorX,ie=M.anchorY;this._addCollisionDebugVertex(q,W,A,te,ie,new C(r,o)),this._addCollisionDebugVertex(q,W,A,te,ie,new C(p,o)),this._addCollisionDebugVertex(q,W,A,te,ie,new C(p,v)),this._addCollisionDebugVertex(q,W,A,te,ie,new C(r,v)),z.vertexLength+=4;const re=E.indexArray;re.emplaceBack(F,F+1),re.emplaceBack(F+1,F+2),re.emplaceBack(F+2,F+3),re.emplaceBack(F+3,F),z.primitiveLength+=4}addDebugCollisionBoxes(r,o,p,v){for(let E=r;E<o;E++){const A=this.collisionBoxArray.get(E);this.addCollisionDebugVertices(A.x1,A.y1,A.x2,A.y2,v?this.textCollisionBox:this.iconCollisionBox,A.anchorPoint,p)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new y_(Zn,Hc.members,qi),this.iconCollisionBox=new y_(Zn,Hc.members,qi);for(let r=0;r<this.symbolInstances.length;r++){const o=this.symbolInstances.get(r);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}}_deserializeCollisionBoxesForSymbol(r,o,p,v,E,A,M,z,F){const q={};for(let W=o;W<p;W++){const te=r.get(W);q.textBox={x1:te.x1,y1:te.y1,x2:te.x2,y2:te.y2,anchorPointX:te.anchorPointX,anchorPointY:te.anchorPointY},q.textFeatureIndex=te.featureIndex;break}for(let W=v;W<E;W++){const te=r.get(W);q.verticalTextBox={x1:te.x1,y1:te.y1,x2:te.x2,y2:te.y2,anchorPointX:te.anchorPointX,anchorPointY:te.anchorPointY},q.verticalTextFeatureIndex=te.featureIndex;break}for(let W=A;W<M;W++){const te=r.get(W);q.iconBox={x1:te.x1,y1:te.y1,x2:te.x2,y2:te.y2,anchorPointX:te.anchorPointX,anchorPointY:te.anchorPointY},q.iconFeatureIndex=te.featureIndex;break}for(let W=z;W<F;W++){const te=r.get(W);q.verticalIconBox={x1:te.x1,y1:te.y1,x2:te.x2,y2:te.y2,anchorPointX:te.anchorPointX,anchorPointY:te.anchorPointY},q.verticalIconFeatureIndex=te.featureIndex;break}return q}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const p=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(r,o){const p=r.placedSymbolArray.get(o),v=p.vertexStartIndex+4*p.numGlyphs;for(let E=p.vertexStartIndex;E<v;E+=4)r.indexArray.emplaceBack(E,E+2,E+1),r.indexArray.emplaceBack(E+1,E+2,E+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(r),p=Math.cos(r),v=[],E=[],A=[];for(let M=0;M<this.symbolInstances.length;++M){A.push(M);const z=this.symbolInstances.get(M);v.push(0|Math.round(o*z.anchorX+p*z.anchorY)),E.push(z.featureIndex)}return A.sort(((M,z)=>v[M]-v[z]||E[z]-E[M])),A}addToSortKeyRanges(r,o){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===o?p.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const p=this.symbolInstances.get(o);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach(((v,E,A)=>{v>=0&&A.indexOf(v)===E&&this.addIndicesForPlacedSymbol(this.text,v)})),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let fv,pp;Yt("SymbolBucket",ff,{omit:["layers","collisionBoxArray","features","compareText"]}),ff.MAX_GLYPHS=65535,ff.addDynamicAttributes=fp;var Mh={get paint(){return pp=pp||new As({"icon-opacity":new Tn(qe.paint_symbol["icon-opacity"]),"icon-color":new Tn(qe.paint_symbol["icon-color"]),"icon-halo-color":new Tn(qe.paint_symbol["icon-halo-color"]),"icon-halo-width":new Tn(qe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Tn(qe.paint_symbol["icon-halo-blur"]),"icon-translate":new an(qe.paint_symbol["icon-translate"]),"icon-translate-anchor":new an(qe.paint_symbol["icon-translate-anchor"]),"text-opacity":new Tn(qe.paint_symbol["text-opacity"]),"text-color":new Tn(qe.paint_symbol["text-color"],{runtimeType:ir,getOverride:l=>l.textColor,hasOverride:l=>!!l.textColor}),"text-halo-color":new Tn(qe.paint_symbol["text-halo-color"]),"text-halo-width":new Tn(qe.paint_symbol["text-halo-width"]),"text-halo-blur":new Tn(qe.paint_symbol["text-halo-blur"]),"text-translate":new an(qe.paint_symbol["text-translate"]),"text-translate-anchor":new an(qe.paint_symbol["text-translate-anchor"])})},get layout(){return fv=fv||new As({"symbol-placement":new an(qe.layout_symbol["symbol-placement"]),"symbol-spacing":new an(qe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new an(qe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Tn(qe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new an(qe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new an(qe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new an(qe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new an(qe.layout_symbol["icon-ignore-placement"]),"icon-optional":new an(qe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new an(qe.layout_symbol["icon-rotation-alignment"]),"icon-size":new Tn(qe.layout_symbol["icon-size"]),"icon-text-fit":new an(qe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new an(qe.layout_symbol["icon-text-fit-padding"]),"icon-image":new Tn(qe.layout_symbol["icon-image"]),"icon-rotate":new Tn(qe.layout_symbol["icon-rotate"]),"icon-padding":new Tn(qe.layout_symbol["icon-padding"]),"icon-keep-upright":new an(qe.layout_symbol["icon-keep-upright"]),"icon-offset":new Tn(qe.layout_symbol["icon-offset"]),"icon-anchor":new Tn(qe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new an(qe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new an(qe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new an(qe.layout_symbol["text-rotation-alignment"]),"text-field":new Tn(qe.layout_symbol["text-field"]),"text-font":new Tn(qe.layout_symbol["text-font"]),"text-size":new Tn(qe.layout_symbol["text-size"]),"text-max-width":new Tn(qe.layout_symbol["text-max-width"]),"text-line-height":new an(qe.layout_symbol["text-line-height"]),"text-letter-spacing":new Tn(qe.layout_symbol["text-letter-spacing"]),"text-justify":new Tn(qe.layout_symbol["text-justify"]),"text-radial-offset":new Tn(qe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new an(qe.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Tn(qe.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Tn(qe.layout_symbol["text-anchor"]),"text-max-angle":new an(qe.layout_symbol["text-max-angle"]),"text-writing-mode":new an(qe.layout_symbol["text-writing-mode"]),"text-rotate":new Tn(qe.layout_symbol["text-rotate"]),"text-padding":new an(qe.layout_symbol["text-padding"]),"text-keep-upright":new an(qe.layout_symbol["text-keep-upright"]),"text-transform":new Tn(qe.layout_symbol["text-transform"]),"text-offset":new Tn(qe.layout_symbol["text-offset"]),"text-allow-overlap":new an(qe.layout_symbol["text-allow-overlap"]),"text-overlap":new an(qe.layout_symbol["text-overlap"]),"text-ignore-placement":new an(qe.layout_symbol["text-ignore-placement"]),"text-optional":new an(qe.layout_symbol["text-optional"])})}};class Em{constructor(r){if(r.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=r.property.overrides?r.property.overrides.runtimeType:Aa,this.defaultValue=r}evaluate(r){if(r.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(r.formattedSection))return o.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Yt("FormatSectionOverride",Em,{omit:["defaultValue"]});class Cd extends ho{constructor(r){super(r,Mh)}recalculate(r,o){if(super.recalculate(r,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const p=this.layout.get("text-writing-mode");if(p){const v=[];for(const E of p)v.indexOf(E)<0&&v.push(E);this.layout._values["text-writing-mode"]=v}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(r,o,p,v){const E=this.layout.get(r).evaluate(o,{},p,v),A=this._unevaluatedLayout._values[r];return A.isDataDriven()||ec(A.value)||!E?E:(function(M,z){return z.replace(/{([^{}]+)}/g,((F,q)=>M&&q in M?String(M[q]):""))})(o.properties,E)}createBucket(r){return new ff(r)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const r of Mh.paint.overridableProperties){if(!Cd.hasPaintOverride(this.layout,r))continue;const o=this.paint.get(r),p=new Em(o),v=new Ju(p,o.property.specification);let E=null;E=o.value.kind==="constant"||o.value.kind==="source"?new f("source",v):new x("composite",v,o.value.zoomStops),this.paint._values[r]=new gl(o.property,E,o.parameters)}}_handleOverridablePaintPropertyUpdate(r,o,p){return!(!this.layout||o.isDataDriven()||p.isDataDriven())&&Cd.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,o){const p=r.get("text-field"),v=Mh.paint.properties[o];let E=!1;const A=M=>{for(const z of M)if(v.overrides&&v.overrides.hasOverride(z))return void(E=!0)};if(p.value.kind==="constant"&&p.value.value instanceof Wi)A(p.value.value.sections);else if(p.value.kind==="source"){const M=F=>{E||(F instanceof na&&fn(F.value)===Us?A(F.value.sections):F instanceof ht?A(F.sections):F.eachChild(M))},z=p.value;z._styleExpression&&M(z._styleExpression.expression)}return E}}let Am;var Ph={get paint(){return Am=Am||new As({"background-color":new an(qe.paint_background["background-color"]),"background-pattern":new Fo(qe.paint_background["background-pattern"]),"background-opacity":new an(qe.paint_background["background-opacity"])})}};class yc extends ho{constructor(r){super(r,Ph)}}let pf;var Nb={get paint(){return pf=pf||new As({"raster-opacity":new an(qe.paint_raster["raster-opacity"]),"raster-hue-rotate":new an(qe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new an(qe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new an(qe.paint_raster["raster-brightness-max"]),"raster-saturation":new an(qe.paint_raster["raster-saturation"]),"raster-contrast":new an(qe.paint_raster["raster-contrast"]),"raster-resampling":new an(qe.paint_raster["raster-resampling"]),"raster-fade-duration":new an(qe.paint_raster["raster-fade-duration"])})}};class pv extends ho{constructor(r){super(r,Nb)}}class mv extends ho{constructor(r){super(r,{}),this.onAdd=o=>{this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)},this.onRemove=o=>{this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)},this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class gv{constructor(r){this._methodToThrottle=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const _v={once:!0},v_=63710088e-1;class vc{constructor(r,o){if(isNaN(r)||isNaN(o))throw new Error(`Invalid LngLat object: (${r}, ${o})`);if(this.lng=+r,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new vc(Fn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const o=Math.PI/180,p=this.lat*o,v=r.lat*o,E=Math.sin(p)*Math.sin(v)+Math.cos(p)*Math.cos(v)*Math.cos((r.lng-this.lng)*o);return v_*Math.acos(Math.min(E,1))}static convert(r){if(r instanceof vc)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new vc(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new vc(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const b_=2*Math.PI*v_;function x_(l){return b_*Math.cos(l*Math.PI/180)}function yv(l){return(180+l)/360}function Cm(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function Im(l,r){return l/x_(r)}function w_(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function vv(l,r){return l*x_(w_(r))}class Yc{constructor(r,o,p=0){this.x=+r,this.y=+o,this.z=+p}static fromLngLat(r,o=0){const p=vc.convert(r);return new Yc(yv(p.lng),Cm(p.lat),Im(o,p.lat))}toLngLat(){return new vc(360*this.x-180,w_(this.y))}toAltitude(){return vv(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/b_*(r=w_(this.y),1/Math.cos(r*Math.PI/180));var r}}function bv(l,r,o){var p=2*Math.PI*6378137/256/Math.pow(2,o);return[l*p-2*Math.PI*6378137/2,r*p-2*Math.PI*6378137/2]}class Mm{constructor(r,o,p){if(!(function(v,E,A){return!(v<0||v>25||A<0||A>=Math.pow(2,v)||E<0||E>=Math.pow(2,v))})(r,o,p))throw new Error(`x=${o}, y=${p}, z=${r} outside of bounds. 0<=x<${Math.pow(2,r)}, 0<=y<${Math.pow(2,r)} 0<=z<=25 `);this.z=r,this.x=o,this.y=p,this.key=Qc(0,r,r,o,p)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,o,p){const v=(A=this.y,M=this.z,z=bv(256*(E=this.x),256*(A=Math.pow(2,M)-A-1),M),F=bv(256*(E+1),256*(A+1),M),z[0]+","+z[1]+","+F[0]+","+F[1]);var E,A,M,z,F;const q=(function(W,te,ie){let re,oe="";for(let pe=W;pe>0;pe--)re=1<<pe-1,oe+=(te&re?1:0)+(ie&re?2:0);return oe})(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(p==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,o>1?"@2x":"").replace(/{quadkey}/g,q).replace(/{bbox-epsg-3857}/g,v)}isChildOf(r){const o=this.z-r.z;return o>0&&r.x===this.x>>o&&r.y===this.y>>o}getTilePoint(r){const o=Math.pow(2,this.z);return new C((r.x*o-this.x)*Zt,(r.y*o-this.y)*Zt)}toString(){return`${this.z}/${this.x}/${this.y}`}}class yi{constructor(r,o){this.wrap=r,this.canonical=o,this.key=Qc(r,o.z,o.z,o.x,o.y)}}class Ho{constructor(r,o,p,v,E){if(this.terrainRttPosMatrix32f=null,r<p)throw new Error(`overscaledZ should be >= z; overscaledZ = ${r}; z = ${p}`);this.overscaledZ=r,this.wrap=o,this.canonical=new Mm(p,+v,+E),this.key=Qc(o,r,p,v,E)}clone(){return new Ho(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-r;return r>this.canonical.z?new Ho(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ho(r,this.wrap,r,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(r,o){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-r;return r>this.canonical.z?Qc(this.wrap*+o,r,this.canonical.z,this.canonical.x,this.canonical.y):Qc(this.wrap*+o,r,r,this.canonical.x>>p,this.canonical.y>>p)}isChildOf(r){if(r.wrap!==this.wrap)return!1;const o=this.canonical.z-r.canonical.z;return r.overscaledZ===0||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>o&&r.canonical.y===this.canonical.y>>o}children(r){if(this.overscaledZ>=r)return[new Ho(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,p=2*this.canonical.x,v=2*this.canonical.y;return[new Ho(o,this.wrap,o,p,v),new Ho(o,this.wrap,o,p+1,v),new Ho(o,this.wrap,o,p,v+1),new Ho(o,this.wrap,o,p+1,v+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Ho(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Ho(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new yi(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(r){return this.canonical.getTilePoint(new Yc(r.x-this.wrap,r.y))}}function Qc(l,r,o,p,v){(l*=2)<0&&(l=-1*l-1);const E=1<<o;return(E*E*l+E*v+p).toString(36)+o.toString(36)+r.toString(36)}function Id(l,r){return r?l.properties[r]:l.id}Yt("CanonicalTileID",Mm),Yt("OverscaledTileID",Ho,{omit:["terrainRttPosMatrix32f"]});class Rh{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(r){return this.minX=Math.min(this.minX,r.x),this.minY=Math.min(this.minY,r.y),this.maxX=Math.max(this.maxX,r.x),this.maxY=Math.max(this.maxY,r.y),this}expandBy(r){return this.minX-=r,this.minY-=r,this.maxX+=r,this.maxY+=r,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(r){return this.expandBy(-r)}map(r){const o=new Rh;return o.extend(r(new C(this.minX,this.minY))),o.extend(r(new C(this.maxX,this.minY))),o.extend(r(new C(this.minX,this.maxY))),o.extend(r(new C(this.maxX,this.maxY))),o}static fromPoints(r){const o=new Rh;for(const p of r)o.extend(p);return o}contains(r){return r.x>=this.minX&&r.x<=this.maxX&&r.y>=this.minY&&r.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(r){return!this.empty()&&!r.empty()&&r.minX>=this.minX&&r.maxX<=this.maxX&&r.minY>=this.minY&&r.maxY<=this.maxY}intersects(r){return!this.empty()&&!r.empty()&&r.minX<=this.maxX&&r.maxX>=this.minX&&r.minY<=this.maxY&&r.maxY>=this.minY}}class Pm{constructor(r){this._stringToNumber={},this._numberToString=[];for(let o=0;o<r.length;o++){const p=r[o];this._stringToNumber[p]=o,this._numberToString[o]=p}}encode(r){return this._stringToNumber[r]}decode(r){if(r>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${r} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[r]}}class mf{constructor(r,o,p,v,E){this.type="Feature",this._vectorTileFeature=r,r._z=o,r._x=p,r._y=v,this.properties=r.properties,this.id=E}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={geometry:this.geometry};for(const o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(r[o]=this[o]);return r}}class mp{constructor(r,o){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new gh(Zt,16,0),this.grid3D=new gh(Zt,16,0),this.featureIndexArray=new Ve,this.promoteId=o}insert(r,o,p,v,E,A){const M=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,v,E);const z=A?this.grid3D:this.grid;for(let F=0;F<o.length;F++){const q=o[F],W=[1/0,1/0,-1/0,-1/0];for(let te=0;te<q.length;te++){const ie=q[te];W[0]=Math.min(W[0],ie.x),W[1]=Math.min(W[1],ie.y),W[2]=Math.max(W[2],ie.x),W[3]=Math.max(W[3],ie.y)}W[0]<Zt&&W[1]<Zt&&W[2]>=0&&W[3]>=0&&z.insert(M,W[0],W[1],W[2],W[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new gc(new lf(this.rawTileData)).layers,this.sourceLayerCoder=new Pm(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(r,o,p,v){this.loadVTLayers();const E=r.params,A=Zt/r.tileSize/r.scale,M=ut(E.filter),z=r.queryGeometry,F=r.queryPadding*A,q=Rh.fromPoints(z),W=this.grid.query(q.minX-F,q.minY-F,q.maxX+F,q.maxY+F),te=Rh.fromPoints(r.cameraQueryGeometry).expandBy(F),ie=this.grid3D.query(te.minX,te.minY,te.maxX,te.maxY,((pe,Te,He,Le)=>(function(Be,ot,gt,It,$t){for(const Gt of Be)if(ot<=Gt.x&&gt<=Gt.y&&It>=Gt.x&&$t>=Gt.y)return!0;const Bt=[new C(ot,gt),new C(ot,$t),new C(It,$t),new C(It,gt)];if(Be.length>2){for(const Gt of Bt)if(pd(Be,Gt))return!0}for(let Gt=0;Gt<Be.length-1;Gt++)if($y(Be[Gt],Be[Gt+1],Bt))return!0;return!1})(r.cameraQueryGeometry,pe-F,Te-F,He+F,Le+F)));for(const pe of ie)W.push(pe);W.sort(wv);const re={};let oe;for(let pe=0;pe<W.length;pe++){const Te=W[pe];if(Te===oe)continue;oe=Te;const He=this.featureIndexArray.get(Te);let Le=null;this.loadMatchingFeature(re,He.bucketIndex,He.sourceLayerIndex,He.featureIndex,M,E.layers,E.availableImages,o,p,v,((Be,ot,gt)=>(Le||(Le=su(Be)),ot.queryIntersectsFeature({queryGeometry:z,feature:Be,featureState:gt,geometry:Le,zoom:this.z,transform:r.transform,pixelsToTileUnits:A,pixelPosMatrix:r.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:r.getElevation}))))}return re}loadMatchingFeature(r,o,p,v,E,A,M,z,F,q,W){const te=this.bucketLayerIDs[o];if(A&&!te.some((pe=>A.has(pe))))return;const ie=this.sourceLayerCoder.decode(p),re=this.vtLayers[ie].feature(v);if(E.needGeometry){const pe=vl(re,!0);if(!E.filter(new Di(this.tileID.overscaledZ),pe,this.tileID.canonical))return}else if(!E.filter(new Di(this.tileID.overscaledZ),re))return;const oe=this.getId(re,ie);for(let pe=0;pe<te.length;pe++){const Te=te[pe];if(A&&!A.has(Te))continue;const He=z[Te];if(!He)continue;let Le={};oe&&q&&(Le=q.getState(He.sourceLayer||"_geojsonTileLayer",oe));const Be=oi({},F[Te]);Be.paint=xv(Be.paint,He.paint,re,Le,M),Be.layout=xv(Be.layout,He.layout,re,Le,M);const ot=!W||W(re,He,Le);if(!ot)continue;const gt=new mf(re,this.z,this.x,this.y,oe);gt.layer=Be;let It=r[Te];It===void 0&&(It=r[Te]=[]),It.push({featureIndex:v,feature:gt,intersectionZ:ot})}}lookupSymbolFeatures(r,o,p,v,E,A,M,z){const F={};this.loadVTLayers();const q=ut(E);for(const W of r)this.loadMatchingFeature(F,p,v,W,q,A,M,z,o);return F}hasLayer(r){for(const o of this.bucketLayerIDs)for(const p of o)if(r===p)return!0;return!1}getId(r,o){var p;let v=r.id;return this.promoteId&&(v=r.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof v=="boolean"&&(v=Number(v)),v===void 0&&(!((p=r.properties)===null||p===void 0)&&p.cluster)&&this.promoteId&&(v=Number(r.properties.cluster_id))),v}}function xv(l,r,o,p,v){return ds(l,((E,A)=>{const M=r instanceof uc?r.get(A):null;return M&&M.evaluate?M.evaluate(o,p,v):M}))}function wv(l,r){return r-l}function Tv(l,r,o,p,v){const E=[];for(let A=0;A<l.length;A++){const M=l[A];let z;for(let F=0;F<M.length-1;F++){let q=M[F],W=M[F+1];q.x<r&&W.x<r||(q.x<r?q=new C(r,q.y+(r-q.x)/(W.x-q.x)*(W.y-q.y))._round():W.x<r&&(W=new C(r,q.y+(r-q.x)/(W.x-q.x)*(W.y-q.y))._round()),q.y<o&&W.y<o||(q.y<o?q=new C(q.x+(o-q.y)/(W.y-q.y)*(W.x-q.x),o)._round():W.y<o&&(W=new C(q.x+(o-q.y)/(W.y-q.y)*(W.x-q.x),o)._round()),q.x>=p&&W.x>=p||(q.x>=p?q=new C(p,q.y+(p-q.x)/(W.x-q.x)*(W.y-q.y))._round():W.x>=p&&(W=new C(p,q.y+(p-q.x)/(W.x-q.x)*(W.y-q.y))._round()),q.y>=v&&W.y>=v||(q.y>=v?q=new C(q.x+(v-q.y)/(W.y-q.y)*(W.x-q.x),v)._round():W.y>=v&&(W=new C(q.x+(v-q.y)/(W.y-q.y)*(W.x-q.x),v)._round()),z&&q.equals(z[z.length-1])||(z=[q],E.push(z)),z.push(W)))))}}return E}Yt("FeatureIndex",mp,{omit:["rawTileData","sourceLayerCoder"]});class Lh extends C{constructor(r,o,p,v){super(r,o),this.angle=p,v!==void 0&&(this.segment=v)}clone(){return new Lh(this.x,this.y,this.angle,this.segment)}}function T_(l,r,o,p,v){if(r.segment===void 0||o===0)return!0;let E=r,A=r.segment+1,M=0;for(;M>-o/2;){if(A--,A<0)return!1;M-=l[A].dist(E),E=l[A]}M+=l[A].dist(l[A+1]),A++;const z=[];let F=0;for(;M<o/2;){const q=l[A],W=l[A+1];if(!W)return!1;let te=l[A-1].angleTo(q)-q.angleTo(W);for(te=Math.abs((te+3*Math.PI)%(2*Math.PI)-Math.PI),z.push({distance:M,angleDelta:te}),F+=te;M-z[0].distance>p;)F-=z.shift().angleDelta;if(F>v)return!1;A++,M+=q.dist(W)}return!0}function S_(l){let r=0;for(let o=0;o<l.length-1;o++)r+=l[o].dist(l[o+1]);return r}function _r(l,r,o){return l?.6*r*o:0}function Rm(l,r){return Math.max(l?l.right-l.left:0,r?r.right-r.left:0)}function io(l,r,o,p,v,E){const A=_r(o,v,E),M=Rm(o,p)*E;let z=0;const F=S_(l)/2;for(let q=0;q<l.length-1;q++){const W=l[q],te=l[q+1],ie=W.dist(te);if(z+ie>F){const re=(F-z)/ie,oe=ws.number(W.x,te.x,re),pe=ws.number(W.y,te.y,re),Te=new Lh(oe,pe,te.angleTo(W),q);return Te._round(),!A||T_(l,Te,M,A,r)?Te:void 0}z+=ie}}function Bb(l,r,o,p,v,E,A,M,z){const F=_r(p,E,A),q=Rm(p,v),W=q*A,te=l[0].x===0||l[0].x===z||l[0].y===0||l[0].y===z;return r-W<r/4&&(r=W+r/4),E_(l,te?r/2*M%r:(q/2+2*E)*A*M%r,r,F,o,W,te,!1,z)}function E_(l,r,o,p,v,E,A,M,z){const F=E/2,q=S_(l);let W=0,te=r-o,ie=[];for(let re=0;re<l.length-1;re++){const oe=l[re],pe=l[re+1],Te=oe.dist(pe),He=pe.angleTo(oe);for(;te+o<W+Te;){te+=o;const Le=(te-W)/Te,Be=ws.number(oe.x,pe.x,Le),ot=ws.number(oe.y,pe.y,Le);if(Be>=0&&Be<z&&ot>=0&&ot<z&&te-F>=0&&te+F<=q){const gt=new Lh(Be,ot,He,re);gt._round(),p&&!T_(l,gt,E,p,v)||ie.push(gt)}}W+=Te}return M||ie.length||A||(ie=E_(l,W/2,o,p,v,E,A,!0,z)),ie}function Sv(l,r,o,p){const v=[],E=l.image,A=E.pixelRatio,M=E.paddedRect.w-2,z=E.paddedRect.h-2;let F={x1:l.left,y1:l.top,x2:l.right,y2:l.bottom};const q=E.stretchX||[[0,M]],W=E.stretchY||[[0,z]],te=(St,Sn)=>St+Sn[1]-Sn[0],ie=q.reduce(te,0),re=W.reduce(te,0),oe=M-ie,pe=z-re;let Te=0,He=ie,Le=0,Be=re,ot=0,gt=oe,It=0,$t=pe;if(E.content&&p){const St=E.content,Sn=St[2]-St[0],Pn=St[3]-St[1];(E.textFitWidth||E.textFitHeight)&&(F=g_(l)),Te=gf(q,0,St[0]),Le=gf(W,0,St[1]),He=gf(q,St[0],St[2]),Be=gf(W,St[1],St[3]),ot=St[0]-Te,It=St[1]-Le,gt=Sn-He,$t=Pn-Be}const Bt=F.x1,Gt=F.y1,dn=F.x2-Bt,qt=F.y2-Gt,jt=(St,Sn,Pn,mn)=>{const un=Md(St.stretch-Te,He,dn,Bt),Qn=gp(St.fixed-ot,gt,St.stretch,ie),Kr=Md(Sn.stretch-Le,Be,qt,Gt),ya=gp(Sn.fixed-It,$t,Sn.stretch,re),us=Md(Pn.stretch-Te,He,dn,Bt),Tl=gp(Pn.fixed-ot,gt,Pn.stretch,ie),_o=Md(mn.stretch-Le,Be,qt,Gt),Da=gp(mn.fixed-It,$t,mn.stretch,re),Lr=new C(un,Kr),za=new C(us,Kr),va=new C(us,_o),cs=new C(un,_o),yo=new C(Qn/A,ya/A),Wo=new C(Tl/A,Da/A),ba=r*Math.PI/180;if(ba){const Oa=Math.sin(ba),xa=Math.cos(ba),yr=[xa,-Oa,Oa,xa];Lr._matMult(yr),za._matMult(yr),cs._matMult(yr),va._matMult(yr)}const Rs=St.stretch+St.fixed,ca=Sn.stretch+Sn.fixed;return{tl:Lr,tr:za,bl:cs,br:va,tex:{x:E.paddedRect.x+1+Rs,y:E.paddedRect.y+1+ca,w:Pn.stretch+Pn.fixed-Rs,h:mn.stretch+mn.fixed-ca},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:yo,pixelOffsetBR:Wo,minFontScaleX:gt/A/dn,minFontScaleY:$t/A/qt,isSDF:o}};if(p&&(E.stretchX||E.stretchY)){const St=Lm(q,oe,ie),Sn=Lm(W,pe,re);for(let Pn=0;Pn<St.length-1;Pn++){const mn=St[Pn],un=St[Pn+1];for(let Qn=0;Qn<Sn.length-1;Qn++)v.push(jt(mn,Sn[Qn],un,Sn[Qn+1]))}}else v.push(jt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:M+1},{fixed:0,stretch:z+1}));return v}function gf(l,r,o){let p=0;for(const v of l)p+=Math.max(r,Math.min(o,v[1]))-Math.max(r,Math.min(o,v[0]));return p}function Lm(l,r,o){const p=[{fixed:-1,stretch:0}];for(const[v,E]of l){const A=p[p.length-1];p.push({fixed:v-A.stretch,stretch:A.stretch}),p.push({fixed:v-A.stretch,stretch:A.stretch+(E-v)})}return p.push({fixed:r+1,stretch:o}),p}function Md(l,r,o,p){return l/r*o+p}function gp(l,r,o,p){return l-r*o/p}Yt("Anchor",Lh);class _p{constructor(r,o,p,v,E,A,M,z,F,q){var W;if(this.boxStartIndex=r.length,F){let te=A.top,ie=A.bottom;const re=A.collisionPadding;re&&(te-=re[1],ie+=re[3]);let oe=ie-te;oe>0&&(oe=Math.max(10,oe),this.circleDiameter=oe)}else{const te=!((W=A.image)===null||W===void 0)&&W.content&&(A.image.textFitWidth||A.image.textFitHeight)?g_(A):{x1:A.left,y1:A.top,x2:A.right,y2:A.bottom};te.y1=te.y1*M-z[0],te.y2=te.y2*M+z[2],te.x1=te.x1*M-z[3],te.x2=te.x2*M+z[1];const ie=A.collisionPadding;if(ie&&(te.x1-=ie[0]*M,te.y1-=ie[1]*M,te.x2+=ie[2]*M,te.y2+=ie[3]*M),q){const re=new C(te.x1,te.y1),oe=new C(te.x2,te.y1),pe=new C(te.x1,te.y2),Te=new C(te.x2,te.y2),He=q*Math.PI/180;re._rotate(He),oe._rotate(He),pe._rotate(He),Te._rotate(He),te.x1=Math.min(re.x,oe.x,pe.x,Te.x),te.x2=Math.max(re.x,oe.x,pe.x,Te.x),te.y1=Math.min(re.y,oe.y,pe.y,Te.y),te.y2=Math.max(re.y,oe.y,pe.y,Te.y)}r.emplaceBack(o.x,o.y,te.x1,te.y1,te.x2,te.y2,p,v,E)}this.boxEndIndex=r.length}}class A_{constructor(r=[],o=(p,v)=>p<v?-1:p>v?1:0){if(this.data=r,this.length=this.data.length,this.compare=o,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:o,compare:p}=this,v=o[r];for(;r>0;){const E=r-1>>1,A=o[E];if(p(v,A)>=0)break;o[r]=A,r=E}o[r]=v}_down(r){const{data:o,compare:p}=this,v=this.length>>1,E=o[r];for(;r<v;){let A=1+(r<<1);const M=A+1;if(M<this.length&&p(o[M],o[A])<0&&(A=M),p(o[A],E)>=0)break;o[r]=o[A],r=A}o[r]=E}}function C_(l,r=1,o=!1){const p=Rh.fromPoints(l[0]),v=Math.min(p.width(),p.height());let E=v/2;const A=new A_([],Fb),{minX:M,minY:z,maxX:F,maxY:q}=p;if(v===0)return new C(M,z);for(let ie=M;ie<F;ie+=v)for(let re=z;re<q;re+=v)A.push(new Pd(ie+E,re+E,E,l));let W=(function(ie){let re=0,oe=0,pe=0;const Te=ie[0];for(let He=0,Le=Te.length,Be=Le-1;He<Le;Be=He++){const ot=Te[He],gt=Te[Be],It=ot.x*gt.y-gt.x*ot.y;oe+=(ot.x+gt.x)*It,pe+=(ot.y+gt.y)*It,re+=3*It}return new Pd(oe/re,pe/re,0,ie)})(l),te=A.length;for(;A.length;){const ie=A.pop();(ie.d>W.d||!W.d)&&(W=ie,o&&console.log("found best %d after %d probes",Math.round(1e4*ie.d)/1e4,te)),ie.max-W.d<=r||(E=ie.h/2,A.push(new Pd(ie.p.x-E,ie.p.y-E,E,l)),A.push(new Pd(ie.p.x+E,ie.p.y-E,E,l)),A.push(new Pd(ie.p.x-E,ie.p.y+E,E,l)),A.push(new Pd(ie.p.x+E,ie.p.y+E,E,l)),te+=4)}return o&&(console.log(`num probes: ${te}`),console.log(`best distance: ${W.d}`)),W.p}function Fb(l,r){return r.max-l.max}function Pd(l,r,o,p){this.p=new C(l,r),this.h=o,this.d=(function(v,E){let A=!1,M=1/0;for(let z=0;z<E.length;z++){const F=E[z];for(let q=0,W=F.length,te=W-1;q<W;te=q++){const ie=F[q],re=F[te];ie.y>v.y!=re.y>v.y&&v.x<(re.x-ie.x)*(v.y-ie.y)/(re.y-ie.y)+ie.x&&(A=!A),M=Math.min(M,Th(v,ie,re))}}return(A?1:-1)*Math.sqrt(M)})(this.p,p),this.max=this.d+this.h*Math.SQRT2}var Ps;_.aE=void 0,(Ps=_.aE||(_.aE={}))[Ps.center=1]="center",Ps[Ps.left=2]="left",Ps[Ps.right=3]="right",Ps[Ps.top=4]="top",Ps[Ps.bottom=5]="bottom",Ps[Ps["top-left"]=6]="top-left",Ps[Ps["top-right"]=7]="top-right",Ps[Ps["bottom-left"]=8]="bottom-left",Ps[Ps["bottom-right"]=9]="bottom-right";const km=Number.POSITIVE_INFINITY;function Ev(l,r){return r[1]!==km?(function(o,p,v){let E=0,A=0;switch(p=Math.abs(p),v=Math.abs(v),o){case"top-right":case"top-left":case"top":A=v-7;break;case"bottom-right":case"bottom-left":case"bottom":A=7-v}switch(o){case"top-right":case"bottom-right":case"right":E=-p;break;case"top-left":case"bottom-left":case"left":E=p}return[E,A]})(l,r[0],r[1]):(function(o,p){let v=0,E=0;p<0&&(p=0);const A=p/Math.SQRT2;switch(o){case"top-right":case"top-left":E=A-7;break;case"bottom-right":case"bottom-left":E=7-A;break;case"bottom":E=7-p;break;case"top":E=p-7}switch(o){case"top-right":case"bottom-right":v=-A;break;case"top-left":case"bottom-left":v=A;break;case"left":v=p;break;case"right":v=-p}return[v,E]})(l,r[0])}function Av(l,r,o){var p;const v=l.layout,E=(p=v.get("text-variable-anchor-offset"))===null||p===void 0?void 0:p.evaluate(r,{},o);if(E){const M=E.values,z=[];for(let F=0;F<M.length;F+=2){const q=z[F]=M[F],W=M[F+1].map((te=>te*Xr));q.startsWith("top")?W[1]-=7:q.startsWith("bottom")&&(W[1]+=7),z[F+1]=W}return new sr(z)}const A=v.get("text-variable-anchor");if(A){let M;M=l._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[v.get("text-radial-offset").evaluate(r,{},o)*Xr,km]:v.get("text-offset").evaluate(r,{},o).map((F=>F*Xr));const z=[];for(const F of A)z.push(F,Ev(F,M));return new sr(z)}return null}function bc(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Cv(l,r,o,p,v,E,A,M,z,F,q,W){let te=E.textMaxSize.evaluate(r,{});te===void 0&&(te=A);const ie=l.layers[0].layout,re=ie.get("icon-offset").evaluate(r,{},q),oe=Dm(o.horizontal),pe=A/24,Te=l.tilePixelRatio*pe,He=l.tilePixelRatio*te/24,Le=l.tilePixelRatio*M,Be=l.tilePixelRatio*ie.get("symbol-spacing"),ot=ie.get("text-padding")*l.tilePixelRatio,gt=(function(Pn,mn,un,Qn=1){const Kr=Pn.get("icon-padding").evaluate(mn,{},un),ya=Kr&&Kr.values;return[ya[0]*Qn,ya[1]*Qn,ya[2]*Qn,ya[3]*Qn]})(ie,r,q,l.tilePixelRatio),It=ie.get("text-max-angle")/180*Math.PI,$t=ie.get("text-rotation-alignment")!=="viewport"&&ie.get("symbol-placement")!=="point",Bt=ie.get("icon-rotation-alignment")==="map"&&ie.get("symbol-placement")!=="point",Gt=ie.get("symbol-placement"),dn=Be/2,qt=ie.get("icon-text-fit");let jt;p&&qt!=="none"&&(l.allowVerticalPlacement&&o.vertical&&(jt=__(p,o.vertical,qt,ie.get("icon-text-fit-padding"),re,pe)),oe&&(p=__(p,oe,qt,ie.get("icon-text-fit-padding"),re,pe)));const St=q?W.line.getGranularityForZoomLevel(q.z):1,Sn=(Pn,mn)=>{mn.x<0||mn.x>=Zt||mn.y<0||mn.y>=Zt||(function(un,Qn,Kr,ya,us,Tl,_o,Da,Lr,za,va,cs,yo,Wo,ba,Rs,ca,Oa,xa,yr,Ii,Ls,xc,Xo,kh){const yf=un.addToLineVertexArray(Qn,Kr);let Dh,wc,vf,Ld,xp=0,M_=0,Mv=0,wp=0,bf=-1,Um=-1;const Sl={};let P_=qc("");if(un.allowVerticalPlacement&&ya.vertical){const vt=Da.layout.get("text-rotate").evaluate(Ii,{},Xo)+90;vf=new _p(Lr,Qn,za,va,cs,ya.vertical,yo,Wo,ba,vt),_o&&(Ld=new _p(Lr,Qn,za,va,cs,_o,ca,Oa,ba,vt))}if(us){const vt=Da.layout.get("icon-rotate").evaluate(Ii,{}),Et=Da.layout.get("icon-text-fit")!=="none",ft=Sv(us,vt,xc,Et),yt=_o?Sv(_o,vt,xc,Et):void 0;wc=new _p(Lr,Qn,za,va,cs,us,ca,Oa,!1,vt),xp=4*ft.length;const cn=un.iconSizeData;let En=null;cn.kind==="source"?(En=[_c*Da.layout.get("icon-size").evaluate(Ii,{})],En[0]>Kc&&Pi(`${un.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):cn.kind==="composite"&&(En=[_c*Ls.compositeIconSizes[0].evaluate(Ii,{},Xo),_c*Ls.compositeIconSizes[1].evaluate(Ii,{},Xo)],(En[0]>Kc||En[1]>Kc)&&Pi(`${un.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),un.addSymbols(un.icon,ft,En,yr,xa,Ii,_.ao.none,Qn,yf.lineStartIndex,yf.lineLength,-1,Xo),bf=un.icon.placedSymbolArray.length-1,yt&&(M_=4*yt.length,un.addSymbols(un.icon,yt,En,yr,xa,Ii,_.ao.vertical,Qn,yf.lineStartIndex,yf.lineLength,-1,Xo),Um=un.icon.placedSymbolArray.length-1)}const jm=Object.keys(ya.horizontal);for(const vt of jm){const Et=ya.horizontal[vt];if(!Dh){P_=qc(Et.text);const yt=Da.layout.get("text-rotate").evaluate(Ii,{},Xo);Dh=new _p(Lr,Qn,za,va,cs,Et,yo,Wo,ba,yt)}const ft=Et.positionedLines.length===1;if(Mv+=I_(un,Qn,Et,Tl,Da,ba,Ii,Rs,yf,ya.vertical?_.ao.horizontal:_.ao.horizontalOnly,ft?jm:[vt],Sl,bf,Ls,Xo),ft)break}ya.vertical&&(wp+=I_(un,Qn,ya.vertical,Tl,Da,ba,Ii,Rs,yf,_.ao.vertical,["vertical"],Sl,Um,Ls,Xo));const qm=Dh?Dh.boxStartIndex:un.collisionBoxArray.length,Pv=Dh?Dh.boxEndIndex:un.collisionBoxArray.length,Ub=vf?vf.boxStartIndex:un.collisionBoxArray.length,$m=vf?vf.boxEndIndex:un.collisionBoxArray.length,s=wc?wc.boxStartIndex:un.collisionBoxArray.length,h=wc?wc.boxEndIndex:un.collisionBoxArray.length,y=Ld?Ld.boxStartIndex:un.collisionBoxArray.length,w=Ld?Ld.boxEndIndex:un.collisionBoxArray.length;let D=-1;const B=(vt,Et)=>vt&&vt.circleDiameter?Math.max(vt.circleDiameter,Et):Et;D=B(Dh,D),D=B(vf,D),D=B(wc,D),D=B(Ld,D);const Q=D>-1?1:0;Q&&(D*=kh/Xr),un.glyphOffsetArray.length>=ff.MAX_GLYPHS&&Pi("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ii.sortKey!==void 0&&un.addToSortKeyRanges(un.symbolInstances.length,Ii.sortKey);const he=Av(Da,Ii,Xo),[Ue,dt]=(function(vt,Et){const ft=vt.length,yt=Et==null?void 0:Et.values;if((yt==null?void 0:yt.length)>0)for(let cn=0;cn<yt.length;cn+=2){const En=yt[cn+1];vt.emplaceBack(_.aE[yt[cn]],En[0],En[1])}return[ft,vt.length]})(un.textAnchorOffsets,he);un.symbolInstances.emplaceBack(Qn.x,Qn.y,Sl.right>=0?Sl.right:-1,Sl.center>=0?Sl.center:-1,Sl.left>=0?Sl.left:-1,Sl.vertical||-1,bf,Um,P_,qm,Pv,Ub,$m,s,h,y,w,za,Mv,wp,xp,M_,Q,0,yo,D,Ue,dt)})(l,mn,Pn,o,p,v,jt,l.layers[0],l.collisionBoxArray,r.index,r.sourceLayerIndex,l.index,Te,[ot,ot,ot,ot],$t,z,Le,gt,Bt,re,r,E,F,q,A)};if(Gt==="line")for(const Pn of Tv(r.geometry,0,0,Zt,Zt)){const mn=Jr(Pn,St),un=Bb(mn,Be,It,o.vertical||oe,p,24,He,l.overscaling,Zt);for(const Qn of un)oe&&Vb(l,oe.text,dn,Qn)||Sn(mn,Qn)}else if(Gt==="line-center"){for(const Pn of r.geometry)if(Pn.length>1){const mn=Jr(Pn,St),un=io(mn,It,o.vertical||oe,p,24,He);un&&Sn(mn,un)}}else if(r.type==="Polygon")for(const Pn of Zu(r.geometry,0)){const mn=C_(Pn,16);Sn(Jr(Pn[0],St,!0),new Lh(mn.x,mn.y,0))}else if(r.type==="LineString")for(const Pn of r.geometry){const mn=Jr(Pn,St);Sn(mn,new Lh(mn[0].x,mn[0].y,0))}else if(r.type==="Point")for(const Pn of r.geometry)for(const mn of Pn)Sn([mn],new Lh(mn.x,mn.y,0))}function I_(l,r,o,p,v,E,A,M,z,F,q,W,te,ie,re){const oe=(function(He,Le,Be,ot,gt,It,$t,Bt){const Gt=ot.layout.get("text-rotate").evaluate(It,{})*Math.PI/180,dn=[];for(const qt of Le.positionedLines)for(const jt of qt.positionedGlyphs){if(!jt.rect)continue;const St=jt.rect||{};let Sn=4,Pn=!0,mn=1,un=0;const Qn=(gt||Bt)&&jt.vertical,Kr=jt.metrics.advance*jt.scale/2;if(Bt&&Le.verticalizable&&(un=qt.lineOffset/2-(jt.imageName?-(Xr-jt.metrics.width*jt.scale)/2:(jt.scale-1)*Xr)),jt.imageName){const Oa=$t[jt.imageName];Pn=Oa.sdf,mn=Oa.pixelRatio,Sn=1/mn}const ya=gt?[jt.x+Kr,jt.y]:[0,0];let us=gt?[0,0]:[jt.x+Kr+Be[0],jt.y+Be[1]-un],Tl=[0,0];Qn&&(Tl=us,us=[0,0]);const _o=jt.metrics.isDoubleResolution?2:1,Da=(jt.metrics.left-Sn)*jt.scale-Kr+us[0],Lr=(-jt.metrics.top-Sn)*jt.scale+us[1],za=Da+St.w/_o*jt.scale/mn,va=Lr+St.h/_o*jt.scale/mn,cs=new C(Da,Lr),yo=new C(za,Lr),Wo=new C(Da,va),ba=new C(za,va);if(Qn){const Oa=new C(-Kr,Kr- -17),xa=-Math.PI/2,yr=12-Kr,Ii=new C(22-yr,-(jt.imageName?yr:0)),Ls=new C(...Tl);cs._rotateAround(xa,Oa)._add(Ii)._add(Ls),yo._rotateAround(xa,Oa)._add(Ii)._add(Ls),Wo._rotateAround(xa,Oa)._add(Ii)._add(Ls),ba._rotateAround(xa,Oa)._add(Ii)._add(Ls)}if(Gt){const Oa=Math.sin(Gt),xa=Math.cos(Gt),yr=[xa,-Oa,Oa,xa];cs._matMult(yr),yo._matMult(yr),Wo._matMult(yr),ba._matMult(yr)}const Rs=new C(0,0),ca=new C(0,0);dn.push({tl:cs,tr:yo,bl:Wo,br:ba,tex:St,writingMode:Le.writingMode,glyphOffset:ya,sectionIndex:jt.sectionIndex,isSDF:Pn,pixelOffsetTL:Rs,pixelOffsetBR:ca,minFontScaleX:0,minFontScaleY:0})}return dn})(0,o,M,v,E,A,p,l.allowVerticalPlacement),pe=l.textSizeData;let Te=null;pe.kind==="source"?(Te=[_c*v.layout.get("text-size").evaluate(A,{})],Te[0]>Kc&&Pi(`${l.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):pe.kind==="composite"&&(Te=[_c*ie.compositeTextSizes[0].evaluate(A,{},re),_c*ie.compositeTextSizes[1].evaluate(A,{},re)],(Te[0]>Kc||Te[1]>Kc)&&Pi(`${l.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),l.addSymbols(l.text,oe,Te,M,E,A,F,r,z.lineStartIndex,z.lineLength,te,re);for(const He of q)W[He]=l.text.placedSymbolArray.length-1;return 4*oe.length}function Dm(l){for(const r in l)return l[r];return null}function Vb(l,r,o,p){const v=l.compareText;if(r in v){const E=v[r];for(let A=E.length-1;A>=0;A--)if(p.dist(E[A])<o)return!0}else v[r]=[];return v[r].push(p),!1}const Iv=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class zm{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,p]=new Uint8Array(r,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const v=p>>4;if(v!==1)throw new Error(`Got v${v} data when expected v1.`);const E=Iv[15&p];if(!E)throw new Error("Unrecognized array type.");const[A]=new Uint16Array(r,2,1),[M]=new Uint32Array(r,4,1);return new zm(M,A,E,r)}constructor(r,o=64,p=Float64Array,v){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=p,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;const E=Iv.indexOf(this.ArrayType),A=2*r*this.ArrayType.BYTES_PER_ELEMENT,M=r*this.IndexArrayType.BYTES_PER_ELEMENT,z=(8-M%8)%8;if(E<0)throw new Error(`Unexpected typed array class: ${p}.`);v&&v instanceof ArrayBuffer?(this.data=v,this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+M+z,2*r),this._pos=2*r,this._finished=!0):(this.data=new ArrayBuffer(8+A+M+z),this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+M+z,2*r),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+E]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=r)}add(r,o){const p=this._pos>>1;return this.ids[p]=p,this.coords[this._pos++]=r,this.coords[this._pos++]=o,p}finish(){const r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return yp(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,o,p,v){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:E,coords:A,nodeSize:M}=this,z=[0,E.length-1,0],F=[];for(;z.length;){const q=z.pop()||0,W=z.pop()||0,te=z.pop()||0;if(W-te<=M){for(let pe=te;pe<=W;pe++){const Te=A[2*pe],He=A[2*pe+1];Te>=r&&Te<=p&&He>=o&&He<=v&&F.push(E[pe])}continue}const ie=te+W>>1,re=A[2*ie],oe=A[2*ie+1];re>=r&&re<=p&&oe>=o&&oe<=v&&F.push(E[ie]),(q===0?r<=re:o<=oe)&&(z.push(te),z.push(ie-1),z.push(1-q)),(q===0?p>=re:v>=oe)&&(z.push(ie+1),z.push(W),z.push(1-q))}return F}within(r,o,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:E,nodeSize:A}=this,M=[0,v.length-1,0],z=[],F=p*p;for(;M.length;){const q=M.pop()||0,W=M.pop()||0,te=M.pop()||0;if(W-te<=A){for(let pe=te;pe<=W;pe++)Nm(E[2*pe],E[2*pe+1],r,o)<=F&&z.push(v[pe]);continue}const ie=te+W>>1,re=E[2*ie],oe=E[2*ie+1];Nm(re,oe,r,o)<=F&&z.push(v[ie]),(q===0?r-p<=re:o-p<=oe)&&(M.push(te),M.push(ie-1),M.push(1-q)),(q===0?r+p>=re:o+p>=oe)&&(M.push(ie+1),M.push(W),M.push(1-q))}return z}}function yp(l,r,o,p,v,E){if(v-p<=o)return;const A=p+v>>1;Om(l,r,A,p,v,E),yp(l,r,o,p,A-1,1-E),yp(l,r,o,A+1,v,1-E)}function Om(l,r,o,p,v,E){for(;v>p;){if(v-p>600){const F=v-p+1,q=o-p+1,W=Math.log(F),te=.5*Math.exp(2*W/3),ie=.5*Math.sqrt(W*te*(F-te)/F)*(q-F/2<0?-1:1);Om(l,r,o,Math.max(p,Math.floor(o-q*te/F+ie)),Math.min(v,Math.floor(o+(F-q)*te/F+ie)),E)}const A=r[2*o+E];let M=p,z=v;for(vp(l,r,p,o),r[2*v+E]>A&&vp(l,r,p,v);M<z;){for(vp(l,r,M,z),M++,z--;r[2*M+E]<A;)M++;for(;r[2*z+E]>A;)z--}r[2*p+E]===A?vp(l,r,p,z):(z++,vp(l,r,z,v)),z<=o&&(p=z+1),o<=z&&(v=z-1)}}function vp(l,r,o,p){xl(l,o,p),xl(r,2*o,2*p),xl(r,2*o+1,2*p+1)}function xl(l,r,o){const p=l[r];l[r]=l[o],l[o]=p}function Nm(l,r,o,p){const v=l-o,E=r-p;return v*v+E*E}var Bm;_.cx=void 0,(Bm=_.cx||(_.cx={})).create="create",Bm.load="load",Bm.fullLoad="fullLoad";let bp=null,_f=[];const Rd=1e3/60,wl="loadTime",Fm="fullLoadTime",Vm={mark(l){performance.mark(l)},frame(l){const r=l;bp!=null&&_f.push(r-bp),bp=r},clearMetrics(){bp=null,_f=[],performance.clearMeasures(wl),performance.clearMeasures(Fm);for(const l in _.cx)performance.clearMarks(_.cx[l])},getPerformanceMetrics(){performance.measure(wl,_.cx.create,_.cx.load),performance.measure(Fm,_.cx.create,_.cx.fullLoad);const l=performance.getEntriesByName(wl)[0].duration,r=performance.getEntriesByName(Fm)[0].duration,o=_f.length,p=1/(_f.reduce(((E,A)=>E+A),0)/o/1e3),v=_f.filter((E=>E>Rd)).reduce(((E,A)=>E+(A-Rd)/Rd),0);return{loadTime:l,fullLoadTime:r,fps:p,percentDroppedFrames:v/(o+v)*100,totalFrames:o}}};_.$=Zt,_.A=Xe,_.B=function([l,r,o]){return r+=90,r*=Math.PI/180,o*=Math.PI/180,{x:l*Math.cos(r)*Math.sin(o),y:l*Math.sin(r)*Math.sin(o),z:l*Math.cos(o)}},_.C=ws,_.D=an,_.E=tn,_.F=Di,_.G=Ql,_.H=function(l){if(Bs==null){const r=l.navigator?l.navigator.userAgent:null;Bs=!!l.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return Bs},_.I=go,_.J=class{constructor(l,r){this.target=l,this.mapId=r,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new gv((()=>this.process())),this.subscription=ao(this.target,"message",(o=>this.receive(o)),!1),this.globalScope=Ta(self)?l:window}registerMessageHandler(l,r){this.messageHandlers[l]=r}sendAsync(l,r){return new Promise(((o,p)=>{const v=Math.round(1e18*Math.random()).toString(36).substring(0,10),E=r?ao(r.signal,"abort",(()=>{E==null||E.unsubscribe(),delete this.resolveRejects[v];const z={id:v,type:"<cancel>",origin:location.origin,targetMapId:l.targetMapId,sourceMapId:this.mapId};this.target.postMessage(z)}),_v):null;this.resolveRejects[v]={resolve:z=>{E==null||E.unsubscribe(),o(z)},reject:z=>{E==null||E.unsubscribe(),p(z)}};const A=[],M=Object.assign(Object.assign({},l),{id:v,sourceMapId:this.mapId,origin:location.origin,data:ac(l.data,A)});this.target.postMessage(M,{transfer:A})}))}receive(l){const r=l.data,o=r.id;if(!(r.origin!=="file://"&&location.origin!=="file://"&&r.origin!=="resource://android"&&location.origin!=="resource://android"&&r.origin!==location.origin||r.targetMapId&&this.mapId!==r.targetMapId)){if(r.type==="<cancel>"){delete this.tasks[o];const p=this.abortControllers[o];return delete this.abortControllers[o],void(p&&p.abort())}if(Ta(self)||r.mustQueue)return this.tasks[o]=r,this.taskQueue.push(o),void this.invoker.trigger();this.processTask(o,r)}}process(){if(this.taskQueue.length===0)return;const l=this.taskQueue.shift(),r=this.tasks[l];delete this.tasks[l],this.taskQueue.length>0&&this.invoker.trigger(),r&&this.processTask(l,r)}processTask(l,r){return c(this,void 0,void 0,(function*(){if(r.type==="<response>"){const v=this.resolveRejects[l];return delete this.resolveRejects[l],v?void(r.error?v.reject(Jl(r.error)):v.resolve(Jl(r.data))):void 0}if(!this.messageHandlers[r.type])return void this.completeTask(l,new Error(`Could not find a registered handler for ${r.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const o=Jl(r.data),p=new AbortController;this.abortControllers[l]=p;try{const v=yield this.messageHandlers[r.type](r.sourceMapId,o,p);this.completeTask(l,null,v)}catch(v){this.completeTask(l,v)}}))}completeTask(l,r,o){const p=[];delete this.abortControllers[l];const v={id:l,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:r?ac(r):null,data:ac(o,p)};this.target.postMessage(v,{transfer:p})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},_.K=fe,_.L=function(){var l=new Xe(16);return Xe!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0),l[0]=1,l[5]=1,l[10]=1,l[15]=1,l},_.M=function(l,r,o){var p,v,E,A,M,z,F,q,W,te,ie,re,oe=o[0],pe=o[1],Te=o[2];return r===l?(l[12]=r[0]*oe+r[4]*pe+r[8]*Te+r[12],l[13]=r[1]*oe+r[5]*pe+r[9]*Te+r[13],l[14]=r[2]*oe+r[6]*pe+r[10]*Te+r[14],l[15]=r[3]*oe+r[7]*pe+r[11]*Te+r[15]):(v=r[1],E=r[2],A=r[3],M=r[4],z=r[5],F=r[6],q=r[7],W=r[8],te=r[9],ie=r[10],re=r[11],l[0]=p=r[0],l[1]=v,l[2]=E,l[3]=A,l[4]=M,l[5]=z,l[6]=F,l[7]=q,l[8]=W,l[9]=te,l[10]=ie,l[11]=re,l[12]=p*oe+M*pe+W*Te+r[12],l[13]=v*oe+z*pe+te*Te+r[13],l[14]=E*oe+F*pe+ie*Te+r[14],l[15]=A*oe+q*pe+re*Te+r[15]),l},_.N=function(l,r,o){var p=o[0],v=o[1],E=o[2];return l[0]=r[0]*p,l[1]=r[1]*p,l[2]=r[2]*p,l[3]=r[3]*p,l[4]=r[4]*v,l[5]=r[5]*v,l[6]=r[6]*v,l[7]=r[7]*v,l[8]=r[8]*E,l[9]=r[9]*E,l[10]=r[10]*E,l[11]=r[11]*E,l[12]=r[12],l[13]=r[13],l[14]=r[14],l[15]=r[15],l},_.O=function(l,r,o){var p=r[0],v=r[1],E=r[2],A=r[3],M=r[4],z=r[5],F=r[6],q=r[7],W=r[8],te=r[9],ie=r[10],re=r[11],oe=r[12],pe=r[13],Te=r[14],He=r[15],Le=o[0],Be=o[1],ot=o[2],gt=o[3];return l[0]=Le*p+Be*M+ot*W+gt*oe,l[1]=Le*v+Be*z+ot*te+gt*pe,l[2]=Le*E+Be*F+ot*ie+gt*Te,l[3]=Le*A+Be*q+ot*re+gt*He,l[4]=(Le=o[4])*p+(Be=o[5])*M+(ot=o[6])*W+(gt=o[7])*oe,l[5]=Le*v+Be*z+ot*te+gt*pe,l[6]=Le*E+Be*F+ot*ie+gt*Te,l[7]=Le*A+Be*q+ot*re+gt*He,l[8]=(Le=o[8])*p+(Be=o[9])*M+(ot=o[10])*W+(gt=o[11])*oe,l[9]=Le*v+Be*z+ot*te+gt*pe,l[10]=Le*E+Be*F+ot*ie+gt*Te,l[11]=Le*A+Be*q+ot*re+gt*He,l[12]=(Le=o[12])*p+(Be=o[13])*M+(ot=o[14])*W+(gt=o[15])*oe,l[13]=Le*v+Be*z+ot*te+gt*pe,l[14]=Le*E+Be*F+ot*ie+gt*Te,l[15]=Le*A+Be*q+ot*re+gt*He,l},_.P=C,_.Q=function(l,r){const o={};for(let p=0;p<r.length;p++){const v=r[p];v in l&&(o[v]=l[v])}return o},_.R=Ms,_.S=vc,_.T=Jf,_.U=Cm,_.V=yv,_.W=Ne,_.X=tt,_.Y=pr,_.Z=Ho,_._=c,_.a=se,_.a$=Pe,_.a0=function(l,r){var o,p,v,E;if(!l)return r??{};if(!r)return l;const A=Object.assign({},l);if(r.removeAll&&(A.removeAll=!0),r.remove){const M=new Set(A.remove?A.remove.concat(r.remove):r.remove);A.remove=Array.from(M.values())}if(r.add){const M=A.add?A.add.concat(r.add):r.add,z=new Map(M.map((F=>[F.id,F])));A.add=Array.from(z.values())}if(r.update){const M=new Map((o=A.update)===null||o===void 0?void 0:o.map((z=>[z.id,z])));for(const z of r.update){const F=(p=M.get(z.id))!==null&&p!==void 0?p:{id:z.id};z.newGeometry&&(F.newGeometry=z.newGeometry),z.addOrUpdateProperties&&(F.addOrUpdateProperties=((v=F.addOrUpdateProperties)!==null&&v!==void 0?v:[]).concat(z.addOrUpdateProperties)),z.removeProperties&&(F.removeProperties=((E=F.removeProperties)!==null&&E!==void 0?E:[]).concat(z.removeProperties)),z.removeAllProperties&&(F.removeAllProperties=!0),M.set(z.id,F)}A.update=Array.from(M.values())}return A},_.a1=Yc,_.a2=Rh,_.a3=25,_.a4=Mm,_.a5=l=>{const r=window.document.createElement("video");return r.muted=!0,new Promise((o=>{r.onloadstart=()=>{o(r)};for(const p of l){const v=window.document.createElement("source");et(p)||(r.crossOrigin="Anonymous"),v.src=p,r.appendChild(v)}}))},_.a6=Rt,_.a7=function(){return fi++},_.a8=H,_.a9=ff,_.aA=function(l){let r=1/0,o=1/0,p=-1/0,v=-1/0;for(const E of l)r=Math.min(r,E.x),o=Math.min(o,E.y),p=Math.max(p,E.x),v=Math.max(v,E.y);return[r,o,p,v]},_.aB=Xr,_.aC=Vt,_.aD=function(l,r,o,p,v=!1){if(!o[0]&&!o[1])return[0,0];const E=v?p==="map"?-l.bearingInRadians:0:p==="viewport"?l.bearingInRadians:0;if(E){const A=Math.sin(E),M=Math.cos(E);o=[o[0]*M-o[1]*A,o[0]*A+o[1]*M]}return[v?o[0]:Vt(r,o[0],l.zoom),v?o[1]:Vt(r,o[1],l.zoom)]},_.aF=Tm,_.aG=bc,_.aH=p_,_.aI=zm,_.aJ=Br,_.aK=rp,_.aL=Ie,_.aM=jn,_.aN=Yi,_.aO=Fn,_.aP=fs,_.aQ=vv,_.aR=Ae,_.aS=ge,_.aT=function(l){var r=new Xe(3);return r[0]=l[0],r[1]=l[1],r[2]=l[2],r},_.aU=function(l,r,o){return l[0]=r[0]-o[0],l[1]=r[1]-o[1],l[2]=r[2]-o[2],l},_.aV=function(l,r){var o=r[0],p=r[1],v=r[2],E=o*o+p*p+v*v;return E>0&&(E=1/Math.sqrt(E)),l[0]=r[0]*E,l[1]=r[1]*E,l[2]=r[2]*E,l},_.aW=Re,_.aX=function(l,r){return l[0]*r[0]+l[1]*r[1]+l[2]*r[2]},_.aY=function(l,r,o){return l[0]=r[0]*o[0],l[1]=r[1]*o[1],l[2]=r[2]*o[2],l[3]=r[3]*o[3],l},_.aZ=de,_.a_=function(l,r,o){const p=r[0]*o[0]+r[1]*o[1]+r[2]*o[2];return p===0?null:(-(l[0]*o[0]+l[1]*o[1]+l[2]*o[2])-o[3])/p},_.aa=ut,_.ab=vl,_.ac=mf,_.ad=function(l){const r={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((o,p,v,E)=>{const A=v||E;return r[p]=!A||A.toLowerCase(),""})),r["max-age"]){const o=parseInt(r["max-age"],10);isNaN(o)?delete r["max-age"]:r["max-age"]=o}return r},_.ae=qr,_.af=function(l){return Math.pow(2,l)},_.ag=Ge,_.ah=Wt,_.ai=85.051129,_.aj=Im,_.ak=function(l){return Math.log(l)/Math.LN2},_.al=function(l){var r=l[0],o=l[1];return r*r+o*o},_.am=function(l,r){const o=[];for(const p in l)p in r||o.push(p);return o},_.an=function(l,r){let o=0,p=0;if(l.kind==="constant")p=l.layoutSize;else if(l.kind!=="source"){const{interpolationType:v,minZoom:E,maxZoom:A}=l,M=v?Wt(lr.interpolationFactor(v,r,E,A),0,1):0;l.kind==="camera"?p=ws.number(l.minSize,l.maxSize,M):o=M}return{uSizeT:o,uSize:p}},_.ap=function(l,{uSize:r,uSizeT:o},{lowerSize:p,upperSize:v}){return l.kind==="source"?p/_c:l.kind==="composite"?ws.number(p/_c,v/_c,o):r},_.aq=function(l,r){var o=r[0],p=r[1],v=r[2],E=r[3],A=r[4],M=r[5],z=r[6],F=r[7],q=r[8],W=r[9],te=r[10],ie=r[11],re=r[12],oe=r[13],pe=r[14],Te=r[15],He=o*M-p*A,Le=o*z-v*A,Be=o*F-E*A,ot=p*z-v*M,gt=p*F-E*M,It=v*F-E*z,$t=q*oe-W*re,Bt=q*pe-te*re,Gt=q*Te-ie*re,dn=W*pe-te*oe,qt=W*Te-ie*oe,jt=te*Te-ie*pe,St=He*jt-Le*qt+Be*dn+ot*Gt-gt*Bt+It*$t;return St?(l[0]=(M*jt-z*qt+F*dn)*(St=1/St),l[1]=(v*qt-p*jt-E*dn)*St,l[2]=(oe*It-pe*gt+Te*ot)*St,l[3]=(te*gt-W*It-ie*ot)*St,l[4]=(z*Gt-A*jt-F*Bt)*St,l[5]=(o*jt-v*Gt+E*Bt)*St,l[6]=(pe*Be-re*It-Te*Le)*St,l[7]=(q*It-te*Be+ie*Le)*St,l[8]=(A*qt-M*Gt+F*$t)*St,l[9]=(p*Gt-o*qt-E*$t)*St,l[10]=(re*gt-oe*Be+Te*He)*St,l[11]=(W*Be-q*gt-ie*He)*St,l[12]=(M*Bt-A*dn-z*$t)*St,l[13]=(o*dn-p*Bt+v*$t)*St,l[14]=(oe*Le-re*ot-pe*He)*St,l[15]=(q*ot-W*Le+te*He)*St,l):null},_.ar=At,_.as=function(l){return Math.hypot(l[0],l[1])},_.at=function(l){return l[0]=0,l[1]=0,l},_.au=function(l,r,o){return l[0]=r[0]*o,l[1]=r[1]*o,l},_.av=fp,_.aw=Mn,_.ax=function(l,r,o,p){const v=r.y-l.y,E=r.x-l.x,A=p.y-o.y,M=p.x-o.x,z=A*E-M*v;if(z===0)return null;const F=(M*(l.y-o.y)-A*(l.x-o.x))/z;return new C(l.x+F*E,l.y+F*v)},_.ay=Tv,_.az=kg,_.b=Sa,_.b$=class extends T{},_.b0=function(l,r,o){return l[0]=r[0]*o,l[1]=r[1]*o,l[2]=r[2]*o,l[3]=r[3]*o,l},_.b1=function(l,r){return l[0]*r[0]+l[1]*r[1]+l[2]*r[2]+l[3]},_.b2=yi,_.b3=Qc,_.b4=function(l,r,o,p,v){var E,A=1/Math.tan(r/2);return l[0]=A/o,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=A,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,v!=null&&v!==1/0?(l[10]=(v+p)*(E=1/(p-v)),l[14]=2*v*p*E):(l[10]=-1,l[14]=-2*p),l},_.b5=function(l){var r=new Xe(16);return r[0]=l[0],r[1]=l[1],r[2]=l[2],r[3]=l[3],r[4]=l[4],r[5]=l[5],r[6]=l[6],r[7]=l[7],r[8]=l[8],r[9]=l[9],r[10]=l[10],r[11]=l[11],r[12]=l[12],r[13]=l[13],r[14]=l[14],r[15]=l[15],r},_.b6=function(l,r,o){var p=Math.sin(o),v=Math.cos(o),E=r[0],A=r[1],M=r[2],z=r[3],F=r[4],q=r[5],W=r[6],te=r[7];return r!==l&&(l[8]=r[8],l[9]=r[9],l[10]=r[10],l[11]=r[11],l[12]=r[12],l[13]=r[13],l[14]=r[14],l[15]=r[15]),l[0]=E*v+F*p,l[1]=A*v+q*p,l[2]=M*v+W*p,l[3]=z*v+te*p,l[4]=F*v-E*p,l[5]=q*v-A*p,l[6]=W*v-M*p,l[7]=te*v-z*p,l},_.b7=function(l,r,o){var p=Math.sin(o),v=Math.cos(o),E=r[4],A=r[5],M=r[6],z=r[7],F=r[8],q=r[9],W=r[10],te=r[11];return r!==l&&(l[0]=r[0],l[1]=r[1],l[2]=r[2],l[3]=r[3],l[12]=r[12],l[13]=r[13],l[14]=r[14],l[15]=r[15]),l[4]=E*v+F*p,l[5]=A*v+q*p,l[6]=M*v+W*p,l[7]=z*v+te*p,l[8]=F*v-E*p,l[9]=q*v-A*p,l[10]=W*v-M*p,l[11]=te*v-z*p,l},_.b8=function(){const l=new Float32Array(16);return Ge(l),l},_.b9=function(){const l=new Float64Array(16);return Ge(l),l},_.bA=function(l,r){const o=ke(l,360),p=ke(r,360),v=p-o,E=p>o?v-360:v+360;return Math.abs(v)<Math.abs(E)?v:E},_.bB=function(l){return l[0]=0,l[1]=0,l[2]=0,l},_.bC=function(l,r,o,p){const v=Math.sqrt(l*l+r*r),E=Math.sqrt(o*o+p*p);l/=v,r/=v,o/=E,p/=E;const A=Math.acos(l*o+r*p);return-r*o+l*p>0?A:-A},_.bD=function(l,r){const o=ke(l,2*Math.PI),p=ke(r,2*Math.PI);return Math.min(Math.abs(o-p),Math.abs(o-p+2*Math.PI),Math.abs(o-p-2*Math.PI))},_.bE=function(){const l={},r=qe.$version;for(const o in qe.$root){const p=qe.$root[o];if(p.required){let v=null;v=o==="version"?r:p.type==="array"?[]:{},v!=null&&(l[o]=v)}}return l},_.bF=Bc,_.bG=De,_.bH=function l(r,o){if(Array.isArray(r)){if(!Array.isArray(o)||r.length!==o.length)return!1;for(let p=0;p<r.length;p++)if(!l(r[p],o[p]))return!1;return!0}if(typeof r=="object"&&r!==null&&o!==null){if(typeof o!="object"||Object.keys(r).length!==Object.keys(o).length)return!1;for(const p in r)if(!l(r[p],o[p]))return!1;return!0}return r===o},_.bI=function(l){l=l.slice();const r=Object.create(null);for(let o=0;o<l.length;o++)r[l[o].id]=l[o];for(let o=0;o<l.length;o++)"ref"in l[o]&&(l[o]=Rn(l[o],r[l[o].ref]));return l},_.bJ=function(l){if(l.type==="custom")return new mv(l);switch(l.type){case"background":return new yc(l);case"circle":return new Vg(l);case"color-relief":return new Wg(l);case"fill":return new Qy(l);case"fill-extrusion":return new sf(l);case"heatmap":return new cm(l);case"hillshade":return new Hy(l);case"line":return new Ah(l);case"raster":return new pv(l);case"symbol":return new Cd(l)}},_.bK=Dr,_.bL=function(l,r){if(!l)return[{command:"setStyle",args:[r]}];let o=[];try{if(!nn(l.version,r.version))return[{command:"setStyle",args:[r]}];nn(l.center,r.center)||o.push({command:"setCenter",args:[r.center]}),nn(l.state,r.state)||o.push({command:"setGlobalState",args:[r.state]}),nn(l.centerAltitude,r.centerAltitude)||o.push({command:"setCenterAltitude",args:[r.centerAltitude]}),nn(l.zoom,r.zoom)||o.push({command:"setZoom",args:[r.zoom]}),nn(l.bearing,r.bearing)||o.push({command:"setBearing",args:[r.bearing]}),nn(l.pitch,r.pitch)||o.push({command:"setPitch",args:[r.pitch]}),nn(l.roll,r.roll)||o.push({command:"setRoll",args:[r.roll]}),nn(l.sprite,r.sprite)||o.push({command:"setSprite",args:[r.sprite]}),nn(l.glyphs,r.glyphs)||o.push({command:"setGlyphs",args:[r.glyphs]}),nn(l.transition,r.transition)||o.push({command:"setTransition",args:[r.transition]}),nn(l.light,r.light)||o.push({command:"setLight",args:[r.light]}),nn(l.terrain,r.terrain)||o.push({command:"setTerrain",args:[r.terrain]}),nn(l.sky,r.sky)||o.push({command:"setSky",args:[r.sky]}),nn(l.projection,r.projection)||o.push({command:"setProjection",args:[r.projection]});const p={},v=[];(function(A,M,z,F){let q;for(q in M=M||{},A=A||{})Object.prototype.hasOwnProperty.call(A,q)&&(Object.prototype.hasOwnProperty.call(M,q)||Gi(q,z,F));for(q in M)Object.prototype.hasOwnProperty.call(M,q)&&(Object.prototype.hasOwnProperty.call(A,q)?nn(A[q],M[q])||(A[q].type==="geojson"&&M[q].type==="geojson"&&Ir(A,M,q)?Nn(z,{command:"setGeoJSONSourceData",args:[q,M[q].data]}):tr(q,M,z,F)):Ri(q,M,z))})(l.sources,r.sources,v,p);const E=[];l.layers&&l.layers.forEach((A=>{"source"in A&&p[A.source]?o.push({command:"removeLayer",args:[A.id]}):E.push(A)})),o=o.concat(v),(function(A,M,z){M=M||[];const F=(A=A||[]).map(Kn),q=M.map(Kn),W=A.reduce(br,{}),te=M.reduce(br,{}),ie=F.slice(),re=Object.create(null);let oe,pe,Te,He,Le;for(let Be=0,ot=0;Be<F.length;Be++)oe=F[Be],Object.prototype.hasOwnProperty.call(te,oe)?ot++:(Nn(z,{command:"removeLayer",args:[oe]}),ie.splice(ie.indexOf(oe,ot),1));for(let Be=0,ot=0;Be<q.length;Be++)oe=q[q.length-1-Be],ie[ie.length-1-Be]!==oe&&(Object.prototype.hasOwnProperty.call(W,oe)?(Nn(z,{command:"removeLayer",args:[oe]}),ie.splice(ie.lastIndexOf(oe,ie.length-ot),1)):ot++,He=ie[ie.length-Be],Nn(z,{command:"addLayer",args:[te[oe],He]}),ie.splice(ie.length-Be,0,oe),re[oe]=!0);for(let Be=0;Be<q.length;Be++)if(oe=q[Be],pe=W[oe],Te=te[oe],!re[oe]&&!nn(pe,Te))if(nn(pe.source,Te.source)&&nn(pe["source-layer"],Te["source-layer"])&&nn(pe.type,Te.type)){for(Le in Vn(pe.layout,Te.layout,z,oe,null,"setLayoutProperty"),Vn(pe.paint,Te.paint,z,oe,null,"setPaintProperty"),nn(pe.filter,Te.filter)||Nn(z,{command:"setFilter",args:[oe,Te.filter]}),nn(pe.minzoom,Te.minzoom)&&nn(pe.maxzoom,Te.maxzoom)||Nn(z,{command:"setLayerZoomRange",args:[oe,Te.minzoom,Te.maxzoom]}),pe)Object.prototype.hasOwnProperty.call(pe,Le)&&Le!=="layout"&&Le!=="paint"&&Le!=="filter"&&Le!=="metadata"&&Le!=="minzoom"&&Le!=="maxzoom"&&(Le.indexOf("paint.")===0?Vn(pe[Le],Te[Le],z,oe,Le.slice(6),"setPaintProperty"):nn(pe[Le],Te[Le])||Nn(z,{command:"setLayerProperty",args:[oe,Le,Te[Le]]}));for(Le in Te)Object.prototype.hasOwnProperty.call(Te,Le)&&!Object.prototype.hasOwnProperty.call(pe,Le)&&Le!=="layout"&&Le!=="paint"&&Le!=="filter"&&Le!=="metadata"&&Le!=="minzoom"&&Le!=="maxzoom"&&(Le.indexOf("paint.")===0?Vn(pe[Le],Te[Le],z,oe,Le.slice(6),"setPaintProperty"):nn(pe[Le],Te[Le])||Nn(z,{command:"setLayerProperty",args:[oe,Le,Te[Le]]}))}else Nn(z,{command:"removeLayer",args:[oe]}),He=ie[ie.lastIndexOf(oe)+1],Nn(z,{command:"addLayer",args:[Te,He]})})(E,r.layers,o)}catch(p){console.warn("Unable to compute style diff:",p),o=[{command:"setStyle",args:[r]}]}return o},_.bM=function(l){const r=[],o=l.id;return o===void 0&&r.push({message:`layers.${o}: missing required property "id"`}),l.render===void 0&&r.push({message:`layers.${o}: missing required method "render"`}),l.renderingMode&&l.renderingMode!=="2d"&&l.renderingMode!=="3d"&&r.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),r},_.bN=ds,_.bO=Ns,_.bP=class extends ss{constructor(l,r){super(l,r),this.current=0}set(l){this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))}},_.bQ=la,_.bR=class extends ss{constructor(l,r){super(l,r),this.current=jo}set(l){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(let r=1;r<16;r++)if(l[r]!==this.current[r]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}}},_.bS=oa,_.bT=class extends ss{constructor(l,r){super(l,r),this.current=[0,0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2]))}},_.bU=class extends ss{constructor(l,r){super(l,r),this.current=[0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1]))}},_.bV=Ke,_.bW=function(l,r){var o=Math.sin(r),p=Math.cos(r);return l[0]=p,l[1]=o,l[2]=0,l[3]=-o,l[4]=p,l[5]=0,l[6]=0,l[7]=0,l[8]=1,l},_.bX=function(l,r,o){var p=r[0],v=r[1],E=r[2];return l[0]=p*o[0]+v*o[3]+E*o[6],l[1]=p*o[1]+v*o[4]+E*o[7],l[2]=p*o[2]+v*o[5]+E*o[8],l},_.bY=function(l,r,o,p,v,E,A){var M=1/(r-o),z=1/(p-v),F=1/(E-A);return l[0]=-2*M,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=-2*z,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=2*F,l[11]=0,l[12]=(r+o)*M,l[13]=(v+p)*z,l[14]=(A+E)*F,l[15]=1,l},_.bZ=class extends ss{constructor(l,r){super(l,r),this.current=new Array}set(l){if(l!=this.current){this.current=l;const r=new Float32Array(4*l.length);for(let o=0;o<l.length;o++)r[4*o]=l[o].r,r[4*o+1]=l[o].g,r[4*o+2]=l[o].b,r[4*o+3]=l[o].a;this.gl.uniform4fv(this.location,r)}}},_.b_=class extends ss{constructor(l,r){super(l,r),this.current=new Array}set(l){if(l!=this.current){this.current=l;const r=new Float32Array(l);this.gl.uniform1fv(this.location,r)}}},_.ba=function(){return new Float64Array(16)},_.bb=function(l,r,o){const p=new Float64Array(4);return mt(p,l,r-90,o),p},_.bc=function(l,r,o,p){var v,E,A,M,z,F=r[0],q=r[1],W=r[2],te=r[3],ie=o[0],re=o[1],oe=o[2],pe=o[3];return(E=F*ie+q*re+W*oe+te*pe)<0&&(E=-E,ie=-ie,re=-re,oe=-oe,pe=-pe),1-E>Je?(v=Math.acos(E),A=Math.sin(v),M=Math.sin((1-p)*v)/A,z=Math.sin(p*v)/A):(M=1-p,z=p),l[0]=M*F+z*ie,l[1]=M*q+z*re,l[2]=M*W+z*oe,l[3]=M*te+z*pe,l},_.bd=function(l){const r=new Float64Array(9);var o,p,v,E,A,M,z,F,q,W,te,ie,re,oe,pe,Te,He,Le;W=(v=(p=l)[0])*(z=v+v),te=(E=p[1])*z,re=(A=p[2])*z,oe=A*(F=E+E),Te=(M=p[3])*z,He=M*F,Le=M*(q=A+A),(o=r)[0]=1-(ie=E*F)-(pe=A*q),o[3]=te-Le,o[6]=re+He,o[1]=te+Le,o[4]=1-W-pe,o[7]=oe-Te,o[2]=re-He,o[5]=oe+Te,o[8]=1-W-ie;const Be=fs(-Math.asin(Wt(r[2],-1,1)));let ot,gt;return Math.hypot(r[5],r[8])<.001?(ot=0,gt=-fs(Math.atan2(r[3],r[4]))):(ot=fs(r[5]===0&&r[8]===0?0:Math.atan2(r[5],r[8])),gt=fs(r[1]===0&&r[0]===0?0:Math.atan2(r[1],r[0]))),{roll:ot,pitch:Be+90,bearing:gt}},_.be=function(l,r){return l.roll==r.roll&&l.pitch==r.pitch&&l.bearing==r.bearing},_.bf=Ln,_.bg=Iu,_.bh=bl,_.bi=Qr,_.bj=Gc,_.bk=xt,_.bl=Ot,_.bm=wr,_.bn=function(l,r,o,p,v){return xt(p,v,Wt((l-r)/(o-r),0,1))},_.bo=ke,_.bp=function(){return new Float64Array(3)},_.bq=function(l,r,o,p){return l[0]=r[0]+o[0]*p,l[1]=r[1]+o[1]*p,l[2]=r[2]+o[2]*p,l},_.br=mt,_.bs=function(l,r,o){var p=o[0],v=o[1],E=o[2],A=r[0],M=r[1],z=r[2],F=v*z-E*M,q=E*A-p*z,W=p*M-v*A,te=v*W-E*q,ie=E*F-p*W,re=p*q-v*F,oe=2*o[3];return q*=oe,W*=oe,ie*=2,re*=2,l[0]=A+(F*=oe)+(te*=2),l[1]=M+q+ie,l[2]=z+W+re,l},_.bt=function(l,r,o){const p=(v=[l[0],l[1],l[2],r[0],r[1],r[2],o[0],o[1],o[2]])[0]*((q=v[8])*(A=v[4])-(M=v[5])*(F=v[7]))+v[1]*(-q*(E=v[3])+M*(z=v[6]))+v[2]*(F*E-A*z);var v,E,A,M,z,F,q;if(p===0)return null;const W=Re([],[r[0],r[1],r[2]],[o[0],o[1],o[2]]),te=Re([],[o[0],o[1],o[2]],[l[0],l[1],l[2]]),ie=Re([],[l[0],l[1],l[2]],[r[0],r[1],r[2]]),re=Ae([],W,-l[3]);return ge(re,re,Ae([],te,-r[3])),ge(re,re,Ae([],ie,-o[3])),Ae(re,re,1/p),re},_.bu=v_,_.bv=function(){return new Float64Array(4)},_.bw=function(l,r,o,p){var v=[],E=[];return v[0]=r[0]-o[0],v[1]=r[1]-o[1],v[2]=r[2]-o[2],E[0]=v[0]*Math.cos(p)-v[1]*Math.sin(p),E[1]=v[0]*Math.sin(p)+v[1]*Math.cos(p),E[2]=v[2],l[0]=E[0]+o[0],l[1]=E[1]+o[1],l[2]=E[2]+o[2],l},_.bx=function(l,r,o,p){var v=[],E=[];return v[0]=r[0]-o[0],v[1]=r[1]-o[1],v[2]=r[2]-o[2],E[0]=v[0],E[1]=v[1]*Math.cos(p)-v[2]*Math.sin(p),E[2]=v[1]*Math.sin(p)+v[2]*Math.cos(p),l[0]=E[0]+o[0],l[1]=E[1]+o[1],l[2]=E[2]+o[2],l},_.by=function(l,r,o,p){var v=[],E=[];return v[0]=r[0]-o[0],v[1]=r[1]-o[1],v[2]=r[2]-o[2],E[0]=v[2]*Math.sin(p)+v[0]*Math.cos(p),E[1]=v[1],E[2]=v[2]*Math.cos(p)-v[0]*Math.sin(p),l[0]=E[0]+o[0],l[1]=E[1]+o[1],l[2]=E[2]+o[2],l},_.bz=function(l,r,o){var p=Math.sin(o),v=Math.cos(o),E=r[0],A=r[1],M=r[2],z=r[3],F=r[8],q=r[9],W=r[10],te=r[11];return r!==l&&(l[4]=r[4],l[5]=r[5],l[6]=r[6],l[7]=r[7],l[12]=r[12],l[13]=r[13],l[14]=r[14],l[15]=r[15]),l[0]=E*v-F*p,l[1]=A*v-q*p,l[2]=M*v-W*p,l[3]=z*v-te*p,l[8]=E*p+F*v,l[9]=A*p+q*v,l[10]=M*p+W*v,l[11]=z*p+te*v,l},_.c=We,_.c0=Td,_.c1=class extends u{},_.c2=$g,_.c3=function(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))},_.c4=qg,_.c5=function(l,r,o){var p=r[0],v=r[1],E=r[2],A=o[3]*p+o[7]*v+o[11]*E+o[15];return l[0]=(o[0]*p+o[4]*v+o[8]*E+o[12])/(A=A||1),l[1]=(o[1]*p+o[5]*v+o[9]*E+o[13])/A,l[2]=(o[2]*p+o[6]*v+o[10]*E+o[14])/A,l},_.c6=class extends Wr{},_.c7=class extends j{},_.c8=function(l,r){return l[0]===r[0]&&l[1]===r[1]&&l[2]===r[2]&&l[3]===r[3]&&l[4]===r[4]&&l[5]===r[5]&&l[6]===r[6]&&l[7]===r[7]&&l[8]===r[8]&&l[9]===r[9]&&l[10]===r[10]&&l[11]===r[11]&&l[12]===r[12]&&l[13]===r[13]&&l[14]===r[14]&&l[15]===r[15]},_.c9=function(l,r){var o=l[0],p=l[1],v=l[2],E=l[3],A=l[4],M=l[5],z=l[6],F=l[7],q=l[8],W=l[9],te=l[10],ie=l[11],re=l[12],oe=l[13],pe=l[14],Te=l[15],He=r[0],Le=r[1],Be=r[2],ot=r[3],gt=r[4],It=r[5],$t=r[6],Bt=r[7],Gt=r[8],dn=r[9],qt=r[10],jt=r[11],St=r[12],Sn=r[13],Pn=r[14],mn=r[15];return Math.abs(o-He)<=Je*Math.max(1,Math.abs(o),Math.abs(He))&&Math.abs(p-Le)<=Je*Math.max(1,Math.abs(p),Math.abs(Le))&&Math.abs(v-Be)<=Je*Math.max(1,Math.abs(v),Math.abs(Be))&&Math.abs(E-ot)<=Je*Math.max(1,Math.abs(E),Math.abs(ot))&&Math.abs(A-gt)<=Je*Math.max(1,Math.abs(A),Math.abs(gt))&&Math.abs(M-It)<=Je*Math.max(1,Math.abs(M),Math.abs(It))&&Math.abs(z-$t)<=Je*Math.max(1,Math.abs(z),Math.abs($t))&&Math.abs(F-Bt)<=Je*Math.max(1,Math.abs(F),Math.abs(Bt))&&Math.abs(q-Gt)<=Je*Math.max(1,Math.abs(q),Math.abs(Gt))&&Math.abs(W-dn)<=Je*Math.max(1,Math.abs(W),Math.abs(dn))&&Math.abs(te-qt)<=Je*Math.max(1,Math.abs(te),Math.abs(qt))&&Math.abs(ie-jt)<=Je*Math.max(1,Math.abs(ie),Math.abs(jt))&&Math.abs(re-St)<=Je*Math.max(1,Math.abs(re),Math.abs(St))&&Math.abs(oe-Sn)<=Je*Math.max(1,Math.abs(oe),Math.abs(Sn))&&Math.abs(pe-Pn)<=Je*Math.max(1,Math.abs(pe),Math.abs(Pn))&&Math.abs(Te-mn)<=Je*Math.max(1,Math.abs(Te),Math.abs(mn))},_.cA=function(l,r){se.REGISTERED_PROTOCOLS[l]=r},_.cB=function(l){delete se.REGISTERED_PROTOCOLS[l]},_.cC=function(l,r){const o={};for(let v=0;v<l.length;v++){const E=r&&r[l[v].id]||Li(l[v]);r&&(r[l[v].id]=E);let A=o[E];A||(A=o[E]=[]),A.push(l[v])}const p=[];for(const v in o)p.push(o[v]);return p},_.cD=Yt,_.cE=Pm,_.cF=mp,_.cG=c_,_.cH=function(l){l.bucket.createArrays(),l.bucket.tilePixelRatio=Zt/(512*l.bucket.overscaling),l.bucket.compareText={},l.bucket.iconsNeedLinear=!1;const r=l.bucket.layers[0],o=r.layout,p=r._unevaluatedLayout._values,v={layoutIconSize:p["icon-size"].possiblyEvaluate(new Di(l.bucket.zoom+1),l.canonical),layoutTextSize:p["text-size"].possiblyEvaluate(new Di(l.bucket.zoom+1),l.canonical),textMaxSize:p["text-size"].possiblyEvaluate(new Di(18))};if(l.bucket.textSizeData.kind==="composite"){const{minZoom:F,maxZoom:q}=l.bucket.textSizeData;v.compositeTextSizes=[p["text-size"].possiblyEvaluate(new Di(F),l.canonical),p["text-size"].possiblyEvaluate(new Di(q),l.canonical)]}if(l.bucket.iconSizeData.kind==="composite"){const{minZoom:F,maxZoom:q}=l.bucket.iconSizeData;v.compositeIconSizes=[p["icon-size"].possiblyEvaluate(new Di(F),l.canonical),p["icon-size"].possiblyEvaluate(new Di(q),l.canonical)]}const E=o.get("text-line-height")*Xr,A=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point",M=o.get("text-keep-upright"),z=o.get("text-size");for(const F of l.bucket.features){const q=o.get("text-font").evaluate(F,{},l.canonical).join(","),W=z.evaluate(F,{},l.canonical),te=v.layoutTextSize.evaluate(F,{},l.canonical),ie=v.layoutIconSize.evaluate(F,{},l.canonical),re={horizontal:{},vertical:void 0},oe=F.text;let pe,Te=[0,0];if(oe){const Be=oe.toString(),ot=o.get("text-letter-spacing").evaluate(F,{},l.canonical)*Xr,gt=Fc(Be)?ot:0,It=o.get("text-anchor").evaluate(F,{},l.canonical),$t=Av(r,F,l.canonical);if(!$t){const qt=o.get("text-radial-offset").evaluate(F,{},l.canonical);Te=qt?Ev(It,[qt*Xr,km]):o.get("text-offset").evaluate(F,{},l.canonical).map((jt=>jt*Xr))}let Bt=A?"center":o.get("text-justify").evaluate(F,{},l.canonical);const Gt=o.get("symbol-placement")==="point"?o.get("text-max-width").evaluate(F,{},l.canonical)*Xr:1/0,dn=()=>{l.bucket.allowVerticalPlacement&&sd(Be)&&(re.vertical=Ad(oe,l.glyphMap,l.glyphPositions,l.imagePositions,q,Gt,E,It,"left",gt,Te,_.ao.vertical,!0,te,W))};if(!A&&$t){const qt=new Set;if(Bt==="auto")for(let St=0;St<$t.values.length;St+=2)qt.add(bc($t.values[St]));else qt.add(Bt);let jt=!1;for(const St of qt)if(!re.horizontal[St])if(jt)re.horizontal[St]=re.horizontal[0];else{const Sn=Ad(oe,l.glyphMap,l.glyphPositions,l.imagePositions,q,Gt,E,"center",St,gt,Te,_.ao.horizontal,!1,te,W);Sn&&(re.horizontal[St]=Sn,jt=Sn.positionedLines.length===1)}dn()}else{Bt==="auto"&&(Bt=bc(It));const qt=Ad(oe,l.glyphMap,l.glyphPositions,l.imagePositions,q,Gt,E,It,Bt,gt,Te,_.ao.horizontal,!1,te,W);qt&&(re.horizontal[Bt]=qt),dn(),sd(Be)&&A&&M&&(re.vertical=Ad(oe,l.glyphMap,l.glyphPositions,l.imagePositions,q,Gt,E,It,Bt,gt,Te,_.ao.vertical,!1,te,W))}}let He=!1;if(F.icon&&F.icon.name){const Be=l.imageMap[F.icon.name];Be&&(pe=hv(l.imagePositions[F.icon.name],o.get("icon-offset").evaluate(F,{},l.canonical),o.get("icon-anchor").evaluate(F,{},l.canonical)),He=!!Be.sdf,l.bucket.sdfIcons===void 0?l.bucket.sdfIcons=He:l.bucket.sdfIcons!==He&&Pi("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Be.pixelRatio!==l.bucket.pixelRatio||o.get("icon-rotate").constantOr(1)!==0)&&(l.bucket.iconsNeedLinear=!0))}const Le=Dm(re.horizontal)||re.vertical;l.bucket.iconsInText=!!Le&&Le.iconsInText,(Le||pe)&&Cv(l.bucket,F,re,pe,l.imageMap,v,te,ie,Te,He,l.canonical,l.subdivisionGranularity)}l.showCollisionBoxes&&l.bucket.generateCollisionDebugBuffers()},_.cI=$i,_.cJ=Ur,_.cK=ap,_.cL=gc,_.cM=lf,_.cN=class{constructor(l){this._marks={start:[l.url,"start"].join("#"),end:[l.url,"end"].join("#"),measure:l.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let l=performance.getEntriesByName(this._marks.measure);return l.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),l=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),l}},_.cO=function(l,r,o,p,v){return c(this,void 0,void 0,(function*(){if(tt())try{return yield pr(l,r,o,p,v)}catch{}return(function(E,A,M,z,F){const q=E.width,W=E.height;Ea&&wo||(Ea=new OffscreenCanvas(q,W),wo=Ea.getContext("2d",{willReadFrequently:!0})),Ea.width=q,Ea.height=W,wo.drawImage(E,0,0,q,W);const te=wo.getImageData(A,M,z,F);return wo.clearRect(0,0,q,W),te.data})(l,r,o,p,v)}))},_.cP=dm,_.cQ=k,_.cR=Go,_.cS=os,_.cT=vu,_.cU=function(l,r){const o=new Map;if(l!=null)if(l.type==="Feature")o.set(Id(l,r),l);else for(const p of l.features)o.set(Id(p,r),p);return o},_.cV=function(l,r){if(l==null)return!0;if(l.type==="Feature")return Id(l,r)!=null;if(l.type==="FeatureCollection"){const o=new Set;for(const p of l.features){const v=Id(p,r);if(v==null||o.has(v))return!1;o.add(v)}return!0}return!1},_.cW=function(l,r,o){var p,v,E,A;if(r.removeAll&&l.clear(),r.remove)for(const M of r.remove)l.delete(M);if(r.add)for(const M of r.add){const z=Id(M,o);z!=null&&l.set(z,M)}if(r.update)for(const M of r.update){let z=l.get(M.id);if(z==null)continue;const F=!M.removeAllProperties&&(((p=M.removeProperties)===null||p===void 0?void 0:p.length)>0||((v=M.addOrUpdateProperties)===null||v===void 0?void 0:v.length)>0);if((M.newGeometry||M.removeAllProperties||F)&&(z=Object.assign({},z),l.set(M.id,z),F&&(z.properties=Object.assign({},z.properties))),M.newGeometry&&(z.geometry=M.newGeometry),M.removeAllProperties)z.properties={};else if(((E=M.removeProperties)===null||E===void 0?void 0:E.length)>0)for(const q of M.removeProperties)Object.prototype.hasOwnProperty.call(z.properties,q)&&delete z.properties[q];if(((A=M.addOrUpdateProperties)===null||A===void 0?void 0:A.length)>0)for(const{key:q,value:W}of M.addOrUpdateProperties)z.properties[q]=W}},_.cX=ml,_.ca=function(l,r){return l[0]=r[0],l[1]=r[1],l[2]=r[2],l[3]=r[3],l[4]=r[4],l[5]=r[5],l[6]=r[6],l[7]=r[7],l[8]=r[8],l[9]=r[9],l[10]=r[10],l[11]=r[11],l[12]=r[12],l[13]=r[13],l[14]=r[14],l[15]=r[15],l},_.cb=l=>l.type==="symbol",_.cc=l=>l.type==="circle",_.cd=l=>l.type==="heatmap",_.ce=l=>l.type==="line",_.cf=l=>l.type==="fill",_.cg=l=>l.type==="fill-extrusion",_.ch=l=>l.type==="hillshade",_.ci=l=>l.type==="color-relief",_.cj=l=>l.type==="raster",_.ck=l=>l.type==="background",_.cl=l=>l.type==="custom",_.cm=Ut,_.cn=function(l,r,o){const p=bt(r.x-o.x,r.y-o.y),v=bt(l.x-o.x,l.y-o.y);var E,A;return fs(Math.atan2(p[0]*v[1]-p[1]*v[0],(E=p)[0]*(A=v)[0]+E[1]*A[1]))},_.co=Jt,_.cp=function(l,r){return Fs[r]&&(l instanceof MouseEvent||l instanceof WheelEvent)},_.cq=function(l,r){return ps[r]&&"touches"in l},_.cr=function(l){return ps[l]||Fs[l]},_.cs=function(l,r,o){var p=r[0],v=r[1];return l[0]=o[0]*p+o[4]*v+o[12],l[1]=o[1]*p+o[5]*v+o[13],l},_.ct=function(l,r){const{x:o,y:p}=Yc.fromLngLat(r);return!(l<0||l>25||p<0||p>=1||o<0||o>=1)},_.cu=function(l,r){return l[0]=r[0],l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=r[1],l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=r[2],l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l},_.cv=class extends Wa{},_.cw=Vm,_.cy=function(l){return l.message===ms},_.cz=Se,_.d=et,_.e=oi,_.f=l=>c(void 0,void 0,void 0,(function*(){if(l.byteLength===0)return createImageBitmap(new ImageData(1,1));const r=new Blob([new Uint8Array(l)],{type:"image/png"});try{return createImageBitmap(r)}catch(o){throw new Error(`Could not load image because of ${o.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),_.g=le,_.h=l=>new Promise(((r,o)=>{const p=new Image;p.onload=()=>{r(p),URL.revokeObjectURL(p.src),p.onload=null,window.requestAnimationFrame((()=>{p.src=Vi}))},p.onerror=()=>o(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const v=new Blob([new Uint8Array(l)],{type:"image/png"});p.src=l.byteLength?URL.createObjectURL(v):Vi})),_.i=Ta,_.j=(l,r)=>$e(oi(l,{type:"json"}),r),_.k=wt,_.l=Pt,_.m=$e,_.n=(l,r)=>$e(oi(l,{type:"arrayBuffer"}),r),_.o=function(l){return new lf(l).readFields(up,[])},_.p=u_,_.q=ef,_.r=As,_.s=ao,_.t=Eu,_.u=ri,_.v=qe,_.w=Pi,_.x=mh,_.y=rd,_.z=ic})),d("worker",["./shared"],(function(_){class c{constructor(se){this.keyCache={},se&&this.replace(se)}replace(se){this._layerConfigs={},this._layers={},this.update(se,[])}update(se,le){for(const Se of se){this._layerConfigs[Se.id]=Se;const De=this._layers[Se.id]=_.bJ(Se);De._featureFilter=_.aa(De.filter),this.keyCache[Se.id]&&delete this.keyCache[Se.id]}for(const Se of le)delete this.keyCache[Se],delete this._layerConfigs[Se],delete this._layers[Se];this.familiesBySource={};const fe=_.cC(Object.values(this._layerConfigs),this.keyCache);for(const Se of fe){const De=Se.map((wt=>this._layers[wt.id])),$e=De[0];if($e.visibility==="none")continue;const et=$e.source||"";let Ze=this.familiesBySource[et];Ze||(Ze=this.familiesBySource[et]={});const _t=$e.sourceLayer||"_geojsonTileLayer";let Pt=Ze[_t];Pt||(Pt=Ze[_t]=[]),Pt.push(De)}}}class C{constructor(se){const le={},fe=[];for(const et in se){const Ze=se[et],_t=le[et]={};for(const Pt in Ze){const wt=Ze[+Pt];if(!wt||wt.bitmap.width===0||wt.bitmap.height===0)continue;const tn={x:0,y:0,w:wt.bitmap.width+2,h:wt.bitmap.height+2};fe.push(tn),_t[Pt]={rect:tn,metrics:wt.metrics}}}const{w:Se,h:De}=_.p(fe),$e=new _.q({width:Se||1,height:De||1});for(const et in se){const Ze=se[et];for(const _t in Ze){const Pt=Ze[+_t];if(!Pt||Pt.bitmap.width===0||Pt.bitmap.height===0)continue;const wt=le[et][_t].rect;_.q.copy(Pt.bitmap,$e,{x:0,y:0},{x:wt.x+1,y:wt.y+1},Pt.bitmap)}}this.image=$e,this.positions=le}}_.cD("GlyphAtlas",C);class k{constructor(se){this.tileID=new _.Z(se.tileID.overscaledZ,se.tileID.wrap,se.tileID.canonical.z,se.tileID.canonical.x,se.tileID.canonical.y),this.uid=se.uid,this.zoom=se.zoom,this.pixelRatio=se.pixelRatio,this.tileSize=se.tileSize,this.source=se.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=se.showCollisionBoxes,this.collectResourceTiming=!!se.collectResourceTiming,this.returnDependencies=!!se.returnDependencies,this.promoteId=se.promoteId,this.inFlightDependencies=[],this.globalState=se.globalState}parse(se,le,fe,Se,De){return _._(this,void 0,void 0,(function*(){this.status="parsing",this.data=se,this.collisionBoxArray=new _.a8;const $e=new _.cE(Object.keys(se.layers).sort()),et=new _.cF(this.tileID,this.promoteId);et.bucketLayerIDs=[];const Ze={},_t={featureIndex:et,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:fe,subdivisionGranularity:De},Pt=le.familiesBySource[this.source];for(const Vn in Pt){const Kn=se.layers[Vn];if(!Kn)continue;Kn.version===1&&_.w(`Vector tile source "${this.source}" layer "${Vn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const br=$e.encode(Vn),Rt=[];for(let en=0;en<Kn.length;en++){const nr=Kn.feature(en),ta=et.getId(nr,Vn);Rt.push({feature:nr,id:ta,index:en,sourceLayerIndex:br})}for(const en of Pt[Vn]){const nr=en[0];nr.source!==this.source&&_.w(`layer.source = ${nr.source} does not equal this.source = ${this.source}`),nr.minzoom&&this.zoom<Math.floor(nr.minzoom)||nr.maxzoom&&this.zoom>=nr.maxzoom||nr.visibility!=="none"&&(V(en,this.zoom,fe),(Ze[nr.id]=nr.createBucket({index:et.bucketLayerIDs.length,layers:en,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:br,sourceID:this.source,globalState:this.globalState})).populate(Rt,_t,this.tileID.canonical),et.bucketLayerIDs.push(en.map((ta=>ta.id))))}}const wt=_.bN(_t.glyphDependencies,(Vn=>Object.keys(Vn).map(Number)));this.inFlightDependencies.forEach((Vn=>Vn==null?void 0:Vn.abort())),this.inFlightDependencies=[];let tn=Promise.resolve({});if(Object.keys(wt).length){const Vn=new AbortController;this.inFlightDependencies.push(Vn),tn=Se.sendAsync({type:"GG",data:{stacks:wt,source:this.source,tileID:this.tileID,type:"glyphs"}},Vn)}const qe=Object.keys(_t.iconDependencies);let vn=Promise.resolve({});if(qe.length){const Vn=new AbortController;this.inFlightDependencies.push(Vn),vn=Se.sendAsync({type:"GI",data:{icons:qe,source:this.source,tileID:this.tileID,type:"icons"}},Vn)}const Rn=Object.keys(_t.patternDependencies);let nn=Promise.resolve({});if(Rn.length){const Vn=new AbortController;this.inFlightDependencies.push(Vn),nn=Se.sendAsync({type:"GI",data:{icons:Rn,source:this.source,tileID:this.tileID,type:"patterns"}},Vn)}const[Nn,Ri,Gi]=yield Promise.all([tn,vn,nn]),tr=new C(Nn),Ir=new _.cG(Ri,Gi);for(const Vn in Ze){const Kn=Ze[Vn];Kn instanceof _.a9?(V(Kn.layers,this.zoom,fe),_.cH({bucket:Kn,glyphMap:Nn,glyphPositions:tr.positions,imageMap:Ri,imagePositions:Ir.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:_t.subdivisionGranularity})):Kn.hasPattern&&(Kn instanceof _.cI||Kn instanceof _.cJ||Kn instanceof _.cK)&&(V(Kn.layers,this.zoom,fe),Kn.addFeatures(_t,this.tileID.canonical,Ir.patternPositions))}return this.status="done",{buckets:Object.values(Ze).filter((Vn=>!Vn.isEmpty())),featureIndex:et,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:tr.image,imageAtlas:Ir,glyphMap:this.returnDependencies?Nn:null,iconMap:this.returnDependencies?Ri:null,glyphPositions:this.returnDependencies?tr.positions:null}}))}}function V(We,se,le){const fe=new _.F(se);for(const Se of We)Se.recalculate(fe,le)}class G{constructor(se,le,fe){this.actor=se,this.layerIndex=le,this.availableImages=fe,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(se,le){return _._(this,void 0,void 0,(function*(){const fe=yield _.n(se.request,le);try{return{vectorTile:new _.cL(new _.cM(fe.data)),rawData:fe.data,cacheControl:fe.cacheControl,expires:fe.expires}}catch(Se){const De=new Uint8Array(fe.data);let $e=`Unable to parse the tile at ${se.request.url}, `;throw $e+=De[0]===31&&De[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Se.message}`,new Error($e)}}))}loadTile(se){return _._(this,void 0,void 0,(function*(){const le=se.uid,fe=!!(se&&se.request&&se.request.collectResourceTiming)&&new _.cN(se.request),Se=new k(se);this.loading[le]=Se;const De=new AbortController;Se.abort=De;try{const $e=yield this.loadVectorTile(se,De);if(delete this.loading[le],!$e)return null;const et=$e.rawData,Ze={};$e.expires&&(Ze.expires=$e.expires),$e.cacheControl&&(Ze.cacheControl=$e.cacheControl);const _t={};if(fe){const wt=fe.finish();wt&&(_t.resourceTiming=JSON.parse(JSON.stringify(wt)))}Se.vectorTile=$e.vectorTile;const Pt=Se.parse($e.vectorTile,this.layerIndex,this.availableImages,this.actor,se.subdivisionGranularity);this.loaded[le]=Se,this.fetching[le]={rawTileData:et,cacheControl:Ze,resourceTiming:_t};try{const wt=yield Pt;return _.e({rawTileData:et.slice(0)},wt,Ze,_t)}finally{delete this.fetching[le]}}catch($e){throw delete this.loading[le],Se.status="done",this.loaded[le]=Se,$e}}))}reloadTile(se){return _._(this,void 0,void 0,(function*(){const le=se.uid;if(!this.loaded||!this.loaded[le])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const fe=this.loaded[le];if(fe.showCollisionBoxes=se.showCollisionBoxes,fe.globalState=se.globalState,fe.status==="parsing"){const Se=yield fe.parse(fe.vectorTile,this.layerIndex,this.availableImages,this.actor,se.subdivisionGranularity);let De;if(this.fetching[le]){const{rawTileData:$e,cacheControl:et,resourceTiming:Ze}=this.fetching[le];delete this.fetching[le],De=_.e({rawTileData:$e.slice(0)},Se,et,Ze)}else De=Se;return De}if(fe.status==="done"&&fe.vectorTile)return fe.parse(fe.vectorTile,this.layerIndex,this.availableImages,this.actor,se.subdivisionGranularity)}))}abortTile(se){return _._(this,void 0,void 0,(function*(){const le=this.loading,fe=se.uid;le&&le[fe]&&le[fe].abort&&(le[fe].abort.abort(),delete le[fe])}))}removeTile(se){return _._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[se.uid]&&delete this.loaded[se.uid]}))}}class ee{constructor(){this.loaded={}}loadTile(se){return _._(this,void 0,void 0,(function*(){const{uid:le,encoding:fe,rawImageData:Se,redFactor:De,greenFactor:$e,blueFactor:et,baseShift:Ze}=se,_t=Se.width+2,Pt=Se.height+2,wt=_.b(Se)?new _.R({width:_t,height:Pt},yield _.cO(Se,-1,-1,_t,Pt)):Se,tn=new _.cP(le,wt,fe,De,$e,et,Ze);return this.loaded=this.loaded||{},this.loaded[le]=tn,tn}))}removeTile(se){const le=this.loaded,fe=se.uid;le&&le[fe]&&delete le[fe]}}var Y,xe,be=(function(){if(xe)return Y;function We(le,fe){if(le.length!==0){se(le[0],fe);for(var Se=1;Se<le.length;Se++)se(le[Se],!fe)}}function se(le,fe){for(var Se=0,De=0,$e=0,et=le.length,Ze=et-1;$e<et;Ze=$e++){var _t=(le[$e][0]-le[Ze][0])*(le[Ze][1]+le[$e][1]),Pt=Se+_t;De+=Math.abs(Se)>=Math.abs(_t)?Se-Pt+_t:_t-Pt+Se,Se=Pt}Se+De>=0!=!!fe&&le.reverse()}return xe=1,Y=function le(fe,Se){var De,$e=fe&&fe.type;if($e==="FeatureCollection")for(De=0;De<fe.features.length;De++)le(fe.features[De],Se);else if($e==="GeometryCollection")for(De=0;De<fe.geometries.length;De++)le(fe.geometries[De],Se);else if($e==="Feature")le(fe.geometry,Se);else if($e==="Polygon")We(fe.coordinates,Se);else if($e==="MultiPolygon")for(De=0;De<fe.coordinates.length;De++)We(fe.coordinates[De],Se);return fe}})(),Ne=_.cQ(be);class tt extends _.cS{constructor(se,le){super(new _.cM,0,le,[],[]),this.feature=se,this.type=se.type,this.properties=se.tags?se.tags:{},"id"in se&&(typeof se.id=="string"?this.id=parseInt(se.id,10):typeof se.id!="number"||isNaN(se.id)||(this.id=se.id))}loadGeometry(){const se=[],le=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const fe of le){const Se=[];for(const De of fe)Se.push(new _.P(De[0],De[1]));se.push(Se)}return se}}class Je extends _.cR{constructor(se,le){super(new _.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=le?le.version:1,this.extent=le?le.extent:4096,this.length=se.length,this.features=se}feature(se){return new tt(this.features[se],this.extent)}}function Xe(We,se){se.writeVarintField(15,We.version||1),se.writeStringField(1,We.name||""),se.writeVarintField(5,We.extent||4096);const le={keys:[],values:[],keycache:{},valuecache:{}};for(let De=0;De<We.length;De++)le.feature=We.feature(De),se.writeMessage(2,Ke,le);const fe=le.keys;for(const De of fe)se.writeStringField(3,De);const Se=le.values;for(const De of Se)se.writeMessage(4,ge,De)}function Ke(We,se){if(!We.feature)return;const le=We.feature;le.id!==void 0&&se.writeVarintField(1,le.id),se.writeMessage(2,Ge,We),se.writeVarintField(3,le.type),se.writeMessage(4,ce,le)}function Ge(We,se){var le;for(const fe in(le=We.feature)==null?void 0:le.properties){let Se=We.feature.properties[fe],De=We.keycache[fe];if(Se===null)continue;De===void 0&&(We.keys.push(fe),De=We.keys.length-1,We.keycache[fe]=De),se.writeVarint(De),typeof Se!="string"&&typeof Se!="boolean"&&typeof Se!="number"&&(Se=JSON.stringify(Se));const $e=typeof Se+":"+Se;let et=We.valuecache[$e];et===void 0&&(We.values.push(Se),et=We.values.length-1,We.valuecache[$e]=et),se.writeVarint(et)}}function Fe(We,se){return(se<<3)+(7&We)}function de(We){return We<<1^We>>31}function ce(We,se){const le=We.loadGeometry(),fe=We.type;let Se=0,De=0;for(const $e of le){let et=1;fe===1&&(et=$e.length),se.writeVarint(Fe(1,et));const Ze=fe===3?$e.length-1:$e.length;for(let _t=0;_t<Ze;_t++){_t===1&&fe!==1&&se.writeVarint(Fe(2,Ze-1));const Pt=$e[_t].x-Se,wt=$e[_t].y-De;se.writeVarint(de(Pt)),se.writeVarint(de(wt)),Se+=Pt,De+=wt}We.type===3&&se.writeVarint(Fe(7,1))}}function ge(We,se){const le=typeof We;le==="string"?se.writeStringField(1,We):le==="boolean"?se.writeBooleanField(7,We):le==="number"&&(We%1!=0?se.writeDoubleField(3,We):We<0?se.writeSVarintField(6,We):se.writeVarintField(5,We))}const Ae={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:We=>We},Re=Math.fround||(je=new Float32Array(1),We=>(je[0]=+We,je[0]));var je;class Pe{constructor(se){this.options=Object.assign(Object.create(Ae),se),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(se){const{log:le,minZoom:fe,maxZoom:Se}=this.options;le&&console.time("total time");const De=`prepare ${se.length} points`;le&&console.time(De),this.points=se;const $e=[];for(let Ze=0;Ze<se.length;Ze++){const _t=se[Ze];if(!_t.geometry)continue;const[Pt,wt]=_t.geometry.coordinates,tn=Re(mt(Pt)),qe=Re(At(wt));$e.push(tn,qe,1/0,Ze,-1,1),this.options.reduce&&$e.push(0)}let et=this.trees[Se+1]=this._createTree($e);le&&console.timeEnd(De);for(let Ze=Se;Ze>=fe;Ze--){const _t=+Date.now();et=this.trees[Ze]=this._createTree(this._cluster(et,Ze)),le&&console.log("z%d: %d clusters in %dms",Ze,et.numItems,+Date.now()-_t)}return le&&console.timeEnd("total time"),this}getClusters(se,le){let fe=((se[0]+180)%360+360)%360-180;const Se=Math.max(-90,Math.min(90,se[1]));let De=se[2]===180?180:((se[2]+180)%360+360)%360-180;const $e=Math.max(-90,Math.min(90,se[3]));if(se[2]-se[0]>=360)fe=-180,De=180;else if(fe>De){const wt=this.getClusters([fe,Se,180,$e],le),tn=this.getClusters([-180,Se,De,$e],le);return wt.concat(tn)}const et=this.trees[this._limitZoom(le)],Ze=et.range(mt(fe),At($e),mt(De),At(Se)),_t=et.data,Pt=[];for(const wt of Ze){const tn=this.stride*wt;Pt.push(_t[tn+5]>1?Mn(_t,tn,this.clusterProps):this.points[_t[tn+3]])}return Pt}getChildren(se){const le=this._getOriginId(se),fe=this._getOriginZoom(se),Se="No cluster with the specified id.",De=this.trees[fe];if(!De)throw new Error(Se);const $e=De.data;if(le*this.stride>=$e.length)throw new Error(Se);const et=this.options.radius/(this.options.extent*Math.pow(2,fe-1)),Ze=De.within($e[le*this.stride],$e[le*this.stride+1],et),_t=[];for(const Pt of Ze){const wt=Pt*this.stride;$e[wt+4]===se&&_t.push($e[wt+5]>1?Mn($e,wt,this.clusterProps):this.points[$e[wt+3]])}if(_t.length===0)throw new Error(Se);return _t}getLeaves(se,le,fe){const Se=[];return this._appendLeaves(Se,se,le=le||10,fe=fe||0,0),Se}getTile(se,le,fe){const Se=this.trees[this._limitZoom(se)],De=Math.pow(2,se),{extent:$e,radius:et}=this.options,Ze=et/$e,_t=(fe-Ze)/De,Pt=(fe+1+Ze)/De,wt={features:[]};return this._addTileFeatures(Se.range((le-Ze)/De,_t,(le+1+Ze)/De,Pt),Se.data,le,fe,De,wt),le===0&&this._addTileFeatures(Se.range(1-Ze/De,_t,1,Pt),Se.data,De,fe,De,wt),le===De-1&&this._addTileFeatures(Se.range(0,_t,Ze/De,Pt),Se.data,-1,fe,De,wt),wt.features.length?wt:null}getClusterExpansionZoom(se){let le=this._getOriginZoom(se)-1;for(;le<=this.options.maxZoom;){const fe=this.getChildren(se);if(le++,fe.length!==1)break;se=fe[0].properties.cluster_id}return le}_appendLeaves(se,le,fe,Se,De){const $e=this.getChildren(le);for(const et of $e){const Ze=et.properties;if(Ze&&Ze.cluster?De+Ze.point_count<=Se?De+=Ze.point_count:De=this._appendLeaves(se,Ze.cluster_id,fe,Se,De):De<Se?De++:se.push(et),se.length===fe)break}return De}_createTree(se){const le=new _.aI(se.length/this.stride|0,this.options.nodeSize,Float32Array);for(let fe=0;fe<se.length;fe+=this.stride)le.add(se[fe],se[fe+1]);return le.finish(),le.data=se,le}_addTileFeatures(se,le,fe,Se,De,$e){for(const et of se){const Ze=et*this.stride,_t=le[Ze+5]>1;let Pt,wt,tn;if(_t)Pt=ni(le,Ze,this.clusterProps),wt=le[Ze],tn=le[Ze+1];else{const Rn=this.points[le[Ze+3]];Pt=Rn.properties;const[nn,Nn]=Rn.geometry.coordinates;wt=mt(nn),tn=At(Nn)}const qe={type:1,geometry:[[Math.round(this.options.extent*(wt*De-fe)),Math.round(this.options.extent*(tn*De-Se))]],tags:Pt};let vn;vn=_t||this.options.generateId?le[Ze+3]:this.points[le[Ze+3]].id,vn!==void 0&&(qe.id=vn),$e.features.push(qe)}}_limitZoom(se){return Math.max(this.options.minZoom,Math.min(Math.floor(+se),this.options.maxZoom+1))}_cluster(se,le){const{radius:fe,extent:Se,reduce:De,minPoints:$e}=this.options,et=fe/(Se*Math.pow(2,le)),Ze=se.data,_t=[],Pt=this.stride;for(let wt=0;wt<Ze.length;wt+=Pt){if(Ze[wt+2]<=le)continue;Ze[wt+2]=le;const tn=Ze[wt],qe=Ze[wt+1],vn=se.within(Ze[wt],Ze[wt+1],et),Rn=Ze[wt+5];let nn=Rn;for(const Nn of vn){const Ri=Nn*Pt;Ze[Ri+2]>le&&(nn+=Ze[Ri+5])}if(nn>Rn&&nn>=$e){let Nn,Ri=tn*Rn,Gi=qe*Rn,tr=-1;const Ir=(wt/Pt<<5)+(le+1)+this.points.length;for(const Vn of vn){const Kn=Vn*Pt;if(Ze[Kn+2]<=le)continue;Ze[Kn+2]=le;const br=Ze[Kn+5];Ri+=Ze[Kn]*br,Gi+=Ze[Kn+1]*br,Ze[Kn+4]=Ir,De&&(Nn||(Nn=this._map(Ze,wt,!0),tr=this.clusterProps.length,this.clusterProps.push(Nn)),De(Nn,this._map(Ze,Kn)))}Ze[wt+4]=Ir,_t.push(Ri/nn,Gi/nn,1/0,Ir,-1,nn),De&&_t.push(tr)}else{for(let Nn=0;Nn<Pt;Nn++)_t.push(Ze[wt+Nn]);if(nn>1)for(const Nn of vn){const Ri=Nn*Pt;if(!(Ze[Ri+2]<=le)){Ze[Ri+2]=le;for(let Gi=0;Gi<Pt;Gi++)_t.push(Ze[Ri+Gi])}}}}return _t}_getOriginId(se){return se-this.points.length>>5}_getOriginZoom(se){return(se-this.points.length)%32}_map(se,le,fe){if(se[le+5]>1){const $e=this.clusterProps[se[le+6]];return fe?Object.assign({},$e):$e}const Se=this.points[se[le+3]].properties,De=this.options.map(Se);return fe&&De===Se?Object.assign({},De):De}}function Mn(We,se,le){return{type:"Feature",id:We[se+3],properties:ni(We,se,le),geometry:{type:"Point",coordinates:[(fe=We[se],360*(fe-.5)),bt(We[se+1])]}};var fe}function ni(We,se,le){const fe=We[se+5],Se=fe>=1e4?`${Math.round(fe/1e3)}k`:fe>=1e3?Math.round(fe/100)/10+"k":fe,De=We[se+6],$e=De===-1?{}:Object.assign({},le[De]);return Object.assign($e,{cluster:!0,cluster_id:We[se+3],point_count:fe,point_count_abbreviated:Se})}function mt(We){return We/360+.5}function At(We){const se=Math.sin(We*Math.PI/180),le=.5-.25*Math.log((1+se)/(1-se))/Math.PI;return le<0?0:le>1?1:le}function bt(We){const se=(180-360*We)*Math.PI/180;return 360*Math.atan(Math.exp(se))/Math.PI-90}function Zt(We,se,le,fe){let Se=fe;const De=se+(le-se>>1);let $e,et=le-se;const Ze=We[se],_t=We[se+1],Pt=We[le],wt=We[le+1];for(let tn=se+3;tn<le;tn+=3){const qe=Vt(We[tn],We[tn+1],Ze,_t,Pt,wt);if(qe>Se)$e=tn,Se=qe;else if(qe===Se){const vn=Math.abs(tn-De);vn<et&&($e=tn,et=vn)}}Se>fe&&($e-se>3&&Zt(We,se,$e,fe),We[$e+2]=Se,le-$e>3&&Zt(We,$e,le,fe))}function Vt(We,se,le,fe,Se,De){let $e=Se-le,et=De-fe;if($e!==0||et!==0){const Ze=((We-le)*$e+(se-fe)*et)/($e*$e+et*et);Ze>1?(le=Se,fe=De):Ze>0&&(le+=$e*Ze,fe+=et*Ze)}return $e=We-le,et=se-fe,$e*$e+et*et}function ke(We,se,le,fe){const Se={id:We??null,type:se,geometry:le,tags:fe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(se==="Point"||se==="MultiPoint"||se==="LineString")xt(Se,le);else if(se==="Polygon")xt(Se,le[0]);else if(se==="MultiLineString")for(const De of le)xt(Se,De);else if(se==="MultiPolygon")for(const De of le)xt(Se,De[0]);return Se}function xt(We,se){for(let le=0;le<se.length;le+=3)We.minX=Math.min(We.minX,se[le]),We.minY=Math.min(We.minY,se[le+1]),We.maxX=Math.max(We.maxX,se[le]),We.maxY=Math.max(We.maxY,se[le+1])}function Ot(We,se,le,fe){if(!se.geometry)return;const Se=se.geometry.coordinates;if(Se&&Se.length===0)return;const De=se.geometry.type,$e=Math.pow(le.tolerance/((1<<le.maxZoom)*le.extent),2);let et=[],Ze=se.id;if(le.promoteId?Ze=se.properties[le.promoteId]:le.generateId&&(Ze=fe||0),De==="Point")Ut(Se,et);else if(De==="MultiPoint")for(const _t of Se)Ut(_t,et);else if(De==="LineString")Jt(Se,et,$e,!1);else if(De==="MultiLineString"){if(le.lineMetrics){for(const _t of Se)et=[],Jt(_t,et,$e,!1),We.push(ke(Ze,"LineString",et,se.properties));return}Wt(Se,et,$e,!1)}else if(De==="Polygon")Wt(Se,et,$e,!0);else{if(De!=="MultiPolygon"){if(De==="GeometryCollection"){for(const _t of se.geometry.geometries)Ot(We,{id:Ze,geometry:_t,properties:se.properties},le,fe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const _t of Se){const Pt=[];Wt(_t,Pt,$e,!0),et.push(Pt)}}We.push(ke(Ze,De,et,se.properties))}function Ut(We,se){se.push(Fn(We[0]),oi(We[1]),0)}function Jt(We,se,le,fe){let Se,De,$e=0;for(let Ze=0;Ze<We.length;Ze++){const _t=Fn(We[Ze][0]),Pt=oi(We[Ze][1]);se.push(_t,Pt,0),Ze>0&&($e+=fe?(Se*Pt-_t*De)/2:Math.sqrt(Math.pow(_t-Se,2)+Math.pow(Pt-De,2))),Se=_t,De=Pt}const et=se.length-3;se[2]=1,Zt(se,0,et,le),se[et+2]=1,se.size=Math.abs($e),se.start=0,se.end=se.size}function Wt(We,se,le,fe){for(let Se=0;Se<We.length;Se++){const De=[];Jt(We[Se],De,le,fe),se.push(De)}}function Fn(We){return We/360+.5}function oi(We){const se=Math.sin(We*Math.PI/180),le=.5-.25*Math.log((1+se)/(1-se))/Math.PI;return le<0?0:le>1?1:le}function fi(We,se,le,fe,Se,De,$e,et){if(fe/=se,De>=(le/=se)&&$e<fe)return We;if($e<le||De>=fe)return null;const Ze=[];for(const _t of We){const Pt=_t.geometry;let wt=_t.type;const tn=Se===0?_t.minX:_t.minY,qe=Se===0?_t.maxX:_t.maxY;if(tn>=le&&qe<fe){Ze.push(_t);continue}if(qe<le||tn>=fe)continue;let vn=[];if(wt==="Point"||wt==="MultiPoint")ds(Pt,vn,le,fe,Se);else if(wt==="LineString")Ns(Pt,vn,le,fe,Se,!1,et.lineMetrics);else if(wt==="MultiLineString")Fi(Pt,vn,le,fe,Se,!1);else if(wt==="Polygon")Fi(Pt,vn,le,fe,Se,!0);else if(wt==="MultiPolygon")for(const Rn of Pt){const nn=[];Fi(Rn,nn,le,fe,Se,!0),nn.length&&vn.push(nn)}if(vn.length){if(et.lineMetrics&&wt==="LineString"){for(const Rn of vn)Ze.push(ke(_t.id,wt,Rn,_t.tags));continue}wt!=="LineString"&&wt!=="MultiLineString"||(vn.length===1?(wt="LineString",vn=vn[0]):wt="MultiLineString"),wt!=="Point"&&wt!=="MultiPoint"||(wt=vn.length===3?"Point":"MultiPoint"),Ze.push(ke(_t.id,wt,vn,_t.tags))}}return Ze.length?Ze:null}function ds(We,se,le,fe,Se){for(let De=0;De<We.length;De+=3){const $e=We[De+Se];$e>=le&&$e<=fe&&Pi(se,We[De],We[De+1],We[De+2])}}function Ns(We,se,le,fe,Se,De,$e){let et=Dr(We);const Ze=Se===0?Va:Ta;let _t,Pt,wt=We.start;for(let nn=0;nn<We.length-3;nn+=3){const Nn=We[nn],Ri=We[nn+1],Gi=We[nn+2],tr=We[nn+3],Ir=We[nn+4],Vn=Se===0?Nn:Ri,Kn=Se===0?tr:Ir;let br=!1;$e&&(_t=Math.sqrt(Math.pow(Nn-tr,2)+Math.pow(Ri-Ir,2))),Vn<le?Kn>le&&(Pt=Ze(et,Nn,Ri,tr,Ir,le),$e&&(et.start=wt+_t*Pt)):Vn>fe?Kn<fe&&(Pt=Ze(et,Nn,Ri,tr,Ir,fe),$e&&(et.start=wt+_t*Pt)):Pi(et,Nn,Ri,Gi),Kn<le&&Vn>=le&&(Pt=Ze(et,Nn,Ri,tr,Ir,le),br=!0),Kn>fe&&Vn<=fe&&(Pt=Ze(et,Nn,Ri,tr,Ir,fe),br=!0),!De&&br&&($e&&(et.end=wt+_t*Pt),se.push(et),et=Dr(We)),$e&&(wt+=_t)}let tn=We.length-3;const qe=We[tn],vn=We[tn+1],Rn=Se===0?qe:vn;Rn>=le&&Rn<=fe&&Pi(et,qe,vn,We[tn+2]),tn=et.length-3,De&&tn>=3&&(et[tn]!==et[0]||et[tn+1]!==et[1])&&Pi(et,et[0],et[1],et[2]),et.length&&se.push(et)}function Dr(We){const se=[];return se.size=We.size,se.start=We.start,se.end=We.end,se}function Fi(We,se,le,fe,Se,De){for(const $e of We)Ns($e,se,le,fe,Se,De,!1)}function Pi(We,se,le,fe){We.push(se,le,fe)}function Va(We,se,le,fe,Se,De){const $e=(De-se)/(fe-se);return Pi(We,De,le+(Se-le)*$e,1),$e}function Ta(We,se,le,fe,Se,De){const $e=(De-le)/(Se-le);return Pi(We,se+(fe-se)*$e,De,1),$e}function Bs(We,se){const le=[];for(let fe=0;fe<We.length;fe++){const Se=We[fe],De=Se.type;let $e;if(De==="Point"||De==="MultiPoint"||De==="LineString")$e=Sa(Se.geometry,se);else if(De==="MultiLineString"||De==="Polygon"){$e=[];for(const et of Se.geometry)$e.push(Sa(et,se))}else if(De==="MultiPolygon"){$e=[];for(const et of Se.geometry){const Ze=[];for(const _t of et)Ze.push(Sa(_t,se));$e.push(Ze)}}le.push(ke(Se.id,De,$e,Se.tags))}return le}function Sa(We,se){const le=[];le.size=We.size,We.start!==void 0&&(le.start=We.start,le.end=We.end);for(let fe=0;fe<We.length;fe+=3)le.push(We[fe]+se,We[fe+1],We[fe+2]);return le}function Vi(We,se){if(We.transformed)return We;const le=1<<We.z,fe=We.x,Se=We.y;for(const De of We.features){const $e=De.geometry,et=De.type;if(De.geometry=[],et===1)for(let Ze=0;Ze<$e.length;Ze+=2)De.geometry.push(pr($e[Ze],$e[Ze+1],se,le,fe,Se));else for(let Ze=0;Ze<$e.length;Ze++){const _t=[];for(let Pt=0;Pt<$e[Ze].length;Pt+=2)_t.push(pr($e[Ze][Pt],$e[Ze][Pt+1],se,le,fe,Se));De.geometry.push(_t)}}return We.transformed=!0,We}function pr(We,se,le,fe,Se,De){return[Math.round(le*(We*fe-Se)),Math.round(le*(se*fe-De))]}function Ea(We,se,le,fe,Se){const De=se===Se.maxZoom?0:Se.tolerance/((1<<se)*Se.extent),$e={features:[],numPoints:0,numSimplified:0,numFeatures:We.length,source:null,x:le,y:fe,z:se,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const et of We)wo($e,et,De,Se);return $e}function wo(We,se,le,fe){const Se=se.geometry,De=se.type,$e=[];if(We.minX=Math.min(We.minX,se.minX),We.minY=Math.min(We.minY,se.minY),We.maxX=Math.max(We.maxX,se.maxX),We.maxY=Math.max(We.maxY,se.maxY),De==="Point"||De==="MultiPoint")for(let et=0;et<Se.length;et+=3)$e.push(Se[et],Se[et+1]),We.numPoints++,We.numSimplified++;else if(De==="LineString")ao($e,Se,We,le,!1,!1);else if(De==="MultiLineString"||De==="Polygon")for(let et=0;et<Se.length;et++)ao($e,Se[et],We,le,De==="Polygon",et===0);else if(De==="MultiPolygon")for(let et=0;et<Se.length;et++){const Ze=Se[et];for(let _t=0;_t<Ze.length;_t++)ao($e,Ze[_t],We,le,!0,_t===0)}if($e.length){let et=se.tags||null;if(De==="LineString"&&fe.lineMetrics){et={};for(const _t in se.tags)et[_t]=se.tags[_t];et.mapbox_clip_start=Se.start/Se.size,et.mapbox_clip_end=Se.end/Se.size}const Ze={geometry:$e,type:De==="Polygon"||De==="MultiPolygon"?3:De==="LineString"||De==="MultiLineString"?2:1,tags:et};se.id!==null&&(Ze.id=se.id),We.features.push(Ze)}}function ao(We,se,le,fe,Se,De){const $e=fe*fe;if(fe>0&&se.size<(Se?$e:fe))return void(le.numPoints+=se.length/3);const et=[];for(let Ze=0;Ze<se.length;Ze+=3)(fe===0||se[Ze+2]>$e)&&(le.numSimplified++,et.push(se[Ze],se[Ze+1])),le.numPoints++;Se&&(function(Ze,_t){let Pt=0;for(let wt=0,tn=Ze.length,qe=tn-2;wt<tn;qe=wt,wt+=2)Pt+=(Ze[wt]-Ze[qe])*(Ze[wt+1]+Ze[qe+1]);if(Pt>0===_t)for(let wt=0,tn=Ze.length;wt<tn/2;wt+=2){const qe=Ze[wt],vn=Ze[wt+1];Ze[wt]=Ze[tn-2-wt],Ze[wt+1]=Ze[tn-1-wt],Ze[tn-2-wt]=qe,Ze[tn-1-wt]=vn}})(et,De),We.push(et)}const qr={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class fs{constructor(se,le){const fe=(le=this.options=(function(De,$e){for(const et in $e)De[et]=$e[et];return De})(Object.create(qr),le)).debug;if(fe&&console.time("preprocess data"),le.maxZoom<0||le.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(le.promoteId&&le.generateId)throw new Error("promoteId and generateId cannot be used together.");let Se=(function(De,$e){const et=[];if(De.type==="FeatureCollection")for(let Ze=0;Ze<De.features.length;Ze++)Ot(et,De.features[Ze],$e,Ze);else Ot(et,De.type==="Feature"?De:{geometry:De},$e);return et})(se,le);this.tiles={},this.tileCoords=[],fe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",le.indexMaxZoom,le.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Se=(function(De,$e){const et=$e.buffer/$e.extent;let Ze=De;const _t=fi(De,1,-1-et,et,0,-1,2,$e),Pt=fi(De,1,1-et,2+et,0,-1,2,$e);return(_t||Pt)&&(Ze=fi(De,1,-et,1+et,0,-1,2,$e)||[],_t&&(Ze=Bs(_t,1).concat(Ze)),Pt&&(Ze=Ze.concat(Bs(Pt,-1)))),Ze})(Se,le),Se.length&&this.splitTile(Se,0,0,0),fe&&(Se.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(se,le,fe,Se,De,$e,et){const Ze=[se,le,fe,Se],_t=this.options,Pt=_t.debug;for(;Ze.length;){Se=Ze.pop(),fe=Ze.pop(),le=Ze.pop(),se=Ze.pop();const wt=1<<le,tn=ps(le,fe,Se);let qe=this.tiles[tn];if(!qe&&(Pt>1&&console.time("creation"),qe=this.tiles[tn]=Ea(se,le,fe,Se,_t),this.tileCoords.push({z:le,x:fe,y:Se}),Pt)){Pt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",le,fe,Se,qe.numFeatures,qe.numPoints,qe.numSimplified),console.timeEnd("creation"));const br=`z${le}`;this.stats[br]=(this.stats[br]||0)+1,this.total++}if(qe.source=se,De==null){if(le===_t.indexMaxZoom||qe.numPoints<=_t.indexMaxPoints)continue}else{if(le===_t.maxZoom||le===De)continue;if(De!=null){const br=De-le;if(fe!==$e>>br||Se!==et>>br)continue}}if(qe.source=null,se.length===0)continue;Pt>1&&console.time("clipping");const vn=.5*_t.buffer/_t.extent,Rn=.5-vn,nn=.5+vn,Nn=1+vn;let Ri=null,Gi=null,tr=null,Ir=null,Vn=fi(se,wt,fe-vn,fe+nn,0,qe.minX,qe.maxX,_t),Kn=fi(se,wt,fe+Rn,fe+Nn,0,qe.minX,qe.maxX,_t);se=null,Vn&&(Ri=fi(Vn,wt,Se-vn,Se+nn,1,qe.minY,qe.maxY,_t),Gi=fi(Vn,wt,Se+Rn,Se+Nn,1,qe.minY,qe.maxY,_t),Vn=null),Kn&&(tr=fi(Kn,wt,Se-vn,Se+nn,1,qe.minY,qe.maxY,_t),Ir=fi(Kn,wt,Se+Rn,Se+Nn,1,qe.minY,qe.maxY,_t),Kn=null),Pt>1&&console.timeEnd("clipping"),Ze.push(Ri||[],le+1,2*fe,2*Se),Ze.push(Gi||[],le+1,2*fe,2*Se+1),Ze.push(tr||[],le+1,2*fe+1,2*Se),Ze.push(Ir||[],le+1,2*fe+1,2*Se+1)}}getTile(se,le,fe){se=+se,le=+le,fe=+fe;const Se=this.options,{extent:De,debug:$e}=Se;if(se<0||se>24)return null;const et=1<<se,Ze=ps(se,le=le+et&et-1,fe);if(this.tiles[Ze])return Vi(this.tiles[Ze],De);$e>1&&console.log("drilling down to z%d-%d-%d",se,le,fe);let _t,Pt=se,wt=le,tn=fe;for(;!_t&&Pt>0;)Pt--,wt>>=1,tn>>=1,_t=this.tiles[ps(Pt,wt,tn)];return _t&&_t.source?($e>1&&(console.log("found parent tile z%d-%d-%d",Pt,wt,tn),console.time("drilling down")),this.splitTile(_t.source,Pt,wt,tn,se,le,fe),$e>1&&console.timeEnd("drilling down"),this.tiles[Ze]?Vi(this.tiles[Ze],De):null):null}}function ps(We,se,le){return 32*((1<<We)*le+se)+We}class Fs extends G{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(se,le){return _._(this,void 0,void 0,(function*(){const fe=se.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const Se=this._geoJSONIndex.getTile(fe.z,fe.x,fe.y);if(!Se)return null;const De=new Je(Se.features,{version:2,extent:_.$});let $e=(function(et){const Ze=new _.cM;return(function(_t,Pt){for(const wt in _t.layers)Pt.writeMessage(3,Xe,_t.layers[wt])})(et,Ze),Ze.finish()})(De);return $e.byteOffset===0&&$e.byteLength===$e.buffer.byteLength||($e=new Uint8Array($e)),{vectorTile:De,rawData:$e.buffer}}))}loadData(se){return _._(this,void 0,void 0,(function*(){var le;(le=this._pendingRequest)===null||le===void 0||le.abort();const fe=!!(se&&se.request&&se.request.collectResourceTiming)&&new _.cN(se.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(se,this._pendingRequest);const Se=yield this._pendingData;this._geoJSONIndex=se.cluster?new Pe((function({superclusterOptions:$e,clusterProperties:et}){if(!et||!$e)return $e;const Ze={},_t={},Pt={accumulated:null,zoom:0},wt={properties:null},tn=Object.keys(et);for(const qe of tn){const[vn,Rn]=et[qe],nn=_.cT(Rn),Nn=_.cT(typeof vn=="string"?[vn,["accumulated"],["get",qe]]:vn);Ze[qe]=nn.value,_t[qe]=Nn.value}return $e.map=qe=>{wt.properties=qe;const vn={};for(const Rn of tn)vn[Rn]=Ze[Rn].evaluate(Pt,wt);return vn},$e.reduce=(qe,vn)=>{wt.properties=vn;for(const Rn of tn)Pt.accumulated=qe[Rn],qe[Rn]=_t[Rn].evaluate(Pt,wt)},$e})(se)).load(Se.features):(function($e,et){return new fs($e,et)})(Se,se.geojsonVtOptions),this.loaded={};const De={data:Se};if(fe){const $e=fe.finish();$e&&(De.resourceTiming={},De.resourceTiming[se.source]=JSON.parse(JSON.stringify($e)))}return De}catch(Se){if(delete this._pendingRequest,_.cy(Se))return{abandoned:!0};throw Se}}))}getData(){return _._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(se){const le=this.loaded;return le&&le[se.uid]?super.reloadTile(se):this.loadTile(se)}loadAndProcessGeoJSON(se,le){return _._(this,void 0,void 0,(function*(){let fe=yield this.loadGeoJSON(se,le);if(delete this._pendingRequest,typeof fe!="object")throw new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`);if(Ne(fe,!0),se.filter){const Se=_.cT(se.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Se.result==="error")throw new Error(Se.value.map(($e=>`${$e.key}: ${$e.message}`)).join(", "));fe={type:"FeatureCollection",features:fe.features.filter(($e=>Se.value.evaluate({zoom:0},$e)))}}return fe}))}loadGeoJSON(se,le){return _._(this,void 0,void 0,(function*(){const{promoteId:fe}=se;if(se.request){const Se=yield _.j(se.request,le);return this._dataUpdateable=_.cV(Se.data,fe)?_.cU(Se.data,fe):void 0,Se.data}if(typeof se.data=="string")try{const Se=JSON.parse(se.data);return this._dataUpdateable=_.cV(Se,fe)?_.cU(Se,fe):void 0,Se}catch{throw new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`)}if(!se.dataDiff)throw new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${se.source}`);return _.cW(this._dataUpdateable,se.dataDiff,fe),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(se){return _._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(se){return this._geoJSONIndex.getClusterExpansionZoom(se.clusterId)}getClusterChildren(se){return this._geoJSONIndex.getChildren(se.clusterId)}getClusterLeaves(se){return this._geoJSONIndex.getLeaves(se.clusterId,se.limit,se.offset)}}class ms{constructor(se){this.self=se,this.actor=new _.J(se),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(le,fe)=>{if(this.externalWorkerSourceTypes[le])throw new Error(`Worker source with name "${le}" already registered.`);this.externalWorkerSourceTypes[le]=fe},this.self.addProtocol=_.cA,this.self.removeProtocol=_.cB,this.self.registerRTLTextPlugin=le=>{_.cX.setMethods(le)},this.actor.registerMessageHandler("LDT",((le,fe)=>this._getDEMWorkerSource(le,fe.source).loadTile(fe))),this.actor.registerMessageHandler("RDT",((le,fe)=>_._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(le,fe.source).removeTile(fe)})))),this.actor.registerMessageHandler("GCEZ",((le,fe)=>_._(this,void 0,void 0,(function*(){return this._getWorkerSource(le,fe.type,fe.source).getClusterExpansionZoom(fe)})))),this.actor.registerMessageHandler("GCC",((le,fe)=>_._(this,void 0,void 0,(function*(){return this._getWorkerSource(le,fe.type,fe.source).getClusterChildren(fe)})))),this.actor.registerMessageHandler("GCL",((le,fe)=>_._(this,void 0,void 0,(function*(){return this._getWorkerSource(le,fe.type,fe.source).getClusterLeaves(fe)})))),this.actor.registerMessageHandler("LD",((le,fe)=>this._getWorkerSource(le,fe.type,fe.source).loadData(fe))),this.actor.registerMessageHandler("GD",((le,fe)=>this._getWorkerSource(le,fe.type,fe.source).getData())),this.actor.registerMessageHandler("LT",((le,fe)=>this._getWorkerSource(le,fe.type,fe.source).loadTile(fe))),this.actor.registerMessageHandler("RT",((le,fe)=>this._getWorkerSource(le,fe.type,fe.source).reloadTile(fe))),this.actor.registerMessageHandler("AT",((le,fe)=>this._getWorkerSource(le,fe.type,fe.source).abortTile(fe))),this.actor.registerMessageHandler("RMT",((le,fe)=>this._getWorkerSource(le,fe.type,fe.source).removeTile(fe))),this.actor.registerMessageHandler("RS",((le,fe)=>_._(this,void 0,void 0,(function*(){if(!this.workerSources[le]||!this.workerSources[le][fe.type]||!this.workerSources[le][fe.type][fe.source])return;const Se=this.workerSources[le][fe.type][fe.source];delete this.workerSources[le][fe.type][fe.source],Se.removeSource!==void 0&&Se.removeSource(fe)})))),this.actor.registerMessageHandler("RM",(le=>_._(this,void 0,void 0,(function*(){delete this.layerIndexes[le],delete this.availableImages[le],delete this.workerSources[le],delete this.demWorkerSources[le]})))),this.actor.registerMessageHandler("SR",((le,fe)=>_._(this,void 0,void 0,(function*(){this.referrer=fe})))),this.actor.registerMessageHandler("SRPS",((le,fe)=>this._syncRTLPluginState(le,fe))),this.actor.registerMessageHandler("IS",((le,fe)=>_._(this,void 0,void 0,(function*(){this.self.importScripts(fe)})))),this.actor.registerMessageHandler("SI",((le,fe)=>this._setImages(le,fe))),this.actor.registerMessageHandler("UL",((le,fe)=>_._(this,void 0,void 0,(function*(){this._getLayerIndex(le).update(fe.layers,fe.removedIds)})))),this.actor.registerMessageHandler("SL",((le,fe)=>_._(this,void 0,void 0,(function*(){this._getLayerIndex(le).replace(fe)}))))}_setImages(se,le){return _._(this,void 0,void 0,(function*(){this.availableImages[se]=le;for(const fe in this.workerSources[se]){const Se=this.workerSources[se][fe];for(const De in Se)Se[De].availableImages=le}}))}_syncRTLPluginState(se,le){return _._(this,void 0,void 0,(function*(){return yield _.cX.syncState(le,this.self.importScripts)}))}_getAvailableImages(se){let le=this.availableImages[se];return le||(le=[]),le}_getLayerIndex(se){let le=this.layerIndexes[se];return le||(le=this.layerIndexes[se]=new c),le}_getWorkerSource(se,le,fe){if(this.workerSources[se]||(this.workerSources[se]={}),this.workerSources[se][le]||(this.workerSources[se][le]={}),!this.workerSources[se][le][fe]){const Se={sendAsync:(De,$e)=>(De.targetMapId=se,this.actor.sendAsync(De,$e))};switch(le){case"vector":this.workerSources[se][le][fe]=new G(Se,this._getLayerIndex(se),this._getAvailableImages(se));break;case"geojson":this.workerSources[se][le][fe]=new Fs(Se,this._getLayerIndex(se),this._getAvailableImages(se));break;default:this.workerSources[se][le][fe]=new this.externalWorkerSourceTypes[le](Se,this._getLayerIndex(se),this._getAvailableImages(se))}}return this.workerSources[se][le][fe]}_getDEMWorkerSource(se,le){return this.demWorkerSources[se]||(this.demWorkerSources[se]={}),this.demWorkerSources[se][le]||(this.demWorkerSources[se][le]=new ee),this.demWorkerSources[se][le]}}return _.i(self)&&(self.worker=new ms(self)),ms})),d("index",["exports","./shared"],(function(_,c){var C="5.6.2";function k(){var T=new c.A(4);return c.A!=Float32Array&&(T[1]=0,T[2]=0),T[0]=1,T[3]=1,T}let V,G;const ee={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(T,n,u){const g=requestAnimationFrame((S=>{b(),n(S)})),{unsubscribe:b}=c.s(T.signal,"abort",(()=>{b(),cancelAnimationFrame(g),u(c.c())}),!1)},frameAsync(T){return new Promise(((n,u)=>{this.frame(T,n,u)}))},getImageData(T,n=0){return this.getImageCanvasContext(T).getImageData(-n,-n,T.width+2*n,T.height+2*n)},getImageCanvasContext(T){const n=window.document.createElement("canvas"),u=n.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return n.width=T.width,n.height=T.height,u.drawImage(T,0,0,T.width,T.height),u},resolveURL:T=>(V||(V=document.createElement("a")),V.href=T,V.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(G==null&&(G=matchMedia("(prefers-reduced-motion: reduce)")),G.matches)}};class Y{static testProp(n){if(!Y.docStyle)return n[0];for(let u=0;u<n.length;u++)if(n[u]in Y.docStyle)return n[u];return n[0]}static create(n,u,g){const b=window.document.createElement(n);return u!==void 0&&(b.className=u),g&&g.appendChild(b),b}static createNS(n,u){return window.document.createElementNS(n,u)}static disableDrag(){Y.docStyle&&Y.selectProp&&(Y.userSelect=Y.docStyle[Y.selectProp],Y.docStyle[Y.selectProp]="none")}static enableDrag(){Y.docStyle&&Y.selectProp&&(Y.docStyle[Y.selectProp]=Y.userSelect)}static setTransform(n,u){n.style[Y.transformProp]=u}static addEventListener(n,u,g,b={}){n.addEventListener(u,g,"passive"in b?b:b.capture)}static removeEventListener(n,u,g,b={}){n.removeEventListener(u,g,"passive"in b?b:b.capture)}static suppressClickInternal(n){n.preventDefault(),n.stopPropagation(),window.removeEventListener("click",Y.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",Y.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",Y.suppressClickInternal,!0)}),0)}static getScale(n){const u=n.getBoundingClientRect();return{x:u.width/n.offsetWidth||1,y:u.height/n.offsetHeight||1,boundingClientRect:u}}static getPoint(n,u,g){const b=u.boundingClientRect;return new c.P((g.clientX-b.left)/u.x-n.clientLeft,(g.clientY-b.top)/u.y-n.clientTop)}static mousePos(n,u){const g=Y.getScale(n);return Y.getPoint(n,g,u)}static touchPos(n,u){const g=[],b=Y.getScale(n);for(let S=0;S<u.length;S++)g.push(Y.getPoint(n,b,u[S]));return g}static mouseButton(n){return n.button}static remove(n){n.parentNode&&n.parentNode.removeChild(n)}static sanitize(n){const u=new DOMParser().parseFromString(n,"text/html").body||document.createElement("body"),g=u.querySelectorAll("script");for(const b of g)b.remove();return Y.clean(u),u.innerHTML}static isPossiblyDangerous(n,u){const g=u.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(n)||!g.includes("javascript:")&&!g.includes("data:"))||!!n.startsWith("on")||void 0}static clean(n){const u=n.children;for(const g of u)Y.removeAttributes(g),Y.clean(g)}static removeAttributes(n){for(const{name:u,value:g}of n.attributes)Y.isPossiblyDangerous(u,g)&&n.removeAttribute(u)}}Y.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,Y.selectProp=Y.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),Y.transformProp=Y.testProp(["transform","WebkitTransform"]);const xe={supported:!1,testSupport:function(T){!tt&&Ne&&(Je?Xe(T):be=T)}};let be,Ne,tt=!1,Je=!1;function Xe(T){const n=T.createTexture();T.bindTexture(T.TEXTURE_2D,n);try{if(T.texImage2D(T.TEXTURE_2D,0,T.RGBA,T.RGBA,T.UNSIGNED_BYTE,Ne),T.isContextLost())return;xe.supported=!0}catch{}T.deleteTexture(n),tt=!0}var Ke;typeof document<"u"&&(Ne=document.createElement("img"),Ne.onload=()=>{be&&Xe(be),be=null,Je=!0},Ne.onerror=()=>{tt=!0,be=null},Ne.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(T){let n,u,g,b;T.resetRequestQueue=()=>{n=[],u=0,g=0,b={}},T.addThrottleControl=N=>{const j=g++;return b[j]=N,j},T.removeThrottleControl=N=>{delete b[N],I()},T.getImage=(N,j,$=!0)=>new Promise(((X,H)=>{xe.supported&&(N.headers||(N.headers={}),N.headers.accept="image/webp,*/*"),c.e(N,{type:"image"}),n.push({abortController:j,requestParameters:N,supportImageRefresh:$,state:"queued",onError:J=>{H(J)},onSuccess:J=>{X(J)}}),I()}));const S=N=>c._(this,void 0,void 0,(function*(){N.state="running";const{requestParameters:j,supportImageRefresh:$,onError:X,onSuccess:H,abortController:J}=N,ae=$===!1&&!c.i(self)&&!c.g(j.url)&&(!j.headers||Object.keys(j.headers).reduce(((ve,we)=>ve&&we==="accept"),!0));u++;const _e=ae?O(j,J):c.m(j,J);try{const ve=yield _e;delete N.abortController,N.state="completed",ve.data instanceof HTMLImageElement||c.b(ve.data)?H(ve):ve.data&&H({data:yield(me=ve.data,typeof createImageBitmap=="function"?c.f(me):c.h(me)),cacheControl:ve.cacheControl,expires:ve.expires})}catch(ve){delete N.abortController,X(ve)}finally{u--,I()}var me})),I=()=>{const N=(()=>{for(const j of Object.keys(b))if(b[j]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let j=u;j<N&&n.length>0;j++){const $=n.shift();$.abortController.signal.aborted?j--:S($)}},O=(N,j)=>new Promise((($,X)=>{const H=new Image,J=N.url,ae=N.credentials;ae&&ae==="include"?H.crossOrigin="use-credentials":(ae&&ae==="same-origin"||!c.d(J))&&(H.crossOrigin="anonymous"),j.signal.addEventListener("abort",(()=>{H.src="",X(c.c())})),H.fetchPriority="high",H.onload=()=>{H.onerror=H.onload=null,$({data:H})},H.onerror=()=>{H.onerror=H.onload=null,j.signal.aborted||X(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},H.src=J}))})(Ke||(Ke={})),Ke.resetRequestQueue();class Ge{constructor(n){this._transformRequestFn=n??null}transformRequest(n,u){return this._transformRequestFn&&this._transformRequestFn(n,u)||{url:n}}setTransformRequest(n){this._transformRequestFn=n}}function Fe(T){const n=[];if(typeof T=="string")n.push({id:"default",url:T});else if(T&&T.length>0){const u=[];for(const{id:g,url:b}of T){const S=`${g}${b}`;u.indexOf(S)===-1&&(u.push(S),n.push({id:g,url:b}))}}return n}function de(T,n,u){try{const g=new URL(T);return g.pathname+=`${n}${u}`,g.toString()}catch{throw new Error(`Invalid sprite URL "${T}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function ce(T){const{userImage:n}=T;return!!(n&&n.render&&n.render())&&(T.data.replace(new Uint8Array(n.data.buffer)),!0)}class ge extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:u,promiseResolve:g}of this.requestors)g(this._getImagesForIds(u));this.requestors=[]}}getImage(n){const u=this.images[n];if(u&&!u.data&&u.spriteData){const g=u.spriteData;u.data=new c.R({width:g.width,height:g.height},g.context.getImageData(g.x,g.y,g.width,g.height).data),u.spriteData=null}return u}addImage(n,u){if(this.images[n])throw new Error(`Image id ${n} already exist, use updateImage instead`);this._validate(n,u)&&(this.images[n]=u)}_validate(n,u){let g=!0;const b=u.data||u.spriteData;return this._validateStretch(u.stretchX,b&&b.width)||(this.fire(new c.k(new Error(`Image "${n}" has invalid "stretchX" value`))),g=!1),this._validateStretch(u.stretchY,b&&b.height)||(this.fire(new c.k(new Error(`Image "${n}" has invalid "stretchY" value`))),g=!1),this._validateContent(u.content,u)||(this.fire(new c.k(new Error(`Image "${n}" has invalid "content" value`))),g=!1),g}_validateStretch(n,u){if(!n)return!0;let g=0;for(const b of n){if(b[0]<g||b[1]<b[0]||u<b[1])return!1;g=b[1]}return!0}_validateContent(n,u){if(!n)return!0;if(n.length!==4)return!1;const g=u.spriteData,b=g&&g.width||u.data.width,S=g&&g.height||u.data.height;return!(n[0]<0||b<n[0]||n[1]<0||S<n[1]||n[2]<0||b<n[2]||n[3]<0||S<n[3]||n[2]<n[0]||n[3]<n[1])}updateImage(n,u,g=!0){const b=this.getImage(n);if(g&&(b.data.width!==u.data.width||b.data.height!==u.data.height))throw new Error(`size mismatch between old image (${b.data.width}x${b.data.height}) and new image (${u.data.width}x${u.data.height}).`);u.version=b.version+1,this.images[n]=u,this.updatedImages[n]=!0}removeImage(n){const u=this.images[n];delete this.images[n],delete this.patterns[n],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n){return new Promise(((u,g)=>{let b=!0;if(!this.isLoaded())for(const S of n)this.images[S]||(b=!1);this.isLoaded()||b?u(this._getImagesForIds(n)):this.requestors.push({ids:n,promiseResolve:u})}))}_getImagesForIds(n){const u={};for(const g of n){let b=this.getImage(g);b||(this.fire(new c.l("styleimagemissing",{id:g})),b=this.getImage(g)),b?u[g]={data:b.data.clone(),pixelRatio:b.pixelRatio,sdf:b.sdf,version:b.version,stretchX:b.stretchX,stretchY:b.stretchY,content:b.content,textFitWidth:b.textFitWidth,textFitHeight:b.textFitHeight,hasRenderCallback:!!(b.userImage&&b.userImage.render)}:c.w(`Image "${g}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return u}getPixelSize(){const{width:n,height:u}=this.atlasImage;return{width:n,height:u}}getPattern(n){const u=this.patterns[n],g=this.getImage(n);if(!g)return null;if(u&&u.position.version===g.version)return u.position;if(u)u.position.version=g.version;else{const b={w:g.data.width+2,h:g.data.height+2,x:0,y:0},S=new c.I(b,g);this.patterns[n]={bin:b,position:S}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const u=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new c.T(n,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const S in this.patterns)n.push(this.patterns[S].bin);const{w:u,h:g}=c.p(n),b=this.atlasImage;b.resize({width:u||1,height:g||1});for(const S in this.patterns){const{bin:I}=this.patterns[S],O=I.x+1,N=I.y+1,j=this.getImage(S).data,$=j.width,X=j.height;c.R.copy(j,b,{x:0,y:0},{x:O,y:N},{width:$,height:X}),c.R.copy(j,b,{x:0,y:X-1},{x:O,y:N-1},{width:$,height:1}),c.R.copy(j,b,{x:0,y:0},{x:O,y:N+X},{width:$,height:1}),c.R.copy(j,b,{x:$-1,y:0},{x:O-1,y:N},{width:1,height:X}),c.R.copy(j,b,{x:0,y:0},{x:O+$,y:N},{width:1,height:X})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const u of n){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const g=this.getImage(u);g||c.w(`Image with ID: "${u}" was not found`),ce(g)&&this.updateImage(u,g)}}}const Ae=1e20;function Re(T,n,u,g,b,S,I,O,N){for(let j=n;j<n+g;j++)je(T,u*S+j,S,b,I,O,N);for(let j=u;j<u+b;j++)je(T,j*S+n,1,g,I,O,N)}function je(T,n,u,g,b,S,I){S[0]=0,I[0]=-Ae,I[1]=Ae,b[0]=T[n];for(let O=1,N=0,j=0;O<g;O++){b[O]=T[n+O*u];const $=O*O;do{const X=S[N];j=(b[O]-b[X]+$-X*X)/(O-X)/2}while(j<=I[N]&&--N>-1);N++,S[N]=O,I[N]=j,I[N+1]=Ae}for(let O=0,N=0;O<g;O++){for(;I[N+1]<O;)N++;const j=S[N],$=O-j;T[n+O*u]=b[j]+$*$}}class Pe{constructor(n,u){this.requestManager=n,this.localIdeographFontFamily=u,this.entries={}}setURL(n){this.url=n}getGlyphs(n){return c._(this,void 0,void 0,(function*(){const u=[];for(const S in n)for(const I of n[S])u.push(this._getAndCacheGlyphsPromise(S,I));const g=yield Promise.all(u),b={};for(const{stack:S,id:I,glyph:O}of g)b[S]||(b[S]={}),b[S][I]=O&&{id:O.id,bitmap:O.bitmap.clone(),metrics:O.metrics};return b}))}_getAndCacheGlyphsPromise(n,u){return c._(this,void 0,void 0,(function*(){let g=this.entries[n];g||(g=this.entries[n]={glyphs:{},requests:{},ranges:{}});let b=g.glyphs[u];if(b!==void 0)return{stack:n,id:u,glyph:b};if(b=this._tinySDF(g,n,u),b)return g.glyphs[u]=b,{stack:n,id:u,glyph:b};const S=Math.floor(u/256);if(256*S>65535)throw new Error("glyphs > 65535 not supported");if(g.ranges[S])return{stack:n,id:u,glyph:b};if(!this.url)throw new Error("glyphsUrl is not set");if(!g.requests[S]){const O=Pe.loadGlyphRange(n,S,this.url,this.requestManager);g.requests[S]=O}const I=yield g.requests[S];for(const O in I)this._doesCharSupportLocalGlyph(+O)||(g.glyphs[+O]=I[+O]);return g.ranges[S]=!0,{stack:n,id:u,glyph:I[u]||null}}))}_doesCharSupportLocalGlyph(n){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(n))||c.u["CJK Unified Ideographs"](n)||c.u["Hangul Syllables"](n)||c.u.Hiragana(n)||c.u.Katakana(n)||c.u["CJK Symbols and Punctuation"](n)||c.u["Halfwidth and Fullwidth Forms"](n))}_tinySDF(n,u,g){const b=this.localIdeographFontFamily;if(!b||!this._doesCharSupportLocalGlyph(g))return;let S=n.tinySDF;if(!S){let O="400";/bold/i.test(u)?O="900":/medium/i.test(u)?O="500":/light/i.test(u)&&(O="200"),S=n.tinySDF=new Pe.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:b,fontWeight:O})}const I=S.draw(String.fromCharCode(g));return{id:g,bitmap:new c.q({width:I.width||60,height:I.height||60},I.data),metrics:{width:I.glyphWidth/2||24,height:I.glyphHeight/2||24,left:I.glyphLeft/2+.5||0,top:I.glyphTop/2-27.5||-8,advance:I.glyphAdvance/2||24,isDoubleResolution:!0}}}}Pe.loadGlyphRange=function(T,n,u,g){return c._(this,void 0,void 0,(function*(){const b=256*n,S=b+255,I=g.transformRequest(u.replace("{fontstack}",T).replace("{range}",`${b}-${S}`),"Glyphs"),O=yield c.n(I,new AbortController);if(!O||!O.data)throw new Error(`Could not load glyph range. range: ${n}, ${b}-${S}`);const N={};for(const j of c.o(O.data))N[j.id]=j;return N}))},Pe.TinySDF=class{constructor({fontSize:T=24,buffer:n=3,radius:u=8,cutoff:g=.25,fontFamily:b="sans-serif",fontWeight:S="normal",fontStyle:I="normal",lang:O=null}={}){this.buffer=n,this.cutoff=g,this.radius=u,this.lang=O;const N=this.size=T+4*n,j=this._createCanvas(N),$=this.ctx=j.getContext("2d",{willReadFrequently:!0});$.font=`${I} ${S} ${T}px ${b}`,$.textBaseline="alphabetic",$.textAlign="left",$.fillStyle="black",this.gridOuter=new Float64Array(N*N),this.gridInner=new Float64Array(N*N),this.f=new Float64Array(N),this.z=new Float64Array(N+1),this.v=new Uint16Array(N)}_createCanvas(T){const n=document.createElement("canvas");return n.width=n.height=T,n}draw(T){const{width:n,actualBoundingBoxAscent:u,actualBoundingBoxDescent:g,actualBoundingBoxLeft:b,actualBoundingBoxRight:S}=this.ctx.measureText(T),I=Math.ceil(u),O=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(S-b))),N=Math.min(this.size-this.buffer,I+Math.ceil(g)),j=O+2*this.buffer,$=N+2*this.buffer,X=Math.max(j*$,0),H=new Uint8ClampedArray(X),J={data:H,width:j,height:$,glyphWidth:O,glyphHeight:N,glyphTop:I,glyphLeft:0,glyphAdvance:n};if(O===0||N===0)return J;const{ctx:ae,buffer:_e,gridInner:me,gridOuter:ve}=this;this.lang&&(ae.lang=this.lang),ae.clearRect(_e,_e,O,N),ae.fillText(T,_e,_e+I);const we=ae.getImageData(_e,_e,O,N);ve.fill(Ae,0,X),me.fill(0,0,X);for(let Me=0;Me<N;Me++)for(let Ee=0;Ee<O;Ee++){const ze=we.data[4*(Me*O+Ee)+3]/255;if(ze===0)continue;const Ve=(Me+_e)*j+Ee+_e;if(ze===1)ve[Ve]=0,me[Ve]=Ae;else{const Ie=.5-ze;ve[Ve]=Ie>0?Ie*Ie:0,me[Ve]=Ie<0?Ie*Ie:0}}Re(ve,0,0,j,$,j,this.f,this.v,this.z),Re(me,_e,_e,O,N,j,this.f,this.v,this.z);for(let Me=0;Me<X;Me++){const Ee=Math.sqrt(ve[Me])-Math.sqrt(me[Me]);H[Me]=Math.round(255-255*(Ee/this.radius+this.cutoff))}return J}};class Mn{constructor(){this.specification=c.v.light.position}possiblyEvaluate(n,u){return c.B(n.expression.evaluate(u))}interpolate(n,u,g){return{x:c.C.number(n.x,u.x,g),y:c.C.number(n.y,u.y,g),z:c.C.number(n.z,u.z,g)}}}let ni;class mt extends c.E{constructor(n){super(),ni=ni||new c.r({anchor:new c.D(c.v.light.anchor),position:new Mn,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.t(ni),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,u={}){if(!this._validate(c.x,n,u))for(const g in n){const b=n[g];g.endsWith("-transition")?this._transitionable.setTransition(g.slice(0,-11),b):this._transitionable.setValue(g,b)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,u,g){return(!g||g.validate!==!1)&&c.y(this,n.call(c.z,{value:u,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const At=new c.r({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class bt extends c.E{constructor(n){super(),this._transitionable=new c.t(At),this.setSky(n),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.F(0))}setSky(n,u={}){if(!this._validate(c.G,n,u)){n||(n={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const g in n){const b=n[g];g.endsWith("-transition")?this._transitionable.setTransition(g.slice(0,-11),b):this._transitionable.setValue(g,b)}}}getSky(){return this._transitionable.serialize()}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,u,g={}){return(g==null?void 0:g.validate)!==!1&&c.y(this,n.call(c.z,c.e({value:u,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(n){return n<60?0:n<70?(n-60)/10:1}}class Zt{constructor(n,u){this.width=n,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(n,u){const g=n.join(",")+String(u);return this.dashEntry[g]||(this.dashEntry[g]=this.addDash(n,u)),this.dashEntry[g]}getDashRanges(n,u,g){const b=[];let S=n.length%2==1?-n[n.length-1]*g:0,I=n[0]*g,O=!0;b.push({left:S,right:I,isDash:O,zeroLength:n[0]===0});let N=n[0];for(let j=1;j<n.length;j++){O=!O;const $=n[j];S=N*g,N+=$,I=N*g,b.push({left:S,right:I,isDash:O,zeroLength:$===0})}return b}addRoundDash(n,u,g){const b=u/2;for(let S=-g;S<=g;S++){const I=this.width*(this.nextRow+g+S);let O=0,N=n[O];for(let j=0;j<this.width;j++){j/N.right>1&&(N=n[++O]);const $=Math.abs(j-N.left),X=Math.abs(j-N.right),H=Math.min($,X);let J;const ae=S/g*(b+1);if(N.isDash){const _e=b-Math.abs(ae);J=Math.sqrt(H*H+_e*_e)}else J=b-Math.sqrt(H*H+ae*ae);this.data[I+j]=Math.max(0,Math.min(255,J+128))}}}addRegularDash(n){for(let O=n.length-1;O>=0;--O){const N=n[O],j=n[O+1];N.zeroLength?n.splice(O,1):j&&j.isDash===N.isDash&&(j.left=N.left,n.splice(O,1))}const u=n[0],g=n[n.length-1];u.isDash===g.isDash&&(u.left=g.left-this.width,g.right=u.right+this.width);const b=this.width*this.nextRow;let S=0,I=n[S];for(let O=0;O<this.width;O++){O/I.right>1&&(I=n[++S]);const N=Math.abs(O-I.left),j=Math.abs(O-I.right),$=Math.min(N,j);this.data[b+O]=Math.max(0,Math.min(255,(I.isDash?$:-$)+128))}}addDash(n,u){const g=u?7:0,b=2*g+1;if(this.nextRow+b>this.height)return c.w("LineAtlas out of space"),null;let S=0;for(let O=0;O<n.length;O++)S+=n[O];if(S!==0){const O=this.width/S,N=this.getDashRanges(n,this.width,O);u?this.addRoundDash(N,O,g):this.addRegularDash(N)}const I={y:(this.nextRow+g+.5)/this.height,height:2*g/this.height,width:S};return this.nextRow+=b,this.dirty=!0,I}bind(n){const u=n.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))}}const Vt="maplibre_preloaded_worker_pool";class ke{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<ke.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach((u=>{u.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Vt]}numActive(){return Object.keys(this.active).length}}const xt=Math.floor(ee.hardwareConcurrency/2);let Ot,Ut;function Jt(){return Ot||(Ot=new ke),Ot}ke.workerCount=c.H(globalThis)?Math.max(Math.min(xt,3),1):1;class Wt{constructor(n,u){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=u;const g=this.workerPool.acquire(u);for(let b=0;b<g.length;b++){const S=new c.J(g[b],u);S.name=`Worker ${b}`,this.actors.push(S)}if(!this.actors.length)throw new Error("No actors found")}broadcast(n,u){const g=[];for(const b of this.actors)g.push(b.sendAsync({type:n,data:u}));return Promise.all(g)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(n=!0){this.actors.forEach((u=>{u.remove()})),this.actors=[],n&&this.workerPool.release(this.id)}registerMessageHandler(n,u){for(const g of this.actors)g.registerMessageHandler(n,u)}}function Fn(){return Ut||(Ut=new Wt(Jt(),c.K),Ut.registerMessageHandler("GR",((T,n,u)=>c.m(n,u)))),Ut}function oi(T,n){const u=c.L();return c.M(u,u,[1,1,0]),c.N(u,u,[.5*T.width,.5*T.height,1]),T.calculatePosMatrix?c.O(u,u,T.calculatePosMatrix(n.toUnwrapped())):u}function fi(T,n,u,g,b,S,I){var O;const N=(function(H,J,ae){if(H)for(const _e of H){const me=J[_e];if(me&&me.source===ae&&me.type==="fill-extrusion")return!0}else for(const _e in J){const me=J[_e];if(me.source===ae&&me.type==="fill-extrusion")return!0}return!1})((O=b==null?void 0:b.layers)!==null&&O!==void 0?O:null,n,T.id),j=S.maxPitchScaleFactor(),$=T.tilesIn(g,j,N);$.sort(ds);const X=[];for(const H of $)X.push({wrappedTileID:H.tileID.wrapped().key,queryResults:H.tile.queryRenderedFeatures(n,u,T._state,H.queryGeometry,H.cameraQueryGeometry,H.scale,b,S,j,oi(T.transform,H.tileID),I?(J,ae)=>I(H.tileID,J,ae):void 0)});return(function(H,J){for(const ae in H)for(const _e of H[ae])Ns(_e,J);return H})((function(H){const J={},ae={};for(const _e of H){const me=_e.queryResults,ve=_e.wrappedTileID,we=ae[ve]=ae[ve]||{};for(const Me in me){const Ee=me[Me],ze=we[Me]=we[Me]||{},Ve=J[Me]=J[Me]||[];for(const Ie of Ee)ze[Ie.featureIndex]||(ze[Ie.featureIndex]=!0,Ve.push(Ie))}}return J})(X),T)}function ds(T,n){const u=T.tileID,g=n.tileID;return u.overscaledZ-g.overscaledZ||u.canonical.y-g.canonical.y||u.wrap-g.wrap||u.canonical.x-g.canonical.x}function Ns(T,n){const u=T.feature,g=n.getFeatureState(u.layer["source-layer"],u.id);u.source=u.layer.source,u.layer["source-layer"]&&(u.sourceLayer=u.layer["source-layer"]),u.state=g}function Dr(T,n,u){return c._(this,void 0,void 0,(function*(){let g=T;if(T.url?g=(yield c.j(n.transformRequest(T.url,"Source"),u)).data:yield ee.frameAsync(u),!g)return null;const b=c.Q(c.e(g,T),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in g&&g.vector_layers&&(b.vectorLayerIds=g.vector_layers.map((S=>S.id))),b}))}class Fi{constructor(n,u){n&&(u?this.setSouthWest(n).setNorthEast(u):Array.isArray(n)&&(n.length===4?this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]]):this.setSouthWest(n[0]).setNorthEast(n[1])))}setNorthEast(n){return this._ne=n instanceof c.S?new c.S(n.lng,n.lat):c.S.convert(n),this}setSouthWest(n){return this._sw=n instanceof c.S?new c.S(n.lng,n.lat):c.S.convert(n),this}extend(n){const u=this._sw,g=this._ne;let b,S;if(n instanceof c.S)b=n,S=n;else{if(!(n instanceof Fi))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(Fi.convert(n)):this.extend(c.S.convert(n)):n&&("lng"in n||"lon"in n)&&"lat"in n?this.extend(c.S.convert(n)):this;if(b=n._sw,S=n._ne,!b||!S)return this}return u||g?(u.lng=Math.min(b.lng,u.lng),u.lat=Math.min(b.lat,u.lat),g.lng=Math.max(S.lng,g.lng),g.lat=Math.max(S.lat,g.lat)):(this._sw=new c.S(b.lng,b.lat),this._ne=new c.S(S.lng,S.lat)),this}getCenter(){return new c.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.S(this.getWest(),this.getNorth())}getSouthEast(){return new c.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:u,lat:g}=c.S.convert(n);let b=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(b=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=g&&g<=this._ne.lat&&b}static convert(n){return n instanceof Fi?n:n&&new Fi(n)}static fromLngLat(n,u=0){const g=360*u/40075017,b=g/Math.cos(Math.PI/180*n.lat);return new Fi(new c.S(n.lng-b,n.lat-g),new c.S(n.lng+b,n.lat+g))}adjustAntiMeridian(){const n=new c.S(this._sw.lng,this._sw.lat),u=new c.S(this._ne.lng,this._ne.lat);return new Fi(n,n.lng>u.lng?new c.S(u.lng+360,u.lat):u)}}class Pi{constructor(n,u,g){this.bounds=Fi.convert(this.validateBounds(n)),this.minzoom=u||0,this.maxzoom=g||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const u=Math.pow(2,n.z),g=Math.floor(c.V(this.bounds.getWest())*u),b=Math.floor(c.U(this.bounds.getNorth())*u),S=Math.ceil(c.V(this.bounds.getEast())*u),I=Math.ceil(c.U(this.bounds.getSouth())*u);return n.x>=g&&n.x<S&&n.y>=b&&n.y<I}}class Va extends c.E{constructor(n,u,g,b){if(super(),this.id=n,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.Q(u,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(b)}load(){return c._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield Dr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),n&&(c.e(this,n),n.bounds&&(this.tileBounds=new Pi(n.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})))}catch(n){this._tileJSONRequest=null,this.fire(new c.k(n))}}))}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}setSourceProperty(n){this._tileJSONRequest&&this._tileJSONRequest.abort(),n(),this.load()}setTiles(n){return this.setSourceProperty((()=>{this._options.tiles=n})),this}setUrl(n){return this.setSourceProperty((()=>{this.url=n,this._options.url=n})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(n){return c._(this,void 0,void 0,(function*(){const u=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),g={request:this.map._requestManager.transformRequest(u,"Tile"),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};g.request.collectResourceTiming=this._collectResourceTiming;let b="RT";if(n.actor&&n.state!=="expired"){if(n.state==="loading")return new Promise(((S,I)=>{n.reloadPromise={resolve:S,reject:I}}))}else n.actor=this.dispatcher.getActor(),b="LT";n.abortController=new AbortController;try{const S=yield n.actor.sendAsync({type:b,data:g},n.abortController);if(delete n.abortController,n.aborted)return;this._afterTileLoadWorkerResponse(n,S)}catch(S){if(delete n.abortController,n.aborted)return;if(S&&S.status!==404)throw S;this._afterTileLoadWorkerResponse(n,null)}}))}_afterTileLoadWorkerResponse(n,u){if(u&&u.resourceTiming&&(n.resourceTiming=u.resourceTiming),u&&this.map._refreshExpiredTiles&&n.setExpiryData(u),n.loadVectorData(u,this.map.painter),n.reloadPromise){const g=n.reloadPromise;n.reloadPromise=null,this.loadTile(n).then(g.resolve).catch(g.reject)}}abortTile(n){return c._(this,void 0,void 0,(function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.actor&&(yield n.actor.sendAsync({type:"AT",data:{uid:n.uid,type:this.type,source:this.id}}))}))}unloadTile(n){return c._(this,void 0,void 0,(function*(){n.unloadVectorData(),n.actor&&(yield n.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class Ta extends c.E{constructor(n,u,g,b){super(),this.id=n,this.dispatcher=g,this.setEventedParent(b),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},u),c.e(this,c.Q(u,["url","scheme","tileSize"]))}load(){return c._(this,arguments,void 0,(function*(n=!1){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const u=yield Dr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,u&&(c.e(this,u),u.bounds&&(this.tileBounds=new Pi(u.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:n})))}catch(u){this._tileJSONRequest=null,this.fire(new c.k(u))}}))}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(n){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),n(),this.load(!0)}setTiles(n){return this.setSourceProperty((()=>{this._options.tiles=n})),this}setUrl(n){return this.setSourceProperty((()=>{this.url=n,this._options.url=n})),this}serialize(){return c.e({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n){return c._(this,void 0,void 0,(function*(){const u=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);n.abortController=new AbortController;try{const g=yield Ke.getImage(this.map._requestManager.transformRequest(u,"Tile"),n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(g&&g.data){this.map._refreshExpiredTiles&&(g.cacheControl||g.expires)&&n.setExpiryData({cacheControl:g.cacheControl,expires:g.expires});const b=this.map.painter.context,S=b.gl,I=g.data;n.texture=this.map.painter.getTileTexture(I.width),n.texture?n.texture.update(I,{useMipmap:!0}):(n.texture=new c.T(b,I,S.RGBA,{useMipmap:!0}),n.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST)),n.state="loaded"}}catch(g){if(delete n.abortController,n.aborted)n.state="unloaded";else if(g)throw n.state="errored",g}}))}abortTile(n){return c._(this,void 0,void 0,(function*(){n.abortController&&(n.abortController.abort(),delete n.abortController)}))}unloadTile(n){return c._(this,void 0,void 0,(function*(){n.texture&&this.map.painter.saveTileTexture(n.texture)}))}hasTransition(){return!1}}class Bs extends Ta{constructor(n,u,g,b){super(n,u,g,b),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox",this.redFactor=u.redFactor,this.greenFactor=u.greenFactor,this.blueFactor=u.blueFactor,this.baseShift=u.baseShift}loadTile(n){return c._(this,void 0,void 0,(function*(){const u=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),g=this.map._requestManager.transformRequest(u,"Tile");n.neighboringTiles=this._getNeighboringTiles(n.tileID),n.abortController=new AbortController;try{const b=yield Ke.getImage(g,n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(b&&b.data){const S=b.data;this.map._refreshExpiredTiles&&(b.cacheControl||b.expires)&&n.setExpiryData({cacheControl:b.cacheControl,expires:b.expires});const I=c.b(S)&&c.W()?S:yield this.readImageNow(S),O={type:this.type,uid:n.uid,source:this.id,rawImageData:I,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!n.actor||n.state==="expired"){n.actor=this.dispatcher.getActor();const N=yield n.actor.sendAsync({type:"LDT",data:O});n.dem=N,n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0,n.state="loaded"}}}catch(b){if(delete n.abortController,n.aborted)n.state="unloaded";else if(b)throw n.state="errored",b}}))}readImageNow(n){return c._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&c.X()){const u=n.width+2,g=n.height+2;try{return new c.R({width:u,height:g},yield c.Y(n,-1,-1,u,g))}catch{}}return ee.getImageData(n,1)}))}_getNeighboringTiles(n){const u=n.canonical,g=Math.pow(2,u.z),b=(u.x-1+g)%g,S=u.x===0?n.wrap-1:n.wrap,I=(u.x+1+g)%g,O=u.x+1===g?n.wrap+1:n.wrap,N={};return N[new c.Z(n.overscaledZ,S,u.z,b,u.y).key]={backfilled:!1},N[new c.Z(n.overscaledZ,O,u.z,I,u.y).key]={backfilled:!1},u.y>0&&(N[new c.Z(n.overscaledZ,S,u.z,b,u.y-1).key]={backfilled:!1},N[new c.Z(n.overscaledZ,n.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},N[new c.Z(n.overscaledZ,O,u.z,I,u.y-1).key]={backfilled:!1}),u.y+1<g&&(N[new c.Z(n.overscaledZ,S,u.z,b,u.y+1).key]={backfilled:!1},N[new c.Z(n.overscaledZ,n.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},N[new c.Z(n.overscaledZ,O,u.z,I,u.y+1).key]={backfilled:!1}),N}unloadTile(n){return c._(this,void 0,void 0,(function*(){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&(yield n.actor.sendAsync({type:"RDT",data:{type:this.type,uid:n.uid,source:this.id}}))}))}}class Sa extends c.E{constructor(n,u,g,b){super(),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:u.data},this.actor=g.getActor(),this.setEventedParent(b),this._data=u.data,this._options=c.e({},u),this._collectResourceTiming=u.collectResourceTiming,u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId,u.clusterMaxZoom!==void 0&&this.maxzoom<=u.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${u.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(u.buffer!==void 0?u.buffer:128),tolerance:this._pixelsToTileUnits(u.tolerance!==void 0?u.tolerance:.375),extent:c.$,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(u.clusterMaxZoom),minPoints:Math.max(2,u.clusterMinPoints||2),extent:c.$,radius:this._pixelsToTileUnits(u.clusterRadius||50),log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(n){return n*(c.$/this.tileSize)}_getClusterMaxZoom(n){const u=n?Math.round(n):this.maxzoom-1;return Number.isInteger(n)||n===void 0||c.w(`Integer expected for option 'clusterMaxZoom': provided value "${n}" rounded to "${u}"`),u}load(){return c._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(n){this.map=n,this.load()}setData(n){return this._data=n,this._pendingWorkerUpdate={data:n},this._updateWorkerData(),this}updateData(n){return this._pendingWorkerUpdate.diff=c.a0(this._pendingWorkerUpdate.diff,n),this._updateWorkerData(),this}getData(){return c._(this,void 0,void 0,(function*(){const n=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:n})}))}getCoordinatesFromGeometry(n){return n.type==="GeometryCollection"?n.geometries.map((u=>u.coordinates)).flat(1/0):n.coordinates.flat(1/0)}getBounds(){return c._(this,void 0,void 0,(function*(){const n=new Fi,u=yield this.getData();let g;switch(u.type){case"FeatureCollection":g=u.features.map((b=>this.getCoordinatesFromGeometry(b.geometry))).flat(1/0);break;case"Feature":g=this.getCoordinatesFromGeometry(u.geometry);break;default:g=this.getCoordinatesFromGeometry(u)}if(g.length==0)return n;for(let b=0;b<g.length-1;b+=2)n.extend([g[b],g[b+1]]);return n}))}setClusterOptions(n){return this.workerOptions.cluster=n.cluster,n&&(n.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(n.clusterRadius)),n.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(n.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(n){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:n,source:this.id}})}getClusterChildren(n){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:n,source:this.id}})}getClusterLeaves(n,u,g){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:n,limit:u,offset:g}})}_updateWorkerData(){return c._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;const{data:n,diff:u}=this._pendingWorkerUpdate;if(!n&&!u)return void c.w(`No data or diff provided to GeoJSONSource ${this.id}.`);const g=c.e({type:this.type},this.workerOptions);n?(typeof n=="string"?(g.request=this.map._requestManager.transformRequest(ee.resolveURL(n),"Source"),g.request.collectResourceTiming=this._collectResourceTiming):g.data=JSON.stringify(n),this._pendingWorkerUpdate.data=void 0):u&&(g.dataDiff=u,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new c.l("dataloading",{dataType:"source"}));try{const b=yield this.actor.sendAsync({type:"LD",data:g});if(this._isUpdatingWorker=!1,this._removed||b.abandoned)return void this.fire(new c.l("dataabort",{dataType:"source"}));this._data=b.data;let S=null;b.resourceTiming&&b.resourceTiming[this.id]&&(S=b.resourceTiming[this.id].slice(0));const I={dataType:"source"};this._collectResourceTiming&&S&&S.length>0&&c.e(I,{resourceTiming:S}),this.fire(new c.l("data",Object.assign(Object.assign({},I),{sourceDataType:"metadata"}))),this.fire(new c.l("data",Object.assign(Object.assign({},I),{sourceDataType:"content"})))}catch(b){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new c.l("dataabort",{dataType:"source"}));this.fire(new c.k(b))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}}))}loaded(){return!this._isUpdatingWorker&&this._pendingWorkerUpdate.data===void 0&&this._pendingWorkerUpdate.diff===void 0}loadTile(n){return c._(this,void 0,void 0,(function*(){const u=n.actor?"RT":"LT";n.actor=this.actor;const g={type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};n.abortController=new AbortController;const b=yield this.actor.sendAsync({type:u,data:g},n.abortController);delete n.abortController,n.unloadVectorData(),n.aborted||n.loadVectorData(b,this.map.painter,u==="RT")}))}abortTile(n){return c._(this,void 0,void 0,(function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.aborted=!0}))}unloadTile(n){return c._(this,void 0,void 0,(function*(){n.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Vi extends c.E{constructor(n,u,g,b){super(),this.flippedWindingOrder=!1,this.id=n,this.dispatcher=g,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(b),this.options=u}load(n){return c._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const u=yield Ke.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,u&&u.data&&(this.image=u.data,n&&(this.coordinates=n),this._finishLoading())}catch(u){this._request=null,this._loaded=!0,this.fire(new c.k(u))}}))}loaded(){return this._loaded}updateImage(n){return n.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=n.url,this.load(n.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(n){this.coordinates=n;const u=n.map(c.a1.fromLngLat);var g;return this.tileID=(function(b){const S=c.a2.fromPoints(b),I=S.width(),O=S.height(),N=Math.max(I,O),j=Math.max(0,Math.floor(-Math.log(N)/Math.LN2)),$=Math.pow(2,j);return new c.a4(j,Math.floor((S.minX+S.maxX)/2*$),Math.floor((S.minY+S.maxY)/2*$))})(u),this.terrainTileRanges=this._getOverlappingTileRanges(u),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=u.map((b=>this.tileID.getTilePoint(b)._round())),this.flippedWindingOrder=((g=this.tileCoords)[1].x-g[0].x)*(g[2].y-g[0].y)-(g[1].y-g[0].y)*(g[2].x-g[0].x)<0,this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const n=this.map.painter.context,u=n.gl;this.texture||(this.texture=new c.T(n,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let g=!1;for(const b in this.tiles){const S=this.tiles[b];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,g=!0)}g&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(n){return c._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={}):n.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(n){const{minX:u,minY:g,maxX:b,maxY:S}=c.a2.fromPoints(n),I={};for(let O=0;O<=c.a3;O++){const N=Math.pow(2,O),j=Math.floor(u*N),$=Math.floor(g*N),X=Math.floor(b*N),H=Math.floor(S*N);I[O]={minTileX:j,minTileY:$,maxTileX:X,maxTileY:H}}return I}}class pr extends Vi{constructor(n,u,g,b){super(n,u,g,b),this.roundZoom=!0,this.type="video",this.options=u}load(){return c._(this,void 0,void 0,(function*(){this._loaded=!1;const n=this.options;this.urls=[];for(const u of n.urls)this.urls.push(this.map._requestManager.transformRequest(u,"Source").url);try{const u=yield c.a5(this.urls);if(this._loaded=!0,!u)return;this.video=u,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(u){this.fire(new c.k(u))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(n){if(this.video){const u=this.video.seekable;n<u.start(0)||n>u.end(0)?this.fire(new c.k(new c.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=n}}getVideo(){return this.video}onAdd(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const n=this.map.painter.context,u=n.gl;this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new c.T(n,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let g=!1;for(const b in this.tiles){const S=this.tiles[b];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,g=!0)}g&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Ea extends Vi{constructor(n,u,g,b){super(n,u,g,b),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some((S=>!Array.isArray(S)||S.length!==2||S.some((I=>typeof I!="number"))))||this.fire(new c.k(new c.a6(`sources.${n}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.k(new c.a6(`sources.${n}`,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new c.k(new c.a6(`sources.${n}`,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof HTMLCanvasElement||this.fire(new c.k(new c.a6(`sources.${n}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.k(new c.a6(`sources.${n}`,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}load(){return c._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const u=this.map.painter.context,g=u.gl;this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new c.T(u,this.canvas,g.RGBA,{premultiply:!0});let b=!1;for(const S in this.tiles){const I=this.tiles[S];I.state!=="loaded"&&(I.state="loaded",I.texture=this.texture,b=!0)}b&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const n of[this.canvas.width,this.canvas.height])if(isNaN(n)||n<=0)return!0;return!1}}const wo={},ao=T=>{switch(T){case"geojson":return Sa;case"image":return Vi;case"raster":return Ta;case"raster-dem":return Bs;case"vector":return Va;case"video":return pr;case"canvas":return Ea}return wo[T]},qr="RTLPluginLoaded";class fs extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Fn()}_syncState(n){return this.status=n,this.dispatcher.broadcast("SRPS",{pluginStatus:n,pluginURL:this.url}).catch((u=>{throw this.status="error",u}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(n){return c._(this,arguments,void 0,(function*(u,g=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=ee.resolveURL(u),!this.url)throw new Error(`requested url ${u} is invalid`);if(this.status==="unavailable"){if(!g)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return c._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.l(qr))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let ps=null;function Fs(){return ps||(ps=new fs),ps}class ms{constructor(n,u){this.timeAdded=0,this.fadeEndTime=0,this.tileID=n,this.uid=c.a7(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(n){const u=n+this.timeAdded;u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(n){this.demTexture&&n.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(n,u,g){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=(function(b,S){const I={};if(!S)return I;for(const O of b){const N=O.layerIds.map((j=>S.getLayer(j))).filter(Boolean);if(N.length!==0){O.layers=N,O.stateDependentLayerIds&&(O.stateDependentLayers=O.stateDependentLayerIds.map((j=>N.filter(($=>$.id===j))[0])));for(const j of N)I[j.id]=O}}return I})(n.buckets,u==null?void 0:u.style),this.hasSymbolBuckets=!1;for(const b in this.buckets){const S=this.buckets[b];if(S instanceof c.a9){if(this.hasSymbolBuckets=!0,!g)break;S.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const b in this.buckets){const S=this.buckets[b];if(S instanceof c.a9&&S.hasRTLText){this.hasRTLText=!0,Fs().lazyLoad();break}}this.queryPadding=0;for(const b in this.buckets){const S=this.buckets[b];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(b).queryRadius(S))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage)}else this.collisionBoxArray=new c.a8}unloadVectorData(){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(n){return this.buckets[n.id]}upload(n){for(const g in this.buckets){const b=this.buckets[g];b.uploadPending()&&b.upload(n)}const u=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new c.T(n,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new c.T(n,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,u,g,b,S,I,O,N,j,$,X){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:b,cameraQueryGeometry:S,scale:I,tileSize:this.tileSize,pixelPosMatrix:$,transform:N,params:O,queryPadding:this.queryPadding*j,getElevation:X},n,u,g):{}}querySourceFeatures(n,u){const g=this.latestFeatureIndex;if(!g||!g.rawTileData)return;const b=g.loadVTLayers(),S=u&&u.sourceLayer?u.sourceLayer:"",I=b._geojsonTileLayer||b[S];if(!I)return;const O=c.aa(u&&u.filter),{z:N,x:j,y:$}=this.tileID.canonical,X={z:N,x:j,y:$};for(let H=0;H<I.length;H++){const J=I.feature(H);if(O.needGeometry){const me=c.ab(J,!0);if(!O.filter(new c.F(this.tileID.overscaledZ),me,this.tileID.canonical))continue}else if(!O.filter(new c.F(this.tileID.overscaledZ),J))continue;const ae=g.getId(J,S),_e=new c.ac(J,N,j,$,ae);_e.tile=X,n.push(_e)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const u=this.expirationTime;if(n.cacheControl){const g=c.ad(n.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const g=Date.now();let b=!1;if(this.expirationTime>g)b=!1;else if(u)if(this.expirationTime<u)b=!0;else{const S=this.expirationTime-u;S?this.expirationTime=g+Math.max(S,3e4):b=!0}else b=!0;b?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0)return;const g=this.latestFeatureIndex.loadVTLayers();for(const b in this.buckets){if(!u.style.hasLayer(b))continue;const S=this.buckets[b],I=S.layers[0].sourceLayer||"_geojsonTileLayer",O=g[I],N=n[I];if(!O||!N||Object.keys(N).length===0)continue;S.update(N,O,this.imageAtlas&&this.imageAtlas.patternPositions||{});const j=u&&u.style&&u.style.getLayer(b);j&&(this.queryPadding=Math.max(this.queryPadding,j.queryRadius(S)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ee.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=ee.now()+n}setDependencies(n,u){const g={};for(const b of u)g[b]=!0;this.dependencies[n]=g}hasDependency(n,u){for(const g of n){const b=this.dependencies[g];if(b){for(const S of u)if(b[S])return!0}}return!1}}class We{constructor(n,u){this.max=n,this.onRemove=u,this.reset()}reset(){for(const n in this.data)for(const u of this.data[n])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(n,u,g){const b=n.wrapped().key;this.data[b]===void 0&&(this.data[b]=[]);const S={value:u,timeout:void 0};if(g!==void 0&&(S.timeout=setTimeout((()=>{this.remove(n,S)}),g)),this.data[b].push(S),this.order.push(b),this.order.length>this.max){const I=this._getAndRemoveByKey(this.order[0]);I&&this.onRemove(I)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const u=this.data[n].shift();return u.timeout&&clearTimeout(u.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),u.value}getByKey(n){const u=this.data[n];return u?u[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,u){if(!this.has(n))return this;const g=n.wrapped().key,b=u===void 0?0:this.data[g].indexOf(u),S=this.data[g][b];return this.data[g].splice(b,1),S.timeout&&clearTimeout(S.timeout),this.data[g].length===0&&delete this.data[g],this.onRemove(S.value),this.order.splice(this.order.indexOf(g),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(n){const u=[];for(const g in this.data)for(const b of this.data[g])n(b.value)||u.push(b);for(const g of u)this.remove(g.value.tileID,g)}}class se{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,u,g){const b=String(u);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][b]=this.stateChanges[n][b]||{},c.e(this.stateChanges[n][b],g),this.deletedStates[n]===null){this.deletedStates[n]={};for(const S in this.state[n])S!==b&&(this.deletedStates[n][S]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][b]===null){this.deletedStates[n][b]={};for(const S in this.state[n][b])g[S]||(this.deletedStates[n][b][S]=null)}else for(const S in g)this.deletedStates[n]&&this.deletedStates[n][b]&&this.deletedStates[n][b][S]===null&&delete this.deletedStates[n][b][S]}removeFeatureState(n,u,g){if(this.deletedStates[n]===null)return;const b=String(u);if(this.deletedStates[n]=this.deletedStates[n]||{},g&&u!==void 0)this.deletedStates[n][b]!==null&&(this.deletedStates[n][b]=this.deletedStates[n][b]||{},this.deletedStates[n][b][g]=null);else if(u!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][b])for(g in this.deletedStates[n][b]={},this.stateChanges[n][b])this.deletedStates[n][b][g]=null;else this.deletedStates[n][b]=null;else this.deletedStates[n]=null}getState(n,u){const g=String(u),b=c.e({},(this.state[n]||{})[g],(this.stateChanges[n]||{})[g]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const S=this.deletedStates[n][u];if(S===null)return{};for(const I in S)delete b[I]}return b}initializeTileState(n,u){n.setFeatureState(this.state,u)}coalesceChanges(n,u){const g={};for(const b in this.stateChanges){this.state[b]=this.state[b]||{};const S={};for(const I in this.stateChanges[b])this.state[b][I]||(this.state[b][I]={}),c.e(this.state[b][I],this.stateChanges[b][I]),S[I]=this.state[b][I];g[b]=S}for(const b in this.deletedStates){this.state[b]=this.state[b]||{};const S={};if(this.deletedStates[b]===null)for(const I in this.state[b])S[I]={},this.state[b][I]={};else for(const I in this.deletedStates[b]){if(this.deletedStates[b][I]===null)this.state[b][I]={};else for(const O of Object.keys(this.deletedStates[b][I]))delete this.state[b][I][O];S[I]=this.state[b][I]}g[b]=g[b]||{},c.e(g[b],S)}if(this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0)for(const b in n)n[b].setFeatureState(g,u)}}const le=89.25;function fe(T,n){const u=c.ah(n.lat,-c.ai,c.ai);return new c.P(c.V(n.lng)*T,c.U(u)*T)}function Se(T,n){return new c.a1(n.x/T,n.y/T).toLngLat()}function De(T){return T.cameraToCenterDistance*Math.min(.85*Math.tan(c.ae(90-T.pitch)),Math.tan(c.ae(le-T.pitch)))}function $e(T,n){const u=T.canonical,g=n/c.af(u.z),b=u.x+Math.pow(2,u.z)*T.wrap,S=c.ag(new Float64Array(16));return c.M(S,S,[b*g,u.y*g,0]),c.N(S,S,[g/c.$,g/c.$,1]),S}function et(T,n,u,g,b){const S=c.a1.fromLngLat(T,n),I=b*c.aj(1,T.lat),O=I*Math.cos(c.ae(u)),N=Math.sqrt(I*I-O*O),j=N*Math.sin(c.ae(-g)),$=N*Math.cos(c.ae(-g));return new c.a1(S.x+j,S.y+$,S.z+O)}function Ze(T,n,u){const g=n.intersectsFrustum(T);if(!u||g===0)return g;const b=n.intersectsPlane(u);return b===0?0:g===2&&b===2?2:1}function _t(T,n,u){let g=0;const b=(u-n)/10;for(let S=0;S<10;S++)g+=b*Math.pow(Math.cos(n+(S+.5)/10*(u-n)),T);return g}function Pt(T,n){return function(u,g,b,S,I){const O=2*((T-1)/c.ak(Math.cos(c.ae(le-I))/Math.cos(c.ae(le)))-1),N=Math.acos(b/S),j=2*_t(O-1,0,c.ae(I/2)),$=Math.min(c.ae(le),N+c.ae(I/2)),X=_t(O-1,Math.min($,N-c.ae(I/2)),$),H=Math.atan(g/b),J=Math.hypot(g,b);let ae=u;return ae+=c.ak(S/J/Math.max(.5,Math.cos(c.ae(I/2)))),ae+=O*c.ak(Math.cos(H))/2,ae-=c.ak(Math.max(1,X/j/n))/2,ae}}const wt=Pt(9.314,3);function tn(T,n){const u=(n.roundZoom?Math.round:Math.floor)(T.zoom+c.ak(T.tileSize/n.tileSize));return Math.max(0,u)}function qe(T,n){const u=T.getCameraFrustum(),g=T.getClippingPlane(),b=T.screenPointToMercatorCoordinate(T.getCameraPoint()),S=c.a1.fromLngLat(T.center,T.elevation);b.z=S.z+Math.cos(T.pitchInRadians)*T.cameraToCenterDistance/T.worldSize;const I=T.getCoveringTilesDetailsProvider(),O=I.allowVariableZoom(T,n),N=tn(T,n),j=n.minzoom||0,$=n.maxzoom!==void 0?n.maxzoom:T.maxZoom,X=Math.min(Math.max(0,N),$),H=Math.pow(2,X),J=[H*b.x,H*b.y,0],ae=[H*S.x,H*S.y,0],_e=Math.hypot(S.x-b.x,S.y-b.y),me=Math.abs(S.z-b.z),ve=Math.hypot(_e,me),we=ze=>({zoom:0,x:0,y:0,wrap:ze,fullyVisible:!1}),Me=[],Ee=[];if(T.renderWorldCopies&&I.allowWorldCopies())for(let ze=1;ze<=3;ze++)Me.push(we(-ze)),Me.push(we(ze));for(Me.push(we(0));Me.length>0;){const ze=Me.pop(),Ve=ze.x,Ie=ze.y;let Ye=ze.fullyVisible;const ct={x:Ve,y:Ie,z:ze.zoom},rt=I.getTileBoundingVolume(ct,ze.wrap,T.elevation,n);if(!Ye){const Ft=Ze(u,rt,g);if(Ft===0)continue;Ye=Ft===2}const st=I.distanceToTile2d(b.x,b.y,ct,rt);let lt=N;O&&(lt=(n.calculateTileZoom||wt)(T.zoom+c.ak(T.tileSize/n.tileSize),st,me,ve,T.fov)),lt=(n.roundZoom?Math.round:Math.floor)(lt),lt=Math.max(0,lt);const Nt=Math.min(lt,$);if(ze.wrap=I.getWrap(S,ct,ze.wrap),ze.zoom>=Nt){if(ze.zoom<j)continue;const Ft=X-ze.zoom,Ct=J[0]-.5-(Ve<<Ft),ln=J[1]-.5-(Ie<<Ft),Zn=n.reparseOverscaled?Math.max(ze.zoom,lt):ze.zoom;Ee.push({tileID:new c.Z(ze.zoom===$?Zn:ze.zoom,ze.wrap,ze.zoom,Ve,Ie),distanceSq:c.al([ae[0]-.5-Ve,ae[1]-.5-Ie]),tileDistanceToCamera:Math.sqrt(Ct*Ct+ln*ln)})}else for(let Ft=0;Ft<4;Ft++)Me.push({zoom:ze.zoom+1,x:(Ve<<1)+Ft%2,y:(Ie<<1)+(Ft>>1),wrap:ze.wrap,fullyVisible:Ye})}return Ee.sort(((ze,Ve)=>ze.distanceSq-Ve.distanceSq)).map((ze=>ze.tileID))}const vn=c.a2.fromPoints([new c.P(0,0),new c.P(c.$,c.$)]);class Rn extends c.E{constructor(n,u,g){super(),this.id=n,this.dispatcher=g,this.on("data",(b=>this._dataHandler(b))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((b,S,I,O)=>{const N=new(ao(S.type))(b,S,I,O);if(N.id!==b)throw new Error(`Expected Source id to be ${b} instead of ${N.id}`);return N})(n,u,g,this),this._tiles={},this._cache=new We(0,(b=>this._unloadTile(b))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new se,this._didEmitContent=!1,this._updated=!1}onAdd(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._maxTileCacheZoomLevels=n?n._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(n)}onRemove(n){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(n)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const n in this._tiles){const u=this._tiles[n];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(n,u,g){return c._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(n),this._tileLoaded(n,u,g)}catch(b){n.state="errored",b.status!==404?this._source.fire(new c.k(b,{tile:n})):this.update(this.transform,this.terrain)}}))}_unloadTile(n){this._source.unloadTile&&this._source.unloadTile(n)}_abortTile(n){this._source.abortTile&&this._source.abortTile(n),this._source.fire(new c.l("dataabort",{tile:n,coord:n.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const g=this._tiles[u];g.upload(n),g.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((n=>n.tileID)).sort(nn).map((n=>n.key))}getRenderableIds(n){const u=[];for(const g in this._tiles)this._isIdRenderable(g,n)&&u.push(this._tiles[g]);return n?u.sort(((g,b)=>{const S=g.tileID,I=b.tileID,O=new c.P(S.canonical.x,S.canonical.y)._rotate(-this.transform.bearingInRadians),N=new c.P(I.canonical.x,I.canonical.y)._rotate(-this.transform.bearingInRadians);return S.overscaledZ-I.overscaledZ||N.y-O.y||N.x-O.x})).map((g=>g.tileID.key)):u.map((g=>g.tileID)).sort(nn).map((g=>g.key))}hasRenderableParent(n){const u=this.findLoadedParent(n,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(n,u){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(u||!this._tiles[n].holdingForFade())}reload(n){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const u in this._tiles)n?this._reloadTile(u,"expired"):this._tiles[u].state!=="errored"&&this._reloadTile(u,"reloading")}}_reloadTile(n,u){return c._(this,void 0,void 0,(function*(){const g=this._tiles[n];g&&(g.state!=="loading"&&(g.state=u),yield this._loadTile(g,n,u))}))}_tileLoaded(n,u,g){n.timeAdded=ee.now(),g==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(u,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),n.aborted||this._source.fire(new c.l("data",{dataType:"source",tile:n,coord:n.tileID}))}_backfillDEM(n){const u=this.getRenderableIds();for(let b=0;b<u.length;b++){const S=u[b];if(n.neighboringTiles&&n.neighboringTiles[S]){const I=this.getTileByID(S);g(n,I),g(I,n)}}function g(b,S){b.needsHillshadePrepare=!0,b.needsTerrainPrepare=!0;let I=S.tileID.canonical.x-b.tileID.canonical.x;const O=S.tileID.canonical.y-b.tileID.canonical.y,N=Math.pow(2,b.tileID.canonical.z),j=S.tileID.key;I===0&&O===0||Math.abs(O)>1||(Math.abs(I)>1&&(Math.abs(I+N)===1?I+=N:Math.abs(I-N)===1&&(I-=N)),S.dem&&b.dem&&(b.dem.backfillBorder(S.dem,I,O),b.neighboringTiles&&b.neighboringTiles[j]&&(b.neighboringTiles[j].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,u,g,b){for(const S in this._tiles){let I=this._tiles[S];if(b[S]||!I.hasData()||I.tileID.overscaledZ<=u||I.tileID.overscaledZ>g)continue;let O=I.tileID;for(;I&&I.tileID.overscaledZ>u+1;){const j=I.tileID.scaledTo(I.tileID.overscaledZ-1);I=this._tiles[j.key],I&&I.hasData()&&(O=j)}let N=O;for(;N.overscaledZ>u;)if(N=N.scaledTo(N.overscaledZ-1),n[N.key]||n[N.canonical.key]){b[O.key]=O;break}}}findLoadedParent(n,u){if(n.key in this._loadedParentTiles){const g=this._loadedParentTiles[n.key];return g&&g.tileID.overscaledZ>=u?g:null}for(let g=n.overscaledZ-1;g>=u;g--){const b=n.scaledTo(g),S=this._getLoadedTile(b);if(S)return S}}findLoadedSibling(n){return this._getLoadedTile(n)}_getLoadedTile(n){const u=this._tiles[n.key];return u&&u.hasData()?u:this._cache.getByKey(n.wrapped().key)}updateCacheSize(n){const u=Math.ceil(n.width/this._source.tileSize)+1,g=Math.ceil(n.height/this._source.tileSize)+1,b=Math.floor(u*g*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),S=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,b):b;this._cache.setMaxSize(S)}handleWrapJump(n){const u=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,u){const g={};for(const b in this._tiles){const S=this._tiles[b];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+u),g[S.tileID.key]=S}this._tiles=g;for(const b in this._timers)clearTimeout(this._timers[b]),delete this._timers[b];for(const b in this._tiles)this._setTileReloadTimer(b,this._tiles[b])}}_updateCoveredAndRetainedTiles(n,u,g,b,S,I){const O={},N={},j=Object.keys(n),$=ee.now();for(const X of j){const H=n[X],J=this._tiles[X];if(!J||J.fadeEndTime!==0&&J.fadeEndTime<=$)continue;const ae=this.findLoadedParent(H,u),_e=this.findLoadedSibling(H),me=ae||_e||null;me&&(this._addTile(me.tileID),O[me.tileID.key]=me.tileID),N[X]=H}this._retainLoadedChildren(N,b,g,n);for(const X in O)n[X]||(this._coveredTiles[X]=!0,n[X]=O[X]);if(I){const X={},H={};for(const J of S)this._tiles[J.key].hasData()?X[J.key]=J:H[J.key]=J;for(const J in H){const ae=H[J].children(this._source.maxzoom);this._tiles[ae[0].key]&&this._tiles[ae[1].key]&&this._tiles[ae[2].key]&&this._tiles[ae[3].key]&&(X[ae[0].key]=n[ae[0].key]=ae[0],X[ae[1].key]=n[ae[1].key]=ae[1],X[ae[2].key]=n[ae[2].key]=ae[2],X[ae[3].key]=n[ae[3].key]=ae[3],delete H[J])}for(const J in H){const ae=H[J],_e=this.findLoadedParent(ae,this._source.minzoom),me=this.findLoadedSibling(ae),ve=_e||me||null;if(ve){X[ve.tileID.key]=n[ve.tileID.key]=ve.tileID;for(const we in X)X[we].isChildOf(ve.tileID)&&delete X[we]}}for(const J in this._tiles)X[J]||(this._coveredTiles[J]=!0)}}update(n,u){if(!this._sourceLoaded||this._paused)return;let g;this.transform=n,this.terrain=u,this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?g=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(($=>new c.Z($.canonical.z,$.wrap,$.canonical.z,$.canonical.x,$.canonical.y))):(g=qe(n,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:u,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(g=g.filter(($=>this._source.hasTile($))))):g=[];const b=tn(n,this._source),S=Math.max(b-Rn.maxOverzooming,this._source.minzoom),I=Math.max(b+Rn.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const $={};for(const X of g)if(X.canonical.z>this._source.minzoom){const H=X.scaledTo(X.canonical.z-1);$[H.key]=H;const J=X.scaledTo(Math.max(this._source.minzoom,Math.min(X.canonical.z,5)));$[J.key]=J}g=g.concat(Object.values($))}const O=g.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,O&&this.fire(new c.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const N=this._updateRetainedTiles(g,b);Nn(this._source.type)&&this._updateCoveredAndRetainedTiles(N,S,I,b,g,u);for(const $ in N)this._tiles[$].clearFadeHold();const j=c.am(this._tiles,N);for(const $ of j){const X=this._tiles[$];X.hasSymbolBuckets&&!X.holdingForFade()?X.setHoldDuration(this.map._fadeDuration):X.hasSymbolBuckets&&!X.symbolFadeFinished()||this._removeTile($)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)}_updateRetainedTiles(n,u){var g;const b={},S={},I=Math.max(u-Rn.maxOverzooming,this._source.minzoom),O=Math.max(u+Rn.maxUnderzooming,this._source.minzoom),N={};for(const j of n){const $=this._addTile(j);b[j.key]=j,$.hasData()||u<this._source.maxzoom&&(N[j.key]=j)}this._retainLoadedChildren(N,u,O,b);for(const j of n){let $=this._tiles[j.key];if($.hasData())continue;if(u+1>this._source.maxzoom){const H=j.children(this._source.maxzoom)[0],J=this.getTile(H);if(J&&J.hasData()){b[H.key]=H;continue}}else{const H=j.children(this._source.maxzoom);if(b[H[0].key]&&b[H[1].key]&&b[H[2].key]&&b[H[3].key])continue}let X=$.wasRequested();for(let H=j.overscaledZ-1;H>=I;--H){const J=j.scaledTo(H);if(S[J.key])break;if(S[J.key]=!0,$=this.getTile(J),!$&&X&&($=this._addTile(J)),$){const ae=$.hasData();if((ae||!(!((g=this.map)===null||g===void 0)&&g.cancelPendingTileRequestsWhileZooming)||X)&&(b[J.key]=J),X=$.wasRequested(),ae)break}}}return b}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const u=[];let g,b=this._tiles[n].tileID;for(;b.overscaledZ>0;){if(b.key in this._loadedParentTiles){g=this._loadedParentTiles[b.key];break}u.push(b.key);const S=b.scaledTo(b.overscaledZ-1);if(g=this._getLoadedTile(S),g)break;b=S}for(const S of u)this._loadedParentTiles[S]=g}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const n in this._tiles){const u=this._tiles[n].tileID,g=this._getLoadedTile(u);this._loadedSiblingTiles[u.key]=g}}_addTile(n){let u=this._tiles[n.key];if(u)return u;u=this._cache.getAndRemove(n),u&&(this._setTileReloadTimer(n.key,u),u.tileID=n,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,u)));const g=u;return u||(u=new ms(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(u,n.key,u.state)),u.uses++,this._tiles[n.key]=u,g||this._source.fire(new c.l("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(n,u){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const g=u.getExpiryTimeout();g&&(this._timers[n]=setTimeout((()=>{this._reloadTile(n,"expired"),delete this._timers[n]}),g))}refreshTiles(n){for(const u in this._tiles)(this._isIdRenderable(u)||this._tiles[u].state=="errored")&&n.some((g=>g.equals(this._tiles[u].tileID.canonical)))&&this._reloadTile(u,"expired")}_removeTile(n){const u=this._tiles[n];u&&(u.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}_dataHandler(n){const u=n.sourceDataType;n.dataType==="source"&&u==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&n.dataType==="source"&&u==="content"&&(this.reload(n.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(n);this._cache.reset()}tilesIn(n,u,g){const b=[],S=this.transform;if(!S)return b;const I=S.getCoveringTilesDetailsProvider().allowWorldCopies(),O=g?S.getCameraQueryGeometry(n):n,N=J=>S.screenPointToMercatorCoordinate(J,this.terrain),j=this.transformBbox(n,N,!I),$=this.transformBbox(O,N,!I),X=this.getIds(),H=c.a2.fromPoints($);for(let J=0;J<X.length;J++){const ae=this._tiles[X[J]];if(ae.holdingForFade())continue;const _e=I?[ae.tileID]:[ae.tileID.unwrapTo(-1),ae.tileID.unwrapTo(0)],me=Math.pow(2,S.zoom-ae.tileID.overscaledZ),ve=u*ae.queryPadding*c.$/ae.tileSize/me;for(const we of _e){const Me=H.map((Ee=>we.getTilePoint(new c.a1(Ee.x,Ee.y))));if(Me.expandBy(ve),Me.intersects(vn)){const Ee=j.map((Ve=>we.getTilePoint(Ve))),ze=$.map((Ve=>we.getTilePoint(Ve)));b.push({tile:ae,tileID:I?we:we.unwrapTo(0),queryGeometry:Ee,cameraQueryGeometry:ze,scale:me})}}}return b}transformBbox(n,u,g){let b=n.map(u);if(g){const S=c.a2.fromPoints(n);S.shrinkBy(.001*Math.min(S.width(),S.height()));const I=S.map(u);c.a2.fromPoints(b).covers(I)||(b=b.map((O=>O.x>.5?new c.a1(O.x-1,O.y,O.z):O)))}return b}getVisibleCoordinates(n){const u=this.getRenderableIds(n).map((g=>this._tiles[g].tileID));return this.transform&&this.transform.populateCache(u),u}hasTransition(){if(this._source.hasTransition())return!0;if(Nn(this._source.type)){const n=ee.now();for(const u in this._tiles)if(this._tiles[u].fadeEndTime>=n)return!0}return!1}setFeatureState(n,u,g){this._state.updateState(n=n||"_geojsonTileLayer",u,g)}removeFeatureState(n,u,g){this._state.removeFeatureState(n=n||"_geojsonTileLayer",u,g)}getFeatureState(n,u){return this._state.getState(n=n||"_geojsonTileLayer",u)}setDependencies(n,u,g){const b=this._tiles[n];b&&b.setDependencies(u,g)}reloadTilesForDependencies(n,u){for(const g in this._tiles)this._tiles[g].hasDependency(n,u)&&this._reloadTile(g,"reloading");this._cache.filter((g=>!g.hasDependency(n,u)))}}function nn(T,n){const u=Math.abs(2*T.wrap)-+(T.wrap<0),g=Math.abs(2*n.wrap)-+(n.wrap<0);return T.overscaledZ-n.overscaledZ||g-u||n.canonical.y-T.canonical.y||n.canonical.x-T.canonical.x}function Nn(T){return T==="raster"||T==="image"||T==="video"}Rn.maxOverzooming=10,Rn.maxUnderzooming=3;class Ri{constructor(n,u){this.reset(n,u)}reset(n,u){this.points=n||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=c.ah(n,0,1);let u=1,g=this._distances[u];const b=n*this.paddedLength+this.padding;for(;g<b&&u<this._distances.length;)g=this._distances[++u];const S=u-1,I=this._distances[S],O=g-I,N=O>0?(b-I)/O:0;return this.points[S].mult(1-N).add(this.points[u].mult(N))}}function Gi(T,n){let u=!0;return T==="always"||T!=="never"&&n!=="never"||(u=!1),u}class tr{constructor(n,u,g){const b=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(n/g),this.yCellCount=Math.ceil(u/g);for(let I=0;I<this.xCellCount*this.yCellCount;I++)b.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=u,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,u,g,b,S){this._forEachCell(u,g,b,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(b),this.bboxes.push(S)}insertCircle(n,u,g,b){this._forEachCell(u-b,g-b,u+b,g+b,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(u),this.circles.push(g),this.circles.push(b)}_insertBoxCell(n,u,g,b,S,I){this.boxCells[S].push(I)}_insertCircleCell(n,u,g,b,S,I){this.circleCells[S].push(I)}_query(n,u,g,b,S,I,O){if(g<0||n>this.width||b<0||u>this.height)return[];const N=[];if(n<=0&&u<=0&&this.width<=g&&this.height<=b){if(S)return[{key:null,x1:n,y1:u,x2:g,y2:b}];for(let j=0;j<this.boxKeys.length;j++)N.push({key:this.boxKeys[j],x1:this.bboxes[4*j],y1:this.bboxes[4*j+1],x2:this.bboxes[4*j+2],y2:this.bboxes[4*j+3]});for(let j=0;j<this.circleKeys.length;j++){const $=this.circles[3*j],X=this.circles[3*j+1],H=this.circles[3*j+2];N.push({key:this.circleKeys[j],x1:$-H,y1:X-H,x2:$+H,y2:X+H})}}else this._forEachCell(n,u,g,b,this._queryCell,N,{hitTest:S,overlapMode:I,seenUids:{box:{},circle:{}}},O);return N}query(n,u,g,b){return this._query(n,u,g,b,!1,null)}hitTest(n,u,g,b,S,I){return this._query(n,u,g,b,!0,S,I).length>0}hitTestCircle(n,u,g,b,S){const I=n-g,O=n+g,N=u-g,j=u+g;if(O<0||I>this.width||j<0||N>this.height)return!1;const $=[];return this._forEachCell(I,N,O,j,this._queryCellCircle,$,{hitTest:!0,overlapMode:b,circle:{x:n,y:u,radius:g},seenUids:{box:{},circle:{}}},S),$.length>0}_queryCell(n,u,g,b,S,I,O,N){const{seenUids:j,hitTest:$,overlapMode:X}=O,H=this.boxCells[S];if(H!==null){const ae=this.bboxes;for(const _e of H)if(!j.box[_e]){j.box[_e]=!0;const me=4*_e,ve=this.boxKeys[_e];if(n<=ae[me+2]&&u<=ae[me+3]&&g>=ae[me+0]&&b>=ae[me+1]&&(!N||N(ve))&&(!$||!Gi(X,ve.overlapMode))&&(I.push({key:ve,x1:ae[me],y1:ae[me+1],x2:ae[me+2],y2:ae[me+3]}),$))return!0}}const J=this.circleCells[S];if(J!==null){const ae=this.circles;for(const _e of J)if(!j.circle[_e]){j.circle[_e]=!0;const me=3*_e,ve=this.circleKeys[_e];if(this._circleAndRectCollide(ae[me],ae[me+1],ae[me+2],n,u,g,b)&&(!N||N(ve))&&(!$||!Gi(X,ve.overlapMode))){const we=ae[me],Me=ae[me+1],Ee=ae[me+2];if(I.push({key:ve,x1:we-Ee,y1:Me-Ee,x2:we+Ee,y2:Me+Ee}),$)return!0}}}return!1}_queryCellCircle(n,u,g,b,S,I,O,N){const{circle:j,seenUids:$,overlapMode:X}=O,H=this.boxCells[S];if(H!==null){const ae=this.bboxes;for(const _e of H)if(!$.box[_e]){$.box[_e]=!0;const me=4*_e,ve=this.boxKeys[_e];if(this._circleAndRectCollide(j.x,j.y,j.radius,ae[me+0],ae[me+1],ae[me+2],ae[me+3])&&(!N||N(ve))&&!Gi(X,ve.overlapMode))return I.push(!0),!0}}const J=this.circleCells[S];if(J!==null){const ae=this.circles;for(const _e of J)if(!$.circle[_e]){$.circle[_e]=!0;const me=3*_e,ve=this.circleKeys[_e];if(this._circlesCollide(ae[me],ae[me+1],ae[me+2],j.x,j.y,j.radius)&&(!N||N(ve))&&!Gi(X,ve.overlapMode))return I.push(!0),!0}}}_forEachCell(n,u,g,b,S,I,O,N){const j=this._convertToXCellCoord(n),$=this._convertToYCellCoord(u),X=this._convertToXCellCoord(g),H=this._convertToYCellCoord(b);for(let J=j;J<=X;J++)for(let ae=$;ae<=H;ae++)if(S.call(this,n,u,g,b,this.xCellCount*ae+J,I,O,N))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,u,g,b,S,I){const O=b-n,N=S-u,j=g+I;return j*j>O*O+N*N}_circleAndRectCollide(n,u,g,b,S,I,O){const N=(I-b)/2,j=Math.abs(n-(b+N));if(j>N+g)return!1;const $=(O-S)/2,X=Math.abs(u-(S+$));if(X>$+g)return!1;if(j<=N||X<=$)return!0;const H=j-N,J=X-$;return H*H+J*J<=g*g}}function Ir(T,n,u){const g=c.L();if(!T){const{vecSouth:X,vecEast:H}=Kn(n),J=k();J[0]=H[0],J[1]=H[1],J[2]=X[0],J[3]=X[1],b=J,($=(I=(S=J)[0])*(j=S[3])-(N=S[2])*(O=S[1]))&&(b[0]=j*($=1/$),b[1]=-O*$,b[2]=-N*$,b[3]=I*$),g[0]=J[0],g[1]=J[1],g[4]=J[2],g[5]=J[3]}var b,S,I,O,N,j,$;return c.N(g,g,[1/u,1/u,1]),g}function Vn(T,n,u,g){if(T){const b=c.L();if(!n){const{vecSouth:S,vecEast:I}=Kn(u);b[0]=I[0],b[1]=I[1],b[4]=S[0],b[5]=S[1]}return c.N(b,b,[g,g,1]),b}return u.pixelsToClipSpaceMatrix}function Kn(T){const n=Math.cos(T.rollInRadians),u=Math.sin(T.rollInRadians),g=Math.cos(T.pitchInRadians),b=Math.cos(T.bearingInRadians),S=Math.sin(T.bearingInRadians),I=c.ar();I[0]=-b*g*u-S*n,I[1]=-S*g*u+b*n;const O=c.as(I);O<1e-9?c.at(I):c.au(I,I,1/O);const N=c.ar();N[0]=b*g*n-S*u,N[1]=S*g*n+b*u;const j=c.as(N);return j<1e-9?c.at(N):c.au(N,N,1/j),{vecEast:N,vecSouth:I}}function br(T,n,u,g){let b;g?(b=[T,n,g(T,n),1],c.aw(b,b,u)):(b=[T,n,0,1],Gr(b,b,u));const S=b[3];return{point:new c.P(b[0]/S,b[1]/S),signedDistanceFromCamera:S,isOccluded:!1}}function Rt(T,n){return .5+T/n*.5}function en(T,n){return T.x>=-n[0]&&T.x<=n[0]&&T.y>=-n[1]&&T.y<=n[1]}function nr(T,n,u,g,b,S,I,O,N,j,$,X,H){const J=u?T.textSizeData:T.iconSizeData,ae=c.an(J,n.transform.zoom),_e=[256/n.width*2+1,256/n.height*2+1],me=u?T.text.dynamicLayoutVertexArray:T.icon.dynamicLayoutVertexArray;me.clear();const ve=T.lineVertexArray,we=u?T.text.placedSymbolArray:T.icon.placedSymbolArray,Me=n.transform.width/n.transform.height;let Ee=!1;for(let ze=0;ze<we.length;ze++){const Ve=we.get(ze);if(Ve.hidden||Ve.writingMode===c.ao.vertical&&!Ee){$r(Ve.numGlyphs,me);continue}Ee=!1;const Ie=new c.P(Ve.anchorX,Ve.anchorY),Ye={getElevation:H,pitchedLabelPlaneMatrix:g,lineVertexArray:ve,pitchWithMap:S,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:n.transform,tileAnchorPoint:Ie,unwrappedTileID:N,width:j,height:$,translation:X},ct=To(Ve.anchorX,Ve.anchorY,Ye);if(!en(ct.point,_e)){$r(Ve.numGlyphs,me);continue}const rt=Rt(n.transform.cameraToCenterDistance,ct.signedDistanceFromCamera),st=c.ap(J,ae,Ve),lt=S?st*n.transform.getPitchedTextCorrection(Ve.anchorX,Ve.anchorY,N)/rt:st*rt,Nt=kt({projectionContext:Ye,pitchedLabelPlaneMatrixInverse:b,symbol:Ve,fontSize:lt,flip:!1,keepUpright:I,glyphOffsetArray:T.glyphOffsetArray,dynamicLayoutVertexArray:me,aspectRatio:Me,rotateToLine:O});Ee=Nt.useVertical,(Nt.notEnoughRoom||Ee||Nt.needsFlipping&&kt({projectionContext:Ye,pitchedLabelPlaneMatrixInverse:b,symbol:Ve,fontSize:lt,flip:!0,keepUpright:I,glyphOffsetArray:T.glyphOffsetArray,dynamicLayoutVertexArray:me,aspectRatio:Me,rotateToLine:O}).notEnoughRoom)&&$r(Ve.numGlyphs,me)}u?T.text.dynamicLayoutVertexBuffer.updateData(me):T.icon.dynamicLayoutVertexBuffer.updateData(me)}function ta(T,n,u,g,b,S,I,O){const N=S.glyphStartIndex+S.numGlyphs,j=S.lineStartIndex,$=S.lineStartIndex+S.lineLength,X=n.getoffsetX(S.glyphStartIndex),H=n.getoffsetX(N-1),J=Us(T*X,u,g,b,S.segment,j,$,O,I);if(!J)return null;const ae=Us(T*H,u,g,b,S.segment,j,$,O,I);return ae?O.projectionCache.anyProjectionOccluded?null:{first:J,last:ae}:null}function Aa(T,n,u,g){return T===c.ao.horizontal&&Math.abs(u.y-n.y)>Math.abs(u.x-n.x)*g?{useVertical:!0}:(T===c.ao.vertical?n.y<u.y:n.x>u.x)?{needsFlipping:!0}:null}function kt(T){const{projectionContext:n,pitchedLabelPlaneMatrixInverse:u,symbol:g,fontSize:b,flip:S,keepUpright:I,glyphOffsetArray:O,dynamicLayoutVertexArray:N,aspectRatio:j,rotateToLine:$}=T,X=b/24,H=g.lineOffsetX*X,J=g.lineOffsetY*X;let ae;if(g.numGlyphs>1){const _e=g.glyphStartIndex+g.numGlyphs,me=g.lineStartIndex,ve=g.lineStartIndex+g.lineLength,we=ta(X,O,H,J,S,g,$,n);if(!we)return{notEnoughRoom:!0};const Me=tl(we.first.point.x,we.first.point.y,n,u),Ee=tl(we.last.point.x,we.last.point.y,n,u);if(I&&!S){const ze=Aa(g.writingMode,Me,Ee,j);if(ze)return ze}ae=[we.first];for(let ze=g.glyphStartIndex+1;ze<_e-1;ze++){const Ve=Us(X*O.getoffsetX(ze),H,J,S,g.segment,me,ve,n,$);if(!Ve)return{notEnoughRoom:!0};ae.push(Ve)}ae.push(we.last)}else{if(I&&!S){const me=ir(n.tileAnchorPoint.x,n.tileAnchorPoint.y,n).point,ve=g.lineStartIndex+g.segment+1,we=new c.P(n.lineVertexArray.getx(ve),n.lineVertexArray.gety(ve)),Me=ir(we.x,we.y,n),Ee=Me.signedDistanceFromCamera>0?Me.point:yn(n.tileAnchorPoint,we,me,1,n),ze=tl(me.x,me.y,n,u),Ve=tl(Ee.x,Ee.y,n,u),Ie=Aa(g.writingMode,ze,Ve,j);if(Ie)return Ie}const _e=Us(X*O.getoffsetX(g.glyphStartIndex),H,J,S,g.segment,g.lineStartIndex,g.lineStartIndex+g.lineLength,n,$);if(!_e||n.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};ae=[_e]}for(const _e of ae)c.av(N,_e.point,_e.angle);return{}}function yn(T,n,u,g,b){const S=T.add(T.sub(n)._unit()),I=ir(S.x,S.y,b).point,O=u.sub(I);return u.add(O._mult(g/O.mag()))}function In(T,n,u){const g=n.projectionCache;if(g.projections[T])return g.projections[T];const b=new c.P(n.lineVertexArray.getx(T),n.lineVertexArray.gety(T)),S=ir(b.x,b.y,n);if(S.signedDistanceFromCamera>0)return g.projections[T]=S.point,g.anyProjectionOccluded=g.anyProjectionOccluded||S.isOccluded,S.point;const I=T-u.direction;return yn(u.distanceFromAnchor===0?n.tileAnchorPoint:new c.P(n.lineVertexArray.getx(I),n.lineVertexArray.gety(I)),b,u.previousVertex,u.absOffsetX-u.distanceFromAnchor+1,n)}function ir(T,n,u){const g=T+u.translation[0],b=n+u.translation[1];let S;return u.pitchWithMap?(S=br(g,b,u.pitchedLabelPlaneMatrix,u.getElevation),S.isOccluded=!1):(S=u.transform.projectTileCoordinates(g,b,u.unwrappedTileID,u.getElevation),S.point.x=(.5*S.point.x+.5)*u.width,S.point.y=(.5*-S.point.y+.5)*u.height),S}function tl(T,n,u,g){if(u.pitchWithMap){const b=[T,n,0,1];return c.aw(b,b,g),u.transform.projectTileCoordinates(b[0]/b[3],b[1]/b[3],u.unwrappedTileID,u.getElevation).point}return{x:T/u.width*2-1,y:1-n/u.height*2}}function To(T,n,u){return u.transform.projectTileCoordinates(T,n,u.unwrappedTileID,u.getElevation)}function Bn(T,n,u){return T._unit()._perp()._mult(n*u)}function Vs(T,n,u,g,b,S,I,O,N){if(O.projectionCache.offsets[T])return O.projectionCache.offsets[T];const j=u.add(n);if(T+N.direction<g||T+N.direction>=b)return O.projectionCache.offsets[T]=j,j;const $=In(T+N.direction,O,N),X=Bn($.sub(u),I,N.direction),H=u.add(X),J=$.add(X);return O.projectionCache.offsets[T]=c.ax(S,j,H,J)||j,O.projectionCache.offsets[T]}function Us(T,n,u,g,b,S,I,O,N){const j=g?T-n:T+n;let $=j>0?1:-1,X=0;g&&($*=-1,X=Math.PI),$<0&&(X+=Math.PI);let H,J=$>0?S+b:S+b+1;O.projectionCache.cachedAnchorPoint?H=O.projectionCache.cachedAnchorPoint:(H=ir(O.tileAnchorPoint.x,O.tileAnchorPoint.y,O).point,O.projectionCache.cachedAnchorPoint=H);let ae,_e,me=H,ve=H,we=0,Me=0;const Ee=Math.abs(j),ze=[];let Ve;for(;we+Me<=Ee;){if(J+=$,J<S||J>=I)return null;we+=Me,ve=me,_e=ae;const ct={absOffsetX:Ee,direction:$,distanceFromAnchor:we,previousVertex:ve};if(me=In(J,O,ct),u===0)ze.push(ve),Ve=me.sub(ve);else{let rt;const st=me.sub(ve);rt=st.mag()===0?Bn(In(J+$,O,ct).sub(me),u,$):Bn(st,u,$),_e||(_e=ve.add(rt)),ae=Vs(J,rt,me,S,I,_e,u,O,ct),ze.push(_e),Ve=ae.sub(_e)}Me=Ve.mag()}const Ie=Ve._mult((Ee-we)/Me)._add(_e||ve),Ye=X+Math.atan2(me.y-ve.y,me.x-ve.x);return ze.push(Ie),{point:Ie,angle:N?Ye:0,path:ze}}const gs=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function $r(T,n){for(let u=0;u<T;u++){const g=n.length;n.resize(g+4),n.float32.set(gs,3*g)}}function Gr(T,n,u){const g=n[0],b=n[1];return T[0]=u[0]*g+u[4]*b+u[12],T[1]=u[1]*g+u[5]*b+u[13],T[3]=u[3]*g+u[7]*b+u[15],T}const Ei=100;class Mr{constructor(n,u=new tr(n.width+200,n.height+200,25),g=new tr(n.width+200,n.height+200,25)){this.transform=n,this.grid=u,this.ignoredGrid=g,this.pitchFactor=Math.cos(n.pitch*Math.PI/180)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+Ei,this.screenBottomBoundary=n.height+Ei,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(n,u,g,b,S,I,O,N,j,$,X,H){const J=this.projectAndGetPerspectiveRatio(n.anchorPointX+N[0],n.anchorPointY+N[1],S,$,H),ae=g*J.perspectiveRatio;let _e;if(I||O)_e=this._projectCollisionBox(n,ae,b,S,I,O,N,J,$,X,H);else{const Ve=J.x+(X?X.x*ae:0),Ie=J.y+(X?X.y*ae:0);_e={allPointsOccluded:!1,box:[Ve+n.x1*ae,Ie+n.y1*ae,Ve+n.x2*ae,Ie+n.y2*ae]}}const[me,ve,we,Me]=_e.box,Ee=I?_e.allPointsOccluded:J.isOccluded;let ze=Ee;return ze||(ze=J.perspectiveRatio<this.perspectiveRatioCutoff),ze||(ze=!this.isInsideGrid(me,ve,we,Me)),ze||u!=="always"&&this.grid.hitTest(me,ve,we,Me,u,j)?{box:[me,ve,we,Me],placeable:!1,offscreen:!1,occluded:Ee}:{box:[me,ve,we,Me],placeable:!0,offscreen:this.isOffscreen(me,ve,we,Me),occluded:Ee}}placeCollisionCircles(n,u,g,b,S,I,O,N,j,$,X,H,J,ae){const _e=[],me=new c.P(u.anchorX,u.anchorY),ve=this.getPerspectiveRatio(me.x,me.y,I,ae),we=(j?S*this.transform.getPitchedTextCorrection(u.anchorX,u.anchorY,I)/ve:S*ve)/c.aB,Me={getElevation:ae,pitchedLabelPlaneMatrix:O,lineVertexArray:g,pitchWithMap:j,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:me,unwrappedTileID:I,width:this.transform.width,height:this.transform.height,translation:J},Ee=ta(we,b,u.lineOffsetX*we,u.lineOffsetY*we,!1,u,!1,Me);let ze=!1,Ve=!1,Ie=!0;if(Ee){const Ye=.5*X*ve+H,ct=new c.P(-100,-100),rt=new c.P(this.screenRightBoundary,this.screenBottomBoundary),st=new Ri,lt=Ee.first,Nt=Ee.last;let Ft=[];for(let Zn=lt.path.length-1;Zn>=1;Zn--)Ft.push(lt.path[Zn]);for(let Zn=1;Zn<Nt.path.length;Zn++)Ft.push(Nt.path[Zn]);const Ct=2.5*Ye;if(j){const Zn=this.projectPathToScreenSpace(Ft,Me);Ft=Zn.some((bi=>bi.signedDistanceFromCamera<=0))?[]:Zn.map((bi=>bi.point))}let ln=[];if(Ft.length>0){const Zn=Ft[0].clone(),bi=Ft[0].clone();for(let Yi=1;Yi<Ft.length;Yi++)Zn.x=Math.min(Zn.x,Ft[Yi].x),Zn.y=Math.min(Zn.y,Ft[Yi].y),bi.x=Math.max(bi.x,Ft[Yi].x),bi.y=Math.max(bi.y,Ft[Yi].y);ln=Zn.x>=ct.x&&bi.x<=rt.x&&Zn.y>=ct.y&&bi.y<=rt.y?[Ft]:bi.x<ct.x||Zn.x>rt.x||bi.y<ct.y||Zn.y>rt.y?[]:c.ay([Ft],ct.x,ct.y,rt.x,rt.y)}for(const Zn of ln){st.reset(Zn,.25*Ye);let bi=0;bi=st.length<=.5*Ye?1:Math.ceil(st.paddedLength/Ct)+1;for(let Yi=0;Yi<bi;Yi++){const qi=Yi/Math.max(bi-1,1),Pr=st.lerp(qi),Fr=Pr.x+Ei,jn=Pr.y+Ei;_e.push(Fr,jn,Ye,0);const ur=Fr-Ye,sa=jn-Ye,Vr=Fr+Ye,La=jn+Ye;if(Ie=Ie&&this.isOffscreen(ur,sa,Vr,La),Ve=Ve||this.isInsideGrid(ur,sa,Vr,La),n!=="always"&&this.grid.hitTestCircle(Fr,jn,Ye,n,$)&&(ze=!0,!N))return{circles:[],offscreen:!1,collisionDetected:ze}}}}return{circles:!N&&ze||!Ve||ve<this.perspectiveRatioCutoff?[]:_e,offscreen:Ie,collisionDetected:ze}}projectPathToScreenSpace(n,u){const g=(function(b,S){const I=c.L();return c.aq(I,S.pitchedLabelPlaneMatrix),b.map((O=>{const N=br(O.x,O.y,I,S.getElevation),j=S.transform.projectTileCoordinates(N.point.x,N.point.y,S.unwrappedTileID,S.getElevation);return j.point.x=(.5*j.point.x+.5)*S.width,j.point.y=(.5*-j.point.y+.5)*S.height,j}))})(n,u);return(function(b){let S=0,I=0,O=0,N=0;for(let j=0;j<b.length;j++)b[j].isOccluded?(O=j+1,N=0):(N++,N>I&&(I=N,S=O));return b.slice(S,S+I)})(g)}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[],g=new c.a2;for(const X of n){const H=new c.P(X.x+Ei,X.y+Ei);g.extend(H),u.push(H)}const{minX:b,minY:S,maxX:I,maxY:O}=g,N=this.grid.query(b,S,I,O).concat(this.ignoredGrid.query(b,S,I,O)),j={},$={};for(const X of N){const H=X.key;if(j[H.bucketInstanceId]===void 0&&(j[H.bucketInstanceId]={}),j[H.bucketInstanceId][H.featureIndex])continue;const J=[new c.P(X.x1,X.y1),new c.P(X.x2,X.y1),new c.P(X.x2,X.y2),new c.P(X.x1,X.y2)];c.az(u,J)&&(j[H.bucketInstanceId][H.featureIndex]=!0,$[H.bucketInstanceId]===void 0&&($[H.bucketInstanceId]=[]),$[H.bucketInstanceId].push(H.featureIndex))}return $}insertCollisionBox(n,u,g,b,S,I){(g?this.ignoredGrid:this.grid).insert({bucketInstanceId:b,featureIndex:S,collisionGroupID:I,overlapMode:u},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,u,g,b,S,I){const O=g?this.ignoredGrid:this.grid,N={bucketInstanceId:b,featureIndex:S,collisionGroupID:I,overlapMode:u};for(let j=0;j<n.length;j+=4)O.insertCircle(N,n[j],n[j+1],n[j+2])}projectAndGetPerspectiveRatio(n,u,g,b,S){if(S){let I;b?(I=[n,u,b(n,u),1],c.aw(I,I,S)):(I=[n,u,0,1],Gr(I,I,S));const O=I[3];return{x:(I[0]/O+1)/2*this.transform.width+Ei,y:(-I[1]/O+1)/2*this.transform.height+Ei,perspectiveRatio:.5+this.transform.cameraToCenterDistance/O*.5,isOccluded:!1,signedDistanceFromCamera:O}}{const I=this.transform.projectTileCoordinates(n,u,g,b);return{x:(I.point.x+1)/2*this.transform.width+Ei,y:(1-I.point.y)/2*this.transform.height+Ei,perspectiveRatio:.5+this.transform.cameraToCenterDistance/I.signedDistanceFromCamera*.5,isOccluded:I.isOccluded,signedDistanceFromCamera:I.signedDistanceFromCamera}}}getPerspectiveRatio(n,u,g,b){const S=this.transform.projectTileCoordinates(n,u,g,b);return .5+this.transform.cameraToCenterDistance/S.signedDistanceFromCamera*.5}isOffscreen(n,u,g,b){return g<Ei||n>=this.screenRightBoundary||b<Ei||u>this.screenBottomBoundary}isInsideGrid(n,u,g,b){return g>=0&&n<this.gridRightBoundary&&b>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const n=c.ag([]);return c.M(n,n,[-100,-100,0]),n}_projectCollisionBox(n,u,g,b,S,I,O,N,j,$,X){let H=1,J=0,ae=0,_e=1;const me=n.anchorPointX+O[0],ve=n.anchorPointY+O[1];if(I&&!S){const Ft=this.projectAndGetPerspectiveRatio(me+1,ve,b,j,X),Ct=Ft.x-N.x,ln=Math.atan((Ft.y-N.y)/Ct)+(Ct<0?Math.PI:0),Zn=Math.sin(ln),bi=Math.cos(ln);H=bi,J=Zn,ae=-Zn,_e=bi}else if(!I&&S){const Ft=Kn(this.transform);H=Ft.vecEast[0],J=Ft.vecEast[1],ae=Ft.vecSouth[0],_e=Ft.vecSouth[1]}let we=N.x,Me=N.y,Ee=u;S&&(we=me,Me=ve,Ee=Math.pow(2,-(this.transform.zoom-g.overscaledZ)),Ee*=this.transform.getPitchedTextCorrection(me,ve,b),$||(Ee*=c.ah(.5+N.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),$&&(we+=H*$.x*Ee+ae*$.y*Ee,Me+=J*$.x*Ee+_e*$.y*Ee);const ze=n.x1*Ee,Ve=n.x2*Ee,Ie=(ze+Ve)/2,Ye=n.y1*Ee,ct=n.y2*Ee,rt=(Ye+ct)/2,st=[{offsetX:ze,offsetY:Ye},{offsetX:Ie,offsetY:Ye},{offsetX:Ve,offsetY:Ye},{offsetX:Ve,offsetY:rt},{offsetX:Ve,offsetY:ct},{offsetX:Ie,offsetY:ct},{offsetX:ze,offsetY:ct},{offsetX:ze,offsetY:rt}];let lt=[];for(const{offsetX:Ft,offsetY:Ct}of st)lt.push(new c.P(we+H*Ft+ae*Ct,Me+J*Ft+_e*Ct));let Nt=!1;if(S){const Ft=lt.map((Ct=>this.projectAndGetPerspectiveRatio(Ct.x,Ct.y,b,j,X)));Nt=Ft.some((Ct=>!Ct.isOccluded)),lt=Ft.map((Ct=>new c.P(Ct.x,Ct.y)))}else Nt=!0;return{box:c.aA(lt),allPointsOccluded:!Nt}}}class da{constructor(n,u,g,b){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?u:-u))):b&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class wi{constructor(n,u,g,b,S){this.text=new da(n?n.text:null,u,g,S),this.icon=new da(n?n.icon:null,u,b,S)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class So{constructor(n,u,g){this.text=n,this.icon=u,this.skipFade=g}}class Ua{constructor(n,u,g,b,S){this.bucketInstanceId=n,this.featureIndex=u,this.sourceLayerIndex=g,this.bucketIndex=b,this.tileID=S}}class Eo{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const u=++this.maxGroupID;this.collisionGroups[n]={ID:u,predicate:g=>g.collisionGroupID===u}}return this.collisionGroups[n]}}function js(T,n,u,g,b){const{horizontalAlign:S,verticalAlign:I}=c.aH(T);return new c.P(-(S-.5)*n+g[0]*b,-(I-.5)*u+g[1]*b)}class qs{constructor(n,u,g,b,S){this.transform=n.clone(),this.terrain=u,this.collisionIndex=new Mr(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=g,this.retainedQueryData={},this.collisionGroups=new Eo(b),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(n){const u=this.terrain;return u?(g,b)=>u.getElevation(n,g,b):null}getBucketParts(n,u,g,b){const S=g.getBucket(u),I=g.latestFeatureIndex;if(!S||!I||u.id!==S.layerIds[0])return;const O=g.collisionBoxArray,N=S.layers[0].layout,j=S.layers[0].paint,$=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),X=g.tileSize/c.$,H=g.tileID.toUnwrapped(),J=N.get("text-rotation-alignment")==="map",ae=c.aC(g,1,this.transform.zoom),_e=c.aD(this.collisionIndex.transform,g,j.get("text-translate"),j.get("text-translate-anchor")),me=c.aD(this.collisionIndex.transform,g,j.get("icon-translate"),j.get("icon-translate-anchor")),ve=Ir(J,this.transform,ae);this.retainedQueryData[S.bucketInstanceId]=new Ua(S.bucketInstanceId,I,S.sourceLayerIndex,S.index,g.tileID);const we={bucket:S,layout:N,translationText:_e,translationIcon:me,unwrappedTileID:H,pitchedLabelPlaneMatrix:ve,scale:$,textPixelRatio:X,holdingForFade:g.holdingForFade(),collisionBoxArray:O,partiallyEvaluatedTextSize:c.an(S.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(S.sourceID)};if(b)for(const Me of S.sortKeyRanges){const{sortKey:Ee,symbolInstanceStart:ze,symbolInstanceEnd:Ve}=Me;n.push({sortKey:Ee,symbolInstanceStart:ze,symbolInstanceEnd:Ve,parameters:we})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:we})}attemptAnchorPlacement(n,u,g,b,S,I,O,N,j,$,X,H,J,ae,_e,me,ve,we,Me,Ee){const ze=c.aE[n.textAnchor],Ve=[n.textOffset0,n.textOffset1],Ie=js(ze,g,b,Ve,S),Ye=this.collisionIndex.placeCollisionBox(u,H,N,j,$,O,I,me,X.predicate,Me,Ie,Ee);if((!we||this.collisionIndex.placeCollisionBox(we,H,N,j,$,O,I,ve,X.predicate,Me,Ie,Ee).placeable)&&Ye.placeable){let ct;if(this.prevPlacement&&this.prevPlacement.variableOffsets[J.crossTileID]&&this.prevPlacement.placements[J.crossTileID]&&this.prevPlacement.placements[J.crossTileID].text&&(ct=this.prevPlacement.variableOffsets[J.crossTileID].anchor),J.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[J.crossTileID]={textOffset:Ve,width:g,height:b,anchor:ze,textBoxScale:S,prevAnchor:ct},this.markUsedJustification(ae,ze,J,_e),ae.allowVerticalPlacement&&(this.markUsedOrientation(ae,_e,J),this.placedOrientations[J.crossTileID]=_e),{shift:Ie,placedGlyphBoxes:Ye}}}placeLayerBucketPart(n,u,g){const{bucket:b,layout:S,translationText:I,translationIcon:O,unwrappedTileID:N,pitchedLabelPlaneMatrix:j,textPixelRatio:$,holdingForFade:X,collisionBoxArray:H,partiallyEvaluatedTextSize:J,collisionGroup:ae}=n.parameters,_e=S.get("text-optional"),me=S.get("icon-optional"),ve=c.aF(S,"text-overlap","text-allow-overlap"),we=ve==="always",Me=c.aF(S,"icon-overlap","icon-allow-overlap"),Ee=Me==="always",ze=S.get("text-rotation-alignment")==="map",Ve=S.get("text-pitch-alignment")==="map",Ie=S.get("icon-text-fit")!=="none",Ye=S.get("symbol-z-order")==="viewport-y",ct=we&&(Ee||!b.hasIconData()||me),rt=Ee&&(we||!b.hasTextData()||_e);!b.collisionArrays&&H&&b.deserializeCollisionBoxes(H);const st=this.retainedQueryData[b.bucketInstanceId].tileID,lt=this._getTerrainElevationFunc(st),Nt=this.transform.getFastPathSimpleProjectionMatrix(st),Ft=(Ct,ln,Zn)=>{var bi,Yi;if(u[Ct.crossTileID])return;if(X)return void(this.placements[Ct.crossTileID]=new So(!1,!1,!1));let qi=!1,Pr=!1,Fr=!0,jn=null,ur={box:null,placeable:!1,offscreen:null,occluded:!1},sa={placeable:!1},Vr=null,La=null,Xa=null,fo=0,Cu=0,iu=0;ln.textFeatureIndex?fo=ln.textFeatureIndex:Ct.useRuntimeCollisionCircles&&(fo=Ct.featureIndex),ln.verticalTextFeatureIndex&&(Cu=ln.verticalTextFeatureIndex);const wh=ln.textBox;if(wh){const to=oa=>{let la=c.ao.horizontal;if(b.allowVerticalPlacement&&!oa&&this.prevPlacement){const jo=this.prevPlacement.placedOrientations[Ct.crossTileID];jo&&(this.placedOrientations[Ct.crossTileID]=jo,la=jo,this.markUsedOrientation(b,la,Ct))}return la},_l=(oa,la)=>{if(b.allowVerticalPlacement&&Ct.numVerticalGlyphVertices>0&&ln.verticalTextBox){for(const jo of b.writingModes)if(jo===c.ao.vertical?(ur=la(),sa=ur):ur=oa(),ur&&ur.placeable)break}else ur=oa()},ss=Ct.textAnchorOffsetStartIndex,Iu=Ct.textAnchorOffsetEndIndex;if(Iu===ss){const oa=(la,jo)=>{const ua=this.collisionIndex.placeCollisionBox(la,ve,$,st,N,Ve,ze,I,ae.predicate,lt,void 0,Nt);return ua&&ua.placeable&&(this.markUsedOrientation(b,jo,Ct),this.placedOrientations[Ct.crossTileID]=jo),ua};_l((()=>oa(wh,c.ao.horizontal)),(()=>{const la=ln.verticalTextBox;return b.allowVerticalPlacement&&Ct.numVerticalGlyphVertices>0&&la?oa(la,c.ao.vertical):{box:null,offscreen:null}})),to(ur&&ur.placeable)}else{let oa=c.aE[(Yi=(bi=this.prevPlacement)===null||bi===void 0?void 0:bi.variableOffsets[Ct.crossTileID])===null||Yi===void 0?void 0:Yi.anchor];const la=(ua,hd,fc)=>{const ru=ua.x2-ua.x1,yl=ua.y2-ua.y1,au=Ct.textBoxScale,Xf=Ie&&Me==="never"?hd:null;let po=null,om=ve==="never"?1:2,Kf="never";oa&&om++;for(let dd=0;dd<om;dd++){for(let pc=ss;pc<Iu;pc++){const su=b.textAnchorOffsets.get(pc);if(oa&&su.textAnchor!==oa)continue;const vl=this.attemptAnchorPlacement(su,ua,ru,yl,au,ze,Ve,$,st,N,ae,Kf,Ct,b,fc,I,O,Xf,lt);if(vl&&(po=vl.placedGlyphBoxes,po&&po.placeable))return qi=!0,jn=vl.shift,po}oa?oa=null:Kf=ve}return g&&!po&&(po={box:this.collisionIndex.placeCollisionBox(wh,"always",$,st,N,Ve,ze,I,ae.predicate,lt,void 0,Nt).box,offscreen:!1,placeable:!1,occluded:!1}),po};_l((()=>la(wh,ln.iconBox,c.ao.horizontal)),(()=>{const ua=ln.verticalTextBox;return b.allowVerticalPlacement&&(!ur||!ur.placeable)&&Ct.numVerticalGlyphVertices>0&&ua?la(ua,ln.verticalIconBox,c.ao.vertical):{box:null,occluded:!0,offscreen:null}})),ur&&(qi=ur.placeable,Fr=ur.offscreen);const jo=to(ur&&ur.placeable);if(!qi&&this.prevPlacement){const ua=this.prevPlacement.variableOffsets[Ct.crossTileID];ua&&(this.variableOffsets[Ct.crossTileID]=ua,this.markUsedJustification(b,ua.anchor,Ct,jo))}}}if(Vr=ur,qi=Vr&&Vr.placeable,Fr=Vr&&Vr.offscreen,Ct.useRuntimeCollisionCircles){const to=b.text.placedSymbolArray.get(Ct.centerJustifiedTextSymbolIndex),_l=c.ap(b.textSizeData,J,to),ss=S.get("text-padding");La=this.collisionIndex.placeCollisionCircles(ve,to,b.lineVertexArray,b.glyphOffsetArray,_l,N,j,g,Ve,ae.predicate,Ct.collisionCircleDiameter,ss,I,lt),La.circles.length&&La.collisionDetected&&!g&&c.w("Collisions detected, but collision boxes are not shown"),qi=we||La.circles.length>0&&!La.collisionDetected,Fr=Fr&&La.offscreen}if(ln.iconFeatureIndex&&(iu=ln.iconFeatureIndex),ln.iconBox){const to=_l=>this.collisionIndex.placeCollisionBox(_l,Me,$,st,N,Ve,ze,O,ae.predicate,lt,Ie&&jn?jn:void 0,Nt);sa&&sa.placeable&&ln.verticalIconBox?(Xa=to(ln.verticalIconBox),Pr=Xa.placeable):(Xa=to(ln.iconBox),Pr=Xa.placeable),Fr=Fr&&Xa.offscreen}const qc=_e||Ct.numHorizontalGlyphVertices===0&&Ct.numVerticalGlyphVertices===0,hc=me||Ct.numIconVertices===0;qc||hc?hc?qc||(Pr=Pr&&qi):qi=Pr&&qi:Pr=qi=Pr&&qi;const dc=Pr&&Xa.placeable;if(qi&&Vr.placeable&&this.collisionIndex.insertCollisionBox(Vr.box,ve,S.get("text-ignore-placement"),b.bucketInstanceId,sa&&sa.placeable&&Cu?Cu:fo,ae.ID),dc&&this.collisionIndex.insertCollisionBox(Xa.box,Me,S.get("icon-ignore-placement"),b.bucketInstanceId,iu,ae.ID),La&&qi&&this.collisionIndex.insertCollisionCircles(La.circles,ve,S.get("text-ignore-placement"),b.bucketInstanceId,fo,ae.ID),g&&this.storeCollisionData(b.bucketInstanceId,Zn,ln,Vr,Xa,La),Ct.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(b.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ct.crossTileID]=new So((qi||ct)&&!(Vr!=null&&Vr.occluded),(Pr||rt)&&!(Xa!=null&&Xa.occluded),Fr||b.justReloaded),u[Ct.crossTileID]=!0};if(Ye){if(n.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ct=b.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let ln=Ct.length-1;ln>=0;--ln){const Zn=Ct[ln];Ft(b.symbolInstances.get(Zn),b.collisionArrays[Zn],Zn)}}else for(let Ct=n.symbolInstanceStart;Ct<n.symbolInstanceEnd;Ct++)Ft(b.symbolInstances.get(Ct),b.collisionArrays[Ct],Ct);b.justReloaded=!1}storeCollisionData(n,u,g,b,S,I){if(g.textBox||g.iconBox){let O,N;this.collisionBoxArrays.has(n)?O=this.collisionBoxArrays.get(n):(O=new Map,this.collisionBoxArrays.set(n,O)),O.has(u)?N=O.get(u):(N={text:null,icon:null},O.set(u,N)),g.textBox&&(N.text=b.box),g.iconBox&&(N.icon=S.box)}if(I){let O=this.collisionCircleArrays[n];O===void 0&&(O=this.collisionCircleArrays[n]=[]);for(let N=0;N<I.circles.length;N+=4)O.push(I.circles[N+0]-Ei),O.push(I.circles[N+1]-Ei),O.push(I.circles[N+2]),O.push(I.collisionDetected?1:0)}}markUsedJustification(n,u,g,b){let S;S=b===c.ao.vertical?g.verticalPlacedTextSymbolIndex:{left:g.leftJustifiedTextSymbolIndex,center:g.centerJustifiedTextSymbolIndex,right:g.rightJustifiedTextSymbolIndex}[c.aG(u)];const I=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex,g.verticalPlacedTextSymbolIndex];for(const O of I)O>=0&&(n.text.placedSymbolArray.get(O).crossTileID=S>=0&&O!==S?0:g.crossTileID)}markUsedOrientation(n,u,g){const b=u===c.ao.horizontal||u===c.ao.horizontalOnly?u:0,S=u===c.ao.vertical?u:0,I=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex];for(const O of I)n.text.placedSymbolArray.get(O).placedOrientation=b;g.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(g.verticalPlacedTextSymbolIndex).placedOrientation=S)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let g=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const b=u?u.symbolFadeChange(n):1,S=u?u.opacities:{},I=u?u.variableOffsets:{},O=u?u.placedOrientations:{};for(const N in this.placements){const j=this.placements[N],$=S[N];$?(this.opacities[N]=new wi($,b,j.text,j.icon),g=g||j.text!==$.text.placed||j.icon!==$.icon.placed):(this.opacities[N]=new wi(null,b,j.text,j.icon,j.skipFade),g=g||j.text||j.icon)}for(const N in S){const j=S[N];if(!this.opacities[N]){const $=new wi(j,b,!1,!1);$.isHidden()||(this.opacities[N]=$,g=g||j.text.placed||j.icon.placed)}}for(const N in I)this.variableOffsets[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.variableOffsets[N]=I[N]);for(const N in O)this.placedOrientations[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.placedOrientations[N]=O[N]);if(u&&u.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");g?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:n)}updateLayerOpacities(n,u){const g={};for(const b of u){const S=b.getBucket(n);S&&b.latestFeatureIndex&&n.id===S.layerIds[0]&&this.updateBucketOpacities(S,b.tileID,g,b.collisionBoxArray)}}updateBucketOpacities(n,u,g,b){n.hasTextData()&&(n.text.opacityVertexArray.clear(),n.text.hasVisibleVertices=!1),n.hasIconData()&&(n.icon.opacityVertexArray.clear(),n.icon.hasVisibleVertices=!1),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const S=n.layers[0],I=S.layout,O=new wi(null,0,!1,!1,!0),N=I.get("text-allow-overlap"),j=I.get("icon-allow-overlap"),$=S._unevaluatedLayout.hasValue("text-variable-anchor")||S._unevaluatedLayout.hasValue("text-variable-anchor-offset"),X=I.get("text-rotation-alignment")==="map",H=I.get("text-pitch-alignment")==="map",J=I.get("icon-text-fit")!=="none",ae=new wi(null,0,N&&(j||!n.hasIconData()||I.get("icon-optional")),j&&(N||!n.hasTextData()||I.get("text-optional")),!0);!n.collisionArrays&&b&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(b);const _e=(ve,we,Me)=>{for(let Ee=0;Ee<we/4;Ee++)ve.opacityVertexArray.emplaceBack(Me);ve.hasVisibleVertices=ve.hasVisibleVertices||Me!==Ca},me=this.collisionBoxArrays.get(n.bucketInstanceId);for(let ve=0;ve<n.symbolInstances.length;ve++){const we=n.symbolInstances.get(ve),{numHorizontalGlyphVertices:Me,numVerticalGlyphVertices:Ee,crossTileID:ze}=we;let Ve=this.opacities[ze];g[ze]?Ve=O:Ve||(Ve=ae,this.opacities[ze]=Ve),g[ze]=!0;const Ie=we.numIconVertices>0,Ye=this.placedOrientations[we.crossTileID],ct=Ye===c.ao.vertical,rt=Ye===c.ao.horizontal||Ye===c.ao.horizontalOnly;if(Me>0||Ee>0){const lt=Ui(Ve.text);_e(n.text,Me,ct?Ca:lt),_e(n.text,Ee,rt?Ca:lt);const Nt=Ve.text.isHidden();[we.rightJustifiedTextSymbolIndex,we.centerJustifiedTextSymbolIndex,we.leftJustifiedTextSymbolIndex].forEach((ln=>{ln>=0&&(n.text.placedSymbolArray.get(ln).hidden=Nt||ct?1:0)})),we.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(we.verticalPlacedTextSymbolIndex).hidden=Nt||rt?1:0);const Ft=this.variableOffsets[we.crossTileID];Ft&&this.markUsedJustification(n,Ft.anchor,we,Ye);const Ct=this.placedOrientations[we.crossTileID];Ct&&(this.markUsedJustification(n,"left",we,Ct),this.markUsedOrientation(n,Ct,we))}if(Ie){const lt=Ui(Ve.icon),Nt=!(J&&we.verticalPlacedIconSymbolIndex&&ct);we.placedIconSymbolIndex>=0&&(_e(n.icon,we.numIconVertices,Nt?lt:Ca),n.icon.placedSymbolArray.get(we.placedIconSymbolIndex).hidden=Ve.icon.isHidden()),we.verticalPlacedIconSymbolIndex>=0&&(_e(n.icon,we.numVerticalIconVertices,Nt?Ca:lt),n.icon.placedSymbolArray.get(we.verticalPlacedIconSymbolIndex).hidden=Ve.icon.isHidden())}const st=me&&me.has(ve)?me.get(ve):{text:null,icon:null};if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const lt=n.collisionArrays[ve];if(lt){let Nt=new c.P(0,0);if(lt.textBox||lt.verticalTextBox){let Ft=!0;if($){const Ct=this.variableOffsets[ze];Ct?(Nt=js(Ct.anchor,Ct.width,Ct.height,Ct.textOffset,Ct.textBoxScale),X&&Nt._rotate(H?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Ft=!1}if(lt.textBox||lt.verticalTextBox){let Ct;lt.textBox&&(Ct=ct),lt.verticalTextBox&&(Ct=rt),nl(n.textCollisionBox.collisionVertexArray,Ve.text.placed,!Ft||Ct,st.text,Nt.x,Nt.y)}}if(lt.iconBox||lt.verticalIconBox){const Ft=!!(!rt&&lt.verticalIconBox);let Ct;lt.iconBox&&(Ct=Ft),lt.verticalIconBox&&(Ct=!Ft),nl(n.iconCollisionBox.collisionVertexArray,Ve.icon.placed,Ct,st.icon,J?Nt.x:0,J?Nt.y:0)}}}}if(n.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.text.opacityVertexArray.length!==n.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${n.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${n.text.layoutVertexArray.length}) / 4`);if(n.icon.opacityVertexArray.length!==n.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${n.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${n.icon.layoutVertexArray.length}) / 4`);n.bucketInstanceId in this.collisionCircleArrays&&(n.collisionCircleArray=this.collisionCircleArrays[n.bucketInstanceId],delete this.collisionCircleArrays[n.bucketInstanceId])}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,u){const g=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*g>n}setStale(){this.stale=!0}}function nl(T,n,u,g,b,S){g&&g.length!==0||(g=[0,0,0,0]);const I=g[0]-Ei,O=g[1]-Ei,N=g[2]-Ei,j=g[3]-Ei;T.emplaceBack(n?1:0,u?1:0,b||0,S||0,I,O),T.emplaceBack(n?1:0,u?1:0,b||0,S||0,N,O),T.emplaceBack(n?1:0,u?1:0,b||0,S||0,N,j),T.emplaceBack(n?1:0,u?1:0,b||0,S||0,I,j)}const ii=Math.pow(2,25),hi=Math.pow(2,24),Zi=Math.pow(2,17),xr=Math.pow(2,16),$s=Math.pow(2,9),uu=Math.pow(2,8),on=Math.pow(2,1);function Ui(T){if(T.opacity===0&&!T.placed)return 0;if(T.opacity===1&&T.placed)return 4294967295;const n=T.placed?1:0,u=Math.floor(127*T.opacity);return u*ii+n*hi+u*Zi+n*xr+u*$s+n*uu+u*on+n}const Ca=0;class so{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&!n.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(n,u,g,b,S){const I=this._bucketParts;for(;this._currentTileIndex<n.length;)if(u.getBucketParts(I,b,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,I.sort(((O,N)=>O.sortKey-N.sortKey)));this._currentPartIndex<I.length;)if(u.placeLayerBucketPart(I[this._currentPartIndex],this._seenCrossTileIDs,g),this._currentPartIndex++,S())return!0;return!1}}class rr{constructor(n,u,g,b,S,I,O,N){this.placement=new qs(n,u,I,O,N),this._currentPlacementIndex=g.length-1,this._forceFullPlacement=b,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(n,u,g){const b=ee.now(),S=()=>!this._forceFullPlacement&&ee.now()-b>2;for(;this._currentPlacementIndex>=0;){const I=u[n[this._currentPlacementIndex]],O=this.placement.collisionIndex.transform.zoom;if(I.type==="symbol"&&(!I.minzoom||I.minzoom<=O)&&(!I.maxzoom||I.maxzoom>O)){if(this._inProgressLayer||(this._inProgressLayer=new so(I)),this._inProgressLayer.continuePlacement(g[I.source],this.placement,this._showCollisionBoxes,I,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const Ao=512/c.$/2;class Pl{constructor(n,u,g){this.tileID=n,this.bucketInstanceId=g,this._symbolsByKey={};const b=new Map;for(let S=0;S<u.length;S++){const I=u.get(S),O=I.key,N=b.get(O);N?N.push(I):b.set(O,[I])}for(const[S,I]of b){const O={positions:I.map((N=>({x:Math.floor(N.anchorX*Ao),y:Math.floor(N.anchorY*Ao)}))),crossTileIDs:I.map((N=>N.crossTileID))};if(O.positions.length>128){const N=new c.aI(O.positions.length,16,Uint16Array);for(const{x:j,y:$}of O.positions)N.add(j,$);N.finish(),delete O.positions,O.index=N}this._symbolsByKey[S]=O}}getScaledCoordinates(n,u){const{x:g,y:b,z:S}=this.tileID.canonical,{x:I,y:O,z:N}=u.canonical,j=Ao/Math.pow(2,N-S),$=(O*c.$+n.anchorY)*j,X=b*c.$*Ao;return{x:Math.floor((I*c.$+n.anchorX)*j-g*c.$*Ao),y:Math.floor($-X)}}findMatches(n,u,g){const b=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let S=0;S<n.length;S++){const I=n.get(S);if(I.crossTileID)continue;const O=this._symbolsByKey[I.key];if(!O)continue;const N=this.getScaledCoordinates(I,u);if(O.index){const j=O.index.range(N.x-b,N.y-b,N.x+b,N.y+b).sort();for(const $ of j){const X=O.crossTileIDs[$];if(!g[X]){g[X]=!0,I.crossTileID=X;break}}}else if(O.positions)for(let j=0;j<O.positions.length;j++){const $=O.positions[j],X=O.crossTileIDs[j];if(Math.abs($.x-N.x)<=b&&Math.abs($.y-N.y)<=b&&!g[X]){g[X]=!0,I.crossTileID=X;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:n})=>n))}}class Gs{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ar{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const u=Math.round((n-this.lng)/360);if(u!==0)for(const g in this.indexes){const b=this.indexes[g],S={};for(const I in b){const O=b[I];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+u),S[O.tileID.key]=O}this.indexes[g]=S}this.lng=n}addBucket(n,u,g){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let S=0;S<u.symbolInstances.length;S++)u.symbolInstances.get(S).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});const b=this.usedCrossTileIDs[n.overscaledZ];for(const S in this.indexes){const I=this.indexes[S];if(Number(S)>n.overscaledZ)for(const O in I){const N=I[O];N.tileID.isChildOf(n)&&N.findMatches(u.symbolInstances,n,b)}else{const O=I[n.scaledTo(Number(S)).key];O&&O.findMatches(u.symbolInstances,n,b)}}for(let S=0;S<u.symbolInstances.length;S++){const I=u.symbolInstances.get(S);I.crossTileID||(I.crossTileID=g.generate(),b[I.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Pl(n,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(n,u){for(const g of u.getCrossTileIDsLists())for(const b of g)delete this.usedCrossTileIDs[n][b]}removeStaleBuckets(n){let u=!1;for(const g in this.indexes){const b=this.indexes[g];for(const S in b)n[b[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,b[S]),delete b[S],u=!0)}return u}}class Qa{constructor(){this.layerIndexes={},this.crossTileIDs=new Gs,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,u,g){let b=this.layerIndexes[n.id];b===void 0&&(b=this.layerIndexes[n.id]=new ar);let S=!1;const I={};b.handleWrapJump(g);for(const O of u){const N=O.getBucket(n);N&&n.id===N.layerIds[0]&&(N.bucketInstanceId||(N.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(O.tileID,N,this.crossTileIDs)&&(S=!0),I[N.bucketInstanceId]=!0)}return b.removeStaleBuckets(I)&&(S=!0),S}pruneUnusedLayers(n){const u={};n.forEach((g=>{u[g]=!0}));for(const g in this.layerIndexes)u[g]||delete this.layerIndexes[g]}}var ja="void main() {fragColor=vec4(1.0);}";const Hi={prelude:Un(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Un("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Un("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Un(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Un(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Un(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Un(ja,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Un(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Un(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Un("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Un("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Un(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Un("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Un(ja,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Un(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Un(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Un(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Un(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Un(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Un(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Un(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Un(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Un(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Un(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Un(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Un(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Un(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Un(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Un(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Un(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Un("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Un("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Un("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Un("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Un(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Un("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Un(T,n){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=n.match(/in ([\w]+) ([\w]+)/g),b=T.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),I=S?S.concat(b):b,O={};return{fragmentSource:T=T.replace(u,((N,j,$,X,H)=>(O[H]=!0,j==="define"?`
#ifndef HAS_UNIFORM_u_${H}
in ${$} ${X} ${H};
#else
uniform ${$} ${X} u_${H};
#endif
`:`
#ifdef HAS_UNIFORM_u_${H}
    ${$} ${X} ${H} = u_${H};
#endif
`))),vertexSource:n=n.replace(u,((N,j,$,X,H)=>{const J=X==="float"?"vec2":"vec4",ae=H.match(/color/)?"color":J;return O[H]?j==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
in ${$} ${J} a_${H};
out ${$} ${X} ${H};
#else
uniform ${$} ${X} u_${H};
#endif
`:ae==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = a_${H};
#else
    ${$} ${X} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = unpack_mix_${ae}(a_${H}, u_${H}_t);
#else
    ${$} ${X} ${H} = u_${H};
#endif
`:j==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
in ${$} ${J} a_${H};
#else
uniform ${$} ${X} u_${H};
#endif
`:ae==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${$} ${X} ${H} = a_${H};
#else
    ${$} ${X} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${$} ${X} ${H} = unpack_mix_${ae}(a_${H}, u_${H}_t);
#else
    ${$} ${X} ${H} = u_${H};
#endif
`})),staticAttributes:g,staticUniforms:I}}class Ja{constructor(n,u,g){this.vertexBuffer=n,this.indexBuffer=u,this.segments=g}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var _s=c.aJ([{name:"a_pos",type:"Int16",components:2}]);const qa="#define PROJECTION_MERCATOR",Zs="mercator";class Ln{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Zs}get shaderDefine(){return qa}get shaderPreludeCode(){return Hi.projectionMercator}get vertexShaderPreludeCode(){return Hi.projectionMercator.vertexSource}get subdivisionGranularity(){return c.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(n){}getMeshFromTileID(n,u,g,b,S){if(this._cachedMesh)return this._cachedMesh;const I=new c.aL;I.emplaceBack(0,0),I.emplaceBack(c.$,0),I.emplaceBack(0,c.$),I.emplaceBack(c.$,c.$);const O=n.createVertexBuffer(I,_s.members),N=c.aM.simpleSegment(0,0,4,2),j=new c.aN;j.emplaceBack(1,0,2),j.emplaceBack(1,2,3);const $=n.createIndexBuffer(j);return this._cachedMesh=new Ja(O,$,N),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(n){}}class ys{constructor(n=0,u=0,g=0,b=0){if(isNaN(n)||n<0||isNaN(u)||u<0||isNaN(g)||g<0||isNaN(b)||b<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=u,this.left=g,this.right=b}interpolate(n,u,g){return u.top!=null&&n.top!=null&&(this.top=c.C.number(n.top,u.top,g)),u.bottom!=null&&n.bottom!=null&&(this.bottom=c.C.number(n.bottom,u.bottom,g)),u.left!=null&&n.left!=null&&(this.left=c.C.number(n.left,u.left,g)),u.right!=null&&n.right!=null&&(this.right=c.C.number(n.right,u.right,g)),this}getCenter(n,u){const g=c.ah((this.left+n-this.right)/2,0,n),b=c.ah((this.top+u-this.bottom)/2,0,u);return new c.P(g,b)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new ys(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ia(T,n){if(!T.renderWorldCopies||T.lngRange)return;const u=n.lng-T.center.lng;n.lng+=u>180?-360:u<-180?360:0}function Rl(T){return Math.max(0,Math.floor(T))}class Wi{constructor(n,u,g,b,S,I){this._callbacks=n,this._tileSize=512,this._renderWorldCopies=I===void 0||!!I,this._minZoom=u||0,this._maxZoom=g||22,this._minPitch=b??0,this._maxPitch=S??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new c.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Rl(this._zoom),this._scale=c.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new ys,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(n,u,g){this._latRange=n.latRange,this._lngRange=n.lngRange,this._width=n.width,this._height=n.height,this._center=n.center,this._elevation=n.elevation,this._minElevationForCurrentTile=n.minElevationForCurrentTile,this._zoom=n.zoom,this._tileZoom=Rl(this._zoom),this._scale=c.af(this._zoom),this._bearingInRadians=n.bearingInRadians,this._fovInRadians=n.fovInRadians,this._pitchInRadians=n.pitchInRadians,this._rollInRadians=n.rollInRadians,this._unmodified=n.unmodified,this._edgeInsets=new ys(n.padding.top,n.padding.bottom,n.padding.left,n.padding.right),this._minZoom=n.minZoom,this._maxZoom=n.maxZoom,this._minPitch=n.minPitch,this._maxPitch=n.maxPitch,this._renderWorldCopies=n.renderWorldCopies,this._cameraToCenterDistance=n.cameraToCenterDistance,this._nearZ=n.nearZ,this._farZ=n.farZ,this._autoCalculateNearFarZ=!g&&n.autoCalculateNearFarZ,u&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(n){this._minElevationForCurrentTile=n}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(n){this._minZoom!==n&&(this._minZoom=n,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(n){this._minPitch!==n&&(this._minPitch=n,this.setPitch(Math.max(this.pitch,n)))}get maxPitch(){return this._maxPitch}setMaxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.setPitch(Math.min(this.pitch,n)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(n){const u=c.aO(n,-180,180)*Math.PI/180;var g,b,S,I,O,N,j,$,X;this._bearingInRadians!==u&&(this._unmodified=!1,this._bearingInRadians=u,this._calcMatrices(),this._rotationMatrix=k(),g=this._rotationMatrix,S=-this._bearingInRadians,I=(b=this._rotationMatrix)[0],O=b[1],N=b[2],j=b[3],$=Math.sin(S),X=Math.cos(S),g[0]=I*X+N*$,g[1]=O*X+j*$,g[2]=I*-$+N*X,g[3]=O*-$+j*X)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(n){const u=c.ah(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==u&&(this._unmodified=!1,this._pitchInRadians=u,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(n){const u=n/180*Math.PI;this._rollInRadians!==u&&(this._unmodified=!1,this._rollInRadians=u,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return c.aP(this._fovInRadians)}setFov(n){n=c.ah(n,.1,150),this.fov!==n&&(this._unmodified=!1,this._fovInRadians=c.ae(n),this._calcMatrices())}get zoom(){return this._zoom}setZoom(n){const u=this.getConstrained(this._center,n).zoom;this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this._tileZoom=Math.max(0,Math.floor(u)),this._scale=c.af(u),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(n){n!==this._elevation&&(this._elevation=n,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(n,u){this._autoCalculateNearFarZ=!1,this._nearZ=n,this._farZ=u,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,u,g){this._unmodified=!1,this._edgeInsets.interpolate(n,u,g),this._constrain(),this._calcMatrices()}resize(n,u,g=!0){this._width=n,this._height=u,g&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Fi([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(n){n?(this._lngRange=[n.getWest(),n.getEast()],this._latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-c.ai,c.ai])}getConstrained(n,u){return this._callbacks.getConstrained(n,u)}getCameraQueryGeometry(n,u){if(u.length===1)return[u[0],n];{const{minX:g,minY:b,maxX:S,maxY:I}=c.a2.fromPoints(u).extend(n);return[new c.P(g,b),new c.P(S,b),new c.P(S,I),new c.P(g,I),new c.P(g,b)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const n=this._unmodified,{center:u,zoom:g}=this.getConstrained(this.center,this.zoom);this.setCenter(u),this.setZoom(g),this._unmodified=n,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let n=c.ag(new Float64Array(16));c.N(n,n,[this._width/2,-this._height/2,1]),c.M(n,n,[1,-1,0]),this._clipSpaceToPixelsMatrix=n,n=c.ag(new Float64Array(16)),c.N(n,n,[1,-1,1]),c.M(n,n,[-1,-1,0]),c.N(n,n,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=n,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(n,u,g,b){const S=g!==void 0?g:this.bearing,I=b=b!==void 0?b:this.pitch,O=c.a1.fromLngLat(n,u),N=-Math.cos(c.ae(I)),j=Math.sin(c.ae(I)),$=j*Math.sin(c.ae(S)),X=-j*Math.cos(c.ae(S));let H=this.elevation;const J=u-H;let ae;N*J>=0||Math.abs(N)<.1?(ae=1e4,H=u+ae*N):ae=-J/N;let _e,me,ve=c.aQ(1,O.y),we=0;do{if(we+=1,we>10)break;me=ae/ve,_e=new c.a1(O.x+$*me,O.y+X*me),ve=1/_e.meterInMercatorCoordinateUnits()}while(Math.abs(ae-me*ve)>1e-12);return{center:_e.toLngLat(),elevation:H,zoom:c.ak(this.height/2/Math.tan(this.fovInRadians/2)/me/this.tileSize)}}recalculateZoomAndCenter(n){if(this.elevation-n==0)return;const u=c.aj(1,this.center.lat)*this.worldSize,g=this.cameraToCenterDistance/u,b=c.a1.fromLngLat(this.center,this.elevation),S=et(this.center,this.elevation,this.pitch,this.bearing,g);this._elevation=n;const I=this.calculateCenterFromCameraLngLatAlt(S.toLngLat(),c.aQ(S.z,b.y),this.bearing,this.pitch);this._elevation=I.elevation,this._center=I.center,this.setZoom(I.zoom)}getCameraPoint(){const n=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(n*Math.sin(this.rollInRadians),n*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const n=c.aj(1,this.center.lat)*this.worldSize;return et(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/n).toLngLat()}getMercatorTileCoordinates(n){if(!n)return[0,0,1,1];const u=n.canonical.z>=0?1<<n.canonical.z:Math.pow(2,n.canonical.z);return[n.canonical.x/u,n.canonical.y/u,1/u/c.$,1/u/c.$]}}class mr{constructor(n,u){this.min=n,this.max=u,this.center=c.aR([],c.aS([],this.min,this.max),.5)}quadrant(n){const u=[n%2==0,n<2],g=c.aT(this.min),b=c.aT(this.max);for(let S=0;S<u.length;S++)g[S]=u[S]?this.min[S]:this.center[S],b[S]=u[S]?this.center[S]:this.max[S];return b[2]=this.max[2],new mr(g,b)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}intersectsFrustum(n){let u=!0;for(let g=0;g<n.planes.length;g++){const b=this.intersectsPlane(n.planes[g]);if(b===0)return 0;b===1&&(u=!1)}return u?2:n.aabb.min[0]>this.max[0]||n.aabb.min[1]>this.max[1]||n.aabb.min[2]>this.max[2]||n.aabb.max[0]<this.min[0]||n.aabb.max[1]<this.min[1]||n.aabb.max[2]<this.min[2]?0:1}intersectsPlane(n){let u=n[3],g=n[3];for(let b=0;b<3;b++)n[b]>0?(u+=n[b]*this.min[b],g+=n[b]*this.max[b]):(g+=n[b]*this.min[b],u+=n[b]*this.max[b]);return u>=0?2:g<0?0:1}}class hn{distanceToTile2d(n,u,g,b){const S=b.distanceX([n,u]),I=b.distanceY([n,u]);return Math.hypot(S,I)}getWrap(n,u,g){return g}getTileBoundingVolume(n,u,g,b){var S,I;let O=0,N=0;if(b!=null&&b.terrain){const $=new c.Z(n.z,u,n.z,n.x,n.y),X=b.terrain.getMinMaxElevation($);O=(S=X.minElevation)!==null&&S!==void 0?S:Math.min(0,g),N=(I=X.maxElevation)!==null&&I!==void 0?I:Math.max(0,g)}const j=1<<n.z;return new mr([u+n.x/j,n.y/j,O],[u+(n.x+1)/j,(n.y+1)/j,N])}allowVariableZoom(n,u){const g=n.fov*(Math.abs(Math.cos(n.rollInRadians))*n.height+Math.abs(Math.sin(n.rollInRadians))*n.width)/n.height,b=c.ah(78.5-g/2,0,60);return!!u.terrain||n.pitch>b}allowWorldCopies(){return!0}prepareNextFrame(){}}class pi{constructor(n,u,g){this.points=n,this.planes=u,this.aabb=g}static fromInvProjectionMatrix(n,u=1,g=0,b,S){const I=S?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],O=Math.pow(2,g),N=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((H=>(function(J,ae,_e,me){const ve=c.aw([],J,ae),we=1/ve[3]/_e*me;return c.aY(ve,ve,[we,we,1/ve[3],we])})(H,n,u,O)));b&&(function(H,J,ae,_e){const me=_e?4:0,ve=_e?0:4;let we=0;const Me=[],Ee=[];for(let Ie=0;Ie<4;Ie++){const Ye=c.aU([],H[Ie+ve],H[Ie+me]),ct=c.aZ(Ye);c.aR(Ye,Ye,1/ct),Me.push(ct),Ee.push(Ye)}for(let Ie=0;Ie<4;Ie++){const Ye=c.a_(H[Ie+me],Ee[Ie],ae);we=Ye!==null&&Ye>=0?Math.max(we,Ye):Math.max(we,Me[Ie])}const ze=(function(Ie,Ye){const ct=c.aU([],Ie[Ye[0]],Ie[Ye[1]]),rt=c.aU([],Ie[Ye[2]],Ie[Ye[1]]),st=[0,0,0,0];return c.aV(st,c.aW([],ct,rt)),st[3]=-c.aX(st,Ie[Ye[0]]),st})(H,J),Ve=(function(Ie,Ye){const ct=c.a$(Ie),rt=c.b0([],Ie,1/ct),st=c.aU([],Ye,c.aR([],rt,c.aX(Ye,rt))),lt=c.a$(st);if(lt>0){const Nt=Math.sqrt(1-rt[3]*rt[3]),Ft=c.aR([],rt,-rt[3]),Ct=c.aS([],Ft,c.aR([],st,Nt/lt));return c.b1(Ye,Ct)}return null})(ae,ze);if(Ve!==null){const Ie=Ve/c.aX(Ee[0],ze);we=Math.min(we,Ie)}for(let Ie=0;Ie<4;Ie++){const Ye=Math.min(we,Me[Ie]);H[Ie+ve]=[H[Ie+me][0]+Ee[Ie][0]*Ye,H[Ie+me][1]+Ee[Ie][1]*Ye,H[Ie+me][2]+Ee[Ie][2]*Ye,1]}})(N,I[0],b,S);const j=I.map((H=>{const J=c.aU([],N[H[0]],N[H[1]]),ae=c.aU([],N[H[2]],N[H[1]]),_e=c.aV([],c.aW([],J,ae)),me=-c.aX(_e,N[H[1]]);return _e.concat(me)})),$=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],X=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const H of N)for(let J=0;J<3;J++)$[J]=Math.min($[J],H[J]),X[J]=Math.max(X[J],H[J]);return new pi(N,j,new mr($,X))}}class xn{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,u,g){return this._helper.interpolatePadding(n,u,g)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,u,g=!0){this._helper.resize(n,u,g)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}overrideNearFarZ(n,u){this._helper.overrideNearFarZ(n,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(n,u){}constructor(n,u,g,b,S){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Wi({calcMatrices:()=>{this._calcMatrices()},getConstrained:(I,O)=>this.getConstrained(I,O)},n,u,g,b,S),this._coveringTilesDetailsProvider=new hn}clone(){const n=new xn;return n.apply(this),n}apply(n,u,g){this._helper.apply(n,u,g)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(n){const u=[new c.b2(0,n)];if(this._helper._renderWorldCopies){const g=this.screenPointToMercatorCoordinate(new c.P(0,0)),b=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,0)),S=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,this._helper._height)),I=this.screenPointToMercatorCoordinate(new c.P(0,this._helper._height)),O=Math.floor(Math.min(g.x,b.x,S.x,I.x)),N=Math.floor(Math.max(g.x,b.x,S.x,I.x)),j=1;for(let $=O-j;$<=N+j;$++)$!==0&&u.push(new c.b2($,n))}return u}getCameraFrustum(){return pi.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(n){const u=this.screenPointToLocation(this.centerPoint,n),g=n?n.getElevationForLngLatZoom(u,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(g)}setLocationAtPoint(n,u){const g=c.aj(this.elevation,this.center.lat),b=this.screenPointToMercatorCoordinateAtZ(u,g),S=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,g),I=c.a1.fromLngLat(n),O=new c.a1(I.x-(b.x-S.x),I.y-(b.y-S.y));this.setCenter(O==null?void 0:O.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(n,u){return u?this.coordinatePoint(c.a1.fromLngLat(n),u.getElevationForLngLatZoom(n,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(c.a1.fromLngLat(n))}screenPointToLocation(n,u){var g;return(g=this.screenPointToMercatorCoordinate(n,u))===null||g===void 0?void 0:g.toLngLat()}screenPointToMercatorCoordinate(n,u){if(u){const g=u.pointCoordinate(n);if(g!=null)return g}return this.screenPointToMercatorCoordinateAtZ(n)}screenPointToMercatorCoordinateAtZ(n,u){const g=u||0,b=[n.x,n.y,0,1],S=[n.x,n.y,1,1];c.aw(b,b,this._pixelMatrixInverse),c.aw(S,S,this._pixelMatrixInverse);const I=b[3],O=S[3],N=b[1]/I,j=S[1]/O,$=b[2]/I,X=S[2]/O,H=$===X?0:(g-$)/(X-$);return new c.a1(c.C.number(b[0]/I,S[0]/O,H)/this.worldSize,c.C.number(N,j,H)/this.worldSize,g)}coordinatePoint(n,u=0,g=this._pixelMatrix){const b=[n.x*this.worldSize,n.y*this.worldSize,u,1];return c.aw(b,b,g),new c.P(b[0]/b[3],b[1]/b[3])}getBounds(){const n=Math.max(0,this._helper._height/2-De(this));return new Fi().extend(this.screenPointToLocation(new c.P(0,n))).extend(this.screenPointToLocation(new c.P(this._helper._width,n))).extend(this.screenPointToLocation(new c.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new c.P(0,this._helper._height)))}isPointOnMapSurface(n,u){return u?u.pointCoordinate(n)!=null:n.y>this.height/2-De(this)}calculatePosMatrix(n,u=!1,g){var b;const S=(b=n.key)!==null&&b!==void 0?b:c.b3(n.wrap,n.canonical.z,n.canonical.z,n.canonical.x,n.canonical.y),I=u?this._alignedPosMatrixCache:this._posMatrixCache;if(I.has(S)){const j=I.get(S);return g?j.f32:j.f64}const O=$e(n,this.worldSize);c.O(O,u?this._alignedProjMatrix:this._viewProjMatrix,O);const N={f64:O,f32:new Float32Array(O)};return I.set(S,N),g?N.f32:N.f64}calculateFogMatrix(n){const u=n.key,g=this._fogMatrixCacheF32;if(g.has(u))return g.get(u);const b=$e(n,this.worldSize);return c.O(b,this._fogMatrix,b),g.set(u,new Float32Array(b)),g.get(u)}getConstrained(n,u){u=c.ah(+u,this.minZoom,this.maxZoom);const g={center:new c.S(n.lng,n.lat),zoom:u};let b=this._helper._lngRange;if(!this._helper._renderWorldCopies&&b===null){const Me=179.9999999999;b=[-Me,Me]}const S=this.tileSize*c.af(g.zoom);let I=0,O=S,N=0,j=S,$=0,X=0;const{x:H,y:J}=this.size;if(this._helper._latRange){const Me=this._helper._latRange;I=c.U(Me[1])*S,O=c.U(Me[0])*S,O-I<J&&($=J/(O-I))}b&&(N=c.aO(c.V(b[0])*S,0,S),j=c.aO(c.V(b[1])*S,0,S),j<N&&(j+=S),j-N<H&&(X=H/(j-N)));const{x:ae,y:_e}=fe(S,n);let me,ve;const we=Math.max(X||0,$||0);if(we){const Me=new c.P(X?(j+N)/2:ae,$?(O+I)/2:_e);return g.center=Se(S,Me).wrap(),g.zoom+=c.ak(we),g}if(this._helper._latRange){const Me=J/2;_e-Me<I&&(ve=I+Me),_e+Me>O&&(ve=O-Me)}if(b){const Me=(N+j)/2;let Ee=ae;this._helper._renderWorldCopies&&(Ee=c.aO(ae,Me-S/2,Me+S/2));const ze=H/2;Ee-ze<N&&(me=N+ze),Ee+ze>j&&(me=j-ze)}if(me!==void 0||ve!==void 0){const Me=new c.P(me??ae,ve??_e);g.center=Se(S,Me).wrap()}return g}calculateCenterFromCameraLngLatAlt(n,u,g,b){return this._helper.calculateCenterFromCameraLngLatAlt(n,u,g,b)}_calculateNearFarZIfNeeded(n,u,g){if(!this._helper.autoCalculateNearFarZ)return;const b=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),S=n-b*this._helper._pixelPerMeter/Math.cos(u),I=b<0?S:n,O=Math.PI/2+this.pitchInRadians,N=c.ae(this.fov)*(Math.abs(Math.cos(c.ae(this.roll)))*this.height+Math.abs(Math.sin(c.ae(this.roll)))*this.width)/this.height*(.5+g.y/this.height),j=Math.sin(N)*I/Math.sin(c.ah(Math.PI-O-N,.01,Math.PI-.01)),$=De(this),X=Math.atan($/this._helper.cameraToCenterDistance),H=c.ae(.75),J=X>H?2*X*(.5+g.y/(2*$)):H,ae=Math.sin(J)*I/Math.sin(c.ah(Math.PI-O-J,.01,Math.PI-.01)),_e=Math.min(j,ae);this._helper._farZ=1.01*(Math.cos(Math.PI/2-u)*_e+I),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const n=this.centerOffset,u=fe(this.worldSize,this.center),g=u.x,b=u.y;this._helper._pixelPerMeter=c.aj(1,this.center.lat)*this.worldSize;const S=c.ae(Math.min(this.pitch,le)),I=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(S));let O;this._calculateNearFarZIfNeeded(I,S,n),O=new Float64Array(16),c.b4(O,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),c.aq(this._invProjMatrix,O),O[8]=2*-n.x/this._helper._width,O[9]=2*n.y/this._helper._height,this._projectionMatrix=c.b5(O),c.N(O,O,[1,-1,1]),c.M(O,O,[0,0,-this._helper.cameraToCenterDistance]),c.b6(O,O,-this.rollInRadians),c.b7(O,O,this.pitchInRadians),c.b6(O,O,-this.bearingInRadians),c.M(O,O,[-g,-b,0]),this._mercatorMatrix=c.N([],O,[this.worldSize,this.worldSize,this.worldSize]),c.N(O,O,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=c.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,O),c.M(O,O,[0,0,-this.elevation]),this._viewProjMatrix=O,this._invViewProjMatrix=c.aq([],O);const N=[0,0,-1,1];c.aw(N,N,this._invViewProjMatrix),this._cameraPosition=[N[0]/N[3],N[1]/N[3],N[2]/N[3]],this._fogMatrix=new Float64Array(16),c.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,I,this._helper._farZ),this._fogMatrix[8]=2*-n.x/this.width,this._fogMatrix[9]=2*n.y/this.height,c.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),c.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),c.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),c.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),c.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),c.M(this._fogMatrix,this._fogMatrix,[-g,-b,0]),c.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),c.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=c.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,O);const j=this._helper._width%2/2,$=this._helper._height%2/2,X=Math.cos(this.bearingInRadians),H=Math.sin(-this.bearingInRadians),J=g-Math.round(g)+X*j+H*$,ae=b-Math.round(b)+X*$+H*j,_e=new Float64Array(O);if(c.M(_e,_e,[J>.5?J-1:J,ae>.5?ae-1:ae,0]),this._alignedProjMatrix=_e,O=c.aq(new Float64Array(16),this._pixelMatrix),!O)throw new Error("failed to invert matrix");this._pixelMatrixInverse=O,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const n=this.screenPointToMercatorCoordinate(new c.P(0,0)),u=[n.x*this.worldSize,n.y*this.worldSize,0,1];return c.aw(u,u,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const n=c.aj(1,this.center.lat)*this.worldSize;return et(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/n).toLngLat()}lngLatToCameraDepth(n,u){const g=c.a1.fromLngLat(n),b=[g.x*this.worldSize,g.y*this.worldSize,u,1];return c.aw(b,b,this._viewProjMatrix),b[2]/b[3]}getProjectionData(n){const{overscaledTileID:u,aligned:g,applyTerrainMatrix:b}=n,S=this._helper.getMercatorTileCoordinates(u),I=u?this.calculatePosMatrix(u,g,!0):null;let O;return O=u&&u.terrainRttPosMatrix32f&&b?u.terrainRttPosMatrix32f:I||c.b8(),{mainMatrix:O,tileMercatorCoords:S,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:O}}isLocationOccluded(n){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(n,u,g){return 1}transformLightDirection(n){return c.aT(n)}getRayDirectionFromPixel(n){throw new Error("Not implemented.")}projectTileCoordinates(n,u,g,b){const S=this.calculatePosMatrix(g);let I;b?(I=[n,u,b(n,u),1],c.aw(I,I,S)):(I=[n,u,0,1],Gr(I,I,S));const O=I[3];return{point:new c.P(I[0]/O,I[1]/O),signedDistanceFromCamera:O,isOccluded:!1}}populateCache(n){for(const u of n)this.calculatePosMatrix(u)}getMatrixForModel(n,u){const g=c.a1.fromLngLat(n,u),b=g.meterInMercatorCoordinateUnits(),S=c.b9();return c.M(S,S,[g.x,g.y,g.z]),c.b6(S,S,Math.PI),c.b7(S,S,Math.PI/2),c.N(S,S,[-b,b,b]),S}getProjectionDataForCustomLayer(n=!0){const u=new c.Z(0,0,0,0,0),g=this.getProjectionData({overscaledTileID:u,applyGlobeMatrix:n}),b=$e(u,this.worldSize);c.O(b,this._viewProjMatrix,b),g.tileMercatorCoords=[0,0,1,1];const S=[c.$,c.$,this.worldSize/this._helper.pixelsPerMeter],I=c.ba();return c.N(I,b,S),g.fallbackMatrix=I,g.mainMatrix=I,g}getFastPathSimpleProjectionMatrix(n){return this.calculatePosMatrix(n)}}function il(){c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function sr(T){if(T.useSlerp)if(T.k<1){const n=c.bb(T.startEulerAngles.roll,T.startEulerAngles.pitch,T.startEulerAngles.bearing),u=c.bb(T.endEulerAngles.roll,T.endEulerAngles.pitch,T.endEulerAngles.bearing),g=new Float64Array(4);c.bc(g,n,u,T.k);const b=c.bd(g);T.tr.setRoll(b.roll),T.tr.setPitch(b.pitch),T.tr.setBearing(b.bearing)}else T.tr.setRoll(T.endEulerAngles.roll),T.tr.setPitch(T.endEulerAngles.pitch),T.tr.setBearing(T.endEulerAngles.bearing);else T.tr.setRoll(c.C.number(T.startEulerAngles.roll,T.endEulerAngles.roll,T.k)),T.tr.setPitch(c.C.number(T.startEulerAngles.pitch,T.endEulerAngles.pitch,T.k)),T.tr.setBearing(c.C.number(T.startEulerAngles.bearing,T.endEulerAngles.bearing,T.k))}function cr(T,n,u,g,b){const S=b.padding,I=fe(b.worldSize,u.getNorthWest()),O=fe(b.worldSize,u.getNorthEast()),N=fe(b.worldSize,u.getSouthEast()),j=fe(b.worldSize,u.getSouthWest()),$=c.ae(-g),X=I.rotate($),H=O.rotate($),J=N.rotate($),ae=j.rotate($),_e=new c.P(Math.max(X.x,H.x,ae.x,J.x),Math.max(X.y,H.y,ae.y,J.y)),me=new c.P(Math.min(X.x,H.x,ae.x,J.x),Math.min(X.y,H.y,ae.y,J.y)),ve=_e.sub(me),we=(b.width-(S.left+S.right+n.left+n.right))/ve.x,Me=(b.height-(S.top+S.bottom+n.top+n.bottom))/ve.y;if(Me<0||we<0)return void il();const Ee=Math.min(c.ak(b.scale*Math.min(we,Me)),T.maxZoom),ze=c.P.convert(T.offset),Ve=new c.P((n.left-n.right)/2,(n.top-n.bottom)/2).rotate(c.ae(g)),Ie=ze.add(Ve).mult(b.scale/c.af(Ee));return{center:Se(b.worldSize,I.add(N).div(2).sub(Ie)),zoom:Ee,bearing:g}}class wr{get useGlobeControls(){return!1}handlePanInertia(n,u){return{easingOffset:n,easingCenter:u.center}}handleMapControlsRollPitchBearingZoom(n,u){n.bearingDelta&&u.setBearing(u.bearing+n.bearingDelta),n.pitchDelta&&u.setPitch(u.pitch+n.pitchDelta),n.rollDelta&&u.setRoll(u.roll+n.rollDelta),n.zoomDelta&&u.setZoom(u.zoom+n.zoomDelta)}handleMapControlsPan(n,u,g){n.around.distSqr(u.centerPoint)<.01||u.setLocationAtPoint(g,n.around)}cameraForBoxAndBearing(n,u,g,b,S){return cr(n,u,g,b,S)}handleJumpToCenterZoom(n,u){n.zoom!==(u.zoom!==void 0?+u.zoom:n.zoom)&&n.setZoom(+u.zoom),u.center!==void 0&&n.setCenter(c.S.convert(u.center))}handleEaseTo(n,u){const g=n.zoom,b=n.padding,S={roll:n.roll,pitch:n.pitch,bearing:n.bearing},I={roll:u.roll===void 0?n.roll:u.roll,pitch:u.pitch===void 0?n.pitch:u.pitch,bearing:u.bearing===void 0?n.bearing:u.bearing},O=u.zoom!==void 0,N=!n.isPaddingEqual(u.padding);let j=!1;const $=O?+u.zoom:n.zoom;let X=n.centerPoint.add(u.offsetAsPoint);const H=n.screenPointToLocation(X),{center:J,zoom:ae}=n.getConstrained(c.S.convert(u.center||H),$??g);Ia(n,J);const _e=fe(n.worldSize,H),me=fe(n.worldSize,J).sub(_e),ve=c.af(ae-g);return j=ae!==g,{easeFunc:we=>{if(j&&n.setZoom(c.C.number(g,ae,we)),c.be(S,I)||sr({startEulerAngles:S,endEulerAngles:I,tr:n,k:we,useSlerp:S.roll!=I.roll}),N&&(n.interpolatePadding(b,u.padding,we),X=n.centerPoint.add(u.offsetAsPoint)),u.around)n.setLocationAtPoint(u.around,u.aroundPoint);else{const Me=c.af(n.zoom-g),Ee=ae>g?Math.min(2,ve):Math.max(.5,ve),ze=Math.pow(Ee,1-we),Ve=Se(n.worldSize,_e.add(me.mult(we*ze)).mult(Me));n.setLocationAtPoint(n.renderWorldCopies?Ve.wrap():Ve,X)}},isZooming:j,elevationCenter:J}}handleFlyTo(n,u){const g=u.zoom!==void 0,b=n.zoom,S=n.getConstrained(c.S.convert(u.center||u.locationAtOffset),g?+u.zoom:b),I=S.center,O=S.zoom;Ia(n,I);const N=fe(n.worldSize,u.locationAtOffset),j=fe(n.worldSize,I).sub(N),$=j.mag(),X=c.af(O-b);let H;if(u.minZoom!==void 0){const J=Math.min(+u.minZoom,b,O),ae=n.getConstrained(I,J).zoom;H=c.af(ae-b)}return{easeFunc:(J,ae,_e,me)=>{n.setZoom(J===1?O:b+c.ak(ae));const ve=J===1?I:Se(n.worldSize,N.add(j.mult(_e)).mult(ae));n.setLocationAtPoint(n.renderWorldCopies?ve.wrap():ve,me)},scaleOfZoom:X,targetCenter:I,scaleOfMinZoom:H,pixelPathLength:$}}}class bn{constructor(n,u,g){this.blendFunction=n,this.blendColor=u,this.mask=g}}bn.Replace=[1,0],bn.disabled=new bn(bn.Replace,c.bf.transparent,[!1,!1,!1,!1]),bn.unblended=new bn(bn.Replace,c.bf.transparent,[!0,!0,!0,!0]),bn.alphaBlended=new bn([1,771],c.bf.transparent,[!0,!0,!0,!0]);const fa=2305;class fn{constructor(n,u,g){this.enable=n,this.mode=u,this.frontFace=g}}fn.disabled=new fn(!1,1029,fa),fn.backCCW=new fn(!0,1029,fa),fn.frontCCW=new fn(!0,1028,fa);class sn{constructor(n,u,g){this.func=n,this.mask=u,this.range=g}}sn.ReadOnly=!1,sn.ReadWrite=!0,sn.disabled=new sn(519,sn.ReadOnly,[0,1]);const na=7680;class qn{constructor(n,u,g,b,S,I){this.test=n,this.ref=u,this.mask=g,this.fail=b,this.depthFail=S,this.pass=I}}qn.disabled=new qn({func:519,mask:0},0,0,na,na,na);const zr=new WeakMap;function Yr(T){var n;if(zr.has(T))return zr.get(T);{const u=(n=T.getParameter(T.VERSION))===null||n===void 0?void 0:n.startsWith("WebGL 2.0");return zr.set(T,u),u}}class or{get awaitingQuery(){return!!this._readbackQueue}constructor(n){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=n;const u=n.context,g=u.gl;this._texFormat=g.RGBA,this._texType=g.UNSIGNED_BYTE;const b=new c.aL;b.emplaceBack(-1,-1),b.emplaceBack(2,-1),b.emplaceBack(-1,2);const S=new c.aN;S.emplaceBack(0,1,2),this._fullscreenTriangle=new Ja(u.createVertexBuffer(b,_s.members),u.createIndexBuffer(S),c.aM.simpleSegment(0,0,b.length,S.length)),this._resultBuffer=new Uint8Array(4),u.activeTexture.set(g.TEXTURE1);const I=g.createTexture();g.bindTexture(g.TEXTURE_2D,I),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.NEAREST),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.NEAREST),g.texImage2D(g.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=u.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(I),Yr(g)&&(this._pbo=g.createBuffer(),g.bindBuffer(g.PIXEL_PACK_BUFFER,this._pbo),g.bufferData(g.PIXEL_PACK_BUFFER,4,g.STREAM_READ),g.bindBuffer(g.PIXEL_PACK_BUFFER,null))}destroy(){const n=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),n.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(n,u){const g=this._updateCount;return this._readbackQueue?g>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():g>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(n,u),this._updateCount++,this._measuredError}_bindFramebuffer(){const n=this._cachedRenderContext.context,u=n.gl;n.activeTexture.set(u.TEXTURE1),u.bindTexture(u.TEXTURE_2D,this._fbo.colorAttachment.get()),n.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(n,u){const g=this._cachedRenderContext.context,b=g.gl;if(this._bindFramebuffer(),g.viewport.set([0,0,this._texWidth,this._texHeight]),g.clear({color:c.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(g,b.TRIANGLES,sn.disabled,qn.disabled,bn.unblended,fn.disabled,((S,I)=>({u_input:S,u_output_expected:I}))(n,u),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Yr(b)){b.bindBuffer(b.PIXEL_PACK_BUFFER,this._pbo),b.readBuffer(b.COLOR_ATTACHMENT0),b.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),b.bindBuffer(b.PIXEL_PACK_BUFFER,null);const S=b.fenceSync(b.SYNC_GPU_COMMANDS_COMPLETE,0);b.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:S}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const n=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Yr(n)){const u=n.clientWaitSync(this._readbackQueue.sync,0,0);if(u===n.WAIT_FAILED)return c.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(u===n.TIMEOUT_EXPIRED)return;n.bindBuffer(n.PIXEL_PACK_BUFFER,this._pbo),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),n.bindBuffer(n.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),n.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=or._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(n){let u=0;return u+=n[0]/256,u+=n[1]/65536,u+=n[2]/16777216,n[3]<127&&(u=-u),u/128}}const vs=c.$/128;function oo(T,n){const u=T.granularity!==void 0?Math.max(T.granularity,1):1,g=u+(T.generateBorders?2:0),b=u+(T.extendToNorthPole||T.generateBorders?1:0)+(T.extendToSouthPole||T.generateBorders?1:0),S=g+1,I=b+1,O=T.generateBorders?-1:0,N=T.generateBorders||T.extendToNorthPole?-1:0,j=u+(T.generateBorders?1:0),$=u+(T.generateBorders||T.extendToSouthPole?1:0),X=S*I,H=g*b*6,J=S*I>65536;if(J&&n==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const ae=J||n==="32bit",_e=new Int16Array(2*X);let me=0;for(let Me=N;Me<=$;Me++)for(let Ee=O;Ee<=j;Ee++){let ze=Ee/u*c.$;Ee===-1&&(ze=-vs),Ee===u+1&&(ze=c.$+vs);let Ve=Me/u*c.$;Me===-1&&(Ve=T.extendToNorthPole?c.bh:-vs),Me===u+1&&(Ve=T.extendToSouthPole?c.bi:c.$+vs),_e[me++]=ze,_e[me++]=Ve}const ve=ae?new Uint32Array(H):new Uint16Array(H);let we=0;for(let Me=0;Me<b;Me++)for(let Ee=0;Ee<g;Ee++){const ze=Ee+1+Me*S,Ve=Ee+(Me+1)*S,Ie=Ee+1+(Me+1)*S;ve[we++]=Ee+Me*S,ve[we++]=Ve,ve[we++]=ze,ve[we++]=ze,ve[we++]=Ve,ve[we++]=Ie}return{vertices:_e.buffer.slice(0),indices:ve.buffer.slice(0),uses32bitIndices:ae}}const bs=new c.aK({fill:new c.bj(128,2),line:new c.bj(512,0),tile:new c.bj(128,32),stencil:new c.bj(128,1),circle:3});class Wn{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Hi.projectionGlobe}get vertexShaderPreludeCode(){return Hi.projectionMercator.vertexSource}get subdivisionGranularity(){return bs}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(n){this._errorMeasurement||(this._errorMeasurement=new or(n));const u=c.U(this._errorQueryLatitudeDegrees),g=2*Math.atan(Math.exp(Math.PI-u*Math.PI*2))-.5*Math.PI,b=this._errorMeasurement.updateErrorLoop(u,g),S=ee.now();b!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=b,this._errorMeasurementLastChangeTime=S);const I=Math.min(Math.max((S-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=c.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,c.bl(I))}_getMeshKey(n){return`${n.granularity.toString(36)}_${n.generateBorders?"b":""}${n.extendToNorthPole?"n":""}${n.extendToSouthPole?"s":""}`}getMeshFromTileID(n,u,g,b,S){const I=(S==="stencil"?bs.stencil:bs.tile).getGranularityForZoomLevel(u.z);return this._getMesh(n,{granularity:I,generateBorders:g,extendToNorthPole:u.y===0&&b,extendToSouthPole:u.y===(1<<u.z)-1&&b})}_getMesh(n,u){const g=this._getMeshKey(u);if(g in this._tileMeshCache)return this._tileMeshCache[g];const b=(function(S,I){const O=oo(I,"16bit"),N=c.aL.deserialize({arrayBuffer:O.vertices,length:O.vertices.byteLength/2/2}),j=c.aN.deserialize({arrayBuffer:O.indices,length:O.indices.byteLength/2/3});return new Ja(S.createVertexBuffer(N,_s.members),S.createIndexBuffer(j),c.aM.simpleSegment(0,0,N.length,j.length))})(n,u);return this._tileMeshCache[g]=b,b}recalculate(n){}hasTransition(){const n=ee.now();let u=!1;return u=u||(n-this._errorMeasurementLastChangeTime)/1e3<.7,u=u||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,u}setErrorQueryLatitudeDegrees(n){this._errorQueryLatitudeDegrees=n}}const Co=new c.r({type:new c.D(c.v.projection.type)});class ia extends c.E{constructor(n){super(),this._transitionable=new c.t(Co),this.setProjection(n),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.F(0)),this._mercatorProjection=new Ln,this._verticalPerspectiveProjection=new Wn}get transitionState(){const n=this.properties.get("type");if(typeof n=="string"&&n==="mercator")return 0;if(typeof n=="string"&&n==="vertical-perspective")return 1;if(n instanceof c.bm){if(n.from==="vertical-perspective"&&n.to==="mercator")return 1-n.transition;if(n.from==="mercator"&&n.to==="vertical-perspective")return n.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(n){this._mercatorProjection.updateGPUdependent(n),this._verticalPerspectiveProjection.updateGPUdependent(n)}getMeshFromTileID(n,u,g,b,S){return this.currentProjection.getMeshFromTileID(n,u,g,b,S)}setProjection(n){this._transitionable.setValue("type",(n==null?void 0:n.type)||"mercator")}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}setErrorQueryLatitudeDegrees(n){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(n),this._mercatorProjection.setErrorQueryLatitudeDegrees(n)}}function Ma(T){const n=xs(T.worldSize,T.center.lat);return 2*Math.PI*n}function Pa(T,n,u,g,b){const S=1/(1<<b),I=n/c.$*S+g*S,O=c.bo((T/c.$*S+u*S)*Math.PI*2+Math.PI,2*Math.PI),N=2*Math.atan(Math.exp(Math.PI-I*Math.PI*2))-.5*Math.PI,j=Math.cos(N),$=new Float64Array(3);return $[0]=Math.sin(O)*j,$[1]=Math.sin(N),$[2]=Math.cos(O)*j,$}function Or(T){return(function(n,u){const g=Math.cos(u),b=new Float64Array(3);return b[0]=Math.sin(n)*g,b[1]=Math.sin(u),b[2]=Math.cos(n)*g,b})(T.lng*Math.PI/180,T.lat*Math.PI/180)}function xs(T,n){return T/(2*Math.PI)/Math.cos(n*Math.PI/180)}function $l(T){const n=Math.asin(T[1])/Math.PI*180,u=Math.sqrt(T[0]*T[0]+T[2]*T[2]);if(u>1e-6){const g=T[0]/u,b=Math.acos(T[2]/u),S=(g>0?b:-b)/Math.PI*180;return new c.S(c.aO(S,-180,180),n)}return new c.S(0,n)}function Io(T){return Math.cos(T*Math.PI/180)}function Xi(T,n){const u=Io(T),g=Io(n);return c.ak(g/u)}function Vu(T,n){const u=T.rotate(n.bearingInRadians),g=n.zoom+Xi(n.center.lat,0),b=c.bk(1/Io(n.center.lat),1/Io(Math.min(Math.abs(n.center.lat),60)),c.bn(g,7,3,0,1)),S=360/Ma({worldSize:n.worldSize,center:{lat:n.center.lat}});return new c.S(n.center.lng-u.x*S*b,c.ah(n.center.lat+u.y*S,-c.ai,c.ai))}function rl(T){const n=.5*T,u=Math.sin(n),g=Math.cos(n);return Math.log(u+g)-Math.log(g-u)}function Gl(T,n,u,g){const b=T.lat+u*g;if(Math.abs(u)>1){const S=(Math.sign(T.lat+u)!==Math.sign(T.lat)?-Math.abs(T.lat):Math.abs(T.lat))*Math.PI/180,I=Math.abs(T.lat+u)*Math.PI/180,O=rl(S+g*(I-S)),N=rl(S),j=rl(I);return new c.S(T.lng+n*((O-N)/(j-N)),b)}return new c.S(T.lng+n*g,b)}class Hs{constructor(n){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=n}swapBuffers(){if(!this._hadAnyChanges)return;const n=this._cachePrevious;this._cachePrevious=this._cache,this._cache=n,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(n,u,g,b){const S=`${n.z}_${n.x}_${n.y}_${b!=null&&b.terrain?"t":""}`,I=this._cache.get(S);if(I)return I;const O=this._cachePrevious.get(S);if(O)return this._cache.set(S,O),O;const N=this._boundingVolumeFactory(n,u,g,b);return this._cache.set(S,N),this._hadAnyChanges=!0,N}}class Ll{constructor(n,u,g,b){this.min=g,this.max=b,this.points=n,this.planes=u}static fromAabb(n,u){const g=[];for(let b=0;b<8;b++)g.push([1&~b?n[0]:u[0],(b>>1&1)==1?u[1]:n[1],(b>>2&1)==1?u[2]:n[2]]);return new Ll(g,[[-1,0,0,u[0]],[1,0,0,-n[0]],[0,-1,0,u[1]],[0,1,0,-n[1]],[0,0,-1,u[2]],[0,0,1,-n[2]]],n,u)}static fromCenterSizeAngles(n,u,g){const b=c.br([],g[0],g[1],g[2]),S=c.bs([],[u[0],0,0],b),I=c.bs([],[0,u[1],0],b),O=c.bs([],[0,0,u[2]],b),N=[...n],j=[...n];for(let X=0;X<8;X++)for(let H=0;H<3;H++){const J=n[H]+S[H]*(1&~X?-1:1)+I[H]*((X>>1&1)==1?1:-1)+O[H]*((X>>2&1)==1?1:-1);N[H]=Math.min(N[H],J),j[H]=Math.max(j[H],J)}const $=[];for(let X=0;X<8;X++){const H=[...n];c.aS(H,H,c.aR([],S,1&~X?-1:1)),c.aS(H,H,c.aR([],I,(X>>1&1)==1?1:-1)),c.aS(H,H,c.aR([],O,(X>>2&1)==1?1:-1)),$.push(H)}return new Ll($,[[...S,-c.aX(S,$[0])],[...I,-c.aX(I,$[0])],[...O,-c.aX(O,$[0])],[-S[0],-S[1],-S[2],-c.aX(S,$[7])],[-I[0],-I[1],-I[2],-c.aX(I,$[7])],[-O[0],-O[1],-O[2],-c.aX(O,$[7])]],N,j)}intersectsFrustum(n){let u=!0;const g=this.points.length,b=this.planes.length,S=n.planes.length,I=n.points.length;for(let O=0;O<S;O++){const N=n.planes[O];let j=0;for(let $=0;$<g;$++){const X=this.points[$];N[0]*X[0]+N[1]*X[1]+N[2]*X[2]+N[3]>=0&&j++}if(j===0)return 0;j<g&&(u=!1)}if(u)return 2;for(let O=0;O<b;O++){const N=this.planes[O];let j=0;for(let $=0;$<I;$++){const X=n.points[$];N[0]*X[0]+N[1]*X[1]+N[2]*X[2]+N[3]>=0&&j++}if(j===0)return 0}return 1}intersectsPlane(n){const u=this.points.length;let g=0;for(let b=0;b<u;b++){const S=this.points[b];n[0]*S[0]+n[1]*S[1]+n[2]*S[2]+n[3]>=0&&g++}return g===u?2:g===0?0:1}}function lr(T,n,u){const g=T-n;return g<0?-g:Math.max(0,g-u)}function es(T,n,u,g,b){const S=T-u;let I;return I=S<0?Math.min(-S,1+S-b):S>1?Math.min(Math.max(S-b,0),1-S):0,Math.max(I,lr(n,g,b))}class ws{constructor(){this._boundingVolumeCache=new Hs(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(n,u,g,b){const S=1<<g.z,I=1/S,O=g.x/S,N=g.y/S;let j=2;return j=Math.min(j,es(n,u,O,N,I)),j=Math.min(j,es(n,u,O+.5,-N-I,I)),j=Math.min(j,es(n,u,O+.5,2-N-I,I)),j}getWrap(n,u,g){const b=1<<u.z,S=1/b,I=u.x/b,O=lr(n.x,I,S),N=lr(n.x,I-1,S),j=lr(n.x,I+1,S),$=Math.min(O,N,j);return $===j?1:$===N?-1:0}allowVariableZoom(n,u){return tn(n,u)>4}allowWorldCopies(){return!1}getTileBoundingVolume(n,u,g,b){return this._boundingVolumeCache.getTileBoundingVolume(n,u,g,b)}_computeTileBoundingVolume(n,u,g,b){var S,I;let O=0,N=0;if(b!=null&&b.terrain){const j=new c.Z(n.z,u,n.z,n.x,n.y),$=b.terrain.getMinMaxElevation(j);O=(S=$.minElevation)!==null&&S!==void 0?S:Math.min(0,g),N=(I=$.maxElevation)!==null&&I!==void 0?I:Math.max(0,g)}if(O/=c.bu,N/=c.bu,O+=1,N+=1,n.z<=0)return Ll.fromAabb([-N,-N,-N],[N,N,N]);if(n.z===1)return Ll.fromAabb([n.x===0?-N:0,n.y===0?0:-N,-N],[n.x===0?0:N,n.y===0?N:0,N]);{const j=[Pa(0,0,n.x,n.y,n.z),Pa(c.$,0,n.x,n.y,n.z),Pa(c.$,c.$,n.x,n.y,n.z),Pa(0,c.$,n.x,n.y,n.z)],$=[];for(const st of j)$.push(c.aR([],st,N));if(N!==O)for(const st of j)$.push(c.aR([],st,O));n.y===0&&$.push([0,1,0]),n.y===(1<<n.z)-1&&$.push([0,-1,0]);const X=[1,1,1],H=[-1,-1,-1];for(const st of $)for(let lt=0;lt<3;lt++)X[lt]=Math.min(X[lt],st[lt]),H[lt]=Math.max(H[lt],st[lt]);const J=Pa(c.$/2,c.$/2,n.x,n.y,n.z),ae=c.aW([],[0,1,0],J);c.aV(ae,ae);const _e=c.aW([],J,ae);c.aV(_e,_e);const me=c.aW([],j[2],j[1]);c.aV(me,me);const ve=c.aW([],j[0],j[3]);c.aV(ve,ve),$.push(c.aR([],J,N)),n.y>=(1<<n.z)/2&&$.push(c.aR([],Pa(c.$/2,0,n.x,n.y,n.z),N)),n.y<(1<<n.z)/2&&$.push(c.aR([],Pa(c.$/2,c.$,n.x,n.y,n.z),N));const we=kl(J,$),Me=kl(_e,$),Ee=[-J[0],-J[1],-J[2],we.max],ze=[J[0],J[1],J[2],-we.min],Ve=[-_e[0],-_e[1],-_e[2],Me.max],Ie=[_e[0],_e[1],_e[2],-Me.min],Ye=[...me,0],ct=[...ve,0],rt=[];return n.y===0?rt.push(c.bt(ct,Ye,Ee),c.bt(ct,Ye,ze)):rt.push(c.bt(Ve,Ye,Ee),c.bt(Ve,Ye,ze),c.bt(Ve,ct,Ee),c.bt(Ve,ct,ze)),n.y===(1<<n.z)-1?rt.push(c.bt(ct,Ye,Ee),c.bt(ct,Ye,ze)):rt.push(c.bt(Ie,Ye,Ee),c.bt(Ie,Ye,ze),c.bt(Ie,ct,Ee),c.bt(Ie,ct,ze)),new Ll(rt,[Ee,ze,Ve,Ie,Ye,ct],X,H)}}}function kl(T,n){let u=1/0,g=-1/0;for(const b of n){const S=c.aX(T,b);u=Math.min(u,S),g=Math.max(g,S)}return{min:u,max:g}}class al{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,u,g){return this._helper.interpolatePadding(n,u,g)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,u){this._helper.resize(n,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}overrideNearFarZ(n,u){this._helper.overrideNearFarZ(n,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(n){}constructor(){this._cachedClippingPlane=c.bv(),this._projectionMatrix=c.b9(),this._globeViewProjMatrix32f=c.b8(),this._globeViewProjMatrixNoCorrection=c.b9(),this._globeViewProjMatrixNoCorrectionInverted=c.b9(),this._globeProjMatrixInverted=c.b9(),this._cameraPosition=c.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Wi({calcMatrices:()=>{this._calcMatrices()},getConstrained:(n,u)=>this.getConstrained(n,u)}),this._coveringTilesDetailsProvider=new ws}clone(){const n=new al;return n.apply(this),n}apply(n,u){this._globeLatitudeErrorCorrectionRadians=u||0,this._helper.apply(n)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const n=c.bp();return n[0]=this._cameraPosition[0],n[1]=this._cameraPosition[1],n[2]=this._cameraPosition[2],n}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(n){const{overscaledTileID:u,applyGlobeMatrix:g}=n,b=this._helper.getMercatorTileCoordinates(u);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:b,clippingPlane:this._cachedClippingPlane,projectionTransition:g?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(n){const u=this.pitchInRadians,g=this.cameraToCenterDistance/n,b=Math.sin(u)*g,S=Math.cos(u)*g+1,I=1/Math.sqrt(b*b+S*S)*1;let O=-b,N=S;const j=Math.sqrt(O*O+N*N);O/=j,N/=j;const $=[0,O,N];c.bw($,$,[0,0,0],-this.bearingInRadians),c.bx($,$,[0,0,0],-1*this.center.lat*Math.PI/180),c.by($,$,[0,0,0],this.center.lng*Math.PI/180);const X=1/c.aZ($);return c.aR($,$,X),[...$,-I*X]}isLocationOccluded(n){return!this.isSurfacePointVisible(Or(n))}transformLightDirection(n){const u=this._helper._center.lng*Math.PI/180,g=this._helper._center.lat*Math.PI/180,b=Math.cos(g),S=[Math.sin(u)*b,Math.sin(g),Math.cos(u)*b],I=[S[2],0,-S[0]],O=[0,0,0];c.aW(O,I,S),c.aV(I,I),c.aV(O,O);const N=[0,0,0];return c.aV(N,[I[0]*n[0]+O[0]*n[1]+S[0]*n[2],I[1]*n[0]+O[1]*n[1]+S[1]*n[2],I[2]*n[0]+O[2]*n[1]+S[2]*n[2]]),N}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(n,u,g){const b=(function(O,N,j){const $=1/(1<<j.z);return new c.a1(O/c.$*$+j.x*$,N/c.$*$+j.y*$)})(n,u,g.canonical),S=(I=b.y,[c.bo(b.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-I*Math.PI*2))-.5*Math.PI]);var I;return this.getCircleRadiusCorrection()/Math.cos(S[1])}projectTileCoordinates(n,u,g,b){const S=g.canonical,I=Pa(n,u,S.x,S.y,S.z),O=1+(b?b(n,u):0)/c.bu,N=[I[0]*O,I[1]*O,I[2]*O,1];c.aw(N,N,this._globeViewProjMatrixNoCorrection);const j=this._cachedClippingPlane,$=j[0]*I[0]+j[1]*I[1]+j[2]*I[2]+j[3]<0;return{point:new c.P(N[0]/N[3],N[1]/N[3]),signedDistanceFromCamera:N[3],isOccluded:$}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const n=xs(this.worldSize,this.center.lat),u=c.ba(),g=c.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*n),c.b4(u,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const b=this.centerOffset;u[8]=2*-b.x/this._helper._width,u[9]=2*b.y/this._helper._height,this._projectionMatrix=c.b5(u),this._globeProjMatrixInverted=c.ba(),c.aq(this._globeProjMatrixInverted,u),c.M(u,u,[0,0,-this.cameraToCenterDistance]),c.b6(u,u,this.rollInRadians),c.b7(u,u,-this.pitchInRadians),c.b6(u,u,this.bearingInRadians),c.M(u,u,[0,0,-n]);const S=c.bp();S[0]=n,S[1]=n,S[2]=n,c.b7(g,u,this.center.lat*Math.PI/180),c.bz(g,g,-this.center.lng*Math.PI/180),c.N(g,g,S),this._globeViewProjMatrixNoCorrection=g,c.b7(u,u,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),c.bz(u,u,-this.center.lng*Math.PI/180),c.N(u,u,S),this._globeViewProjMatrix32f=new Float32Array(u),this._globeViewProjMatrixNoCorrectionInverted=c.ba(),c.aq(this._globeViewProjMatrixNoCorrectionInverted,g);const I=c.bp();this._cameraPosition=c.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/n,c.bw(this._cameraPosition,this._cameraPosition,I,-this.rollInRadians),c.bx(this._cameraPosition,this._cameraPosition,I,this.pitchInRadians),c.bw(this._cameraPosition,this._cameraPosition,I,-this.bearingInRadians),c.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),c.bx(this._cameraPosition,this._cameraPosition,I,-this.center.lat*Math.PI/180),c.by(this._cameraPosition,this._cameraPosition,I,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(n);const O=c.b5(this._globeViewProjMatrixNoCorrectionInverted);c.N(O,O,[1,1,-1]),this._cachedFrustum=pi.fromInvProjectionMatrix(O,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(n){c.w("calculateFogMatrix is not supported on globe projection.");const u=c.ba();return c.ag(u),u}getVisibleUnwrappedCoordinates(n){return[new c.b2(0,n)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(n){n&&c.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(n,u){if(!this._globeViewProjMatrixNoCorrection)return 1;const g=Or(n);c.aR(g,g,1+u/c.bu);const b=c.bv();return c.aw(b,[g[0],g[1],g[2],1],this._globeViewProjMatrixNoCorrection),b[2]/b[3]}populateCache(n){}getBounds(){const n=.5*this.width,u=.5*this.height,g=[new c.P(0,0),new c.P(n,0),new c.P(this.width,0),new c.P(this.width,u),new c.P(this.width,this.height),new c.P(n,this.height),new c.P(0,this.height),new c.P(0,u)],b=[];for(const X of g)b.push(this.unprojectScreenPoint(X));let S=0,I=0,O=0,N=0;const j=this.center;for(const X of b){const H=c.bA(j.lng,X.lng),J=c.bA(j.lat,X.lat);H<I&&(I=H),H>S&&(S=H),J<N&&(N=J),J>O&&(O=J)}const $=[j.lng+I,j.lat+N,j.lng+S,j.lat+O];return this.isSurfacePointOnScreen([0,1,0])&&($[3]=90,$[0]=-180,$[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&($[1]=-90,$[0]=-180,$[2]=180),new Fi($)}getConstrained(n,u){const g=c.ah(n.lat,-c.ai,c.ai),b=c.ah(+u,this.minZoom+Xi(0,g),this.maxZoom);return{center:new c.S(n.lng,g),zoom:b}}calculateCenterFromCameraLngLatAlt(n,u,g,b){return this._helper.calculateCenterFromCameraLngLatAlt(n,u,g,b)}setLocationAtPoint(n,u){const g=Or(this.unprojectScreenPoint(u)),b=Or(n),S=c.bp();c.bB(S);const I=c.bp();c.by(I,g,S,-this.center.lng*Math.PI/180),c.bx(I,I,S,this.center.lat*Math.PI/180);const O=b[0]*b[0]+b[2]*b[2],N=I[0]*I[0];if(O<N)return;const j=Math.sqrt(O-N),$=-j,X=c.bC(b[0],b[2],I[0],j),H=c.bC(b[0],b[2],I[0],$),J=c.bp();c.by(J,b,S,-X);const ae=c.bC(J[1],J[2],I[1],I[2]),_e=c.bp();c.by(_e,b,S,-H);const me=c.bC(_e[1],_e[2],I[1],I[2]),ve=.5*Math.PI,we=ae>=-ve&&ae<=ve,Me=me>=-ve&&me<=ve;let Ee,ze;if(we&&Me){const ct=this.center.lng*Math.PI/180,rt=this.center.lat*Math.PI/180;c.bD(X,ct)+c.bD(ae,rt)<c.bD(H,ct)+c.bD(me,rt)?(Ee=X,ze=ae):(Ee=H,ze=me)}else if(we)Ee=X,ze=ae;else{if(!Me)return;Ee=H,ze=me}const Ve=Ee/Math.PI*180,Ie=ze/Math.PI*180,Ye=this.center.lat;this.setCenter(new c.S(Ve,c.ah(Ie,-90,90))),this.setZoom(this.zoom+Xi(Ye,this.center.lat))}locationToScreenPoint(n,u){const g=Or(n);if(u){const b=u.getElevationForLngLatZoom(n,this._helper._tileZoom);c.aR(g,g,1+b/c.bu)}return this._projectSurfacePointToScreen(g)}_projectSurfacePointToScreen(n){const u=c.bv();return c.aw(u,[...n,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],new c.P((.5*u[0]+.5)*this.width,(.5*-u[1]+.5)*this.height)}screenPointToMercatorCoordinate(n,u){if(u){const g=u.pointCoordinate(n);if(g)return g}return c.a1.fromLngLat(this.unprojectScreenPoint(n))}screenPointToLocation(n,u){var g;return(g=this.screenPointToMercatorCoordinate(n,u))===null||g===void 0?void 0:g.toLngLat()}isPointOnMapSurface(n,u){const g=this._cameraPosition,b=this.getRayDirectionFromPixel(n);return!!this.rayPlanetIntersection(g,b)}getRayDirectionFromPixel(n){const u=c.bv();u[0]=n.x/this.width*2-1,u[1]=-1*(n.y/this.height*2-1),u[2]=1,u[3]=1,c.aw(u,u,this._globeViewProjMatrixNoCorrectionInverted),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3];const g=c.bp();g[0]=u[0]-this._cameraPosition[0],g[1]=u[1]-this._cameraPosition[1],g[2]=u[2]-this._cameraPosition[2];const b=c.bp();return c.aV(b,g),b}isSurfacePointVisible(n){const u=this._cachedClippingPlane;return u[0]*n[0]+u[1]*n[1]+u[2]*n[2]+u[3]>=0}isSurfacePointOnScreen(n){if(!this.isSurfacePointVisible(n))return!1;const u=c.bv();return c.aw(u,[...n,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3],u[0]>-1&&u[0]<1&&u[1]>-1&&u[1]<1&&u[2]>-1&&u[2]<1}rayPlanetIntersection(n,u){const g=c.aX(n,u),b=c.bp(),S=c.bp();c.aR(S,u,g),c.aU(b,n,S);const I=1-c.aX(b,b);if(I<0)return null;const O=c.aX(n,n)-1,N=-g+(g<0?1:-1)*Math.sqrt(I),j=O/N,$=N;return{tMin:Math.min(j,$),tMax:Math.max(j,$)}}unprojectScreenPoint(n){const u=this._cameraPosition,g=this.getRayDirectionFromPixel(n),b=this.rayPlanetIntersection(u,g);if(b){const $=c.bp();c.aS($,u,[g[0]*b.tMin,g[1]*b.tMin,g[2]*b.tMin]);const X=c.bp();return c.aV(X,$),$l(X)}const S=this._cachedClippingPlane,I=S[0]*g[0]+S[1]*g[1]+S[2]*g[2],O=-c.b1(S,u)/I,N=c.bp();if(O>0)c.aS(N,u,[g[0]*O,g[1]*O,g[2]*O]);else{const $=c.bp();c.aS($,u,[2*g[0],2*g[1],2*g[2]]);const X=c.b1(this._cachedClippingPlane,$);c.aU(N,$,[this._cachedClippingPlane[0]*X,this._cachedClippingPlane[1]*X,this._cachedClippingPlane[2]*X])}const j=(function($){const X=c.bp();return X[0]=$[0]*-$[3],X[1]=$[1]*-$[3],X[2]=$[2]*-$[3],{center:X,radius:Math.sqrt(1-$[3]*$[3])}})(S);return $l((function($,X,H){const J=c.bp();c.aU(J,H,$);const ae=c.bp();return c.bq(ae,$,J,X/c.a$(J)),ae})(j.center,j.radius,N))}getMatrixForModel(n,u){const g=c.S.convert(n),b=1/c.bu,S=c.b9();return c.bz(S,S,g.lng/180*Math.PI),c.b7(S,S,-g.lat/180*Math.PI),c.M(S,S,[0,0,1+u/c.bu]),c.b7(S,S,.5*Math.PI),c.N(S,S,[b,b,b]),S}getProjectionDataForCustomLayer(n=!0){const u=this.getProjectionData({overscaledTileID:new c.Z(0,0,0,0,0),applyGlobeMatrix:n});return u.tileMercatorCoords=[0,0,1,1],u}getFastPathSimpleProjectionMatrix(n){}}class lo{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,u,g){return this._helper.interpolatePadding(n,u,g)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,u,g=!0){this._helper.resize(n,u,g)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}overrideNearFarZ(n,u){this._helper.overrideNearFarZ(n,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(n,u){this._globeness=n,this._globeLatitudeErrorCorrectionRadians=u,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Wi({calcMatrices:()=>{this._calcMatrices()},getConstrained:(n,u)=>this.getConstrained(n,u)}),this._globeness=1,this._mercatorTransform=new xn,this._verticalPerspectiveTransform=new al}clone(){const n=new lo;return n._globeness=this._globeness,n._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,n.apply(this),n}apply(n){this._helper.apply(n),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(n){const u=this._mercatorTransform.getProjectionData(n),g=this._verticalPerspectiveTransform.getProjectionData(n);return{mainMatrix:this.isGlobeRendering?g.mainMatrix:u.mainMatrix,clippingPlane:g.clippingPlane,tileMercatorCoords:g.tileMercatorCoords,projectionTransition:n.applyGlobeMatrix?this._globeness:0,fallbackMatrix:u.fallbackMatrix}}isLocationOccluded(n){return this.currentTransform.isLocationOccluded(n)}transformLightDirection(n){return this.currentTransform.transformLightDirection(n)}getPixelScale(){return c.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return c.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(n,u,g){const b=this._mercatorTransform.getPitchedTextCorrection(n,u,g),S=this._verticalPerspectiveTransform.getPitchedTextCorrection(n,u,g);return c.bk(b,S,this._globeness)}projectTileCoordinates(n,u,g,b){return this.currentTransform.projectTileCoordinates(n,u,g,b)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(n){return this.currentTransform.calculateFogMatrix(n)}getVisibleUnwrappedCoordinates(n){return this.currentTransform.getVisibleUnwrappedCoordinates(n)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(n){this._mercatorTransform.recalculateZoomAndCenter(n),this._verticalPerspectiveTransform.recalculateZoomAndCenter(n)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(n,u){return this.currentTransform.lngLatToCameraDepth(n,u)}populateCache(n){this._mercatorTransform.populateCache(n),this._verticalPerspectiveTransform.populateCache(n)}getBounds(){return this.currentTransform.getBounds()}getConstrained(n,u){return this.currentTransform.getConstrained(n,u)}calculateCenterFromCameraLngLatAlt(n,u,g,b){return this._helper.calculateCenterFromCameraLngLatAlt(n,u,g,b)}setLocationAtPoint(n,u){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(n,u),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(n,u),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(n,u){return this.currentTransform.locationToScreenPoint(n,u)}screenPointToMercatorCoordinate(n,u){return this.currentTransform.screenPointToMercatorCoordinate(n,u)}screenPointToLocation(n,u){return this.currentTransform.screenPointToLocation(n,u)}isPointOnMapSurface(n,u){return this.currentTransform.isPointOnMapSurface(n,u)}getRayDirectionFromPixel(n){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(n)}getMatrixForModel(n,u){return this.currentTransform.getMatrixForModel(n,u)}getProjectionDataForCustomLayer(n=!0){const u=this._mercatorTransform.getProjectionDataForCustomLayer(n);if(!this.isGlobeRendering)return u;const g=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(n);return g.fallbackMatrix=u.mainMatrix,g}getFastPathSimpleProjectionMatrix(n){return this.currentTransform.getFastPathSimpleProjectionMatrix(n)}}class Ai{get useGlobeControls(){return!0}handlePanInertia(n,u){const g=Vu(n,u);return Math.abs(g.lng-u.center.lng)>180&&(g.lng=u.center.lng+179.5*Math.sign(g.lng-u.center.lng)),{easingCenter:g,easingOffset:new c.P(0,0)}}handleMapControlsRollPitchBearingZoom(n,u){const g=n.around,b=u.screenPointToLocation(g);n.bearingDelta&&u.setBearing(u.bearing+n.bearingDelta),n.pitchDelta&&u.setPitch(u.pitch+n.pitchDelta),n.rollDelta&&u.setRoll(u.roll+n.rollDelta);const S=u.zoom;n.zoomDelta&&u.setZoom(u.zoom+n.zoomDelta);const I=u.zoom-S;if(I===0)return;const O=c.bA(u.center.lng,b.lng),N=O/(Math.abs(O/180)+1),j=c.bA(u.center.lat,b.lat),$=u.getRayDirectionFromPixel(g),X=u.cameraPosition,H=-1*c.aX(X,$),J=c.bp();c.aS(J,X,[$[0]*H,$[1]*H,$[2]*H]);const ae=c.aZ(J)-1,_e=Math.exp(.5*-Math.max(ae-.3,0)),me=xs(u.worldSize,u.center.lat)/Math.min(u.width,u.height),ve=c.bn(me,.9,.5,1,.25),we=(1-c.af(-I))*Math.min(_e,ve),Me=u.center.lat,Ee=u.zoom,ze=new c.S(u.center.lng+N*we,c.ah(u.center.lat+j*we,-c.ai,c.ai));u.setLocationAtPoint(b,g);const Ve=u.center,Ie=c.bn(Math.abs(O),45,85,0,1),Ye=c.bn(me,.75,.35,0,1),ct=Math.pow(Math.max(Ie,Ye),.25),rt=c.bA(Ve.lng,ze.lng),st=c.bA(Ve.lat,ze.lat);u.setCenter(new c.S(Ve.lng+rt*ct,Ve.lat+st*ct).wrap()),u.setZoom(Ee+Xi(Me,u.center.lat))}handleMapControlsPan(n,u,g){if(!n.panDelta)return;const b=u.center.lat,S=u.zoom;u.setCenter(Vu(n.panDelta,u).wrap()),u.setZoom(S+Xi(b,u.center.lat))}cameraForBoxAndBearing(n,u,g,b,S){const I=cr(n,u,g,b,S),O=u.left/S.width*2-1,N=(S.width-u.right)/S.width*2-1,j=u.top/S.height*-2+1,$=(S.height-u.bottom)/S.height*-2+1,X=c.bA(g.getWest(),g.getEast())<0,H=X?g.getEast():g.getWest(),J=X?g.getWest():g.getEast(),ae=Math.max(g.getNorth(),g.getSouth()),_e=Math.min(g.getNorth(),g.getSouth()),me=H+.5*c.bA(H,J),ve=ae+.5*c.bA(ae,_e),we=S.clone();we.setCenter(I.center),we.setBearing(I.bearing),we.setPitch(0),we.setRoll(0),we.setZoom(I.zoom);const Me=we.modelViewProjectionMatrix,Ee=[Or(g.getNorthWest()),Or(g.getNorthEast()),Or(g.getSouthWest()),Or(g.getSouthEast()),Or(new c.S(J,ve)),Or(new c.S(H,ve)),Or(new c.S(me,ae)),Or(new c.S(me,_e))],ze=Or(I.center);let Ve=Number.POSITIVE_INFINITY;for(const Ie of Ee)O<0&&(Ve=Ai.getLesserNonNegativeNonNull(Ve,Ai.solveVectorScale(Ie,ze,Me,"x",O))),N>0&&(Ve=Ai.getLesserNonNegativeNonNull(Ve,Ai.solveVectorScale(Ie,ze,Me,"x",N))),j>0&&(Ve=Ai.getLesserNonNegativeNonNull(Ve,Ai.solveVectorScale(Ie,ze,Me,"y",j))),$<0&&(Ve=Ai.getLesserNonNegativeNonNull(Ve,Ai.solveVectorScale(Ie,ze,Me,"y",$)));if(Number.isFinite(Ve)&&Ve!==0)return I.zoom=we.zoom+c.ak(Ve),I;il()}handleJumpToCenterZoom(n,u){const g=n.center.lat,b=n.getConstrained(u.center?c.S.convert(u.center):n.center,n.zoom).center;n.setCenter(b.wrap());const S=u.zoom!==void 0?+u.zoom:n.zoom+Xi(g,b.lat);n.zoom!==S&&n.setZoom(S)}handleEaseTo(n,u){const g=n.zoom,b=n.center,S=n.padding,I={roll:n.roll,pitch:n.pitch,bearing:n.bearing},O={roll:u.roll===void 0?n.roll:u.roll,pitch:u.pitch===void 0?n.pitch:u.pitch,bearing:u.bearing===void 0?n.bearing:u.bearing},N=u.zoom!==void 0,j=!n.isPaddingEqual(u.padding);let $=!1;const X=u.center?c.S.convert(u.center):b,H=n.getConstrained(X,g).center;Ia(n,H);const J=n.clone();J.setCenter(H),J.setZoom(N?+u.zoom:g+Xi(b.lat,X.lat)),J.setBearing(u.bearing);const ae=new c.P(c.ah(n.centerPoint.x+u.offsetAsPoint.x,0,n.width),c.ah(n.centerPoint.y+u.offsetAsPoint.y,0,n.height));J.setLocationAtPoint(H,ae);const _e=(u.offset&&u.offsetAsPoint.mag())>0?J.center:H,me=N?+u.zoom:g+Xi(b.lat,_e.lat),ve=g+Xi(b.lat,0),we=me+Xi(_e.lat,0),Me=c.bA(b.lng,_e.lng),Ee=c.bA(b.lat,_e.lat),ze=c.af(we-ve);return $=me!==g,{easeFunc:Ve=>{if(c.be(I,O)||sr({startEulerAngles:I,endEulerAngles:O,tr:n,k:Ve,useSlerp:I.roll!=O.roll}),j&&n.interpolatePadding(S,u.padding,Ve),u.around)c.w("Easing around a point is not supported under globe projection."),n.setLocationAtPoint(u.around,u.aroundPoint);else{const Ie=we>ve?Math.min(2,ze):Math.max(.5,ze),Ye=Math.pow(Ie,1-Ve),ct=Gl(b,Me,Ee,Ve*Ye);n.setCenter(ct.wrap())}if($){const Ie=c.C.number(ve,we,Ve)+Xi(0,n.center.lat);n.setZoom(Ie)}},isZooming:$,elevationCenter:_e}}handleFlyTo(n,u){const g=u.zoom!==void 0,b=n.center,S=n.zoom,I=n.padding,O=!n.isPaddingEqual(u.padding),N=n.getConstrained(c.S.convert(u.center||u.locationAtOffset),S).center,j=g?+u.zoom:n.zoom+Xi(n.center.lat,N.lat),$=n.clone();$.setCenter(N),$.setZoom(j),$.setBearing(u.bearing);const X=new c.P(c.ah(n.centerPoint.x+u.offsetAsPoint.x,0,n.width),c.ah(n.centerPoint.y+u.offsetAsPoint.y,0,n.height));$.setLocationAtPoint(N,X);const H=$.center;Ia(n,H);const J=(function(Ee,ze,Ve){const Ie=Or(ze),Ye=Or(Ve),ct=c.aX(Ie,Ye),rt=Math.acos(ct),st=Ma(Ee);return rt/(2*Math.PI)*st})(n,b,H),ae=S+Xi(b.lat,0),_e=j+Xi(H.lat,0),me=c.af(_e-ae);let ve;if(typeof u.minZoom=="number"){const Ee=+u.minZoom+Xi(H.lat,0),ze=Math.min(Ee,ae,_e)+Xi(0,H.lat),Ve=n.getConstrained(H,ze).zoom+Xi(H.lat,0);ve=c.af(Ve-ae)}const we=c.bA(b.lng,H.lng),Me=c.bA(b.lat,H.lat);return{easeFunc:(Ee,ze,Ve,Ie)=>{const Ye=Gl(b,we,Me,Ve);O&&n.interpolatePadding(I,u.padding,Ee);const ct=Ee===1?H:Ye;n.setCenter(ct.wrap());const rt=ae+c.ak(ze);n.setZoom(Ee===1?j:rt+Xi(0,ct.lat))},scaleOfZoom:me,targetCenter:H,scaleOfMinZoom:ve,pixelPathLength:J}}static solveVectorScale(n,u,g,b,S){const I=b==="x"?[g[0],g[4],g[8],g[12]]:[g[1],g[5],g[9],g[13]],O=[g[3],g[7],g[11],g[15]],N=n[0]*I[0]+n[1]*I[1]+n[2]*I[2],j=n[0]*O[0]+n[1]*O[1]+n[2]*O[2],$=u[0]*I[0]+u[1]*I[1]+u[2]*I[2],X=u[0]*O[0]+u[1]*O[1]+u[2]*O[2];return $+S*j===N+S*X||O[3]*(N-$)+I[3]*(X-j)+N*X==$*j?null:($+I[3]-S*X-S*O[3])/($-N-S*X+S*j)}static getLesserNonNegativeNonNull(n,u){return u!==null&&u>=0&&u<n?u:n}}class Uu{constructor(n){this._globe=n,this._mercatorCameraHelper=new wr,this._verticalPerspectiveCameraHelper=new Ai}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(n,u){return this.currentHelper.handlePanInertia(n,u)}handleMapControlsRollPitchBearingZoom(n,u){return this.currentHelper.handleMapControlsRollPitchBearingZoom(n,u)}handleMapControlsPan(n,u,g){this.currentHelper.handleMapControlsPan(n,u,g)}cameraForBoxAndBearing(n,u,g,b,S){return this.currentHelper.cameraForBoxAndBearing(n,u,g,b,S)}handleJumpToCenterZoom(n,u){this.currentHelper.handleJumpToCenterZoom(n,u)}handleEaseTo(n,u){return this.currentHelper.handleEaseTo(n,u)}handleFlyTo(n,u){return this.currentHelper.handleFlyTo(n,u)}}const cu=(T,n)=>c.y(T,n&&n.filter((u=>u.identifier!=="source.canvas"))),Dl=c.bE();class P extends c.E{constructor(n,u={}){super(),this._rtlPluginLoaded=()=>{for(const g in this.sourceCaches){const b=this.sourceCaches[g].getSource().type;b!=="vector"&&b!=="geojson"||this.sourceCaches[g].reload()}},this.map=n,this.dispatcher=new Wt(Jt(),n._getMapId()),this.dispatcher.registerMessageHandler("GG",((g,b)=>this.getGlyphs(g,b))),this.dispatcher.registerMessageHandler("GI",((g,b)=>this.getImages(g,b))),this.imageManager=new ge,this.imageManager.setEventedParent(this),this.glyphManager=new Pe(n._requestManager,u.localIdeographFontFamily),this.lineAtlas=new Zt(256,512),this.crossTileSymbolIndex=new Qa,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",c.bG()),Fs().on(qr,this._rtlPluginLoaded),this.on("data",(g=>{if(g.dataType!=="source"||g.sourceDataType!=="metadata")return;const b=this.sourceCaches[g.sourceId];if(!b)return;const S=b.getSource();if(S&&S.vectorLayerIds)for(const I in this._layers){const O=this._layers[I];O.source===S.id&&this._validateLayer(O)}}))}setGlobalStateProperty(n,u){var g,b,S;this._checkLoaded();const I=u===null?(S=(b=(g=this.stylesheet.state)===null||g===void 0?void 0:g[n])===null||b===void 0?void 0:b.default)!==null&&S!==void 0?S:null:u;if(c.bH(I,this._globalState[n]))return this;this._globalState[n]=I;const O=this._findGlobalStateAffectedSources([n]);for(const N in this.sourceCaches)O.has(N)&&(this._reloadSource(N),this._changed=!0)}getGlobalState(){return this._globalState}setGlobalState(n){this._checkLoaded();const u=[];for(const b in n)!c.bH(this._globalState[b],n[b].default)&&(u.push(b),this._globalState[b]=n[b].default);const g=this._findGlobalStateAffectedSources(u);for(const b in this.sourceCaches)g.has(b)&&(this._reloadSource(b),this._changed=!0)}_findGlobalStateAffectedSources(n){if(n.length===0)return new Set;const u=new Set;for(const g in this._layers){const b=this._layers[g],S=b.getLayoutAffectingGlobalStateRefs();for(const I of n)S.has(I)&&u.add(b.source)}return u}loadURL(n,u={},g){this.fire(new c.l("dataloading",{dataType:"style"})),u.validate=typeof u.validate!="boolean"||u.validate;const b=this.map._requestManager.transformRequest(n,"Style");this._loadStyleRequest=new AbortController;const S=this._loadStyleRequest;c.j(b,this._loadStyleRequest).then((I=>{this._loadStyleRequest=null,this._load(I.data,u,g)})).catch((I=>{this._loadStyleRequest=null,I&&!S.signal.aborted&&this.fire(new c.k(I))}))}loadJSON(n,u={},g){this.fire(new c.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,ee.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,u.validate=u.validate!==!1,this._load(n,u,g)})).catch((()=>{}))}loadEmpty(){this.fire(new c.l("dataloading",{dataType:"style"})),this._load(Dl,{validate:!1})}_load(n,u,g){var b,S,I;const O=u.transformStyle?u.transformStyle(g,n):n;if(!u.validate||!cu(this,c.z(O))){this._loaded=!0,this.stylesheet=O;for(const N in O.sources)this.addSource(N,O.sources[N],{validate:!1});O.sprite?this._loadSprite(O.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(O.glyphs),this._createLayers(),this.light=new mt(this.stylesheet.light),this._setProjectionInternal(((b=this.stylesheet.projection)===null||b===void 0?void 0:b.type)||"mercator"),this.sky=new bt(this.stylesheet.sky),this.map.setTerrain((S=this.stylesheet.terrain)!==null&&S!==void 0?S:null),this.setGlobalState((I=this.stylesheet.state)!==null&&I!==void 0?I:null),this.fire(new c.l("data",{dataType:"style"})),this.fire(new c.l("style.load"))}}_createLayers(){const n=c.bI(this.stylesheet.layers);this.dispatcher.broadcast("SL",n),this._order=n.map((u=>u.id)),this._layers={},this._serializedLayers=null;for(const u of n){const g=c.bJ(u);g.setEventedParent(this,{layer:{id:u.id}}),this._layers[u.id]=g}}_loadSprite(n,u=!1,g=void 0){let b;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,(function(S,I,O,N){return c._(this,void 0,void 0,(function*(){const j=Fe(S),$=O>1?"@2x":"",X={},H={};for(const{id:J,url:ae}of j){const _e=I.transformRequest(de(ae,$,".json"),"SpriteJSON");X[J]=c.j(_e,N);const me=I.transformRequest(de(ae,$,".png"),"SpriteImage");H[J]=Ke.getImage(me,N)}return yield Promise.all([...Object.values(X),...Object.values(H)]),(function(J,ae){return c._(this,void 0,void 0,(function*(){const _e={};for(const me in J){_e[me]={};const ve=ee.getImageCanvasContext((yield ae[me]).data),we=(yield J[me]).data;for(const Me in we){const{width:Ee,height:ze,x:Ve,y:Ie,sdf:Ye,pixelRatio:ct,stretchX:rt,stretchY:st,content:lt,textFitWidth:Nt,textFitHeight:Ft}=we[Me];_e[me][Me]={data:null,pixelRatio:ct,sdf:Ye,stretchX:rt,stretchY:st,content:lt,textFitWidth:Nt,textFitHeight:Ft,spriteData:{width:Ee,height:ze,x:Ve,y:Ie,context:ve}}}}return _e}))})(X,H)}))})(n,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((S=>{if(this._spriteRequest=null,S)for(const I in S){this._spritesImagesIds[I]=[];const O=this._spritesImagesIds[I]?this._spritesImagesIds[I].filter((N=>!(N in S))):[];for(const N of O)this.imageManager.removeImage(N),this._changedImages[N]=!0;for(const N in S[I]){const j=I==="default"?N:`${I}:${N}`;this._spritesImagesIds[I].push(j),j in this.imageManager.images?this.imageManager.updateImage(j,S[I][N],!1):this.imageManager.addImage(j,S[I][N]),u&&(this._changedImages[j]=!0)}}})).catch((S=>{this._spriteRequest=null,b=S,this.fire(new c.k(b))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),u&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"})),g&&g(b)}))}_unloadSprite(){for(const n of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(n),this._changedImages[n]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}_validateLayer(n){const u=this.sourceCaches[n.source];if(!u)return;const g=n.sourceLayer;if(!g)return;const b=u.getSource();(b.type==="geojson"||b.vectorLayerIds&&b.vectorLayerIds.indexOf(g)===-1)&&this.fire(new c.k(new Error(`Source layer "${g}" does not exist on source "${b.id}" as specified by style layer "${n.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(n,u=!1){const g=this._serializedAllLayers();if(!n||n.length===0)return Object.values(u?c.bK(g):g);const b=[];for(const S of n)if(g[S]){const I=u?c.bK(g[S]):g[S];b.push(I)}return b}_serializedAllLayers(){let n=this._serializedLayers;if(n)return n;n=this._serializedLayers={};const u=Object.keys(this._layers);for(const g of u){const b=this._layers[g];b.type!=="custom"&&(n[g]=b.serialize())}return n}hasTransitions(){var n,u,g;if(!((n=this.light)===null||n===void 0)&&n.hasTransition()||!((u=this.sky)===null||u===void 0)&&u.hasTransition()||!((g=this.projection)===null||g===void 0)&&g.hasTransition())return!0;for(const b in this.sourceCaches)if(this.sourceCaches[b].hasTransition())return!0;for(const b in this._layers)if(this._layers[b].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(n){if(!this._loaded)return;const u=this._changed;if(u){const b=Object.keys(this._updatedLayers),S=Object.keys(this._removedLayers);(b.length||S.length)&&this._updateWorkerLayers(b,S);for(const I in this._updatedSources){const O=this._updatedSources[I];if(O==="reload")this._reloadSource(I);else{if(O!=="clear")throw new Error(`Invalid action ${O}`);this._clearSource(I)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const I in this._updatedPaintProps)this._layers[I].updateTransitions(n);this.light.updateTransitions(n),this.sky.updateTransitions(n),this._resetUpdates()}const g={};for(const b in this.sourceCaches){const S=this.sourceCaches[b];g[b]=S.used,S.used=!1}for(const b of this._order){const S=this._layers[b];S.recalculate(n,this._availableImages),!S.isHidden(n.zoom)&&S.source&&(this.sourceCaches[S.source].used=!0)}for(const b in g){const S=this.sourceCaches[b];!!g[b]!=!!S.used&&S.fire(new c.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:b}))}this.light.recalculate(n),this.sky.recalculate(n),this.projection.recalculate(n),this.z=n.zoom,u&&this.fire(new c.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(n,u){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(n,!1),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(n,u={}){var g;this._checkLoaded();const b=this.serialize();if(n=u.transformStyle?u.transformStyle(b,n):n,((g=u.validate)===null||g===void 0||g)&&cu(this,c.z(n)))return!1;(n=c.bK(n)).layers=c.bI(n.layers);const S=c.bL(b,n),I=this._getOperationsToPerform(S);if(I.unimplemented.length>0)throw new Error(`Unimplemented: ${I.unimplemented.join(", ")}.`);if(I.operations.length===0)return!1;for(const O of I.operations)O();return this.stylesheet=n,this._serializedLayers=null,!0}_getOperationsToPerform(n){const u=[],g=[];for(const b of n)switch(b.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":u.push((()=>this.addLayer.apply(this,b.args)));break;case"removeLayer":u.push((()=>this.removeLayer.apply(this,b.args)));break;case"setPaintProperty":u.push((()=>this.setPaintProperty.apply(this,b.args)));break;case"setLayoutProperty":u.push((()=>this.setLayoutProperty.apply(this,b.args)));break;case"setFilter":u.push((()=>this.setFilter.apply(this,b.args)));break;case"addSource":u.push((()=>this.addSource.apply(this,b.args)));break;case"removeSource":u.push((()=>this.removeSource.apply(this,b.args)));break;case"setLayerZoomRange":u.push((()=>this.setLayerZoomRange.apply(this,b.args)));break;case"setLight":u.push((()=>this.setLight.apply(this,b.args)));break;case"setGeoJSONSourceData":u.push((()=>this.setGeoJSONSourceData.apply(this,b.args)));break;case"setGlyphs":u.push((()=>this.setGlyphs.apply(this,b.args)));break;case"setSprite":u.push((()=>this.setSprite.apply(this,b.args)));break;case"setTerrain":u.push((()=>this.map.setTerrain.apply(this,b.args)));break;case"setSky":u.push((()=>this.setSky.apply(this,b.args)));break;case"setProjection":this.setProjection.apply(this,b.args);break;case"setGlobalState":u.push((()=>this.setGlobalState.apply(this,b.args)));break;case"setTransition":u.push((()=>{}));break;default:g.push(b.command)}return{operations:u,unimplemented:g}}addImage(n,u){if(this.getImage(n))return this.fire(new c.k(new Error(`An image named "${n}" already exists.`)));this.imageManager.addImage(n,u),this._afterImageUpdated(n)}updateImage(n,u){this.imageManager.updateImage(n,u)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){if(!this.getImage(n))return this.fire(new c.k(new Error(`An image named "${n}" does not exist.`)));this.imageManager.removeImage(n),this._afterImageUpdated(n)}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(n,u,g={}){if(this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error(`Source "${n}" already exists.`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(c.z.source,`sources.${n}`,u,null,g))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const b=this.sourceCaches[n]=new Rn(n,u,this.dispatcher);b.style=this,b.setEventedParent(this,(()=>({isSourceLoaded:b.loaded(),source:b.serialize(),sourceId:n}))),b.onAdd(this.map),this._changed=!0}removeSource(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(const g in this._layers)if(this._layers[g].source===n)return this.fire(new c.k(new Error(`Source "${n}" cannot be removed while layer "${g}" is using it.`)));const u=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],u.fire(new c.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),u.setEventedParent(null),u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(n,u){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error(`There is no source with this ID=${n}`);const g=this.sourceCaches[n].getSource();if(g.type!=="geojson")throw new Error(`geojsonSource.type is ${g.type}, which is !== 'geojson`);g.setData(u),this._changed=!0}getSource(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()}addLayer(n,u,g={}){this._checkLoaded();const b=n.id;if(this.getLayer(b))return void this.fire(new c.k(new Error(`Layer "${b}" already exists on this map.`)));let S;if(n.type==="custom"){if(cu(this,c.bM(n)))return;S=c.bJ(n)}else{if("source"in n&&typeof n.source=="object"&&(this.addSource(b,n.source),n=c.bK(n),n=c.e(n,{source:b})),this._validate(c.z.layer,`layers.${b}`,n,{arrayIndex:-1},g))return;S=c.bJ(n),this._validateLayer(S),S.setEventedParent(this,{layer:{id:b}})}const I=u?this._order.indexOf(u):this._order.length;if(u&&I===-1)this.fire(new c.k(new Error(`Cannot add layer "${b}" before non-existing layer "${u}".`)));else{if(this._order.splice(I,0,b),this._layerOrderChanged=!0,this._layers[b]=S,this._removedLayers[b]&&S.source&&S.type!=="custom"){const O=this._removedLayers[b];delete this._removedLayers[b],O.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",this.sourceCaches[S.source].pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map)}}moveLayer(n,u){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new c.k(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===u)return;const g=this._order.indexOf(n);this._order.splice(g,1);const b=u?this._order.indexOf(u):this._order.length;u&&b===-1?this.fire(new c.k(new Error(`Cannot move layer "${n}" before non-existing layer "${u}".`))):(this._order.splice(b,0,n),this._layerOrderChanged=!0)}removeLayer(n){this._checkLoaded();const u=this._layers[n];if(!u)return void this.fire(new c.k(new Error(`Cannot remove non-existing layer "${n}".`)));u.setEventedParent(null);const g=this._order.indexOf(n);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=u,delete this._layers[n],this._serializedLayers&&delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],u.onRemove&&u.onRemove(this.map)}getLayer(n){return this._layers[n]}getLayersOrder(){return[...this._order]}hasLayer(n){return n in this._layers}setLayerZoomRange(n,u,g){this._checkLoaded();const b=this.getLayer(n);b?b.minzoom===u&&b.maxzoom===g||(u!=null&&(b.minzoom=u),g!=null&&(b.maxzoom=g),this._updateLayer(b)):this.fire(new c.k(new Error(`Cannot set the zoom range of non-existing layer "${n}".`)))}setFilter(n,u,g={}){this._checkLoaded();const b=this.getLayer(n);if(b){if(!c.bH(b.filter,u))return u==null?(b.setFilter(void 0),void this._updateLayer(b)):void(this._validate(c.z.filter,`layers.${b.id}.filter`,u,null,g)||(b.setFilter(c.bK(u)),this._updateLayer(b)))}else this.fire(new c.k(new Error(`Cannot filter non-existing layer "${n}".`)))}getFilter(n){return c.bK(this.getLayer(n).filter)}setLayoutProperty(n,u,g,b={}){this._checkLoaded();const S=this.getLayer(n);S?c.bH(S.getLayoutProperty(u),g)||(S.setLayoutProperty(u,g,b),this._updateLayer(S)):this.fire(new c.k(new Error(`Cannot style non-existing layer "${n}".`)))}getLayoutProperty(n,u){const g=this.getLayer(n);if(g)return g.getLayoutProperty(u);this.fire(new c.k(new Error(`Cannot get style of non-existing layer "${n}".`)))}setPaintProperty(n,u,g,b={}){this._checkLoaded();const S=this.getLayer(n);S?c.bH(S.getPaintProperty(u),g)||(S.setPaintProperty(u,g,b)&&this._updateLayer(S),this._changed=!0,this._updatedPaintProps[n]=!0,this._serializedLayers=null):this.fire(new c.k(new Error(`Cannot style non-existing layer "${n}".`)))}getPaintProperty(n,u){return this.getLayer(n).getPaintProperty(u)}setFeatureState(n,u){this._checkLoaded();const g=n.source,b=n.sourceLayer,S=this.sourceCaches[g];if(S===void 0)return void this.fire(new c.k(new Error(`The source '${g}' does not exist in the map's style.`)));const I=S.getSource().type;I==="geojson"&&b?this.fire(new c.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):I!=="vector"||b?(n.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),S.setFeatureState(b,n.id,u)):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(n,u){this._checkLoaded();const g=n.source,b=this.sourceCaches[g];if(b===void 0)return void this.fire(new c.k(new Error(`The source '${g}' does not exist in the map's style.`)));const S=b.getSource().type,I=S==="vector"?n.sourceLayer:void 0;S!=="vector"||I?u&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new c.k(new Error("A feature id is required to remove its specific state property."))):b.removeFeatureState(I,n.id,u):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(n){this._checkLoaded();const u=n.source,g=n.sourceLayer,b=this.sourceCaches[u];if(b!==void 0)return b.getSource().type!=="vector"||g?(n.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),b.getFeatureState(g,n.id)):void this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.k(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const n=c.bN(this.sourceCaches,(S=>S.serialize())),u=this._serializeByIds(this._order,!0),g=this.map.getTerrain()||void 0,b=this.stylesheet;return c.bO({version:b.version,name:b.name,metadata:b.metadata,light:b.light,sky:b.sky,center:b.center,zoom:b.zoom,bearing:b.bearing,pitch:b.pitch,sprite:b.sprite,glyphs:b.glyphs,transition:b.transition,projection:b.projection,sources:n,layers:u,terrain:g},(S=>S!==void 0))}_updateLayer(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(n){const u=I=>this._layers[I].type==="fill-extrusion",g={},b=[];for(let I=this._order.length-1;I>=0;I--){const O=this._order[I];if(u(O)){g[O]=I;for(const N of n){const j=N[O];if(j)for(const $ of j)b.push($)}}}b.sort(((I,O)=>O.intersectionZ-I.intersectionZ));const S=[];for(let I=this._order.length-1;I>=0;I--){const O=this._order[I];if(u(O))for(let N=b.length-1;N>=0;N--){const j=b[N].feature;if(g[j.layer.id]<I)break;S.push(j),b.pop()}else for(const N of n){const j=N[O];if(j)for(const $ of j)S.push($.feature)}}return S}queryRenderedFeatures(n,u,g){u&&u.filter&&this._validate(c.z.filter,"queryRenderedFeatures.filter",u.filter,null,u);const b={};if(u&&u.layers){if(!(Array.isArray(u.layers)||u.layers instanceof Set))return this.fire(new c.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const j of u.layers){const $=this._layers[j];if(!$)return this.fire(new c.k(new Error(`The layer '${j}' does not exist in the map's style and cannot be queried for features.`))),[];b[$.source]=!0}}const S=[];u.availableImages=this._availableImages;const I=this._serializedAllLayers(),O=u.layers instanceof Set?u.layers:Array.isArray(u.layers)?new Set(u.layers):null,N=Object.assign(Object.assign({},u),{layers:O});for(const j in this.sourceCaches)u.layers&&!b[j]||S.push(fi(this.sourceCaches[j],this._layers,I,n,N,g,this.map.terrain?($,X,H)=>this.map.terrain.getElevation($,X,H):void 0));return this.placement&&S.push((function(j,$,X,H,J,ae,_e){const me={},ve=ae.queryRenderedSymbols(H),we=[];for(const Me of Object.keys(ve).map(Number))we.push(_e[Me]);we.sort(ds);for(const Me of we){const Ee=Me.featureIndex.lookupSymbolFeatures(ve[Me.bucketInstanceId],$,Me.bucketIndex,Me.sourceLayerIndex,J.filter,J.layers,J.availableImages,j);for(const ze in Ee){const Ve=me[ze]=me[ze]||[],Ie=Ee[ze];Ie.sort(((Ye,ct)=>{const rt=Me.featureSortOrder;if(rt){const st=rt.indexOf(Ye.featureIndex);return rt.indexOf(ct.featureIndex)-st}return ct.featureIndex-Ye.featureIndex}));for(const Ye of Ie)Ve.push(Ye)}}return(function(Me,Ee,ze){for(const Ve in Me)for(const Ie of Me[Ve])Ns(Ie,ze[Ee[Ve].source]);return Me})(me,j,X)})(this._layers,I,this.sourceCaches,n,N,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(S)}querySourceFeatures(n,u){u&&u.filter&&this._validate(c.z.filter,"querySourceFeatures.filter",u.filter,null,u);const g=this.sourceCaches[n];return g?(function(b,S){const I=b.getRenderableIds().map((j=>b.getTileByID(j))),O=[],N={};for(let j=0;j<I.length;j++){const $=I[j],X=$.tileID.canonical.key;N[X]||(N[X]=!0,$.querySourceFeatures(O,S))}return O})(g,u):[]}getLight(){return this.light.getLight()}setLight(n,u={}){this._checkLoaded();const g=this.light.getLight();let b=!1;for(const I in n)if(!c.bH(n[I],g[I])){b=!0;break}if(!b)return;const S={now:ee.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,u),this.light.updateTransitions(S)}getProjection(){var n;return(n=this.stylesheet)===null||n===void 0?void 0:n.projection}setProjection(n){if(this._checkLoaded(),this.projection){if(this.projection.name===n.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=n,this._setProjectionInternal(n.type)}getSky(){var n;return(n=this.stylesheet)===null||n===void 0?void 0:n.sky}setSky(n,u={}){this._checkLoaded();const g=this.getSky();let b=!1;if(!n&&!g)return;if(n&&!g)b=!0;else if(!n&&g)b=!0;else for(const I in n)if(!c.bH(n[I],g[I])){b=!0;break}if(!b)return;const S={now:ee.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=n,this.sky.setSky(n,u),this.sky.updateTransitions(S)}_setProjectionInternal(n){const u=(function(g){if(Array.isArray(g)){const b=new ia({type:g});return{projection:b,transform:new lo,cameraHelper:new Uu(b)}}switch(g){case"mercator":return{projection:new Ln,transform:new xn,cameraHelper:new wr};case"globe":{const b=new ia({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:b,transform:new lo,cameraHelper:new Uu(b)}}case"vertical-perspective":return{projection:new Wn,transform:new al,cameraHelper:new Ai};default:return c.w(`Unknown projection name: ${g}. Falling back to mercator projection.`),{projection:new Ln,transform:new xn,cameraHelper:new wr}}})(n);this.projection=u.projection,this.map.migrateProjection(u.transform,u.cameraHelper);for(const g in this.sourceCaches)this.sourceCaches[g].reload()}_validate(n,u,g,b,S={}){return(!S||S.validate!==!1)&&cu(this,n.call(c.z,c.e({key:u,style:this.serialize(),value:g,styleSpec:c.v},b)))}_remove(n=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Fs().off(qr,this._rtlPluginLoaded);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this.sourceCaches){const g=this.sourceCaches[u];g.setEventedParent(null),g.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),n&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(n)}_clearSource(n){this.sourceCaches[n].clearTiles()}_reloadSource(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()}_updateSources(n){for(const u in this.sourceCaches)this.sourceCaches[u].update(n,this.map.terrain)}_generateCollisionBoxes(){for(const n in this.sourceCaches)this._reloadSource(n)}_updatePlacement(n,u,g,b,S=!1){let I=!1,O=!1;const N={};for(const j of this._order){const $=this._layers[j];if($.type!=="symbol")continue;if(!N[$.source]){const H=this.sourceCaches[$.source];N[$.source]=H.getRenderableIds(!0).map((J=>H.getTileByID(J))).sort(((J,ae)=>ae.tileID.overscaledZ-J.tileID.overscaledZ||(J.tileID.isLessThan(ae.tileID)?-1:1)))}const X=this.crossTileSymbolIndex.addLayer($,N[$.source],n.center.lng);I=I||X}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((S=S||this._layerOrderChanged||g===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(ee.now(),n.zoom))&&(this.pauseablePlacement=new rr(n,this.map.terrain,this._order,S,u,g,b,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,N),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(ee.now()),O=!0),I&&this.pauseablePlacement.placement.setStale()),O||I)for(const j of this._order){const $=this._layers[j];$.type==="symbol"&&this.placement.updateLayerOpacities($,N[$.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(ee.now())}_releaseSymbolFadeTiles(){for(const n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,u){return c._(this,void 0,void 0,(function*(){const g=yield this.imageManager.getImages(u.icons);this._updateTilesForChangedImages();const b=this.sourceCaches[u.source];return b&&b.setDependencies(u.tileID.key,u.type,u.icons),g}))}getGlyphs(n,u){return c._(this,void 0,void 0,(function*(){const g=yield this.glyphManager.getGlyphs(u.stacks),b=this.sourceCaches[u.source];return b&&b.setDependencies(u.tileID.key,u.type,[""]),g}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(n,u={}){this._checkLoaded(),n&&this._validate(c.z.glyphs,"glyphs",n,null,u)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=n,this.glyphManager.entries={},this.glyphManager.setURL(n))}addSprite(n,u,g={},b){this._checkLoaded();const S=[{id:n,url:u}],I=[...Fe(this.stylesheet.sprite),...S];this._validate(c.z.sprite,"sprite",I,null,g)||(this.stylesheet.sprite=I,this._loadSprite(S,!0,b))}removeSprite(n){this._checkLoaded();const u=Fe(this.stylesheet.sprite);if(u.find((g=>g.id===n))){if(this._spritesImagesIds[n])for(const g of this._spritesImagesIds[n])this.imageManager.removeImage(g),this._changedImages[g]=!0;u.splice(u.findIndex((g=>g.id===n)),1),this.stylesheet.sprite=u.length>0?u:void 0,delete this._spritesImagesIds[n],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}else this.fire(new c.k(new Error(`Sprite "${n}" doesn't exists on this map.`)))}getSprite(){return Fe(this.stylesheet.sprite)}setSprite(n,u={},g){this._checkLoaded(),n&&this._validate(c.z.sprite,"sprite",n,null,u)||(this.stylesheet.sprite=n,n?this._loadSprite(n,!0,g):(this._unloadSprite(),g&&g(null)))}}var Z=c.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class ne{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(n,u,g,b,S,I,O,N,j){this.context=n;let $=this.boundPaintVertexBuffers.length!==b.length;for(let X=0;!$&&X<b.length;X++)this.boundPaintVertexBuffers[X]!==b[X]&&($=!0);!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==g||$||this.boundIndexBuffer!==S||this.boundVertexOffset!==I||this.boundDynamicVertexBuffer!==O||this.boundDynamicVertexBuffer2!==N||this.boundDynamicVertexBuffer3!==j?this.freshBind(u,g,b,S,I,O,N,j):(n.bindVertexArray.set(this.vao),O&&O.bind(),S&&S.dynamicDraw&&S.bind(),N&&N.bind(),j&&j.bind())}freshBind(n,u,g,b,S,I,O,N){const j=n.numAttributes,$=this.context,X=$.gl;this.vao&&this.destroy(),this.vao=$.createVertexArray(),$.bindVertexArray.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=b,this.boundVertexOffset=S,this.boundDynamicVertexBuffer=I,this.boundDynamicVertexBuffer2=O,this.boundDynamicVertexBuffer3=N,u.enableAttributes(X,n);for(const H of g)H.enableAttributes(X,n);I&&I.enableAttributes(X,n),O&&O.enableAttributes(X,n),N&&N.enableAttributes(X,n),u.bind(),u.setVertexAttribPointers(X,n,S);for(const H of g)H.bind(),H.setVertexAttribPointers(X,n,S);I&&(I.bind(),I.setVertexAttribPointers(X,n,S)),b&&b.bind(),O&&(O.bind(),O.setVertexAttribPointers(X,n,S)),N&&(N.bind(),N.setVertexAttribPointers(X,n,S)),$.currentNumAttributes=j}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const ye=(T,n,u,g,b)=>({u_texture:0,u_ele_delta:T,u_fog_matrix:n,u_fog_color:u?u.properties.get("fog-color"):c.bf.white,u_fog_ground_blend:u?u.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:b?0:u?u.calculateFogBlendOpacity(g):0,u_horizon_color:u?u.properties.get("horizon-color"):c.bf.white,u_horizon_fog_blend:u?u.properties.get("horizon-fog-blend"):1,u_is_globe_mode:b?1:0}),at={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function ht(T){const n=[];for(let u=0;u<T.length;u++){if(T[u]===null)continue;const g=T[u].split(" ");n.push(g.pop())}return n}class Xt{constructor(n,u,g,b,S,I,O,N,j=[]){const $=n.gl;this.program=$.createProgram();const X=ht(u.staticAttributes),H=g?g.getBinderAttributes():[],J=X.concat(H),ae=Hi.prelude.staticUniforms?ht(Hi.prelude.staticUniforms):[],_e=O.staticUniforms?ht(O.staticUniforms):[],me=u.staticUniforms?ht(u.staticUniforms):[],ve=g?g.getBinderUniforms():[],we=ae.concat(_e).concat(me).concat(ve),Me=[];for(const rt of we)Me.indexOf(rt)<0&&Me.push(rt);const Ee=g?g.defines():[];Yr($)&&Ee.unshift("#version 300 es"),S&&Ee.push("#define OVERDRAW_INSPECTOR;"),I&&Ee.push("#define TERRAIN3D;"),N&&Ee.push(N),j&&Ee.push(...j);let ze=Ee.concat(Hi.prelude.fragmentSource,O.fragmentSource,u.fragmentSource).join(`
`),Ve=Ee.concat(Hi.prelude.vertexSource,O.vertexSource,u.vertexSource).join(`
`);Yr($)||(ze=(function(rt){return rt.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(ze),Ve=(function(rt){return rt.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(Ve));const Ie=$.createShader($.FRAGMENT_SHADER);if($.isContextLost())return void(this.failedToCreate=!0);if($.shaderSource(Ie,ze),$.compileShader(Ie),!$.getShaderParameter(Ie,$.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${$.getShaderInfoLog(Ie)}`);$.attachShader(this.program,Ie);const Ye=$.createShader($.VERTEX_SHADER);if($.isContextLost())return void(this.failedToCreate=!0);if($.shaderSource(Ye,Ve),$.compileShader(Ye),!$.getShaderParameter(Ye,$.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${$.getShaderInfoLog(Ye)}`);$.attachShader(this.program,Ye),this.attributes={};const ct={};this.numAttributes=J.length;for(let rt=0;rt<this.numAttributes;rt++)J[rt]&&($.bindAttribLocation(this.program,rt,J[rt]),this.attributes[J[rt]]=rt);if($.linkProgram(this.program),!$.getProgramParameter(this.program,$.LINK_STATUS))throw new Error(`Program failed to link: ${$.getProgramInfoLog(this.program)}`);$.deleteShader(Ye),$.deleteShader(Ie);for(let rt=0;rt<Me.length;rt++){const st=Me[rt];if(st&&!ct[st]){const lt=$.getUniformLocation(this.program,st);lt&&(ct[st]=lt)}}this.fixedUniforms=b(n,ct),this.terrainUniforms=((rt,st)=>({u_depth:new c.bP(rt,st.u_depth),u_terrain:new c.bP(rt,st.u_terrain),u_terrain_dim:new c.bg(rt,st.u_terrain_dim),u_terrain_matrix:new c.bR(rt,st.u_terrain_matrix),u_terrain_unpack:new c.bS(rt,st.u_terrain_unpack),u_terrain_exaggeration:new c.bg(rt,st.u_terrain_exaggeration)}))(n,ct),this.projectionUniforms=((rt,st)=>({u_projection_matrix:new c.bR(rt,st.u_projection_matrix),u_projection_tile_mercator_coords:new c.bS(rt,st.u_projection_tile_mercator_coords),u_projection_clipping_plane:new c.bS(rt,st.u_projection_clipping_plane),u_projection_transition:new c.bg(rt,st.u_projection_transition),u_projection_fallback_matrix:new c.bR(rt,st.u_projection_fallback_matrix)}))(n,ct),this.binderUniforms=g?g.getUniforms(n,ct):[]}draw(n,u,g,b,S,I,O,N,j,$,X,H,J,ae,_e,me,ve,we,Me){const Ee=n.gl;if(this.failedToCreate)return;if(n.program.set(this.program),n.setDepthMode(g),n.setStencilMode(b),n.setColorMode(S),n.setCullFace(I),N){n.activeTexture.set(Ee.TEXTURE2),Ee.bindTexture(Ee.TEXTURE_2D,N.depthTexture),n.activeTexture.set(Ee.TEXTURE3),Ee.bindTexture(Ee.TEXTURE_2D,N.texture);for(const Ve in this.terrainUniforms)this.terrainUniforms[Ve].set(N[Ve])}if(j)for(const Ve in j)this.projectionUniforms[at[Ve]].set(j[Ve]);if(O)for(const Ve in this.fixedUniforms)this.fixedUniforms[Ve].set(O[Ve]);me&&me.setUniforms(n,this.binderUniforms,ae,{zoom:_e});let ze=0;switch(u){case Ee.LINES:ze=2;break;case Ee.TRIANGLES:ze=3;break;case Ee.LINE_STRIP:ze=1}for(const Ve of J.get()){const Ie=Ve.vaos||(Ve.vaos={});(Ie[$]||(Ie[$]=new ne)).bind(n,this,X,me?me.getPaintVertexBuffers():[],H,Ve.vertexOffset,ve,we,Me),Ee.drawElements(u,Ve.primitiveLength*ze,Ee.UNSIGNED_SHORT,Ve.primitiveOffset*ze*2)}}}function kn(T,n,u){const g=1/c.aC(u,1,n.transform.tileZoom),b=Math.pow(2,u.tileID.overscaledZ),S=u.tileSize*Math.pow(2,n.transform.tileZoom)/b,I=S*(u.tileID.canonical.x+u.tileID.wrap*b),O=S*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[g,T.fromScale,T.toScale],u_fade:T.t,u_pixel_coord_upper:[I>>16,O>>16],u_pixel_coord_lower:[65535&I,65535&O]}}const Xn=(T,n,u,g)=>{const b=T.style.light,S=b.properties.get("position"),I=[S.x,S.y,S.z],O=c.bV();b.properties.get("anchor")==="viewport"&&c.bW(O,T.transform.bearingInRadians),c.bX(I,I,O);const N=T.transform.transformLightDirection(I),j=b.properties.get("color");return{u_lightpos:I,u_lightpos_globe:N,u_lightintensity:b.properties.get("intensity"),u_lightcolor:[j.r,j.g,j.b],u_vertical_gradient:+n,u_opacity:u,u_fill_translate:g}},Ti=(T,n,u,g,b,S,I)=>c.e(Xn(T,n,u,g),kn(S,T,I),{u_height_factor:-Math.pow(2,b.overscaledZ)/I.tileSize/8}),Ki=(T,n,u,g)=>c.e(kn(n,T,u),{u_fill_translate:g}),$a=(T,n)=>({u_world:T,u_fill_translate:n}),Ga=(T,n,u,g,b)=>c.e(Ki(T,n,u,b),{u_world:g}),Ws=(T,n,u,g,b)=>{const S=T.transform;let I,O,N=0;if(u.paint.get("circle-pitch-alignment")==="map"){const j=c.aC(n,1,S.zoom);I=!0,O=[j,j],N=j/(c.$*Math.pow(2,n.tileID.overscaledZ))*2*Math.PI*b}else I=!1,O=S.pixelsToGLUnits;return{u_camera_to_center_distance:S.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+I,u_device_pixel_ratio:T.pixelRatio,u_extrude_scale:O,u_globe_extrude_scale:N,u_translate:g}},Ts=T=>({u_pixel_extrude_scale:[1/T.width,1/T.height]}),hu=T=>({u_viewport_size:[T.width,T.height]}),Xs=(T,n=1)=>({u_color:T,u_overlay:0,u_overlay_scale:n}),du=(T,n,u,g)=>{const b=c.aC(T,1,n)/(c.$*Math.pow(2,T.tileID.overscaledZ))*2*Math.PI*g;return{u_extrude_scale:c.aC(T,1,n),u_intensity:u,u_globe_extrude_scale:b}},Ks=(T,n,u,g)=>{const b=c.L();c.bY(b,0,T.width,T.height,0,0,1);const S=T.context.gl;return{u_matrix:b,u_world:[S.drawingBufferWidth,S.drawingBufferHeight],u_image:u,u_color_ramp:g,u_opacity:n.paint.get("heatmap-opacity")}},ju=(T,n,u)=>{const g=u.paint.get("hillshade-accent-color");let b;switch(u.paint.get("hillshade-method")){case"basic":b=4;break;case"combined":b=1;break;case"igor":b=2;break;case"multidirectional":b=3;break;default:b=0}const S=u.getIlluminationProperties();for(let I=0;I<S.directionRadians.length;I++)u.paint.get("hillshade-illumination-anchor")==="viewport"&&(S.directionRadians[I]+=T.transform.bearingInRadians);return{u_image:0,u_latrange:uo(0,n.tileID),u_exaggeration:u.paint.get("hillshade-exaggeration"),u_altitudes:S.altitudeRadians,u_azimuths:S.directionRadians,u_accent:g,u_method:b,u_highlights:S.highlightColor,u_shadows:S.shadowColor}},Hd=(T,n)=>{const u=n.stride,g=c.L();return c.bY(g,0,c.$,-c.$,0,0,1),c.M(g,g,[0,-c.$,0]),{u_matrix:g,u_image:1,u_dimension:[u,u],u_zoom:T.overscaledZ,u_unpack:n.getUnpackVector()}};function uo(T,n){const u=Math.pow(2,n.canonical.z),g=n.canonical.y;return[new c.a1(0,g/u).toLngLat().lat,new c.a1(0,(g+1)/u).toLngLat().lat]}const Jh=(T,n,u=0)=>({u_image:0,u_unpack:n.getUnpackVector(),u_dimension:[n.stride,n.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:u,u_opacity:T.paint.get("color-relief-opacity")}),Ys=(T,n,u,g)=>{const b=T.transform;return{u_translation:hh(T,n,u),u_ratio:g/c.aC(n,1,b.zoom),u_device_pixel_ratio:T.pixelRatio,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]]}},qu=(T,n,u,g,b)=>c.e(Ys(T,n,u,g),{u_image:0,u_image_height:b}),$u=(T,n,u,g,b)=>{const S=T.transform,I=fu(n,S);return{u_translation:hh(T,n,u),u_texsize:n.imageAtlasTexture.size,u_ratio:g/c.aC(n,1,S.zoom),u_device_pixel_ratio:T.pixelRatio,u_image:0,u_scale:[I,b.fromScale,b.toScale],u_fade:b.t,u_units_to_pixels:[1/S.pixelsToGLUnits[0],1/S.pixelsToGLUnits[1]]}},Mo=(T,n,u,g,b,S)=>{const I=T.lineAtlas,O=fu(n,T.transform),N=u.layout.get("line-cap")==="round",j=I.getDash(b.from,N),$=I.getDash(b.to,N),X=j.width*S.fromScale,H=$.width*S.toScale;return c.e(Ys(T,n,u,g),{u_patternscale_a:[O/X,-j.height/2],u_patternscale_b:[O/H,-$.height/2],u_sdfgamma:I.width/(256*Math.min(X,H)*T.pixelRatio)/2,u_image:0,u_tex_y_a:j.y,u_tex_y_b:$.y,u_mix:S.t})};function fu(T,n){return 1/c.aC(T,1,n.tileZoom)}function hh(T,n,u){return c.aD(T.transform,n,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const Ss=(T,n,u,g,b)=>{return{u_tl_parent:T,u_scale_parent:n,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*g.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:g.paint.get("raster-brightness-min"),u_brightness_high:g.paint.get("raster-brightness-max"),u_saturation_factor:(I=g.paint.get("raster-saturation"),I>0?1-1/(1.001-I):-I),u_contrast_factor:(S=g.paint.get("raster-contrast"),S>0?1/(1-S):1+S),u_spin_weights:Gu(g.paint.get("raster-hue-rotate")),u_coords_top:[b[0].x,b[0].y,b[1].x,b[1].y],u_coords_bottom:[b[3].x,b[3].y,b[2].x,b[2].y]};var S,I};function Gu(T){T*=Math.PI/180;const n=Math.sin(T),u=Math.cos(T);return[(2*u+1)/3,(-Math.sqrt(3)*n-u+1)/3,(Math.sqrt(3)*n-u+1)/3]}const Zu=(T,n,u,g,b,S,I,O,N,j,$,X,H)=>{const J=I.transform;return{u_is_size_zoom_constant:+(T==="constant"||T==="source"),u_is_size_feature_constant:+(T==="constant"||T==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:J.cameraToCenterDistance,u_pitch:J.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:J.width/J.height,u_fade_change:I.options.fadeDuration?I.symbolFadeChange:1,u_label_plane_matrix:O,u_coord_matrix:N,u_is_text:+$,u_pitch_with_map:+g,u_is_along_line:b,u_is_variable_anchor:S,u_texsize:X,u_texture:0,u_translation:j,u_pitched_scale:H}},Lc=(T,n,u,g,b,S,I,O,N,j,$,X,H,J)=>{const ae=I.transform;return c.e(Zu(T,n,u,g,b,S,I,O,N,j,$,X,J),{u_gamma_scale:g?Math.cos(ae.pitch*Math.PI/180)*ae.cameraToCenterDistance:1,u_device_pixel_ratio:I.pixelRatio,u_is_halo:1})},Wd=(T,n,u,g,b,S,I,O,N,j,$,X,H)=>c.e(Lc(T,n,u,g,b,S,I,O,N,j,!0,$,0,H),{u_texsize_icon:X,u_texture_icon:1}),sl=(T,n)=>({u_opacity:T,u_color:n}),Xd=(T,n,u,g,b)=>c.e((function(S,I,O,N){const j=O.imageManager.getPattern(S.from.toString()),$=O.imageManager.getPattern(S.to.toString()),{width:X,height:H}=O.imageManager.getPixelSize(),J=Math.pow(2,N.tileID.overscaledZ),ae=N.tileSize*Math.pow(2,O.transform.tileZoom)/J,_e=ae*(N.tileID.canonical.x+N.tileID.wrap*J),me=ae*N.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:j.tl,u_pattern_br_a:j.br,u_pattern_tl_b:$.tl,u_pattern_br_b:$.br,u_texsize:[X,H],u_mix:I.t,u_pattern_size_a:j.displaySize,u_pattern_size_b:$.displaySize,u_scale_a:I.fromScale,u_scale_b:I.toScale,u_tile_units_to_pixels:1/c.aC(N,1,O.transform.tileZoom),u_pixel_coord_upper:[_e>>16,me>>16],u_pixel_coord_lower:[65535&_e,65535&me]}})(u,b,n,g),{u_opacity:T}),Zl=(T,n)=>{},ed={fillExtrusion:(T,n)=>({u_lightpos:new c.bT(T,n.u_lightpos),u_lightpos_globe:new c.bT(T,n.u_lightpos_globe),u_lightintensity:new c.bg(T,n.u_lightintensity),u_lightcolor:new c.bT(T,n.u_lightcolor),u_vertical_gradient:new c.bg(T,n.u_vertical_gradient),u_opacity:new c.bg(T,n.u_opacity),u_fill_translate:new c.bU(T,n.u_fill_translate)}),fillExtrusionPattern:(T,n)=>({u_lightpos:new c.bT(T,n.u_lightpos),u_lightpos_globe:new c.bT(T,n.u_lightpos_globe),u_lightintensity:new c.bg(T,n.u_lightintensity),u_lightcolor:new c.bT(T,n.u_lightcolor),u_vertical_gradient:new c.bg(T,n.u_vertical_gradient),u_height_factor:new c.bg(T,n.u_height_factor),u_opacity:new c.bg(T,n.u_opacity),u_fill_translate:new c.bU(T,n.u_fill_translate),u_image:new c.bP(T,n.u_image),u_texsize:new c.bU(T,n.u_texsize),u_pixel_coord_upper:new c.bU(T,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(T,n.u_pixel_coord_lower),u_scale:new c.bT(T,n.u_scale),u_fade:new c.bg(T,n.u_fade)}),fill:(T,n)=>({u_fill_translate:new c.bU(T,n.u_fill_translate)}),fillPattern:(T,n)=>({u_image:new c.bP(T,n.u_image),u_texsize:new c.bU(T,n.u_texsize),u_pixel_coord_upper:new c.bU(T,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(T,n.u_pixel_coord_lower),u_scale:new c.bT(T,n.u_scale),u_fade:new c.bg(T,n.u_fade),u_fill_translate:new c.bU(T,n.u_fill_translate)}),fillOutline:(T,n)=>({u_world:new c.bU(T,n.u_world),u_fill_translate:new c.bU(T,n.u_fill_translate)}),fillOutlinePattern:(T,n)=>({u_world:new c.bU(T,n.u_world),u_image:new c.bP(T,n.u_image),u_texsize:new c.bU(T,n.u_texsize),u_pixel_coord_upper:new c.bU(T,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(T,n.u_pixel_coord_lower),u_scale:new c.bT(T,n.u_scale),u_fade:new c.bg(T,n.u_fade),u_fill_translate:new c.bU(T,n.u_fill_translate)}),circle:(T,n)=>({u_camera_to_center_distance:new c.bg(T,n.u_camera_to_center_distance),u_scale_with_map:new c.bP(T,n.u_scale_with_map),u_pitch_with_map:new c.bP(T,n.u_pitch_with_map),u_extrude_scale:new c.bU(T,n.u_extrude_scale),u_device_pixel_ratio:new c.bg(T,n.u_device_pixel_ratio),u_globe_extrude_scale:new c.bg(T,n.u_globe_extrude_scale),u_translate:new c.bU(T,n.u_translate)}),collisionBox:(T,n)=>({u_pixel_extrude_scale:new c.bU(T,n.u_pixel_extrude_scale)}),collisionCircle:(T,n)=>({u_viewport_size:new c.bU(T,n.u_viewport_size)}),debug:(T,n)=>({u_color:new c.bQ(T,n.u_color),u_overlay:new c.bP(T,n.u_overlay),u_overlay_scale:new c.bg(T,n.u_overlay_scale)}),depth:Zl,clippingMask:Zl,heatmap:(T,n)=>({u_extrude_scale:new c.bg(T,n.u_extrude_scale),u_intensity:new c.bg(T,n.u_intensity),u_globe_extrude_scale:new c.bg(T,n.u_globe_extrude_scale)}),heatmapTexture:(T,n)=>({u_matrix:new c.bR(T,n.u_matrix),u_world:new c.bU(T,n.u_world),u_image:new c.bP(T,n.u_image),u_color_ramp:new c.bP(T,n.u_color_ramp),u_opacity:new c.bg(T,n.u_opacity)}),hillshade:(T,n)=>({u_image:new c.bP(T,n.u_image),u_latrange:new c.bU(T,n.u_latrange),u_exaggeration:new c.bg(T,n.u_exaggeration),u_altitudes:new c.b_(T,n.u_altitudes),u_azimuths:new c.b_(T,n.u_azimuths),u_accent:new c.bQ(T,n.u_accent),u_method:new c.bP(T,n.u_method),u_shadows:new c.bZ(T,n.u_shadows),u_highlights:new c.bZ(T,n.u_highlights)}),hillshadePrepare:(T,n)=>({u_matrix:new c.bR(T,n.u_matrix),u_image:new c.bP(T,n.u_image),u_dimension:new c.bU(T,n.u_dimension),u_zoom:new c.bg(T,n.u_zoom),u_unpack:new c.bS(T,n.u_unpack)}),colorRelief:(T,n)=>({u_image:new c.bP(T,n.u_image),u_unpack:new c.bS(T,n.u_unpack),u_dimension:new c.bU(T,n.u_dimension),u_elevation_stops:new c.bP(T,n.u_elevation_stops),u_color_stops:new c.bP(T,n.u_color_stops),u_color_ramp_size:new c.bP(T,n.u_color_ramp_size),u_opacity:new c.bg(T,n.u_opacity)}),line:(T,n)=>({u_translation:new c.bU(T,n.u_translation),u_ratio:new c.bg(T,n.u_ratio),u_device_pixel_ratio:new c.bg(T,n.u_device_pixel_ratio),u_units_to_pixels:new c.bU(T,n.u_units_to_pixels)}),lineGradient:(T,n)=>({u_translation:new c.bU(T,n.u_translation),u_ratio:new c.bg(T,n.u_ratio),u_device_pixel_ratio:new c.bg(T,n.u_device_pixel_ratio),u_units_to_pixels:new c.bU(T,n.u_units_to_pixels),u_image:new c.bP(T,n.u_image),u_image_height:new c.bg(T,n.u_image_height)}),linePattern:(T,n)=>({u_translation:new c.bU(T,n.u_translation),u_texsize:new c.bU(T,n.u_texsize),u_ratio:new c.bg(T,n.u_ratio),u_device_pixel_ratio:new c.bg(T,n.u_device_pixel_ratio),u_image:new c.bP(T,n.u_image),u_units_to_pixels:new c.bU(T,n.u_units_to_pixels),u_scale:new c.bT(T,n.u_scale),u_fade:new c.bg(T,n.u_fade)}),lineSDF:(T,n)=>({u_translation:new c.bU(T,n.u_translation),u_ratio:new c.bg(T,n.u_ratio),u_device_pixel_ratio:new c.bg(T,n.u_device_pixel_ratio),u_units_to_pixels:new c.bU(T,n.u_units_to_pixels),u_patternscale_a:new c.bU(T,n.u_patternscale_a),u_patternscale_b:new c.bU(T,n.u_patternscale_b),u_sdfgamma:new c.bg(T,n.u_sdfgamma),u_image:new c.bP(T,n.u_image),u_tex_y_a:new c.bg(T,n.u_tex_y_a),u_tex_y_b:new c.bg(T,n.u_tex_y_b),u_mix:new c.bg(T,n.u_mix)}),raster:(T,n)=>({u_tl_parent:new c.bU(T,n.u_tl_parent),u_scale_parent:new c.bg(T,n.u_scale_parent),u_buffer_scale:new c.bg(T,n.u_buffer_scale),u_fade_t:new c.bg(T,n.u_fade_t),u_opacity:new c.bg(T,n.u_opacity),u_image0:new c.bP(T,n.u_image0),u_image1:new c.bP(T,n.u_image1),u_brightness_low:new c.bg(T,n.u_brightness_low),u_brightness_high:new c.bg(T,n.u_brightness_high),u_saturation_factor:new c.bg(T,n.u_saturation_factor),u_contrast_factor:new c.bg(T,n.u_contrast_factor),u_spin_weights:new c.bT(T,n.u_spin_weights),u_coords_top:new c.bS(T,n.u_coords_top),u_coords_bottom:new c.bS(T,n.u_coords_bottom)}),symbolIcon:(T,n)=>({u_is_size_zoom_constant:new c.bP(T,n.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bP(T,n.u_is_size_feature_constant),u_size_t:new c.bg(T,n.u_size_t),u_size:new c.bg(T,n.u_size),u_camera_to_center_distance:new c.bg(T,n.u_camera_to_center_distance),u_pitch:new c.bg(T,n.u_pitch),u_rotate_symbol:new c.bP(T,n.u_rotate_symbol),u_aspect_ratio:new c.bg(T,n.u_aspect_ratio),u_fade_change:new c.bg(T,n.u_fade_change),u_label_plane_matrix:new c.bR(T,n.u_label_plane_matrix),u_coord_matrix:new c.bR(T,n.u_coord_matrix),u_is_text:new c.bP(T,n.u_is_text),u_pitch_with_map:new c.bP(T,n.u_pitch_with_map),u_is_along_line:new c.bP(T,n.u_is_along_line),u_is_variable_anchor:new c.bP(T,n.u_is_variable_anchor),u_texsize:new c.bU(T,n.u_texsize),u_texture:new c.bP(T,n.u_texture),u_translation:new c.bU(T,n.u_translation),u_pitched_scale:new c.bg(T,n.u_pitched_scale)}),symbolSDF:(T,n)=>({u_is_size_zoom_constant:new c.bP(T,n.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bP(T,n.u_is_size_feature_constant),u_size_t:new c.bg(T,n.u_size_t),u_size:new c.bg(T,n.u_size),u_camera_to_center_distance:new c.bg(T,n.u_camera_to_center_distance),u_pitch:new c.bg(T,n.u_pitch),u_rotate_symbol:new c.bP(T,n.u_rotate_symbol),u_aspect_ratio:new c.bg(T,n.u_aspect_ratio),u_fade_change:new c.bg(T,n.u_fade_change),u_label_plane_matrix:new c.bR(T,n.u_label_plane_matrix),u_coord_matrix:new c.bR(T,n.u_coord_matrix),u_is_text:new c.bP(T,n.u_is_text),u_pitch_with_map:new c.bP(T,n.u_pitch_with_map),u_is_along_line:new c.bP(T,n.u_is_along_line),u_is_variable_anchor:new c.bP(T,n.u_is_variable_anchor),u_texsize:new c.bU(T,n.u_texsize),u_texture:new c.bP(T,n.u_texture),u_gamma_scale:new c.bg(T,n.u_gamma_scale),u_device_pixel_ratio:new c.bg(T,n.u_device_pixel_ratio),u_is_halo:new c.bP(T,n.u_is_halo),u_translation:new c.bU(T,n.u_translation),u_pitched_scale:new c.bg(T,n.u_pitched_scale)}),symbolTextAndIcon:(T,n)=>({u_is_size_zoom_constant:new c.bP(T,n.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bP(T,n.u_is_size_feature_constant),u_size_t:new c.bg(T,n.u_size_t),u_size:new c.bg(T,n.u_size),u_camera_to_center_distance:new c.bg(T,n.u_camera_to_center_distance),u_pitch:new c.bg(T,n.u_pitch),u_rotate_symbol:new c.bP(T,n.u_rotate_symbol),u_aspect_ratio:new c.bg(T,n.u_aspect_ratio),u_fade_change:new c.bg(T,n.u_fade_change),u_label_plane_matrix:new c.bR(T,n.u_label_plane_matrix),u_coord_matrix:new c.bR(T,n.u_coord_matrix),u_is_text:new c.bP(T,n.u_is_text),u_pitch_with_map:new c.bP(T,n.u_pitch_with_map),u_is_along_line:new c.bP(T,n.u_is_along_line),u_is_variable_anchor:new c.bP(T,n.u_is_variable_anchor),u_texsize:new c.bU(T,n.u_texsize),u_texsize_icon:new c.bU(T,n.u_texsize_icon),u_texture:new c.bP(T,n.u_texture),u_texture_icon:new c.bP(T,n.u_texture_icon),u_gamma_scale:new c.bg(T,n.u_gamma_scale),u_device_pixel_ratio:new c.bg(T,n.u_device_pixel_ratio),u_is_halo:new c.bP(T,n.u_is_halo),u_translation:new c.bU(T,n.u_translation),u_pitched_scale:new c.bg(T,n.u_pitched_scale)}),background:(T,n)=>({u_opacity:new c.bg(T,n.u_opacity),u_color:new c.bQ(T,n.u_color)}),backgroundPattern:(T,n)=>({u_opacity:new c.bg(T,n.u_opacity),u_image:new c.bP(T,n.u_image),u_pattern_tl_a:new c.bU(T,n.u_pattern_tl_a),u_pattern_br_a:new c.bU(T,n.u_pattern_br_a),u_pattern_tl_b:new c.bU(T,n.u_pattern_tl_b),u_pattern_br_b:new c.bU(T,n.u_pattern_br_b),u_texsize:new c.bU(T,n.u_texsize),u_mix:new c.bg(T,n.u_mix),u_pattern_size_a:new c.bU(T,n.u_pattern_size_a),u_pattern_size_b:new c.bU(T,n.u_pattern_size_b),u_scale_a:new c.bg(T,n.u_scale_a),u_scale_b:new c.bg(T,n.u_scale_b),u_pixel_coord_upper:new c.bU(T,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(T,n.u_pixel_coord_lower),u_tile_units_to_pixels:new c.bg(T,n.u_tile_units_to_pixels)}),terrain:(T,n)=>({u_texture:new c.bP(T,n.u_texture),u_ele_delta:new c.bg(T,n.u_ele_delta),u_fog_matrix:new c.bR(T,n.u_fog_matrix),u_fog_color:new c.bQ(T,n.u_fog_color),u_fog_ground_blend:new c.bg(T,n.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.bg(T,n.u_fog_ground_blend_opacity),u_horizon_color:new c.bQ(T,n.u_horizon_color),u_horizon_fog_blend:new c.bg(T,n.u_horizon_fog_blend),u_is_globe_mode:new c.bg(T,n.u_is_globe_mode)}),terrainDepth:(T,n)=>({u_ele_delta:new c.bg(T,n.u_ele_delta)}),terrainCoords:(T,n)=>({u_texture:new c.bP(T,n.u_texture),u_terrain_coords_id:new c.bg(T,n.u_terrain_coords_id),u_ele_delta:new c.bg(T,n.u_ele_delta)}),projectionErrorMeasurement:(T,n)=>({u_input:new c.bg(T,n.u_input),u_output_expected:new c.bg(T,n.u_output_expected)}),atmosphere:(T,n)=>({u_sun_pos:new c.bT(T,n.u_sun_pos),u_atmosphere_blend:new c.bg(T,n.u_atmosphere_blend),u_globe_position:new c.bT(T,n.u_globe_position),u_globe_radius:new c.bg(T,n.u_globe_radius),u_inv_proj_matrix:new c.bR(T,n.u_inv_proj_matrix)}),sky:(T,n)=>({u_sky_color:new c.bQ(T,n.u_sky_color),u_horizon_color:new c.bQ(T,n.u_horizon_color),u_horizon:new c.bU(T,n.u_horizon),u_horizon_normal:new c.bU(T,n.u_horizon_normal),u_sky_horizon_blend:new c.bg(T,n.u_sky_horizon_blend),u_sky_blend:new c.bg(T,n.u_sky_blend)})};class ol{constructor(n,u,g){this.context=n;const b=n.gl;this.buffer=b.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const u=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ra={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Es{constructor(n,u,g,b){this.length=u.length,this.attributes=g,this.itemSize=u.bytesPerElement,this.dynamicDraw=b,this.context=n;const S=n.gl;this.buffer=S.createBuffer(),n.bindVertexBuffer.set(this.buffer),S.bufferData(S.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){if(n.length!==this.length)throw new Error(`Length of new data is ${n.length}, which doesn't match current length of ${this.length}`);const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,u){for(let g=0;g<this.attributes.length;g++){const b=u.attributes[this.attributes[g].name];b!==void 0&&n.enableVertexAttribArray(b)}}setVertexAttribPointers(n,u,g){for(let b=0;b<this.attributes.length;b++){const S=this.attributes[b],I=u.attributes[S.name];I!==void 0&&n.vertexAttribPointer(I,S.components,n[ra[S.type]],!1,this.itemSize,S.offset+this.itemSize*(g||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class li{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class pu extends li{getDefault(){return c.bf.transparent}set(n){const u=this.current;(n.r!==u.r||n.g!==u.g||n.b!==u.b||n.a!==u.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Hu extends li{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class Wu extends li{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class ll extends li{getDefault(){return[!0,!0,!0,!0]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||n[3]!==u[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class ul extends li{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class cl extends li{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class dh extends li{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const u=this.current;(n.func!==u.func||n.ref!==u.ref||n.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class kc extends li{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class Xu extends li{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=n,this.dirty=!1}}class Kd extends li{getDefault(){return[0,1]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class zl extends li{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=n,this.dirty=!1}}class Ku extends li{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class Dc extends li{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.BLEND):u.disable(u.BLEND),this.current=n,this.dirty=!1}}class zc extends li{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class aa extends li{getDefault(){return c.bf.transparent}set(n){const u=this.current;(n.r!==u.r||n.g!==u.g||n.b!==u.b||n.a!==u.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Hl extends li{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class fh extends li{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=n,this.dirty=!1}}class Po extends li{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class Oc extends li{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}class mu extends li{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}}class co extends li{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class gu extends li{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||n[3]!==u[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class td extends li{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class hl extends li{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class pa extends li{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class Wl extends li{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class ts extends li{getDefault(){return null}set(n){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class ma extends li{getDefault(){return null}set(n){var u;if(n===this.current&&!this.dirty)return;const g=this.gl;Yr(g)?g.bindVertexArray(n):(u=g.getExtension("OES_vertex_array_object"))===null||u===void 0||u.bindVertexArrayOES(n),this.current=n,this.dirty=!1}}class _u extends li{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class Yu extends li{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class Qs extends li{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class dl extends li{constructor(n,u){super(n),this.context=n,this.parent=u}getDefault(){return null}}class Ro extends dl{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class Xl extends dl{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class $n extends dl{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}const Lo="Framebuffer is not complete";class Gf{constructor(n,u,g,b,S){this.context=n,this.width=u,this.height=g;const I=n.gl,O=this.framebuffer=I.createFramebuffer();if(this.colorAttachment=new Ro(n,O),b)this.depthAttachment=S?new $n(n,O):new Xl(n,O);else if(S)throw new Error("Stencil cannot be set without depth");if(I.checkFramebufferStatus(I.FRAMEBUFFER)!==I.FRAMEBUFFER_COMPLETE)throw new Error(Lo)}destroy(){const n=this.context.gl,u=this.colorAttachment.get();if(u&&n.deleteTexture(u),this.depthAttachment){const g=this.depthAttachment.get();g&&n.deleteRenderbuffer(g)}n.deleteFramebuffer(this.framebuffer)}}class ns{constructor(n){var u,g;if(this.gl=n,this.clearColor=new pu(this),this.clearDepth=new Hu(this),this.clearStencil=new Wu(this),this.colorMask=new ll(this),this.depthMask=new ul(this),this.stencilMask=new cl(this),this.stencilFunc=new dh(this),this.stencilOp=new kc(this),this.stencilTest=new Xu(this),this.depthRange=new Kd(this),this.depthTest=new zl(this),this.depthFunc=new Ku(this),this.blend=new Dc(this),this.blendFunc=new zc(this),this.blendColor=new aa(this),this.blendEquation=new Hl(this),this.cullFace=new fh(this),this.cullFaceSide=new Po(this),this.frontFace=new Oc(this),this.program=new mu(this),this.activeTexture=new co(this),this.viewport=new gu(this),this.bindFramebuffer=new td(this),this.bindRenderbuffer=new hl(this),this.bindTexture=new pa(this),this.bindVertexBuffer=new Wl(this),this.bindElementBuffer=new ts(this),this.bindVertexArray=new ma(this),this.pixelStoreUnpack=new _u(this),this.pixelStoreUnpackPremultiplyAlpha=new Yu(this),this.pixelStoreUnpackFlipY=new Qs(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),Yr(n)){this.HALF_FLOAT=n.HALF_FLOAT;const b=n.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(u=n.RGBA16F)!==null&&u!==void 0?u:b==null?void 0:b.RGBA16F_EXT,this.RGB16F=(g=n.RGB16F)!==null&&g!==void 0?g:b==null?void 0:b.RGB16F_EXT,n.getExtension("EXT_color_buffer_float")}else{n.getExtension("EXT_color_buffer_half_float"),n.getExtension("OES_texture_half_float_linear");const b=n.getExtension("OES_texture_half_float");this.HALF_FLOAT=b==null?void 0:b.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,u){return new ol(this,n,u)}createVertexBuffer(n,u,g){return new Es(this,n,u,g)}createRenderbuffer(n,u,g){const b=this.gl,S=b.createRenderbuffer();return this.bindRenderbuffer.set(S),b.renderbufferStorage(b.RENDERBUFFER,n,u,g),this.bindRenderbuffer.set(null),S}createFramebuffer(n,u,g,b){return new Gf(this,n,u,g,b)}clear({color:n,depth:u,stencil:g}){const b=this.gl;let S=0;n&&(S|=b.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(S|=b.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),g!==void 0&&(S|=b.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),b.clear(S)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){c.bH(n.blendFunction,bn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}createVertexArray(){var n;return Yr(this.gl)?this.gl.createVertexArray():(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.createVertexArrayOES()}deleteVertexArray(n){var u;return Yr(this.gl)?this.gl.deleteVertexArray(n):(u=this.gl.getExtension("OES_vertex_array_object"))===null||u===void 0?void 0:u.deleteVertexArrayOES(n)}unbindVAO(){this.bindVertexArray.set(null)}}let ko;function Do(T,n,u,g,b){const S=T.context,I=T.transform,O=S.gl,N=T.useProgram("collisionBox"),j=[];let $=0,X=0;for(let ve=0;ve<g.length;ve++){const we=g[ve],Me=n.getTile(we).getBucket(u);if(!Me)continue;const Ee=b?Me.textCollisionBox:Me.iconCollisionBox,ze=Me.collisionCircleArray;ze.length>0&&(j.push({circleArray:ze,circleOffset:X,coord:we}),$+=ze.length/4,X=$),Ee&&N.draw(S,O.LINES,sn.disabled,qn.disabled,T.colorModeForRenderPass(),fn.disabled,Ts(T.transform),T.style.map.terrain&&T.style.map.terrain.getTerrainData(we),I.getProjectionData({overscaledTileID:we,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),u.id,Ee.layoutVertexBuffer,Ee.indexBuffer,Ee.segments,null,T.transform.zoom,null,null,Ee.collisionVertexBuffer)}if(!b||!j.length)return;const H=T.useProgram("collisionCircle"),J=new c.b$;J.resize(4*$),J._trim();let ae=0;for(const ve of j)for(let we=0;we<ve.circleArray.length/4;we++){const Me=4*we,Ee=ve.circleArray[Me+0],ze=ve.circleArray[Me+1],Ve=ve.circleArray[Me+2],Ie=ve.circleArray[Me+3];J.emplace(ae++,Ee,ze,Ve,Ie,0),J.emplace(ae++,Ee,ze,Ve,Ie,1),J.emplace(ae++,Ee,ze,Ve,Ie,2),J.emplace(ae++,Ee,ze,Ve,Ie,3)}(!ko||ko.length<2*$)&&(ko=(function(ve){const we=2*ve,Me=new c.c1;Me.resize(we),Me._trim();for(let Ee=0;Ee<we;Ee++){const ze=6*Ee;Me.uint16[ze+0]=4*Ee+0,Me.uint16[ze+1]=4*Ee+1,Me.uint16[ze+2]=4*Ee+2,Me.uint16[ze+3]=4*Ee+2,Me.uint16[ze+4]=4*Ee+3,Me.uint16[ze+5]=4*Ee+0}return Me})($));const _e=S.createIndexBuffer(ko,!0),me=S.createVertexBuffer(J,c.c0.members,!0);for(const ve of j){const we=hu(T.transform);H.draw(S,O.TRIANGLES,sn.disabled,qn.disabled,T.colorModeForRenderPass(),fn.disabled,we,T.style.map.terrain&&T.style.map.terrain.getTerrainData(ve.coord),null,u.id,me,_e,c.aM.simpleSegment(0,2*ve.circleOffset,ve.circleArray.length,ve.circleArray.length/2),null,T.transform.zoom,null,null,null)}me.destroy(),_e.destroy()}const nd=c.ag(new Float32Array(16));function Qu(T,n,u,g,b,S){const{horizontalAlign:I,verticalAlign:O}=c.aH(T);return new c.P((-(I-.5)*n/b+g[0])*S,(-(O-.5)*u/b+g[1])*S)}function yu(T,n,u,g,b,S){const I=n.tileAnchorPoint.add(new c.P(n.translation[0],n.translation[1]));if(n.pitchWithMap){let O=g.mult(S);u||(O=O.rotate(-b));const N=I.add(O);return br(N.x,N.y,n.pitchedLabelPlaneMatrix,n.getElevation).point}if(u){const O=ir(n.tileAnchorPoint.x+1,n.tileAnchorPoint.y,n).point.sub(T),N=Math.atan(O.y/O.x)+(O.x<0?Math.PI:0);return T.add(g.rotate(N))}return T.add(g)}function Ju(T,n,u,g,b,S,I,O,N,j,$,X){const H=T.text.placedSymbolArray,J=T.text.dynamicLayoutVertexArray,ae=T.icon.dynamicLayoutVertexArray,_e={};J.clear();for(let me=0;me<H.length;me++){const ve=H.get(me),we=ve.hidden||!ve.crossTileID||T.allowVerticalPlacement&&!ve.placedOrientation?null:g[ve.crossTileID];if(we){const Me=new c.P(ve.anchorX,ve.anchorY),Ee={getElevation:X,width:b.width,height:b.height,pitchedLabelPlaneMatrix:S,pitchWithMap:u,transform:b,tileAnchorPoint:Me,translation:j,unwrappedTileID:$},ze=u?To(Me.x,Me.y,Ee):ir(Me.x,Me.y,Ee),Ve=Rt(b.cameraToCenterDistance,ze.signedDistanceFromCamera);let Ie=c.ap(T.textSizeData,O,ve)*Ve/c.aB;u&&(Ie*=T.tilePixelRatio/I);const{width:Ye,height:ct,anchor:rt,textOffset:st,textBoxScale:lt}=we,Nt=Qu(rt,Ye,ct,st,lt,Ie),Ft=b.getPitchedTextCorrection(Me.x+j[0],Me.y+j[1],$),Ct=yu(ze.point,Ee,n,Nt,-b.bearingInRadians,Ft),ln=T.allowVerticalPlacement&&ve.placedOrientation===c.ao.vertical?Math.PI/2:0;for(let Zn=0;Zn<ve.numGlyphs;Zn++)c.av(J,Ct,ln);N&&ve.associatedIconIndex>=0&&(_e[ve.associatedIconIndex]={shiftedAnchor:Ct,angle:ln})}else $r(ve.numGlyphs,J)}if(N){ae.clear();const me=T.icon.placedSymbolArray;for(let ve=0;ve<me.length;ve++){const we=me.get(ve);if(we.hidden)$r(we.numGlyphs,ae);else{const Me=_e[ve];if(Me)for(let Ee=0;Ee<we.numGlyphs;Ee++)c.av(ae,Me.shiftedAnchor,Me.angle);else $r(we.numGlyphs,ae)}}T.icon.dynamicLayoutVertexBuffer.updateData(ae)}T.text.dynamicLayoutVertexBuffer.updateData(J)}function ec(T,n,u){return u.iconsInText&&n?"symbolTextAndIcon":T?"symbolSDF":"symbolIcon"}function vu(T,n,u,g,b,S,I,O,N,j,$,X,H){const J=T.context,ae=J.gl,_e=T.transform,me=O==="map",ve=N==="map",we=O!=="viewport"&&u.layout.get("symbol-placement")!=="point",Me=me&&!ve&&!we,Ee=!u.layout.get("symbol-sort-key").isConstant();let ze=!1;const Ve=T.getDepthModeForSublayer(0,sn.ReadOnly),Ie=u._unevaluatedLayout.hasValue("text-variable-anchor")||u._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ye=[],ct=_e.getCircleRadiusCorrection();for(const rt of g){const st=n.getTile(rt),lt=st.getBucket(u);if(!lt)continue;const Nt=b?lt.text:lt.icon;if(!Nt||!Nt.segments.get().length||!Nt.hasVisibleVertices)continue;const Ft=Nt.programConfigurations.get(u.id),Ct=b||lt.sdfIcons,ln=b?lt.textSizeData:lt.iconSizeData,Zn=ve||_e.pitch!==0,bi=T.useProgram(ec(Ct,b,lt),Ft),Yi=c.an(ln,_e.zoom),qi=T.style.map.terrain&&T.style.map.terrain.getTerrainData(rt);let Pr,Fr,jn,ur,sa=[0,0],Vr=null;if(b)Fr=st.glyphAtlasTexture,jn=ae.LINEAR,Pr=st.glyphAtlasTexture.size,lt.iconsInText&&(sa=st.imageAtlasTexture.size,Vr=st.imageAtlasTexture,ur=Zn||T.options.rotating||T.options.zooming||ln.kind==="composite"||ln.kind==="camera"?ae.LINEAR:ae.NEAREST);else{const oa=u.layout.get("icon-size").constantOr(0)!==1||lt.iconsNeedLinear;Fr=st.imageAtlasTexture,jn=Ct||T.options.rotating||T.options.zooming||oa||Zn?ae.LINEAR:ae.NEAREST,Pr=st.imageAtlasTexture.size}const La=c.aC(st,1,T.transform.zoom),Xa=Ir(me,T.transform,La),fo=c.L();c.aq(fo,Xa);const Cu=Vn(ve,me,T.transform,La),iu=c.aD(_e,st,S,I),wh=_e.getProjectionData({overscaledTileID:rt,applyGlobeMatrix:!H,applyTerrainMatrix:!0}),qc=Ie&&lt.hasTextData(),hc=u.layout.get("icon-text-fit")!=="none"&&qc&&lt.hasIconData();if(we){const oa=T.style.map.terrain?(jo,ua)=>T.style.map.terrain.getElevation(rt,jo,ua):null,la=u.layout.get("text-rotation-alignment")==="map";nr(lt,T,b,Xa,fo,ve,j,la,rt.toUnwrapped(),_e.width,_e.height,iu,oa)}const dc=b&&Ie||hc,to=we||dc?nd:ve?Xa:T.transform.clipSpaceToPixelsMatrix,_l=Ct&&u.paint.get(b?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ss;ss=Ct?lt.iconsInText?Wd(ln.kind,Yi,Me,ve,we,dc,T,to,Cu,iu,Pr,sa,ct):Lc(ln.kind,Yi,Me,ve,we,dc,T,to,Cu,iu,b,Pr,0,ct):Zu(ln.kind,Yi,Me,ve,we,dc,T,to,Cu,iu,b,Pr,ct);const Iu={program:bi,buffers:Nt,uniformValues:ss,projectionData:wh,atlasTexture:Fr,atlasTextureIcon:Vr,atlasInterpolation:jn,atlasInterpolationIcon:ur,isSDF:Ct,hasHalo:_l};if(Ee&&lt.canOverlap){ze=!0;const oa=Nt.segments.get();for(const la of oa)Ye.push({segments:new c.aM([la]),sortKey:la.sortKey,state:Iu,terrainData:qi})}else Ye.push({segments:Nt.segments,sortKey:0,state:Iu,terrainData:qi})}ze&&Ye.sort(((rt,st)=>rt.sortKey-st.sortKey));for(const rt of Ye){const st=rt.state;if(J.activeTexture.set(ae.TEXTURE0),st.atlasTexture.bind(st.atlasInterpolation,ae.CLAMP_TO_EDGE),st.atlasTextureIcon&&(J.activeTexture.set(ae.TEXTURE1),st.atlasTextureIcon&&st.atlasTextureIcon.bind(st.atlasInterpolationIcon,ae.CLAMP_TO_EDGE)),st.isSDF){const lt=st.uniformValues;st.hasHalo&&(lt.u_is_halo=1,f(st.buffers,rt.segments,u,T,st.program,Ve,$,X,lt,st.projectionData,rt.terrainData)),lt.u_is_halo=0}f(st.buffers,rt.segments,u,T,st.program,Ve,$,X,st.uniformValues,st.projectionData,rt.terrainData)}}function f(T,n,u,g,b,S,I,O,N,j,$){const X=g.context;b.draw(X,X.gl.TRIANGLES,S,I,O,fn.backCCW,N,$,j,u.id,T.layoutVertexBuffer,T.indexBuffer,n,u.paint,g.transform.zoom,T.programConfigurations.get(u.id),T.dynamicLayoutVertexBuffer,T.opacityVertexBuffer)}function x(T,n,u,g,b){const S=T.context,I=S.gl,O=qn.disabled,N=new bn([I.ONE,I.ONE],c.bf.transparent,[!0,!0,!0,!0]),j=n.getBucket(u);if(!j)return;const $=g.key;let X=u.heatmapFbos.get($);X||(X=U(S,n.tileSize,n.tileSize),u.heatmapFbos.set($,X)),S.bindFramebuffer.set(X.framebuffer),S.viewport.set([0,0,n.tileSize,n.tileSize]),S.clear({color:c.bf.transparent});const H=j.programConfigurations.get(u.id),J=T.useProgram("heatmap",H,!b),ae=T.transform.getProjectionData({overscaledTileID:n.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),_e=T.style.map.terrain.getTerrainData(g);J.draw(S,I.TRIANGLES,sn.disabled,O,N,fn.disabled,du(n,T.transform.zoom,u.paint.get("heatmap-intensity"),1),_e,ae,u.id,j.layoutVertexBuffer,j.indexBuffer,j.segments,u.paint,T.transform.zoom,H)}function R(T,n,u,g,b){const S=T.context,I=S.gl,O=T.transform;S.setColorMode(T.colorModeForRenderPass());const N=K(S,n),j=u.key,$=n.heatmapFbos.get(j);if(!$)return;S.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,$.colorAttachment.get()),S.activeTexture.set(I.TEXTURE1),N.bind(I.LINEAR,I.CLAMP_TO_EDGE);const X=O.getProjectionData({overscaledTileID:u,applyTerrainMatrix:b,applyGlobeMatrix:!g});T.useProgram("heatmapTexture").draw(S,I.TRIANGLES,sn.disabled,qn.disabled,T.colorModeForRenderPass(),fn.disabled,Ks(T,n,0,1),null,X,n.id,T.rasterBoundsBuffer,T.quadTriangleIndexBuffer,T.rasterBoundsSegments,n.paint,O.zoom),$.destroy(),n.heatmapFbos.delete(j)}function U(T,n,u){var g,b;const S=T.gl,I=S.createTexture();S.bindTexture(S.TEXTURE_2D,I),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_S,S.CLAMP_TO_EDGE),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_T,S.CLAMP_TO_EDGE),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MIN_FILTER,S.LINEAR),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MAG_FILTER,S.LINEAR);const O=(g=T.HALF_FLOAT)!==null&&g!==void 0?g:S.UNSIGNED_BYTE,N=(b=T.RGBA16F)!==null&&b!==void 0?b:S.RGBA;S.texImage2D(S.TEXTURE_2D,0,N,n,u,0,S.RGBA,O,null);const j=T.createFramebuffer(n,u,!1,!1);return j.colorAttachment.set(I),j}function K(T,n){return n.colorRampTexture||(n.colorRampTexture=new c.T(T,n.colorRamp,T.gl.RGBA)),n.colorRampTexture}function ue(T,n,u,g,b){if(!u||!g||!g.imageAtlas)return;const S=g.imageAtlas.patternPositions;let I=S[u.to.toString()],O=S[u.from.toString()];if(!I&&O&&(I=O),!O&&I&&(O=I),!I||!O){const N=b.getPaintProperty(n);I=S[N],O=S[N]}I&&O&&T.setConstantPatternPositions(I,O)}function Oe(T,n,u,g,b,S,I,O){const N=T.context.gl,j="fill-pattern",$=u.paint.get(j),X=$&&$.constantOr(1),H=u.getCrossfadeParameters();let J,ae,_e,me,ve;const we=T.transform,Me=u.paint.get("fill-translate"),Ee=u.paint.get("fill-translate-anchor");I?(ae=X&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",J=N.LINES):(ae=X?"fillPattern":"fill",J=N.TRIANGLES);const ze=$.constantOr(null);for(const Ve of g){const Ie=n.getTile(Ve);if(X&&!Ie.patternsLoaded())continue;const Ye=Ie.getBucket(u);if(!Ye)continue;const ct=Ye.programConfigurations.get(u.id),rt=T.useProgram(ae,ct),st=T.style.map.terrain&&T.style.map.terrain.getTerrainData(Ve);X&&(T.context.activeTexture.set(N.TEXTURE0),Ie.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),ct.updatePaintBuffers(H)),ue(ct,j,ze,Ie,u);const lt=we.getProjectionData({overscaledTileID:Ve,applyGlobeMatrix:!O,applyTerrainMatrix:!0}),Nt=c.aD(we,Ie,Me,Ee);if(I){me=Ye.indexBuffer2,ve=Ye.segments2;const Ct=[N.drawingBufferWidth,N.drawingBufferHeight];_e=ae==="fillOutlinePattern"&&X?Ga(T,H,Ie,Ct,Nt):$a(Ct,Nt)}else me=Ye.indexBuffer,ve=Ye.segments,_e=X?Ki(T,H,Ie,Nt):{u_fill_translate:Nt};const Ft=T.stencilModeForClipping(Ve);rt.draw(T.context,J,b,Ft,S,fn.backCCW,_e,st,lt,u.id,Ye.layoutVertexBuffer,me,ve,u.paint,T.transform.zoom,ct)}}function nt(T,n,u,g,b,S,I,O){const N=T.context,j=N.gl,$="fill-extrusion-pattern",X=u.paint.get($),H=X.constantOr(1),J=u.getCrossfadeParameters(),ae=u.paint.get("fill-extrusion-opacity"),_e=X.constantOr(null),me=T.transform;for(const ve of g){const we=n.getTile(ve),Me=we.getBucket(u);if(!Me)continue;const Ee=T.style.map.terrain&&T.style.map.terrain.getTerrainData(ve),ze=Me.programConfigurations.get(u.id),Ve=T.useProgram(H?"fillExtrusionPattern":"fillExtrusion",ze);H&&(T.context.activeTexture.set(j.TEXTURE0),we.imageAtlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),ze.updatePaintBuffers(J));const Ie=me.getProjectionData({overscaledTileID:ve,applyGlobeMatrix:!O,applyTerrainMatrix:!0});ue(ze,$,_e,we,u);const Ye=c.aD(me,we,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),ct=u.paint.get("fill-extrusion-vertical-gradient"),rt=H?Ti(T,ct,ae,Ye,ve,J,we):Xn(T,ct,ae,Ye);Ve.draw(N,N.gl.TRIANGLES,b,S,I,fn.backCCW,rt,Ee,Ie,u.id,Me.layoutVertexBuffer,Me.indexBuffer,Me.segments,u.paint,T.transform.zoom,ze,T.style.map.terrain&&Me.centroidVertexBuffer)}}function ut(T,n,u,g,b,S,I,O,N){var j;const $=T.style.projection,X=T.context,H=T.transform,J=X.gl,ae=[`#define NUM_ILLUMINATION_SOURCES ${u.paint.get("hillshade-highlight-color").values.length}`],_e=T.useProgram("hillshade",null,!1,ae),me=!T.options.moving;for(const ve of g){const we=n.getTile(ve),Me=we.fbo;if(!Me)continue;const Ee=$.getMeshFromTileID(X,ve.canonical,O,!0,"raster"),ze=(j=T.style.map.terrain)===null||j===void 0?void 0:j.getTerrainData(ve);X.activeTexture.set(J.TEXTURE0),J.bindTexture(J.TEXTURE_2D,Me.colorAttachment.get());const Ve=H.getProjectionData({overscaledTileID:ve,aligned:me,applyGlobeMatrix:!N,applyTerrainMatrix:!0});_e.draw(X,J.TRIANGLES,S,b[ve.overscaledZ],I,fn.backCCW,ju(T,we,u),ze,Ve,u.id,Ee.vertexBuffer,Ee.indexBuffer,Ee.segments)}}function Mt(T,n,u,g,b,S,I,O,N){var j;const $=T.style.projection,X=T.context,H=T.transform,J=X.gl,ae=T.useProgram("colorRelief"),_e=!T.options.moving;let me=!0,ve=0;for(const we of g){const Me=n.getTile(we),Ee=Me.dem;if(me){const rt=J.getParameter(J.MAX_TEXTURE_SIZE),{elevationTexture:st,colorTexture:lt}=u.getColorRampTextures(X,rt,Ee.getUnpackVector());X.activeTexture.set(J.TEXTURE1),st.bind(J.NEAREST,J.CLAMP_TO_EDGE),X.activeTexture.set(J.TEXTURE4),lt.bind(J.LINEAR,J.CLAMP_TO_EDGE),me=!1,ve=st.size[0]}if(!Ee||!Ee.data)continue;const ze=Ee.stride,Ve=Ee.getPixels();if(X.activeTexture.set(J.TEXTURE0),X.pixelStoreUnpackPremultiplyAlpha.set(!1),Me.demTexture=Me.demTexture||T.getTileTexture(ze),Me.demTexture){const rt=Me.demTexture;rt.update(Ve,{premultiply:!1}),rt.bind(J.LINEAR,J.CLAMP_TO_EDGE)}else Me.demTexture=new c.T(X,Ve,J.RGBA,{premultiply:!1}),Me.demTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE);const Ie=$.getMeshFromTileID(X,we.canonical,O,!0,"raster"),Ye=(j=T.style.map.terrain)===null||j===void 0?void 0:j.getTerrainData(we),ct=H.getProjectionData({overscaledTileID:we,aligned:_e,applyGlobeMatrix:!N,applyTerrainMatrix:!0});ae.draw(X,J.TRIANGLES,S,b[we.overscaledZ],I,fn.backCCW,Jh(u,Me.dem,ve),Ye,ct,u.id,Ie.vertexBuffer,Ie.indexBuffer,Ie.segments)}}const Kt=[new c.P(0,0),new c.P(c.$,0),new c.P(c.$,c.$),new c.P(0,c.$)];function pn(T,n,u,g,b,S,I,O,N=!1,j=!1){const $=g[g.length-1].overscaledZ,X=T.context,H=X.gl,J=T.useProgram("raster"),ae=T.transform,_e=T.style.projection,me=T.colorModeForRenderPass(),ve=!T.options.moving;for(const we of g){const Me=T.getDepthModeForSublayer(we.overscaledZ-$,u.paint.get("raster-opacity")===1?sn.ReadWrite:sn.ReadOnly,H.LESS),Ee=n.getTile(we);Ee.registerFadeDuration(u.paint.get("raster-fade-duration"));const ze=n.findLoadedParent(we,0),Ve=n.findLoadedSibling(we),Ie=Yn(Ee,ze||Ve||null,n,u,T.transform,T.style.map.terrain);let Ye,ct;const rt=u.paint.get("raster-resampling")==="nearest"?H.NEAREST:H.LINEAR;X.activeTexture.set(H.TEXTURE0),Ee.texture.bind(rt,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),X.activeTexture.set(H.TEXTURE1),ze?(ze.texture.bind(rt,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),Ye=Math.pow(2,ze.tileID.overscaledZ-Ee.tileID.overscaledZ),ct=[Ee.tileID.canonical.x*Ye%1,Ee.tileID.canonical.y*Ye%1]):Ee.texture.bind(rt,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),Ee.texture.useMipmap&&X.extTextureFilterAnisotropic&&T.transform.pitch>20&&H.texParameterf(H.TEXTURE_2D,X.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,X.extTextureFilterAnisotropicMax);const st=T.style.map.terrain&&T.style.map.terrain.getTerrainData(we),lt=ae.getProjectionData({overscaledTileID:we,aligned:ve,applyGlobeMatrix:!j,applyTerrainMatrix:!0}),Nt=Ss(ct||[0,0],Ye||1,Ie,u,O),Ft=_e.getMeshFromTileID(X,we.canonical,S,I,"raster");J.draw(X,H.TRIANGLES,Me,b?b[we.overscaledZ]:qn.disabled,me,N?fn.frontCCW:fn.backCCW,Nt,st,lt,u.id,Ft.vertexBuffer,Ft.indexBuffer,Ft.segments)}}function Yn(T,n,u,g,b,S){const I=g.paint.get("raster-fade-duration");if(!S&&I>0){const O=ee.now(),N=(O-T.timeAdded)/I,j=n?(O-n.timeAdded)/I:-1,$=u.getSource(),X=tn(b,{tileSize:$.tileSize,roundZoom:$.roundZoom}),H=!n||Math.abs(n.tileID.overscaledZ-X)>Math.abs(T.tileID.overscaledZ-X),J=H&&T.refreshedUponExpiration?1:c.ah(H?N:1-j,0,1);return T.refreshedUponExpiration&&N>=1&&(T.refreshedUponExpiration=!1),n?{opacity:1,mix:1-J}:{opacity:J,mix:0}}return{opacity:1,mix:0}}const ga=new c.bf(1,0,0,1),Zr=new c.bf(0,1,0,1),Za=new c.bf(0,0,1,1),Si=new c.bf(1,0,1,1),Li=new c.bf(0,1,1,1);function ui(T,n,u,g){Hr(T,0,n+u/2,T.transform.width,u,g)}function ki(T,n,u,g){Hr(T,n-u/2,0,u,T.transform.height,g)}function Hr(T,n,u,g,b,S){const I=T.context,O=I.gl;O.enable(O.SCISSOR_TEST),O.scissor(n*T.pixelRatio,u*T.pixelRatio,g*T.pixelRatio,b*T.pixelRatio),I.clear({color:S}),O.disable(O.SCISSOR_TEST)}function is(T,n,u){const g=T.context,b=g.gl,S=T.useProgram("debug"),I=sn.disabled,O=qn.disabled,N=T.colorModeForRenderPass(),j="$debug",$=T.style.map.terrain&&T.style.map.terrain.getTerrainData(u);g.activeTexture.set(b.TEXTURE0);const X=n.getTileByID(u.key).latestRawTileData,H=Math.floor((X&&X.byteLength||0)/1024),J=n.getTile(u).tileSize,ae=512/Math.min(J,512)*(u.overscaledZ/T.transform.zoom)*.5;let _e=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(_e+=` => ${u.overscaledZ}`),(function(ve,we){ve.initDebugOverlayCanvas();const Me=ve.debugOverlayCanvas,Ee=ve.context.gl,ze=ve.debugOverlayCanvas.getContext("2d");ze.clearRect(0,0,Me.width,Me.height),ze.shadowColor="white",ze.shadowBlur=2,ze.lineWidth=1.5,ze.strokeStyle="white",ze.textBaseline="top",ze.font="bold 36px Open Sans, sans-serif",ze.fillText(we,5,5),ze.strokeText(we,5,5),ve.debugOverlayTexture.update(Me),ve.debugOverlayTexture.bind(Ee.LINEAR,Ee.CLAMP_TO_EDGE)})(T,`${_e} ${H}kB`);const me=T.transform.getProjectionData({overscaledTileID:u,applyGlobeMatrix:!0,applyTerrainMatrix:!0});S.draw(g,b.TRIANGLES,I,O,bn.alphaBlended,fn.disabled,Xs(c.bf.transparent,ae),null,me,j,T.debugBuffer,T.quadTriangleIndexBuffer,T.debugSegments),S.draw(g,b.LINE_STRIP,I,O,N,fn.disabled,Xs(c.bf.red),$,me,j,T.debugBuffer,T.tileBorderIndexBuffer,T.debugSegments)}function zo(T,n,u,g){const{isRenderingGlobe:b}=g,S=T.context,I=S.gl,O=T.transform,N=T.colorModeForRenderPass(),j=T.getDepthModeFor3D(),$=T.useProgram("terrain");S.bindFramebuffer.set(null),S.viewport.set([0,0,T.width,T.height]);for(const X of u){const H=n.getTerrainMesh(X.tileID),J=T.renderToTexture.getTexture(X),ae=n.getTerrainData(X.tileID);S.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,J.texture);const _e=n.getMeshFrameDelta(O.zoom),me=O.calculateFogMatrix(X.tileID.toUnwrapped()),ve=ye(_e,me,T.style.sky,O.pitch,b),we=O.getProjectionData({overscaledTileID:X.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});$.draw(S,I.TRIANGLES,j,qn.disabled,N,fn.backCCW,ve,ae,we,"terrain",H.vertexBuffer,H.indexBuffer,H.segments)}}function bu(T,n){if(!n.mesh){const u=new c.aL;u.emplaceBack(-1,-1),u.emplaceBack(1,-1),u.emplaceBack(1,1),u.emplaceBack(-1,1);const g=new c.aN;g.emplaceBack(0,1,2),g.emplaceBack(0,2,3),n.mesh=new Ja(T.createVertexBuffer(u,_s.members),T.createIndexBuffer(g),c.aM.simpleSegment(0,0,u.length,g.length))}return n.mesh}class Nr{constructor(n,u){this.context=new ns(n),this.transform=u,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Rn.maxUnderzooming+Rn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Qa}resize(n,u,g){if(this.width=Math.floor(n*g),this.height=Math.floor(u*g),this.pixelRatio=g,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const b of this.style._order)this.style._layers[b].resize()}setup(){const n=this.context,u=new c.aL;u.emplaceBack(0,0),u.emplaceBack(c.$,0),u.emplaceBack(0,c.$),u.emplaceBack(c.$,c.$),this.tileExtentBuffer=n.createVertexBuffer(u,_s.members),this.tileExtentSegments=c.aM.simpleSegment(0,0,4,2);const g=new c.aL;g.emplaceBack(0,0),g.emplaceBack(c.$,0),g.emplaceBack(0,c.$),g.emplaceBack(c.$,c.$),this.debugBuffer=n.createVertexBuffer(g,_s.members),this.debugSegments=c.aM.simpleSegment(0,0,4,5);const b=new c.c6;b.emplaceBack(0,0,0,0),b.emplaceBack(c.$,0,c.$,0),b.emplaceBack(0,c.$,0,c.$),b.emplaceBack(c.$,c.$,c.$,c.$),this.rasterBoundsBuffer=n.createVertexBuffer(b,Z.members),this.rasterBoundsSegments=c.aM.simpleSegment(0,0,4,2);const S=new c.aL;S.emplaceBack(0,0),S.emplaceBack(c.$,0),S.emplaceBack(0,c.$),S.emplaceBack(c.$,c.$),this.rasterBoundsBufferPosOnly=n.createVertexBuffer(S,_s.members),this.rasterBoundsSegmentsPosOnly=c.aM.simpleSegment(0,0,4,5);const I=new c.aL;I.emplaceBack(0,0),I.emplaceBack(1,0),I.emplaceBack(0,1),I.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(I,_s.members),this.viewportSegments=c.aM.simpleSegment(0,0,4,2);const O=new c.c7;O.emplaceBack(0),O.emplaceBack(1),O.emplaceBack(3),O.emplaceBack(2),O.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(O);const N=new c.aN;N.emplaceBack(1,0,2),N.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(N);const j=this.context.gl;this.stencilClearMode=new qn({func:j.ALWAYS,mask:0},0,255,j.ZERO,j.ZERO,j.ZERO),this.tileExtentMesh=new Ja(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const n=this.context,u=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const g=c.L();c.bY(g,0,this.width,this.height,0,0,1),c.N(g,g,[u.drawingBufferWidth,u.drawingBufferHeight,0]);const b={mainMatrix:g,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:g};this.useProgram("clippingMask",null,!0).draw(n,u.TRIANGLES,sn.disabled,this.stencilClearMode,bn.disabled,fn.disabled,null,null,b,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(n,u,g){if(this.currentStencilSource===n.source||!n.isTileClipped()||!u||!u.length)return;this.currentStencilSource=n.source,this.nextStencilID+u.length>256&&this.clearStencil();const b=this.context;b.setColorMode(bn.disabled),b.setDepthMode(sn.disabled);const S={};for(const I of u)S[I.key]=this.nextStencilID++;this._renderTileMasks(S,u,g,!0),this._renderTileMasks(S,u,g,!1),this._tileClippingMaskIDs=S}_renderTileMasks(n,u,g,b){const S=this.context,I=S.gl,O=this.style.projection,N=this.transform,j=this.useProgram("clippingMask");for(const $ of u){const X=n[$.key],H=this.style.map.terrain&&this.style.map.terrain.getTerrainData($),J=O.getMeshFromTileID(this.context,$.canonical,b,!0,"stencil"),ae=N.getProjectionData({overscaledTileID:$,applyGlobeMatrix:!g,applyTerrainMatrix:!0});j.draw(S,I.TRIANGLES,sn.disabled,new qn({func:I.ALWAYS,mask:0},X,255,I.KEEP,I.KEEP,I.REPLACE),bn.disabled,g?fn.disabled:fn.backCCW,null,H,ae,"$clipping",J.vertexBuffer,J.indexBuffer,J.segments)}}_renderTilesDepthBuffer(){const n=this.context,u=n.gl,g=this.style.projection,b=this.transform,S=this.useProgram("depth"),I=this.getDepthModeFor3D(),O=qe(b,{tileSize:b.tileSize});for(const N of O){const j=this.style.map.terrain&&this.style.map.terrain.getTerrainData(N),$=g.getMeshFromTileID(this.context,N.canonical,!0,!0,"raster"),X=b.getProjectionData({overscaledTileID:N,applyGlobeMatrix:!0,applyTerrainMatrix:!0});S.draw(n,u.TRIANGLES,I,qn.disabled,bn.disabled,fn.backCCW,null,j,X,"$clipping",$.vertexBuffer,$.indexBuffer,$.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,u=this.context.gl;return new qn({func:u.NOTEQUAL,mask:255},n,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(n){const u=this.context.gl;return new qn({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,u.KEEP,u.KEEP,u.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(n){const u=this.context.gl,g=n.sort(((I,O)=>O.overscaledZ-I.overscaledZ)),b=g[g.length-1].overscaledZ,S=g[0].overscaledZ-b+1;if(S>1){this.currentStencilSource=void 0,this.nextStencilID+S>256&&this.clearStencil();const I={};for(let O=0;O<S;O++)I[O+b]=new qn({func:u.GEQUAL,mask:255},O+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=S,[I,g]}return[{[b]:qn.disabled},g]}stencilConfigForOverlapTwoPass(n){const u=this.context.gl,g=n.sort(((I,O)=>O.overscaledZ-I.overscaledZ)),b=g[g.length-1].overscaledZ,S=g[0].overscaledZ-b+1;if(this.clearStencil(),S>1){const I={},O={};for(let N=0;N<S;N++)I[N+b]=new qn({func:u.GREATER,mask:255},S+1+N,255,u.KEEP,u.KEEP,u.REPLACE),O[N+b]=new qn({func:u.GREATER,mask:255},1+N,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID=2*S+1,[I,O,g]}return this.nextStencilID=3,[{[b]:new qn({func:u.GREATER,mask:255},2,255,u.KEEP,u.KEEP,u.REPLACE)},{[b]:new qn({func:u.GREATER,mask:255},1,255,u.KEEP,u.KEEP,u.REPLACE)},g]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new bn([n.CONSTANT_COLOR,n.ONE],new c.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?bn.unblended:bn.alphaBlended}getDepthModeForSublayer(n,u,g){if(!this.opaquePassEnabledForLayer())return sn.disabled;const b=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new sn(g||this.context.gl.LEQUAL,u,[b,b])}getDepthModeFor3D(){return new sn(this.context.gl.LEQUAL,sn.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,u){var g,b;this.style=n,this.options=u,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(ee.now()),this.imageManager.beginFrame();const S=this.style._order,I=this.style.sourceCaches,O={},N={},j={},$={isRenderingToTexture:!1,isRenderingGlobe:((g=n.projection)===null||g===void 0?void 0:g.transitionState)>0};for(const H in I){const J=I[H];J.used&&J.prepare(this.context),O[H]=J.getVisibleCoordinates(!1),N[H]=O[H].slice().reverse(),j[H]=J.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let H=0;H<S.length;H++)if(this.style._layers[S[H]].is3D()){this.opaquePassCutoff=H;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const H of S){const J=this.style._layers[H];if(!J.hasOffscreenPass()||J.isHidden(this.transform.zoom))continue;const ae=N[J.source];(J.type==="custom"||ae.length)&&this.renderLayer(this,I[J.source],J,ae,$)}if((b=this.style.projection)===null||b===void 0||b.updateGPUdependent({context:this.context,useProgram:H=>this.useProgram(H)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?c.bf.black:c.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(H,J){const ae=H.context,_e=ae.gl,me=((Ve,Ie,Ye)=>{const ct=Math.cos(Ie.rollInRadians),rt=Math.sin(Ie.rollInRadians),st=De(Ie),lt=Ie.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Ve.properties.get("sky-color"),u_horizon_color:Ve.properties.get("horizon-color"),u_horizon:[(Ie.width/2-st*rt)*Ye,(Ie.height/2+st*ct)*Ye],u_horizon_normal:[-rt,ct],u_sky_horizon_blend:Ve.properties.get("sky-horizon-blend")*Ie.height/2*Ye,u_sky_blend:lt}})(J,H.style.map.transform,H.pixelRatio),ve=new sn(_e.LEQUAL,sn.ReadWrite,[0,1]),we=qn.disabled,Me=H.colorModeForRenderPass(),Ee=H.useProgram("sky"),ze=bu(ae,J);Ee.draw(ae,_e.TRIANGLES,ve,we,Me,fn.disabled,me,null,void 0,"sky",ze.vertexBuffer,ze.indexBuffer,ze.segments)})(this,this.style.sky),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=S.length-1;this.currentLayer>=0;this.currentLayer--){const H=this.style._layers[S[this.currentLayer]],J=I[H.source],ae=O[H.source];this._renderTileClippingMasks(H,ae,!1),this.renderLayer(this,J,H,ae,$)}this.renderPass="translucent";let X=!1;for(this.currentLayer=0;this.currentLayer<S.length;this.currentLayer++){const H=this.style._layers[S[this.currentLayer]],J=I[H.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(H,$))continue;this.opaquePassEnabledForLayer()||X||(X=!0,$.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const ae=(H.type==="symbol"?j:N)[H.source];this._renderTileClippingMasks(H,O[H.source],!!this.renderToTexture),this.renderLayer(this,J,H,ae,$)}if($.isRenderingGlobe&&(function(H,J,ae){const _e=H.context,me=_e.gl,ve=H.useProgram("atmosphere"),we=new sn(me.LEQUAL,sn.ReadOnly,[0,1]),Me=H.transform,Ee=(function(lt,Nt){const Ft=lt.properties.get("position"),Ct=[-Ft.x,-Ft.y,-Ft.z],ln=c.ag(new Float64Array(16));return lt.properties.get("anchor")==="map"&&(c.b6(ln,ln,Nt.rollInRadians),c.b7(ln,ln,-Nt.pitchInRadians),c.b6(ln,ln,Nt.bearingInRadians),c.b7(ln,ln,Nt.center.lat*Math.PI/180),c.bz(ln,ln,-Nt.center.lng*Math.PI/180)),c.c5(Ct,Ct,ln),Ct})(ae,H.transform),ze=Me.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Ve=J.properties.get("atmosphere-blend")*ze.projectionTransition;if(Ve===0)return;const Ie=xs(Me.worldSize,Me.center.lat),Ye=Me.inverseProjectionMatrix,ct=new Float64Array(4);ct[3]=1,c.aw(ct,ct,Me.modelViewProjectionMatrix),ct[0]/=ct[3],ct[1]/=ct[3],ct[2]/=ct[3],ct[3]=1,c.aw(ct,ct,Ye),ct[0]/=ct[3],ct[1]/=ct[3],ct[2]/=ct[3],ct[3]=1;const rt=((lt,Nt,Ft,Ct,ln)=>({u_sun_pos:lt,u_atmosphere_blend:Nt,u_globe_position:Ft,u_globe_radius:Ct,u_inv_proj_matrix:ln}))(Ee,Ve,[ct[0],ct[1],ct[2]],Ie,Ye),st=bu(_e,J);ve.draw(_e,me.TRIANGLES,we,qn.disabled,bn.alphaBlended,fn.disabled,rt,null,null,"atmosphere",st.vertexBuffer,st.indexBuffer,st.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const H=(function(J,ae){let _e=null;const me=Object.values(J._layers).flatMap((Ee=>Ee.source&&!Ee.isHidden(ae)?[J.sourceCaches[Ee.source]]:[])),ve=me.filter((Ee=>Ee.getSource().type==="vector")),we=me.filter((Ee=>Ee.getSource().type!=="vector")),Me=Ee=>{(!_e||_e.getSource().maxzoom<Ee.getSource().maxzoom)&&(_e=Ee)};return ve.forEach((Ee=>Me(Ee))),_e||we.forEach((Ee=>Me(Ee))),_e})(this.style,this.transform.zoom);H&&(function(J,ae,_e){for(let me=0;me<_e.length;me++)is(J,ae,_e[me])})(this,H,H.getVisibleCoordinates())}this.options.showPadding&&(function(H){const J=H.transform.padding;ui(H,H.transform.height-(J.top||0),3,ga),ui(H,J.bottom||0,3,Zr),ki(H,J.left||0,3,Za),ki(H,H.transform.width-(J.right||0),3,Si);const ae=H.transform.centerPoint;(function(_e,me,ve,we){Hr(_e,me-1,ve-10,2,20,we),Hr(_e,me-10,ve-1,20,2,we)})(H,ae.x,H.transform.height-ae.y,Li)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(n){if(!this.style||!this.style.map||!this.style.map.terrain)return;const u=this.terrainFacilitator.matrix,g=this.transform.modelViewProjectionMatrix;let b=this.terrainFacilitator.dirty;b||(b=n?!c.c8(u,g):!c.c9(u,g)),b||(b=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),b&&(c.ca(u,g),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(S,I){const O=S.context,N=O.gl,j=S.transform,$=bn.unblended,X=new sn(N.LEQUAL,sn.ReadWrite,[0,1]),H=I.sourceCache.getRenderableTiles(),J=S.useProgram("terrainDepth");O.bindFramebuffer.set(I.getFramebuffer("depth").framebuffer),O.viewport.set([0,0,S.width/devicePixelRatio,S.height/devicePixelRatio]),O.clear({color:c.bf.transparent,depth:1});for(const ae of H){const _e=I.getTerrainMesh(ae.tileID),me=I.getTerrainData(ae.tileID),ve=j.getProjectionData({overscaledTileID:ae.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),we={u_ele_delta:I.getMeshFrameDelta(j.zoom)};J.draw(O,N.TRIANGLES,X,qn.disabled,$,fn.backCCW,we,me,ve,"terrain",_e.vertexBuffer,_e.indexBuffer,_e.segments)}O.bindFramebuffer.set(null),O.viewport.set([0,0,S.width,S.height])})(this,this.style.map.terrain),(function(S,I){const O=S.context,N=O.gl,j=S.transform,$=bn.unblended,X=new sn(N.LEQUAL,sn.ReadWrite,[0,1]),H=I.getCoordsTexture(),J=I.sourceCache.getRenderableTiles(),ae=S.useProgram("terrainCoords");O.bindFramebuffer.set(I.getFramebuffer("coords").framebuffer),O.viewport.set([0,0,S.width/devicePixelRatio,S.height/devicePixelRatio]),O.clear({color:c.bf.transparent,depth:1}),I.coordsIndex=[];for(const _e of J){const me=I.getTerrainMesh(_e.tileID),ve=I.getTerrainData(_e.tileID);O.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,H.texture);const we={u_terrain_coords_id:(255-I.coordsIndex.length)/255,u_texture:0,u_ele_delta:I.getMeshFrameDelta(j.zoom)},Me=j.getProjectionData({overscaledTileID:_e.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});ae.draw(O,N.TRIANGLES,X,qn.disabled,$,fn.backCCW,we,ve,Me,"terrain",me.vertexBuffer,me.indexBuffer,me.segments),I.coordsIndex.push(_e.tileID.key)}O.bindFramebuffer.set(null),O.viewport.set([0,0,S.width,S.height])})(this,this.style.map.terrain))}renderLayer(n,u,g,b,S){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="custom"||(b||[]).length)&&(this.id=g.id,c.cb(g)?(function(I,O,N,j,$,X){if(I.renderPass!=="translucent")return;const{isRenderingToTexture:H}=X,J=qn.disabled,ae=I.colorModeForRenderPass();(N._unevaluatedLayout.hasValue("text-variable-anchor")||N._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(_e,me,ve,we,Me,Ee,ze,Ve,Ie){const Ye=me.transform,ct=me.style.map.terrain,rt=Me==="map",st=Ee==="map";for(const lt of _e){const Nt=we.getTile(lt),Ft=Nt.getBucket(ve);if(!Ft||!Ft.text||!Ft.text.segments.get().length)continue;const Ct=c.an(Ft.textSizeData,Ye.zoom),ln=c.aC(Nt,1,me.transform.zoom),Zn=Ir(rt,me.transform,ln),bi=ve.layout.get("icon-text-fit")!=="none"&&Ft.hasIconData();if(Ct){const Yi=Math.pow(2,Ye.zoom-Nt.tileID.overscaledZ),qi=ct?(Pr,Fr)=>ct.getElevation(lt,Pr,Fr):null;Ju(Ft,rt,st,Ie,Ye,Zn,Yi,Ct,bi,c.aD(Ye,Nt,ze,Ve),lt.toUnwrapped(),qi)}}})(j,I,N,O,N.layout.get("text-rotation-alignment"),N.layout.get("text-pitch-alignment"),N.paint.get("text-translate"),N.paint.get("text-translate-anchor"),$),N.paint.get("icon-opacity").constantOr(1)!==0&&vu(I,O,N,j,!1,N.paint.get("icon-translate"),N.paint.get("icon-translate-anchor"),N.layout.get("icon-rotation-alignment"),N.layout.get("icon-pitch-alignment"),N.layout.get("icon-keep-upright"),J,ae,H),N.paint.get("text-opacity").constantOr(1)!==0&&vu(I,O,N,j,!0,N.paint.get("text-translate"),N.paint.get("text-translate-anchor"),N.layout.get("text-rotation-alignment"),N.layout.get("text-pitch-alignment"),N.layout.get("text-keep-upright"),J,ae,H),O.map.showCollisionBoxes&&(Do(I,O,N,j,!0),Do(I,O,N,j,!1))})(n,u,g,b,this.style.placement.variableOffsets,S):c.cc(g)?(function(I,O,N,j,$){if(I.renderPass!=="translucent")return;const{isRenderingToTexture:X}=$,H=N.paint.get("circle-opacity"),J=N.paint.get("circle-stroke-width"),ae=N.paint.get("circle-stroke-opacity"),_e=!N.layout.get("circle-sort-key").isConstant();if(H.constantOr(1)===0&&(J.constantOr(1)===0||ae.constantOr(1)===0))return;const me=I.context,ve=me.gl,we=I.transform,Me=I.getDepthModeForSublayer(0,sn.ReadOnly),Ee=qn.disabled,ze=I.colorModeForRenderPass(),Ve=[],Ie=we.getCircleRadiusCorrection();for(let Ye=0;Ye<j.length;Ye++){const ct=j[Ye],rt=O.getTile(ct),st=rt.getBucket(N);if(!st)continue;const lt=N.paint.get("circle-translate"),Nt=N.paint.get("circle-translate-anchor"),Ft=c.aD(we,rt,lt,Nt),Ct=st.programConfigurations.get(N.id),ln=I.useProgram("circle",Ct),Zn=st.layoutVertexBuffer,bi=st.indexBuffer,Yi=I.style.map.terrain&&I.style.map.terrain.getTerrainData(ct),qi={programConfiguration:Ct,program:ln,layoutVertexBuffer:Zn,indexBuffer:bi,uniformValues:Ws(I,rt,N,Ft,Ie),terrainData:Yi,projectionData:we.getProjectionData({overscaledTileID:ct,applyGlobeMatrix:!X,applyTerrainMatrix:!0})};if(_e){const Pr=st.segments.get();for(const Fr of Pr)Ve.push({segments:new c.aM([Fr]),sortKey:Fr.sortKey,state:qi})}else Ve.push({segments:st.segments,sortKey:0,state:qi})}_e&&Ve.sort(((Ye,ct)=>Ye.sortKey-ct.sortKey));for(const Ye of Ve){const{programConfiguration:ct,program:rt,layoutVertexBuffer:st,indexBuffer:lt,uniformValues:Nt,terrainData:Ft,projectionData:Ct}=Ye.state;rt.draw(me,ve.TRIANGLES,Me,Ee,ze,fn.backCCW,Nt,Ft,Ct,N.id,st,lt,Ye.segments,N.paint,I.transform.zoom,ct)}})(n,u,g,b,S):c.cd(g)?(function(I,O,N,j,$){if(N.paint.get("heatmap-opacity")===0)return;const X=I.context,{isRenderingToTexture:H,isRenderingGlobe:J}=$;if(I.style.map.terrain){for(const ae of j){const _e=O.getTile(ae);O.hasRenderableParent(ae)||(I.renderPass==="offscreen"?x(I,_e,N,ae,J):I.renderPass==="translucent"&&R(I,N,ae,H,J))}X.viewport.set([0,0,I.width,I.height])}else I.renderPass==="offscreen"?(function(ae,_e,me,ve){const we=ae.context,Me=we.gl,Ee=ae.transform,ze=qn.disabled,Ve=new bn([Me.ONE,Me.ONE],c.bf.transparent,[!0,!0,!0,!0]);(function(Ie,Ye,ct){const rt=Ie.gl;Ie.activeTexture.set(rt.TEXTURE1),Ie.viewport.set([0,0,Ye.width/4,Ye.height/4]);let st=ct.heatmapFbos.get(c.c2);st?(rt.bindTexture(rt.TEXTURE_2D,st.colorAttachment.get()),Ie.bindFramebuffer.set(st.framebuffer)):(st=U(Ie,Ye.width/4,Ye.height/4),ct.heatmapFbos.set(c.c2,st))})(we,ae,me),we.clear({color:c.bf.transparent});for(let Ie=0;Ie<ve.length;Ie++){const Ye=ve[Ie];if(_e.hasRenderableParent(Ye))continue;const ct=_e.getTile(Ye),rt=ct.getBucket(me);if(!rt)continue;const st=rt.programConfigurations.get(me.id),lt=ae.useProgram("heatmap",st),Nt=Ee.getProjectionData({overscaledTileID:Ye,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Ft=Ee.getCircleRadiusCorrection();lt.draw(we,Me.TRIANGLES,sn.disabled,ze,Ve,fn.backCCW,du(ct,Ee.zoom,me.paint.get("heatmap-intensity"),Ft),null,Nt,me.id,rt.layoutVertexBuffer,rt.indexBuffer,rt.segments,me.paint,Ee.zoom,st)}we.viewport.set([0,0,ae.width,ae.height])})(I,O,N,j):I.renderPass==="translucent"&&(function(ae,_e){const me=ae.context,ve=me.gl;me.setColorMode(ae.colorModeForRenderPass());const we=_e.heatmapFbos.get(c.c2);we&&(me.activeTexture.set(ve.TEXTURE0),ve.bindTexture(ve.TEXTURE_2D,we.colorAttachment.get()),me.activeTexture.set(ve.TEXTURE1),K(me,_e).bind(ve.LINEAR,ve.CLAMP_TO_EDGE),ae.useProgram("heatmapTexture").draw(me,ve.TRIANGLES,sn.disabled,qn.disabled,ae.colorModeForRenderPass(),fn.disabled,Ks(ae,_e,0,1),null,null,_e.id,ae.viewportBuffer,ae.quadTriangleIndexBuffer,ae.viewportSegments,_e.paint,ae.transform.zoom))})(I,N)})(n,u,g,b,S):c.ce(g)?(function(I,O,N,j,$){if(I.renderPass!=="translucent")return;const{isRenderingToTexture:X}=$,H=N.paint.get("line-opacity"),J=N.paint.get("line-width");if(H.constantOr(1)===0||J.constantOr(1)===0)return;const ae=I.getDepthModeForSublayer(0,sn.ReadOnly),_e=I.colorModeForRenderPass(),me=N.paint.get("line-dasharray"),ve=N.paint.get("line-pattern"),we=ve.constantOr(1),Me=N.paint.get("line-gradient"),Ee=N.getCrossfadeParameters(),ze=we?"linePattern":me?"lineSDF":Me?"lineGradient":"line",Ve=I.context,Ie=Ve.gl,Ye=I.transform;let ct=!0;for(const rt of j){const st=O.getTile(rt);if(we&&!st.patternsLoaded())continue;const lt=st.getBucket(N);if(!lt)continue;const Nt=lt.programConfigurations.get(N.id),Ft=I.context.program.get(),Ct=I.useProgram(ze,Nt),ln=ct||Ct.program!==Ft,Zn=I.style.map.terrain&&I.style.map.terrain.getTerrainData(rt),bi=ve.constantOr(null);if(bi&&st.imageAtlas){const jn=st.imageAtlas,ur=jn.patternPositions[bi.to.toString()],sa=jn.patternPositions[bi.from.toString()];ur&&sa&&Nt.setConstantPatternPositions(ur,sa)}const Yi=Ye.getProjectionData({overscaledTileID:rt,applyGlobeMatrix:!X,applyTerrainMatrix:!0}),qi=Ye.getPixelScale(),Pr=we?$u(I,st,N,qi,Ee):me?Mo(I,st,N,qi,me,Ee):Me?qu(I,st,N,qi,lt.lineClipsArray.length):Ys(I,st,N,qi);if(we)Ve.activeTexture.set(Ie.TEXTURE0),st.imageAtlasTexture.bind(Ie.LINEAR,Ie.CLAMP_TO_EDGE),Nt.updatePaintBuffers(Ee);else if(me&&(ln||I.lineAtlas.dirty))Ve.activeTexture.set(Ie.TEXTURE0),I.lineAtlas.bind(Ve);else if(Me){const jn=lt.gradients[N.id];let ur=jn.texture;if(N.gradientVersion!==jn.version){let sa=256;if(N.stepInterpolant){const Vr=O.getSource().maxzoom,La=rt.canonical.z===Vr?Math.ceil(1<<I.transform.maxZoom-rt.canonical.z):1;sa=c.ah(c.c3(lt.maxLineLength/c.$*1024*La),256,Ve.maxTextureSize)}jn.gradient=c.c4({expression:N.gradientExpression(),evaluationKey:"lineProgress",resolution:sa,image:jn.gradient||void 0,clips:lt.lineClipsArray}),jn.texture?jn.texture.update(jn.gradient):jn.texture=new c.T(Ve,jn.gradient,Ie.RGBA),jn.version=N.gradientVersion,ur=jn.texture}Ve.activeTexture.set(Ie.TEXTURE0),ur.bind(N.stepInterpolant?Ie.NEAREST:Ie.LINEAR,Ie.CLAMP_TO_EDGE)}const Fr=I.stencilModeForClipping(rt);Ct.draw(Ve,Ie.TRIANGLES,ae,Fr,_e,fn.disabled,Pr,Zn,Yi,N.id,lt.layoutVertexBuffer,lt.indexBuffer,lt.segments,N.paint,I.transform.zoom,Nt,lt.layoutVertexBuffer2),ct=!1}})(n,u,g,b,S):c.cf(g)?(function(I,O,N,j,$){const X=N.paint.get("fill-color"),H=N.paint.get("fill-opacity");if(H.constantOr(1)===0)return;const{isRenderingToTexture:J}=$,ae=I.colorModeForRenderPass(),_e=N.paint.get("fill-pattern"),me=I.opaquePassEnabledForLayer()&&!_e.constantOr(1)&&X.constantOr(c.bf.transparent).a===1&&H.constantOr(0)===1?"opaque":"translucent";if(I.renderPass===me){const ve=I.getDepthModeForSublayer(1,I.renderPass==="opaque"?sn.ReadWrite:sn.ReadOnly);Oe(I,O,N,j,ve,ae,!1,J)}if(I.renderPass==="translucent"&&N.paint.get("fill-antialias")){const ve=I.getDepthModeForSublayer(N.getPaintProperty("fill-outline-color")?2:0,sn.ReadOnly);Oe(I,O,N,j,ve,ae,!0,J)}})(n,u,g,b,S):c.cg(g)?(function(I,O,N,j,$){const X=N.paint.get("fill-extrusion-opacity");if(X===0)return;const{isRenderingToTexture:H}=$;if(I.renderPass==="translucent"){const J=new sn(I.context.gl.LEQUAL,sn.ReadWrite,I.depthRangeFor3D);if(X!==1||N.paint.get("fill-extrusion-pattern").constantOr(1))nt(I,O,N,j,J,qn.disabled,bn.disabled,H),nt(I,O,N,j,J,I.stencilModeFor3D(),I.colorModeForRenderPass(),H);else{const ae=I.colorModeForRenderPass();nt(I,O,N,j,J,qn.disabled,ae,H)}}})(n,u,g,b,S):c.ch(g)?(function(I,O,N,j,$){if(I.renderPass!=="offscreen"&&I.renderPass!=="translucent")return;const{isRenderingToTexture:X}=$,H=I.context,J=I.style.projection.useSubdivision,ae=I.getDepthModeForSublayer(0,sn.ReadOnly),_e=I.colorModeForRenderPass();if(I.renderPass==="offscreen")(function(me,ve,we,Me,Ee,ze,Ve){const Ie=me.context,Ye=Ie.gl;for(const ct of we){const rt=ve.getTile(ct),st=rt.dem;if(!st||!st.data||!rt.needsHillshadePrepare)continue;const lt=st.dim,Nt=st.stride,Ft=st.getPixels();if(Ie.activeTexture.set(Ye.TEXTURE1),Ie.pixelStoreUnpackPremultiplyAlpha.set(!1),rt.demTexture=rt.demTexture||me.getTileTexture(Nt),rt.demTexture){const ln=rt.demTexture;ln.update(Ft,{premultiply:!1}),ln.bind(Ye.NEAREST,Ye.CLAMP_TO_EDGE)}else rt.demTexture=new c.T(Ie,Ft,Ye.RGBA,{premultiply:!1}),rt.demTexture.bind(Ye.NEAREST,Ye.CLAMP_TO_EDGE);Ie.activeTexture.set(Ye.TEXTURE0);let Ct=rt.fbo;if(!Ct){const ln=new c.T(Ie,{width:lt,height:lt,data:null},Ye.RGBA);ln.bind(Ye.LINEAR,Ye.CLAMP_TO_EDGE),Ct=rt.fbo=Ie.createFramebuffer(lt,lt,!0,!1),Ct.colorAttachment.set(ln.texture)}Ie.bindFramebuffer.set(Ct.framebuffer),Ie.viewport.set([0,0,lt,lt]),me.useProgram("hillshadePrepare").draw(Ie,Ye.TRIANGLES,Ee,ze,Ve,fn.disabled,Hd(rt.tileID,st),null,null,Me.id,me.rasterBoundsBuffer,me.quadTriangleIndexBuffer,me.rasterBoundsSegments),rt.needsHillshadePrepare=!1}})(I,O,j,N,ae,qn.disabled,_e),H.viewport.set([0,0,I.width,I.height]);else if(I.renderPass==="translucent")if(J){const[me,ve,we]=I.stencilConfigForOverlapTwoPass(j);ut(I,O,N,we,me,ae,_e,!1,X),ut(I,O,N,we,ve,ae,_e,!0,X)}else{const[me,ve]=I.getStencilConfigForOverlapAndUpdateStencilID(j);ut(I,O,N,ve,me,ae,_e,!1,X)}})(n,u,g,b,S):c.ci(g)?(function(I,O,N,j,$){if(I.renderPass!=="translucent"||!j.length)return;const{isRenderingToTexture:X}=$,H=I.style.projection.useSubdivision,J=I.getDepthModeForSublayer(0,sn.ReadOnly),ae=I.colorModeForRenderPass();if(H){const[_e,me,ve]=I.stencilConfigForOverlapTwoPass(j);Mt(I,O,N,ve,_e,J,ae,!1,X),Mt(I,O,N,ve,me,J,ae,!0,X)}else{const[_e,me]=I.getStencilConfigForOverlapAndUpdateStencilID(j);Mt(I,O,N,me,_e,J,ae,!1,X)}})(n,u,g,b,S):c.cj(g)?(function(I,O,N,j,$){if(I.renderPass!=="translucent"||N.paint.get("raster-opacity")===0||!j.length)return;const{isRenderingToTexture:X}=$,H=O.getSource(),J=I.style.projection.useSubdivision;if(H instanceof Vi)pn(I,O,N,j,null,!1,!1,H.tileCoords,H.flippedWindingOrder,X);else if(J){const[ae,_e,me]=I.stencilConfigForOverlapTwoPass(j);pn(I,O,N,me,ae,!1,!0,Kt,!1,X),pn(I,O,N,me,_e,!0,!0,Kt,!1,X)}else{const[ae,_e]=I.getStencilConfigForOverlapAndUpdateStencilID(j);pn(I,O,N,_e,ae,!1,!0,Kt,!1,X)}})(n,u,g,b,S):c.ck(g)?(function(I,O,N,j,$){const X=N.paint.get("background-color"),H=N.paint.get("background-opacity");if(H===0)return;const{isRenderingToTexture:J}=$,ae=I.context,_e=ae.gl,me=I.style.projection,ve=I.transform,we=ve.tileSize,Me=N.paint.get("background-pattern");if(I.isPatternMissing(Me))return;const Ee=!Me&&X.a===1&&H===1&&I.opaquePassEnabledForLayer()?"opaque":"translucent";if(I.renderPass!==Ee)return;const ze=qn.disabled,Ve=I.getDepthModeForSublayer(0,Ee==="opaque"?sn.ReadWrite:sn.ReadOnly),Ie=I.colorModeForRenderPass(),Ye=I.useProgram(Me?"backgroundPattern":"background"),ct=j||qe(ve,{tileSize:we,terrain:I.style.map.terrain});Me&&(ae.activeTexture.set(_e.TEXTURE0),I.imageManager.bind(I.context));const rt=N.getCrossfadeParameters();for(const st of ct){const lt=ve.getProjectionData({overscaledTileID:st,applyGlobeMatrix:!J,applyTerrainMatrix:!0}),Nt=Me?Xd(H,I,Me,{tileID:st,tileSize:we},rt):sl(H,X),Ft=I.style.map.terrain&&I.style.map.terrain.getTerrainData(st),Ct=me.getMeshFromTileID(ae,st.canonical,!1,!0,"raster");Ye.draw(ae,_e.TRIANGLES,Ve,ze,Ie,fn.backCCW,Nt,Ft,lt,N.id,Ct.vertexBuffer,Ct.indexBuffer,Ct.segments)}})(n,0,g,b,S):c.cl(g)&&(function(I,O,N,j){const{isRenderingGlobe:$}=j,X=I.context,H=N.implementation,J=I.style.projection,ae=I.transform,_e=ae.getProjectionDataForCustomLayer($),me={farZ:ae.farZ,nearZ:ae.nearZ,fov:ae.fov*Math.PI/180,modelViewProjectionMatrix:ae.modelViewProjectionMatrix,projectionMatrix:ae.projectionMatrix,shaderData:{variantName:J.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${J.shaderPreludeCode.vertexSource}`,define:J.shaderDefine},defaultProjectionData:_e},ve=H.renderingMode?H.renderingMode:"2d";if(I.renderPass==="offscreen"){const we=H.prerender;we&&(I.setCustomLayerDefaults(),X.setColorMode(I.colorModeForRenderPass()),we.call(H,X.gl,me),X.setDirty(),I.setBaseState())}else if(I.renderPass==="translucent"){I.setCustomLayerDefaults(),X.setColorMode(I.colorModeForRenderPass()),X.setStencilMode(qn.disabled);const we=ve==="3d"?I.getDepthModeFor3D():I.getDepthModeForSublayer(0,sn.ReadOnly);X.setDepthMode(we),H.render(X.gl,me),X.setDirty(),I.setBaseState(),X.bindFramebuffer.set(null)}})(n,0,g,S))}saveTileTexture(n){const u=this._tileTextures[n.size[0]];u?u.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const u=this._tileTextures[n];return u&&u.length>0?u.pop():null}isPatternMissing(n){if(!n)return!1;if(!n.from||!n.to)return!0;const u=this.imageManager.getPattern(n.from.toString()),g=this.imageManager.getPattern(n.to.toString());return!u||!g}useProgram(n,u,g=!1,b=[]){this.cache=this.cache||{};const S=!!this.style.map.terrain,I=this.style.projection,O=g?Hi.projectionMercator:I.shaderPreludeCode,N=g?qa:I.shaderDefine,j=n+(u?u.cacheKey:"")+`/${g?Zs:I.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(S?"/terrain":"")+(b?`/${b.join("/")}`:"");return this.cache[j]||(this.cache[j]=new Xt(this.context,Hi[n],u,ed[n],this._showOverdrawInspector,S,O,N,b)),this.cache[j]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new c.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:n,drawingBufferHeight:u}=this.context.gl;return this.width!==n||this.height!==u}}function rs(T,n){let u,g=!1,b=null,S=null;const I=()=>{b=null,g&&(T.apply(S,u),b=setTimeout(I,n),g=!1)};return(...O)=>(g=!0,S=this,u=O,b||I(),b)}class fl{constructor(n){this._getCurrentHash=()=>{const u=window.location.hash.replace("#","");if(this._hashName){let g;return u.split("&").map((b=>b.split("="))).forEach((b=>{b[0]===this._hashName&&(g=b)})),(g&&g[1]||"").split("/")}return u.split("/")},this._onHashChange=()=>{const u=this._getCurrentHash();if(!this._isValidHash(u))return!1;const g=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:g,pitch:+(u[4]||0)}),!0},this._updateHashUnthrottled=()=>{const u=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,u)},this._removeHash=()=>{const u=this._getCurrentHash();if(u.length===0)return;const g=u.join("/");let b=g;b.split("&").length>0&&(b=b.split("&")[0]),this._hashName&&(b=`${this._hashName}=${g}`);let S=window.location.hash.replace(b,"");S.startsWith("#&")?S=S.slice(0,1)+S.slice(2):S==="#"&&(S="");let I=window.location.href.replace(/(#.+)?$/,S);I=I.replace("&&","&"),window.history.replaceState(window.history.state,null,I)},this._updateHash=rs(this._updateHashUnthrottled,300),this._hashName=n&&encodeURIComponent(n)}addTo(n){return this._map=n,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(n){const u=this._map.getCenter(),g=Math.round(100*this._map.getZoom())/100,b=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),S=Math.pow(10,b),I=Math.round(u.lng*S)/S,O=Math.round(u.lat*S)/S,N=this._map.getBearing(),j=this._map.getPitch();let $="";if($+=n?`/${I}/${O}/${g}`:`${g}/${O}/${I}`,(N||j)&&($+="/"+Math.round(10*N)/10),j&&($+=`/${Math.round(j)}`),this._hashName){const X=this._hashName;let H=!1;const J=window.location.hash.slice(1).split("&").map((ae=>{const _e=ae.split("=")[0];return _e===X?(H=!0,`${_e}=${$}`):ae})).filter((ae=>ae));return H||J.push(`${X}=${$}`),`#${J.join("&")}`}return`#${$}`}_isValidHash(n){if(n.length<3||n.some(isNaN))return!1;try{new c.S(+n[2],+n[1])}catch{return!1}const u=+n[0],g=+(n[3]||0),b=+(n[4]||0);return u>=this._map.getMinZoom()&&u<=this._map.getMaxZoom()&&g>=-180&&g<=180&&b>=this._map.getMinPitch()&&b<=this._map.getMaxPitch()}}const Oo={linearity:.3,easing:c.cm(0,0,.3,1)},xu=c.e({deceleration:2500,maxSpeed:1400},Oo),tc=c.e({deceleration:20,maxSpeed:1400},Oo),Ol=c.e({deceleration:1e3,maxSpeed:360},Oo),pl=c.e({deceleration:1e3,maxSpeed:90},Oo),wu=c.e({deceleration:1e3,maxSpeed:360},Oo);class Kl{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:ee.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,u=ee.now();for(;n.length>0&&u-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,roll:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:S}of this._inertiaBuffer)u.zoom+=S.zoomDelta||0,u.bearing+=S.bearingDelta||0,u.pitch+=S.pitchDelta||0,u.roll+=S.rollDelta||0,S.panDelta&&u.pan._add(S.panDelta),S.around&&(u.around=S.around),S.pinchAround&&(u.pinchAround=S.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,b={};if(u.pan.mag()){const S=nc(u.pan.mag(),g,c.e({},xu,n||{})),I=u.pan.mult(S.amount/u.pan.mag()),O=this._map.cameraHelper.handlePanInertia(I,this._map.transform);b.center=O.easingCenter,b.offset=O.easingOffset,No(b,S)}if(u.zoom){const S=nc(u.zoom,g,tc);b.zoom=this._map.transform.zoom+S.amount,No(b,S)}if(u.bearing){const S=nc(u.bearing,g,Ol);b.bearing=this._map.transform.bearing+c.ah(S.amount,-179,179),No(b,S)}if(u.pitch){const S=nc(u.pitch,g,pl);b.pitch=this._map.transform.pitch+S.amount,No(b,S)}if(u.roll){const S=nc(u.roll,g,wu);b.roll=this._map.transform.roll+c.ah(S.amount,-179,179),No(b,S)}if(b.zoom||b.bearing){const S=u.pinchAround===void 0?u.around:u.pinchAround;b.around=S?this._map.unproject(S):this._map.getCenter()}return this.clear(),c.e(b,{noMoveStart:!0})}}function No(T,n){(!T.duration||T.duration<n.duration)&&(T.duration=n.duration,T.easing=n.easing)}function nc(T,n,u){const{maxSpeed:g,linearity:b,deceleration:S}=u,I=c.ah(T*b/(n/1e3),-g,g),O=Math.abs(I)/(S*b);return{easing:u.easing,duration:1e3*O,amount:I*(O/2)}}class Ra extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,g,b={}){g=g instanceof MouseEvent?g:new MouseEvent(n,g);const S=Y.mousePos(u.getCanvas(),g),I=u.unproject(S);super(n,c.e({point:S,lngLat:I,originalEvent:g},b)),this._defaultPrevented=!1,this.target=u}}class Tu extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,g){const b=n==="touchend"?g.changedTouches:g.touches,S=Y.touchPos(u.getCanvasContainer(),b),I=S.map((N=>u.unproject(N))),O=S.reduce(((N,j,$,X)=>N.add(j.div(X.length))),new c.P(0,0));super(n,{points:S,point:O,lngLats:I,lngLat:u.unproject(O),originalEvent:g}),this._defaultPrevented=!1}}class Su extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,g){super(n,{originalEvent:g}),this._defaultPrevented=!1}}class Ha{constructor(n,u){this._map=n,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(n){return this._firePreventable(new Su(n.type,this._map,n))}mousedown(n,u){return this._mousedownPos=u,this._firePreventable(new Ra(n.type,this._map,n))}mouseup(n){this._map.fire(new Ra(n.type,this._map,n))}click(n,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new Ra(n.type,this._map,n))}dblclick(n){return this._firePreventable(new Ra(n.type,this._map,n))}mouseover(n){this._map.fire(new Ra(n.type,this._map,n))}mouseout(n){this._map.fire(new Ra(n.type,this._map,n))}touchstart(n){return this._firePreventable(new Tu(n.type,this._map,n))}touchmove(n){this._map.fire(new Tu(n.type,this._map,n))}touchend(n){this._map.fire(new Tu(n.type,this._map,n))}touchcancel(n){this._map.fire(new Tu(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class id{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(n){this._map.fire(new Ra(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ra("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._ignoreContextMenu||this._map.fire(new Ra(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Nc{constructor(n){this._map=n}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(n){return this.transform.screenPointToLocation(c.P.convert(n),this._map.terrain)}}class Zf{constructor(n,u){this._map=n,this._tr=new Nc(n),this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,u){this.isEnabled()&&n.shiftKey&&n.button===0&&(Y.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(n,u){if(!this._active)return;const g=u;if(this._lastPos.equals(g)||!this._box&&g.dist(this._startPos)<this._clickTolerance)return;const b=this._startPos;this._lastPos=g,this._box||(this._box=Y.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",n));const S=Math.min(b.x,g.x),I=Math.max(b.x,g.x),O=Math.min(b.y,g.y),N=Math.max(b.y,g.y);Y.setTransform(this._box,`translate(${S}px,${O}px)`),this._box.style.width=I-S+"px",this._box.style.height=N-O+"px"}mouseupWindow(n,u){if(!this._active||n.button!==0)return;const g=this._startPos,b=u;if(this.reset(),Y.suppressClick(),g.x!==b.x||g.y!==b.y)return this._map.fire(new c.l("boxzoomend",{originalEvent:n})),{cameraAnimation:S=>S.fitScreenCoordinates(g,b,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",n)}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(Y.remove(this._box),this._box=null),Y.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(n,u){return this._map.fire(new c.l(n,{originalEvent:u}))}}function ph(T,n){if(T.length!==n.length)throw new Error(`The number of touches and points are not equal - touches ${T.length}, points ${n.length}`);const u={};for(let g=0;g<T.length;g++)u[T[g].identifier]=n[g];return u}class rm{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(n,u,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),g.length===this.numTouches&&(this.centroid=(function(b){const S=new c.P(0,0);for(const I of b)S._add(I);return S.div(b.length)})(u),this.touches=ph(g,u)))}touchmove(n,u,g){if(this.aborted||!this.centroid)return;const b=ph(g,u);for(const S in this.touches){const I=b[S];(!I||I.dist(this.touches[S])>30)&&(this.aborted=!0)}}touchend(n,u,g){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const b=!this.aborted&&this.centroid;if(this.reset(),b)return b}}}class Ci{constructor(n){this.singleTap=new rm(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(n,u,g){this.singleTap.touchstart(n,u,g)}touchmove(n,u,g){this.singleTap.touchmove(n,u,g)}touchend(n,u,g){const b=this.singleTap.touchend(n,u,g);if(b){const S=n.timeStamp-this.lastTime<500,I=!this.lastTap||this.lastTap.dist(b)<30;if(S&&I||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=b,this.count===this.numTaps)return this.reset(),b}}}class Bo{constructor(n){this._tr=new Nc(n),this._zoomIn=new Ci({numTouches:1,numTaps:2}),this._zoomOut=new Ci({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,u,g){this._zoomIn.touchstart(n,u,g),this._zoomOut.touchstart(n,u,g)}touchmove(n,u,g){this._zoomIn.touchmove(n,u,g),this._zoomOut.touchmove(n,u,g)}touchend(n,u,g){const b=this._zoomIn.touchend(n,u,g),S=this._zoomOut.touchend(n,u,g),I=this._tr;return b?(this._active=!0,n.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:O=>O.easeTo({duration:300,zoom:I.zoom+1,around:I.unproject(b)},{originalEvent:n})}):S?(this._active=!0,n.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:O=>O.easeTo({duration:300,zoom:I.zoom-1,around:I.unproject(S)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Yl{constructor(n){this._enabled=!!n.enable,this._moveStateManager=n.moveStateManager,this._clickTolerance=n.clickTolerance||1,this._moveFunction=n.move,this._activateOnStart=!!n.activateOnStart,n.assignEvents(this),this.reset()}reset(n){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(n)}_move(...n){const u=this._moveFunction(...n);if(u.bearingDelta||u.pitchDelta||u.rollDelta||u.around||u.panDelta)return this._active=!0,u}dragStart(n,u){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(n)&&(this._moveStateManager.startMove(n),this._lastPoint=Array.isArray(u)?u[0]:u,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(n,u){if(!this.isEnabled())return;const g=this._lastPoint;if(!g)return;if(n.preventDefault(),!this._moveStateManager.isValidMoveEvent(n))return void this.reset(n);const b=Array.isArray(u)?u[0]:u;return!this._moved&&b.dist(g)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=b,this._move(g,b))}dragEnd(n){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(n)&&(this._moved&&Y.suppressClick(),this.reset(n))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Js=0,ic=2,mh={[Js]:1,[ic]:2};class Ql{constructor(n){this._correctEvent=n.checkCorrectEvent}startMove(n){const u=Y.mouseButton(n);this._eventButton=u}endMove(n){delete this._eventButton}isValidStartEvent(n){return this._correctEvent(n)}isValidMoveEvent(n){return!(function(u,g){const b=mh[g];return u.buttons===void 0||(u.buttons&b)!==b})(n,this._eventButton)}isValidEndEvent(n){return Y.mouseButton(n)===this._eventButton}}class Rg{constructor(){this._firstTouch=void 0}_isOneFingerTouch(n){return n.targetTouches.length===1}_isSameTouchEvent(n){return n.targetTouches[0].identifier===this._firstTouch}startMove(n){this._firstTouch=n.targetTouches[0].identifier}endMove(n){delete this._firstTouch}isValidStartEvent(n){return this._isOneFingerTouch(n)}isValidMoveEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}isValidEndEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}}class am{constructor(n=new Ql({checkCorrectEvent:()=>!0}),u=new Rg){this.mouseMoveStateManager=n,this.oneFingerTouchMoveStateManager=u}_executeRelevantHandler(n,u,g){return n instanceof MouseEvent?u(n):typeof TouchEvent<"u"&&n instanceof TouchEvent?g(n):void 0}startMove(n){this._executeRelevantHandler(n,(u=>this.mouseMoveStateManager.startMove(u)),(u=>this.oneFingerTouchMoveStateManager.startMove(u)))}endMove(n){this._executeRelevantHandler(n,(u=>this.mouseMoveStateManager.endMove(u)),(u=>this.oneFingerTouchMoveStateManager.endMove(u)))}isValidStartEvent(n){return this._executeRelevantHandler(n,(u=>this.mouseMoveStateManager.isValidStartEvent(u)),(u=>this.oneFingerTouchMoveStateManager.isValidStartEvent(u)))}isValidMoveEvent(n){return this._executeRelevantHandler(n,(u=>this.mouseMoveStateManager.isValidMoveEvent(u)),(u=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(u)))}isValidEndEvent(n){return this._executeRelevantHandler(n,(u=>this.mouseMoveStateManager.isValidEndEvent(u)),(u=>this.oneFingerTouchMoveStateManager.isValidEndEvent(u)))}}const rd=T=>{T.mousedown=T.dragStart,T.mousemoveWindow=T.dragMove,T.mouseup=T.dragEnd,T.contextmenu=n=>{n.preventDefault()}};class gh{constructor(n,u){this._clickTolerance=n.clickTolerance||1,this._map=u,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(n){return n<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(n,u,g){return this._calculateTransform(n,u,g)}touchmove(n,u,g){if(this._active){if(!this._shouldBePrevented(g.length))return n.preventDefault(),this._calculateTransform(n,u,g);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",n)}}touchend(n,u,g){this._calculateTransform(n,u,g),this._active&&this._shouldBePrevented(g.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,u,g){g.length>0&&(this._active=!0);const b=ph(g,u),S=new c.P(0,0),I=new c.P(0,0);let O=0;for(const j in b){const $=b[j],X=this._touches[j];X&&(S._add($),I._add($.sub(X)),O++,b[j]=$)}if(this._touches=b,this._shouldBePrevented(O)||!I.mag())return;const N=I.div(O);return this._sum._add(N),this._sum.mag()<this._clickTolerance?void 0:{around:S.div(O),panDelta:N}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class as{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(n,u,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([u[0],u[1]]))}touchmove(n,u,g){if(!this._firstTwoTouches)return;n.preventDefault();const[b,S]=this._firstTwoTouches,I=Yt(g,u,b),O=Yt(g,u,S);if(!I||!O)return;const N=this._aroundCenter?null:I.add(O).div(2);return this._move([I,O],N,n)}touchend(n,u,g){if(!this._firstTwoTouches)return;const[b,S]=this._firstTwoTouches,I=Yt(g,u,b),O=Yt(g,u,S);I&&O||(this._active&&Y.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Yt(T,n,u){for(let g=0;g<T.length;g++)if(T[g].identifier===u)return n[g]}function _h(T,n){return Math.log(T/n)/Math.LN2}class ad extends as{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,u){const g=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(_h(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:_h(this._distance,g),pinchAround:u}}}function rc(T,n){return 180*T.angleWith(n)/Math.PI}class ac extends as{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,u,g){const b=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:rc(this._vector,b),pinchAround:u}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const u=25/(Math.PI*this._minDiameter)*360,g=rc(n,this._startVector);return Math.abs(g)<u}}function Jl(T){return Math.abs(T.y)>Math.abs(T.x)}class Bc extends as{constructor(n){super(),this._currentTouchCount=0,this._map=n}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(n,u,g){super.touchstart(n,u,g),this._currentTouchCount=g.length}_start(n){this._lastPoints=n,Jl(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,u,g){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const b=n[0].sub(this._lastPoints[0]),S=n[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(b,S,g.timeStamp),this._valid?(this._lastPoints=n,this._active=!0,{pitchDelta:(b.y+S.y)/2*-.5}):void 0}gestureBeginsVertically(n,u,g){if(this._valid!==void 0)return this._valid;const b=n.mag()>=2,S=u.mag()>=2;if(!b&&!S)return;if(!b||!S)return this._firstMove===void 0&&(this._firstMove=g),g-this._firstMove<100&&void 0;const I=n.y>0==u.y>0;return Jl(n)&&Jl(u)&&I}}const ri={panStep:100,bearingStep:15,pitchStep:10};class sd{constructor(n){this._tr=new Nc(n);const u=ri;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let u=0,g=0,b=0,S=0,I=0;switch(n.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:n.shiftKey?g=-1:(n.preventDefault(),S=-1);break;case 39:n.shiftKey?g=1:(n.preventDefault(),S=1);break;case 38:n.shiftKey?b=1:(n.preventDefault(),I=-1);break;case 40:n.shiftKey?b=-1:(n.preventDefault(),I=1);break;default:return}return this._rotationDisabled&&(g=0,b=0),{cameraAnimation:O=>{const N=this._tr;O.easeTo({duration:300,easeId:"keyboardHandler",easing:Fc,zoom:u?Math.round(N.zoom)+u*(n.shiftKey?2:1):N.zoom,bearing:N.bearing+g*this._bearingStep,pitch:N.pitch+b*this._pitchStep,offset:[-S*this._panStep,-I*this._panStep],center:N.center},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Fc(T){return T*(2-T)}const eu=4.000244140625,sm=1/450;class Hf{constructor(n,u){this._onTimeout=g=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(g)},this._map=n,this._tr=new Nc(n),this._triggerRenderFrame=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=sm}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(n){return!!this._map.cooperativeGestures.isEnabled()&&!(n.ctrlKey||this._map.cooperativeGestures.isBypassed(n))}wheel(n){if(!this.isEnabled())return;if(this._shouldBePrevented(n))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",n);let u=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const g=ee.now(),b=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,u!==0&&u%eu==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":b>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(b*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),n.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=n,this._delta-=u,this._active||this._start(n)),n.preventDefault()}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=Y.mousePos(this._map.getCanvas(),n),g=this._tr;this._aroundPoint=this._aroundCenter?g.transform.locationToScreenPoint(c.S.convert(g.center)):u,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const O=n.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=O),typeof this._targetZoom=="number"&&(this._targetZoom+=O)}if(this._delta!==0){const O=this._type==="wheel"&&Math.abs(this._delta)>eu?this._wheelZoomRate:this._defaultZoomRate;let N=2/(1+Math.exp(-Math.abs(this._delta*O)));this._delta<0&&N!==0&&(N=1/N);const j=typeof this._targetZoom!="number"?n.scale:c.af(this._targetZoom);this._targetZoom=n.getConstrained(n.getCameraLngLat(),c.ak(j*N)).zoom,this._type==="wheel"&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const u=typeof this._targetZoom!="number"?n.zoom:this._targetZoom,g=this._startZoom,b=this._easing;let S,I=!1;if(this._type==="wheel"&&g&&b){const O=ee.now()-this._lastWheelEventTime,N=Math.min((O+5)/200,1),j=b(N);S=c.C.number(g,u,j),N<1?this._frameId||(this._frameId=!0):I=!0}else S=u,I=!0;return this._active=!0,I&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=S,{noInertia:!0,needsRenderFrame:!I,zoomDelta:S-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let u=c.co;if(this._prevEase){const g=this._prevEase,b=(ee.now()-g.start)/g.duration,S=g.easing(b+.01)-g.easing(b),I=.27/Math.sqrt(S*S+1e-4)*.01,O=Math.sqrt(.0729-I*I);u=c.cm(I,O,.25,1)}return this._prevEase={start:ee.now(),duration:n,easing:u},u}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class sc{constructor(n,u){this._clickZoom=n,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Vc{constructor(n){this._tr=new Nc(n),this.reset()}reset(){this._active=!1}dblclick(n,u){return n.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:this._tr.zoom+(n.shiftKey?-1:1),around:this._tr.unproject(u)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class od{constructor(){this._tap=new Ci({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(n,u,g){if(!this._swipePoint)if(this._tapTime){const b=u[0],S=n.timeStamp-this._tapTime<500,I=this._tapPoint.dist(b)<30;S&&I?g.length>0&&(this._swipePoint=b,this._swipeTouch=g[0].identifier):this.reset()}else this._tap.touchstart(n,u,g)}touchmove(n,u,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const b=u[0],S=b.y-this._swipePoint.y;return this._swipePoint=b,n.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(n,u,g)}touchend(n,u,g){if(this._tapTime)this._swipePoint&&g.length===0&&this.reset();else{const b=this._tap.touchend(n,u,g);b&&(this._tapTime=n.timeStamp,this._tapPoint=b)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class yh{constructor(n,u,g){this._el=n,this._mousePan=u,this._touchPan=g}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class vh{constructor(n,u,g,b){this._pitchWithRotate=n.pitchWithRotate,this._rollEnabled=n.rollEnabled,this._mouseRotate=u,this._mousePitch=g,this._mouseRoll=b}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Wf{constructor(n,u,g,b){this._el=n,this._touchZoom=u,this._touchRotate=g,this._tapDragZoom=b,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class oc{constructor(n,u){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=n,this._options=u,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const n=this._map.getCanvasContainer();n.classList.add("maplibregl-cooperative-gestures"),this._container=Y.create("div","maplibregl-cooperative-gesture-screen",n);let u=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(u=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const g=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),b=document.createElement("div");b.className="maplibregl-desktop-message",b.textContent=u,this._container.appendChild(b);const S=document.createElement("div");S.className="maplibregl-mobile-message",S.textContent=g,this._container.appendChild(S),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(Y.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(n){return n[this._bypassKey]}notifyGestureBlocked(n,u){this._enabled&&(this._map.fire(new c.l("cooperativegestureprevented",{gestureType:n,originalEvent:u})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const ml=T=>T.zoom||T.drag||T.roll||T.pitch||T.rotate;class Di extends c.l{}function lc(T){return T.panDelta&&T.panDelta.mag()||T.zoomDelta||T.bearingDelta||T.pitchDelta||T.rollDelta}class ld{constructor(n,u){this.handleWindowEvent=b=>{this.handleEvent(b,`${b.type}Window`)},this.handleEvent=(b,S)=>{if(b.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const I=b.type==="renderFrame"?void 0:b,O={needsRenderFrame:!1},N={},j={};for(const{handlerName:H,handler:J,allowed:ae}of this._handlers){if(!J.isEnabled())continue;let _e;if(this._blockedByActive(j,ae,H))J.reset();else if(J[S||b.type]){if(c.cp(b,S||b.type)){const me=Y.mousePos(this._map.getCanvas(),b);_e=J[S||b.type](b,me)}else if(c.cq(b,S||b.type)){const me=this._getMapTouches(b.touches),ve=Y.touchPos(this._map.getCanvas(),me);_e=J[S||b.type](b,ve,me)}else c.cr(S||b.type)||(_e=J[S||b.type](b));this.mergeHandlerResult(O,N,_e,H,I),_e&&_e.needsRenderFrame&&this._triggerRenderFrame()}(_e||J.isActive())&&(j[H]=J)}const $={};for(const H in this._previousActiveHandlers)j[H]||($[H]=I);this._previousActiveHandlers=j,(Object.keys($).length||lc(O))&&(this._changes.push([O,N,$]),this._triggerRenderFrame()),(Object.keys(j).length||lc(O))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:X}=O;X&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],X(this._map))},this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Kl(n),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];for(const[b,S,I]of this._listeners)Y.addEventListener(b,S,b===document?this.handleWindowEvent:this.handleEvent,I)}destroy(){for(const[n,u,g]of this._listeners)Y.removeEventListener(n,u,n===document?this.handleWindowEvent:this.handleEvent,g)}_addDefaultHandlers(n){const u=this._map,g=u.getCanvasContainer();this._add("mapEvent",new Ha(u,n));const b=u.boxZoom=new Zf(u,n);this._add("boxZoom",b),n.interactive&&n.boxZoom&&b.enable();const S=u.cooperativeGestures=new oc(u,n.cooperativeGestures);this._add("cooperativeGestures",S),n.cooperativeGestures&&S.enable();const I=new Bo(u),O=new Vc(u);u.doubleClickZoom=new sc(O,I),this._add("tapZoom",I),this._add("clickZoom",O),n.interactive&&n.doubleClickZoom&&u.doubleClickZoom.enable();const N=new od;this._add("tapDragZoom",N);const j=u.touchPitch=new Bc(u);this._add("touchPitch",j),n.interactive&&n.touchPitch&&u.touchPitch.enable(n.touchPitch);const $=()=>u.project(u.getCenter()),X=(function({enable:Ee,clickTolerance:ze,aroundCenter:Ve=!0,minPixelCenterThreshold:Ie=100,rotateDegreesPerPixelMoved:Ye=.8},ct){const rt=new Ql({checkCorrectEvent:st=>Y.mouseButton(st)===0&&st.ctrlKey||Y.mouseButton(st)===2&&!st.ctrlKey});return new Yl({clickTolerance:ze,move:(st,lt)=>{const Nt=ct();if(Ve&&Math.abs(Nt.y-st.y)>Ie)return{bearingDelta:c.cn(new c.P(st.x,lt.y),lt,Nt)};let Ft=(lt.x-st.x)*Ye;return Ve&&lt.y<Nt.y&&(Ft=-Ft),{bearingDelta:Ft}},moveStateManager:rt,enable:Ee,assignEvents:rd})})(n,$),H=(function({enable:Ee,clickTolerance:ze,pitchDegreesPerPixelMoved:Ve=-.5}){const Ie=new Ql({checkCorrectEvent:Ye=>Y.mouseButton(Ye)===0&&Ye.ctrlKey||Y.mouseButton(Ye)===2});return new Yl({clickTolerance:ze,move:(Ye,ct)=>({pitchDelta:(ct.y-Ye.y)*Ve}),moveStateManager:Ie,enable:Ee,assignEvents:rd})})(n),J=(function({enable:Ee,clickTolerance:ze,rollDegreesPerPixelMoved:Ve=.3},Ie){const Ye=new Ql({checkCorrectEvent:ct=>Y.mouseButton(ct)===2&&ct.ctrlKey});return new Yl({clickTolerance:ze,move:(ct,rt)=>{const st=Ie();let lt=(rt.x-ct.x)*Ve;return rt.y<st.y&&(lt=-lt),{rollDelta:lt}},moveStateManager:Ye,enable:Ee,assignEvents:rd})})(n,$);u.dragRotate=new vh(n,X,H,J),this._add("mouseRotate",X,["mousePitch"]),this._add("mousePitch",H,["mouseRotate","mouseRoll"]),this._add("mouseRoll",J,["mousePitch"]),n.interactive&&n.dragRotate&&u.dragRotate.enable();const ae=(function({enable:Ee,clickTolerance:ze}){const Ve=new Ql({checkCorrectEvent:Ie=>Y.mouseButton(Ie)===0&&!Ie.ctrlKey});return new Yl({clickTolerance:ze,move:(Ie,Ye)=>({around:Ye,panDelta:Ye.sub(Ie)}),activateOnStart:!0,moveStateManager:Ve,enable:Ee,assignEvents:rd})})(n),_e=new gh(n,u);u.dragPan=new yh(g,ae,_e),this._add("mousePan",ae),this._add("touchPan",_e,["touchZoom","touchRotate"]),n.interactive&&n.dragPan&&u.dragPan.enable(n.dragPan);const me=new ac,ve=new ad;u.touchZoomRotate=new Wf(g,ve,me,N),this._add("touchRotate",me,["touchPan","touchZoom"]),this._add("touchZoom",ve,["touchPan","touchRotate"]),n.interactive&&n.touchZoomRotate&&u.touchZoomRotate.enable(n.touchZoomRotate);const we=u.scrollZoom=new Hf(u,(()=>this._triggerRenderFrame()));this._add("scrollZoom",we,["mousePan"]),n.interactive&&n.scrollZoom&&u.scrollZoom.enable(n.scrollZoom);const Me=u.keyboard=new sd(u);this._add("keyboard",Me),n.interactive&&n.keyboard&&u.keyboard.enable(),this._add("blockableMapEvent",new id(u))}_add(n,u,g){this._handlers.push({handlerName:n,handler:u,allowed:g}),this._handlersById[n]=u}stop(n){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ml(this._eventsInProgress)||this.isZooming()}_blockedByActive(n,u,g){for(const b in n)if(b!==g&&(!u||u.indexOf(b)<0))return!0;return!1}_getMapTouches(n){const u=[];for(const g of n)this._el.contains(g.target)&&u.push(g);return u}mergeHandlerResult(n,u,g,b,S){if(!g)return;c.e(n,g);const I={handlerName:b,originalEvent:g.originalEvent||S};g.zoomDelta!==void 0&&(u.zoom=I),g.panDelta!==void 0&&(u.drag=I),g.rollDelta!==void 0&&(u.roll=I),g.pitchDelta!==void 0&&(u.pitch=I),g.bearingDelta!==void 0&&(u.rotate=I)}_applyChanges(){const n={},u={},g={};for(const[b,S,I]of this._changes)b.panDelta&&(n.panDelta=(n.panDelta||new c.P(0,0))._add(b.panDelta)),b.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+b.zoomDelta),b.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+b.bearingDelta),b.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+b.pitchDelta),b.rollDelta&&(n.rollDelta=(n.rollDelta||0)+b.rollDelta),b.around!==void 0&&(n.around=b.around),b.pinchAround!==void 0&&(n.pinchAround=b.pinchAround),b.noInertia&&(n.noInertia=b.noInertia),c.e(u,S),c.e(g,I);this._updateMapTransform(n,u,g),this._changes=[]}_updateMapTransform(n,u,g){const b=this._map,S=b._getTransformForUpdate(),I=b.terrain;if(!(lc(n)||I&&this._terrainMovement))return this._fireEvents(u,g,!0);b._stop(!0);let{panDelta:O,zoomDelta:N,bearingDelta:j,pitchDelta:$,rollDelta:X,around:H,pinchAround:J}=n;J!==void 0&&(H=J),H=H||b.transform.centerPoint,I&&!S.isPointOnMapSurface(H)&&(H=S.centerPoint);const ae={panDelta:O,zoomDelta:N,rollDelta:X,pitchDelta:$,bearingDelta:j,around:H};this._map.cameraHelper.useGlobeControls&&!S.isPointOnMapSurface(H)&&(H=S.centerPoint);const _e=H.distSqr(S.centerPoint)<.01?S.center:S.screenPointToLocation(O?H.sub(O):H);I?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(ae,S),this._terrainMovement||!u.drag&&!u.zoom?u.drag&&this._terrainMovement?S.setCenter(S.screenPointToLocation(S.centerPoint.sub(O))):this._map.cameraHelper.handleMapControlsPan(ae,S,_e):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(ae,S,_e))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(ae,S),this._map.cameraHelper.handleMapControlsPan(ae,S,_e)),b._applyUpdatedTransform(S),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(u,g,!0)}_fireEvents(n,u,g){const b=ml(this._eventsInProgress),S=ml(n),I={};for(const X in n){const{originalEvent:H}=n[X];this._eventsInProgress[X]||(I[`${X}start`]=H),this._eventsInProgress[X]=n[X]}!b&&S&&this._fireEvent("movestart",S.originalEvent);for(const X in I)this._fireEvent(X,I[X]);S&&this._fireEvent("move",S.originalEvent);for(const X in n){const{originalEvent:H}=n[X];this._fireEvent(X,H)}const O={};let N;for(const X in this._eventsInProgress){const{handlerName:H,originalEvent:J}=this._eventsInProgress[X];this._handlersById[H].isActive()||(delete this._eventsInProgress[X],N=u[H]||J,O[`${X}end`]=N)}for(const X in O)this._fireEvent(X,O[X]);const j=ml(this._eventsInProgress),$=(b||S)&&!j;if($&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const X=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&X.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(X)}if(g&&$){this._updatingCamera=!0;const X=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),H=J=>J!==0&&-this._bearingSnap<J&&J<this._bearingSnap;!X||!X.essential&&ee.prefersReducedMotion?(this._map.fire(new c.l("moveend",{originalEvent:N})),H(this._map.getBearing())&&this._map.resetNorth()):(H(X.bearing||this._map.getBearing())&&(X.bearing=0),X.freezeElevation=!0,this._map.easeTo(X,{originalEvent:N})),this._updatingCamera=!1}}_fireEvent(n,u){this._map.fire(new c.l(n,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((n=>{delete this._frameId,this.handleEvent(new Di("renderFrame",{timeStamp:n})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Eu extends c.E{constructor(n,u,g){super(),this._renderFrameCallback=()=>{const b=Math.min((ee.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(b)),b<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=g.bearingSnap,this.cameraHelper=u,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(n,u){n.apply(this.transform),this.transform=n,this.cameraHelper=u}getCenter(){return new c.S(this.transform.center.lng,this.transform.center.lat)}setCenter(n,u){return this.jumpTo({center:n},u)}getCenterElevation(){return this.transform.elevation}setCenterElevation(n,u){return this.jumpTo({elevation:n},u),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(n){this._centerClampedToGround=n}panBy(n,u,g){return n=c.P.convert(n).mult(-1),this.panTo(this.transform.center,c.e({offset:n},u),g)}panTo(n,u,g){return this.easeTo(c.e({center:n},u),g)}getZoom(){return this.transform.zoom}setZoom(n,u){return this.jumpTo({zoom:n},u),this}zoomTo(n,u,g){return this.easeTo(c.e({zoom:n},u),g)}zoomIn(n,u){return this.zoomTo(this.getZoom()+1,n,u),this}zoomOut(n,u){return this.zoomTo(this.getZoom()-1,n,u),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(n,u){return n!=this.transform.fov&&(this.transform.setFov(n),this.fire(new c.l("movestart",u)).fire(new c.l("move",u)).fire(new c.l("moveend",u))),this}getBearing(){return this.transform.bearing}setBearing(n,u){return this.jumpTo({bearing:n},u),this}getPadding(){return this.transform.padding}setPadding(n,u){return this.jumpTo({padding:n},u),this}rotateTo(n,u,g){return this.easeTo(c.e({bearing:n},u),g)}resetNorth(n,u){return this.rotateTo(0,c.e({duration:1e3},n),u),this}resetNorthPitch(n,u){return this.easeTo(c.e({bearing:0,pitch:0,roll:0,duration:1e3},n),u),this}snapToNorth(n,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,u):this}getPitch(){return this.transform.pitch}setPitch(n,u){return this.jumpTo({pitch:n},u),this}getRoll(){return this.transform.roll}setRoll(n,u){return this.jumpTo({roll:n},u),this}cameraForBounds(n,u){n=Fi.convert(n).adjustAntiMeridian();const g=u&&u.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),g,u)}_cameraForBoxAndBearing(n,u,g,b){const S={top:0,bottom:0,right:0,left:0};if(typeof(b=c.e({padding:S,offset:[0,0],maxZoom:this.transform.maxZoom},b)).padding=="number"){const j=b.padding;b.padding={top:j,bottom:j,right:j,left:j}}const I=c.e(S,b.padding);b.padding=I;const O=this.transform,N=new Fi(n,u);return this.cameraHelper.cameraForBoxAndBearing(b,I,N,g,O)}fitBounds(n,u,g){return this._fitInternal(this.cameraForBounds(n,u),u,g)}fitScreenCoordinates(n,u,g,b,S){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(c.P.convert(n)),this.transform.screenPointToLocation(c.P.convert(u)),g,b),b,S)}_fitInternal(n,u,g){return n?(delete(u=c.e(n,u)).padding,u.linear?this.easeTo(u,g):this.flyTo(u,g)):this}jumpTo(n,u){this.stop();const g=this._getTransformForUpdate();let b=!1,S=!1,I=!1;const O=g.zoom;this.cameraHelper.handleJumpToCenterZoom(g,n);const N=g.zoom!==O;return"elevation"in n&&g.elevation!==+n.elevation&&g.setElevation(+n.elevation),"bearing"in n&&g.bearing!==+n.bearing&&(b=!0,g.setBearing(+n.bearing)),"pitch"in n&&g.pitch!==+n.pitch&&(S=!0,g.setPitch(+n.pitch)),"roll"in n&&g.roll!==+n.roll&&(I=!0,g.setRoll(+n.roll)),n.padding==null||g.isPaddingEqual(n.padding)||g.setPadding(n.padding),this._applyUpdatedTransform(g),this.fire(new c.l("movestart",u)).fire(new c.l("move",u)),N&&this.fire(new c.l("zoomstart",u)).fire(new c.l("zoom",u)).fire(new c.l("zoomend",u)),b&&this.fire(new c.l("rotatestart",u)).fire(new c.l("rotate",u)).fire(new c.l("rotateend",u)),S&&this.fire(new c.l("pitchstart",u)).fire(new c.l("pitch",u)).fire(new c.l("pitchend",u)),I&&this.fire(new c.l("rollstart",u)).fire(new c.l("roll",u)).fire(new c.l("rollend",u)),this.fire(new c.l("moveend",u))}calculateCameraOptionsFromTo(n,u,g,b=0){const S=c.a1.fromLngLat(n,u),I=c.a1.fromLngLat(g,b),O=I.x-S.x,N=I.y-S.y,j=I.z-S.z,$=Math.hypot(O,N,j);if($===0)throw new Error("Can't calculate camera options with same From and To");const X=Math.hypot(O,N),H=c.ak(this.transform.cameraToCenterDistance/$/this.transform.tileSize),J=180*Math.atan2(O,-N)/Math.PI;let ae=180*Math.acos(X/$)/Math.PI;return ae=j<0?90-ae:90+ae,{center:I.toLngLat(),elevation:b,zoom:H,pitch:ae,bearing:J}}calculateCameraOptionsFromCameraLngLatAltRotation(n,u,g,b,S){const I=this.transform.calculateCenterFromCameraLngLatAlt(n,u,g,b);return{center:I.center,elevation:I.elevation,zoom:I.zoom,bearing:g,pitch:b,roll:S}}easeTo(n,u){this._stop(!1,n.easeId),((n=c.e({offset:[0,0],duration:500,easing:c.co},n)).animate===!1||!n.essential&&ee.prefersReducedMotion)&&(n.duration=0);const g=this._getTransformForUpdate(),b=this.getBearing(),S=g.pitch,I=g.roll,O="bearing"in n?this._normalizeBearing(n.bearing,b):b,N="pitch"in n?+n.pitch:S,j="roll"in n?this._normalizeBearing(n.roll,I):I,$="padding"in n?n.padding:g.padding,X=c.P.convert(n.offset);let H,J;n.around&&(H=c.S.convert(n.around),J=g.locationToScreenPoint(H));const ae={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},_e=this.cameraHelper.handleEaseTo(g,{bearing:O,pitch:N,roll:j,padding:$,around:H,aroundPoint:J,offsetAsPoint:X,offset:n.offset,zoom:n.zoom,center:n.center});return this._rotating=this._rotating||b!==O,this._pitching=this._pitching||N!==S,this._rolling=this._rolling||j!==I,this._padding=!g.isPaddingEqual($),this._zooming=this._zooming||_e.isZooming,this._easeId=n.easeId,this._prepareEase(u,n.noMoveStart,ae),this.terrain&&this._prepareElevation(_e.elevationCenter),this._ease((me=>{_e.easeFunc(me),this.terrain&&!n.freezeElevation&&this._updateElevation(me),this._applyUpdatedTransform(g),this._fireMoveEvents(u)}),(me=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(u,me)}),n),this}_prepareEase(n,u,g={}){this._moving=!0,u||g.moving||this.fire(new c.l("movestart",n)),this._zooming&&!g.zooming&&this.fire(new c.l("zoomstart",n)),this._rotating&&!g.rotating&&this.fire(new c.l("rotatestart",n)),this._pitching&&!g.pitching&&this.fire(new c.l("pitchstart",n)),this._rolling&&!g.rolling&&this.fire(new c.l("rollstart",n))}_prepareElevation(n){this._elevationCenter=n,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(n){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const u=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(n<1&&u!==this._elevationTarget){const g=this._elevationTarget-this._elevationStart;this._elevationStart+=n*(g-(u-(g*n+this._elevationStart))/(1-n)),this._elevationTarget=u}this.transform.setElevation(c.C.number(this._elevationStart,this._elevationTarget,n))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(n){if(!this.terrain&&n.elevation>=0&&n.pitch<=90)return{};const u=n.getCameraLngLat(),g=n.getCameraAltitude(),b=this.terrain?this.terrain.getElevationForLngLatZoom(u,n.zoom):0;if(g<b){const S=this.calculateCameraOptionsFromTo(u,b,n.center,n.elevation);return{pitch:S.pitch,zoom:S.zoom}}return{}}_applyUpdatedTransform(n){const u=[];if(u.push((b=>this._elevateCameraIfInsideTerrain(b))),this.transformCameraUpdate&&u.push((b=>this.transformCameraUpdate(b))),!u.length)return;const g=n.clone();for(const b of u){const S=g.clone(),{center:I,zoom:O,roll:N,pitch:j,bearing:$,elevation:X}=b(S);I&&S.setCenter(I),X!==void 0&&S.setElevation(X),O!==void 0&&S.setZoom(O),N!==void 0&&S.setRoll(N),j!==void 0&&S.setPitch(j),$!==void 0&&S.setBearing($),g.apply(S)}this.transform.apply(g)}_fireMoveEvents(n){this.fire(new c.l("move",n)),this._zooming&&this.fire(new c.l("zoom",n)),this._rotating&&this.fire(new c.l("rotate",n)),this._pitching&&this.fire(new c.l("pitch",n)),this._rolling&&this.fire(new c.l("roll",n))}_afterEase(n,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId;const g=this._zooming,b=this._rotating,S=this._pitching,I=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,g&&this.fire(new c.l("zoomend",n)),b&&this.fire(new c.l("rotateend",n)),S&&this.fire(new c.l("pitchend",n)),I&&this.fire(new c.l("rollend",n)),this.fire(new c.l("moveend",n))}flyTo(n,u){if(!n.essential&&ee.prefersReducedMotion){const lt=c.Q(n,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(lt,u)}this.stop(),n=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.co},n);const g=this._getTransformForUpdate(),b=g.bearing,S=g.pitch,I=g.roll,O=g.padding,N="bearing"in n?this._normalizeBearing(n.bearing,b):b,j="pitch"in n?+n.pitch:S,$="roll"in n?this._normalizeBearing(n.roll,I):I,X="padding"in n?n.padding:g.padding,H=c.P.convert(n.offset);let J=g.centerPoint.add(H);const ae=g.screenPointToLocation(J),_e=this.cameraHelper.handleFlyTo(g,{bearing:N,pitch:j,roll:$,padding:X,locationAtOffset:ae,offsetAsPoint:H,center:n.center,minZoom:n.minZoom,zoom:n.zoom});let me=n.curve;const ve=Math.max(g.width,g.height),we=ve/_e.scaleOfZoom,Me=_e.pixelPathLength;typeof _e.scaleOfMinZoom=="number"&&(me=Math.sqrt(ve/_e.scaleOfMinZoom/Me*2));const Ee=me*me;function ze(lt){const Nt=(we*we-ve*ve+(lt?-1:1)*Ee*Ee*Me*Me)/(2*(lt?we:ve)*Ee*Me);return Math.log(Math.sqrt(Nt*Nt+1)-Nt)}function Ve(lt){return(Math.exp(lt)-Math.exp(-lt))/2}function Ie(lt){return(Math.exp(lt)+Math.exp(-lt))/2}const Ye=ze(!1);let ct=function(lt){return Ie(Ye)/Ie(Ye+me*lt)},rt=function(lt){return ve*((Ie(Ye)*(Ve(Nt=Ye+me*lt)/Ie(Nt))-Ve(Ye))/Ee)/Me;var Nt},st=(ze(!0)-Ye)/me;if(Math.abs(Me)<2e-6||!isFinite(st)){if(Math.abs(ve-we)<1e-6)return this.easeTo(n,u);const lt=we<ve?-1:1;st=Math.abs(Math.log(we/ve))/me,rt=()=>0,ct=Nt=>Math.exp(lt*me*Nt)}return n.duration="duration"in n?+n.duration:1e3*st/("screenSpeed"in n?+n.screenSpeed/me:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=b!==N,this._pitching=j!==S,this._rolling=$!==I,this._padding=!g.isPaddingEqual(X),this._prepareEase(u,!1),this.terrain&&this._prepareElevation(_e.targetCenter),this._ease((lt=>{const Nt=lt*st,Ft=1/ct(Nt),Ct=rt(Nt);this._rotating&&g.setBearing(c.C.number(b,N,lt)),this._pitching&&g.setPitch(c.C.number(S,j,lt)),this._rolling&&g.setRoll(c.C.number(I,$,lt)),this._padding&&(g.interpolatePadding(O,X,lt),J=g.centerPoint.add(H)),_e.easeFunc(lt,Ft,Ct,J),this.terrain&&!n.freezeElevation&&this._updateElevation(lt),this._applyUpdatedTransform(g),this._fireMoveEvents(u)}),(()=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(u)}),n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,u){var g;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const b=this._onEaseEnd;delete this._onEaseEnd,b.call(this,u)}return n||(g=this.handlers)===null||g===void 0||g.stop(!1),this}_ease(n,u,g){g.animate===!1||g.duration===0?(n(1),u()):(this._easeStart=ee.now(),this._easeOptions=g,this._onEaseFrame=n,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(n,u){n=c.aO(n,-180,180);const g=Math.abs(n-u);return Math.abs(n-360-u)<g&&(n-=360),Math.abs(n+360-u)<g&&(n+=360),n}queryTerrainElevation(n){return this.terrain?this.terrain.getElevationForLngLatZoom(c.S.convert(n),this.transform.tileZoom):null}}const tu={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Uc{constructor(n=tu){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=u=>{!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"&&u.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=n}getDefaultPosition(){return"bottom-right"}onAdd(n){return this._map=n,this._compact=this.options.compact,this._container=Y.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=Y.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Y.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){Y.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(n,u){const g=this._map._getUIString(`AttributionControl.${u}`);n.title=g,n.setAttribute("aria-label",g)}_updateAttributions(){if(!this._map.style)return;let n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map((b=>typeof b!="string"?"":b))):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){const b=this._map.style.stylesheet;this.styleOwner=b.owner,this.styleId=b.id}const u=this._map.style.sourceCaches;for(const b in u){const S=u[b];if(S.used||S.usedForTerrain){const I=S.getSource();I.attribution&&n.indexOf(I.attribution)<0&&n.push(I.attribution)}}n=n.filter((b=>String(b).trim())),n.sort(((b,S)=>b.length-S.length)),n=n.filter(((b,S)=>{for(let I=S+1;I<n.length;I++)if(n[I].indexOf(b)>=0)return!1;return!0}));const g=n.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,n.length?(this._innerContainer.innerHTML=Y.sanitize(g),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Yd{constructor(n={}){this._updateCompact=()=>{const u=this._container.children;if(u.length){const g=u[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&g.classList.add("maplibregl-compact"):g.classList.remove("maplibregl-compact")}},this.options=n}getDefaultPosition(){return"bottom-left"}onAdd(n){this._map=n,this._compact=this.options&&this.options.compact,this._container=Y.create("div","maplibregl-ctrl");const u=Y.create("a","maplibregl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://maplibre.org/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){Y.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class gl{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const u=++this._id;return this._queue.push({callback:n,id:u,cancelled:!1}),u}remove(n){const u=this._currentlyRunning,g=u?this._queue.concat(u):this._queue;for(const b of g)if(b.id===n)return void(b.cancelled=!0)}run(n=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const u=this._currentlyRunning=this._queue;this._queue=[];for(const g of u)if(!g.cancelled&&(g.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var uc=c.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class an extends c.E{constructor(n){super(),this._lastTilesetChange=ee.now(),this.sourceCache=n,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=n._source.tileSize*2**this.deltaZoom,n.usedForTerrain=!0,n.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(n,u){this.sourceCache.update(n,u),this._renderableTilesKeys=[];const g={};for(const b of qe(n,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:u,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))g[b.key]=!0,this._renderableTilesKeys.push(b.key),this._tiles[b.key]||(b.terrainRttPosMatrix32f=new Float64Array(16),c.bY(b.terrainRttPosMatrix32f,0,c.$,c.$,0,0,1),this._tiles[b.key]=new ms(b,this.tileSize),this._lastTilesetChange=ee.now());for(const b in this._tiles)g[b]||delete this._tiles[b]}freeRtt(n){for(const u in this._tiles){const g=this._tiles[u];(!n||g.tileID.equals(n)||g.tileID.isChildOf(n)||n.isChildOf(g.tileID))&&(g.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((n=>this.getTileByID(n)))}getTileByID(n){return this._tiles[n]}getTerrainCoords(n,u){return u?this._getTerrainCoordsForTileRanges(n,u):this._getTerrainCoordsForRegularTile(n)}_getTerrainCoordsForRegularTile(n){const u={};for(const g of this._renderableTilesKeys){const b=this._tiles[g].tileID,S=n.clone(),I=c.ba();if(b.canonical.equals(n.canonical))c.bY(I,0,c.$,c.$,0,0,1);else if(b.canonical.isChildOf(n.canonical)){const O=b.canonical.z-n.canonical.z,N=b.canonical.x-(b.canonical.x>>O<<O),j=b.canonical.y-(b.canonical.y>>O<<O),$=c.$>>O;c.bY(I,0,$,$,0,0,1),c.M(I,I,[-N*$,-j*$,0])}else{if(!n.canonical.isChildOf(b.canonical))continue;{const O=n.canonical.z-b.canonical.z,N=n.canonical.x-(n.canonical.x>>O<<O),j=n.canonical.y-(n.canonical.y>>O<<O),$=c.$>>O;c.bY(I,0,c.$,c.$,0,0,1),c.M(I,I,[N*$,j*$,0]),c.N(I,I,[1/2**O,1/2**O,0])}}S.terrainRttPosMatrix32f=new Float32Array(I),u[g]=S}return u}_getTerrainCoordsForTileRanges(n,u){const g={};for(const b of this._renderableTilesKeys){const S=this._tiles[b].tileID;if(!this._isWithinTileRanges(S,u))continue;const I=n.clone(),O=c.ba();if(S.canonical.z===n.canonical.z){const N=n.canonical.x-S.canonical.x,j=n.canonical.y-S.canonical.y;c.bY(O,0,c.$,c.$,0,0,1),c.M(O,O,[N*c.$,j*c.$,0])}else if(S.canonical.z>n.canonical.z){const N=S.canonical.z-n.canonical.z,j=S.canonical.x-(S.canonical.x>>N<<N),$=S.canonical.y-(S.canonical.y>>N<<N),X=n.canonical.x-(S.canonical.x>>N),H=n.canonical.y-(S.canonical.y>>N),J=c.$>>N;c.bY(O,0,J,J,0,0,1),c.M(O,O,[-j*J+X*c.$,-$*J+H*c.$,0])}else{const N=n.canonical.z-S.canonical.z,j=n.canonical.x-(n.canonical.x>>N<<N),$=n.canonical.y-(n.canonical.y>>N<<N),X=(n.canonical.x>>N)-S.canonical.x,H=(n.canonical.y>>N)-S.canonical.y,J=c.$<<N;c.bY(O,0,J,J,0,0,1),c.M(O,O,[j*c.$+X*J,$*c.$+H*J,0])}I.terrainRttPosMatrix32f=new Float32Array(O),g[b]=I}return g}getSourceTile(n,u){const g=this.sourceCache._source;let b=n.overscaledZ-this.deltaZoom;if(b>g.maxzoom&&(b=g.maxzoom),b<g.minzoom)return null;this._sourceTileCache[n.key]||(this._sourceTileCache[n.key]=n.scaledTo(b).key);let S=this.sourceCache.getTileByID(this._sourceTileCache[n.key]);if((!S||!S.dem)&&u)for(;b>=g.minzoom&&(!S||!S.dem);)S=this.sourceCache.getTileByID(n.scaledTo(b--).key);return S}anyTilesAfterTime(n=Date.now()){return this._lastTilesetChange>=n}_isWithinTileRanges(n,u){return u[n.canonical.z]&&n.canonical.x>=u[n.canonical.z].minTileX&&n.canonical.x<=u[n.canonical.z].maxTileX&&n.canonical.y>=u[n.canonical.z].minTileY&&n.canonical.y<=u[n.canonical.z].maxTileY}}class Tn{constructor(n,u,g){this._meshCache={},this.painter=n,this.sourceCache=new an(u),this.options=g,this.exaggeration=typeof g.exaggeration=="number"?g.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(n,u,g,b=c.$){var S;if(!(u>=0&&u<b&&g>=0&&g<b))return 0;const I=this.getTerrainData(n),O=(S=I.tile)===null||S===void 0?void 0:S.dem;if(!O)return 0;const N=c.cs([],[u/b*c.$,g/b*c.$],I.u_terrain_matrix),j=[N[0]*O.dim,N[1]*O.dim],$=Math.floor(j[0]),X=Math.floor(j[1]),H=j[0]-$,J=j[1]-X;return O.get($,X)*(1-H)*(1-J)+O.get($+1,X)*H*(1-J)+O.get($,X+1)*(1-H)*J+O.get($+1,X+1)*H*J}getElevationForLngLatZoom(n,u){if(!c.ct(u,n.wrap()))return 0;const{tileID:g,mercatorX:b,mercatorY:S}=this._getOverscaledTileIDFromLngLatZoom(n,u);return this.getElevation(g,b%c.$,S%c.$,c.$)}getElevation(n,u,g,b=c.$){return this.getDEMElevation(n,u,g,b)*this.exaggeration}getTerrainData(n){if(!this._emptyDemTexture){const b=this.painter.context,S=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new c.T(b,S,b.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new c.T(b,new c.R({width:1,height:1}),b.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(b.gl.NEAREST,b.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.ag([])}const u=this.sourceCache.getSourceTile(n,!0);if(u&&u.dem&&(!u.demTexture||u.needsTerrainPrepare)){const b=this.painter.context;u.demTexture=this.painter.getTileTexture(u.dem.stride),u.demTexture?u.demTexture.update(u.dem.getPixels(),{premultiply:!1}):u.demTexture=new c.T(b,u.dem.getPixels(),b.gl.RGBA,{premultiply:!1}),u.demTexture.bind(b.gl.NEAREST,b.gl.CLAMP_TO_EDGE),u.needsTerrainPrepare=!1}const g=u&&u+u.tileID.key+n.key;if(g&&!this._demMatrixCache[g]){const b=this.sourceCache.sourceCache._source.maxzoom;let S=n.canonical.z-u.tileID.canonical.z;n.overscaledZ>n.canonical.z&&(n.canonical.z>=b?S=n.canonical.z-b:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const I=n.canonical.x-(n.canonical.x>>S<<S),O=n.canonical.y-(n.canonical.y>>S<<S),N=c.cu(new Float64Array(16),[1/(c.$<<S),1/(c.$<<S),0]);c.M(N,N,[I*c.$,O*c.$,0]),this._demMatrixCache[n.key]={matrix:N,coord:n}}return{u_depth:2,u_terrain:3,u_terrain_dim:u&&u.dem&&u.dem.dim||1,u_terrain_matrix:g?this._demMatrixCache[n.key].matrix:this._emptyDemMatrix,u_terrain_unpack:u&&u.dem&&u.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(u&&u.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:u}}getFramebuffer(n){const u=this.painter,g=u.width/devicePixelRatio,b=u.height/devicePixelRatio;return!this._fbo||this._fbo.width===g&&this._fbo.height===b||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new c.T(u.context,{width:g,height:b,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new c.T(u.context,{width:g,height:b,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=u.context.createFramebuffer(g,b,!0,!1),this._fbo.depthAttachment.set(u.context.createRenderbuffer(u.context.gl.DEPTH_COMPONENT16,g,b))),this._fbo.colorAttachment.set(n==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const n=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const u=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let S=0,I=0;S<this._coordsTextureSize;S++)for(let O=0;O<this._coordsTextureSize;O++,I+=4)u[I+0]=255&O,u[I+1]=255&S,u[I+2]=O>>8<<4|S>>8,u[I+3]=0;const g=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(u.buffer)),b=new c.T(n,g,n.gl.RGBA,{premultiply:!1});return b.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._coordsTexture=b,b}pointCoordinate(n){this.painter.maybeDrawDepthAndCoords(!0);const u=new Uint8Array(4),g=this.painter.context,b=g.gl,S=Math.round(n.x*this.painter.pixelRatio/devicePixelRatio),I=Math.round(n.y*this.painter.pixelRatio/devicePixelRatio),O=Math.round(this.painter.height/devicePixelRatio);g.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),b.readPixels(S,O-I-1,1,1,b.RGBA,b.UNSIGNED_BYTE,u),g.bindFramebuffer.set(null);const N=u[0]+(u[2]>>4<<8),j=u[1]+((15&u[2])<<8),$=this.coordsIndex[255-u[3]],X=$&&this.sourceCache.getTileByID($);if(!X)return null;const H=this._coordsTextureSize,J=(1<<X.tileID.canonical.z)*H;return new c.a1((X.tileID.canonical.x*H+N)/J+X.tileID.wrap,(X.tileID.canonical.y*H+j)/J,this.getElevation(X.tileID,N,j,H))}depthAtPoint(n){const u=new Uint8Array(4),g=this.painter.context,b=g.gl;return g.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),b.readPixels(n.x,this.painter.height/devicePixelRatio-n.y-1,1,1,b.RGBA,b.UNSIGNED_BYTE,u),g.bindFramebuffer.set(null),(u[0]/16777216+u[1]/65536+u[2]/256+u[3])/256}getTerrainMesh(n){var u;const g=((u=this.painter.style.projection)===null||u===void 0?void 0:u.transitionState)>0,b=g&&n.canonical.y===0,S=g&&n.canonical.y===(1<<n.canonical.z)-1,I=`m_${b?"n":""}_${S?"s":""}`;if(this._meshCache[I])return this._meshCache[I];const O=this.painter.context,N=new c.cv,j=new c.aN,$=this.meshSize,X=c.$/$,H=$*$;for(let Ie=0;Ie<=$;Ie++)for(let Ye=0;Ye<=$;Ye++)N.emplaceBack(Ye*X,Ie*X,0);for(let Ie=0;Ie<H;Ie+=$+1)for(let Ye=0;Ye<$;Ye++)j.emplaceBack(Ye+Ie,$+Ye+Ie+1,$+Ye+Ie+2),j.emplaceBack(Ye+Ie,$+Ye+Ie+2,Ye+Ie+1);const J=N.length,ae=J+($+1),_e=($+1)*$,me=b?c.bh:0,ve=b?0:1,we=S?c.bi:c.$,Me=S?0:1;for(let Ie=0;Ie<=$;Ie++)N.emplaceBack(Ie*X,me,ve);for(let Ie=0;Ie<=$;Ie++)N.emplaceBack(Ie*X,we,Me);for(let Ie=0;Ie<$;Ie++)j.emplaceBack(_e+Ie,ae+Ie,ae+Ie+1),j.emplaceBack(_e+Ie,ae+Ie+1,_e+Ie+1),j.emplaceBack(0+Ie,J+Ie+1,J+Ie),j.emplaceBack(0+Ie,0+Ie+1,J+Ie+1);const Ee=N.length,ze=Ee+2*($+1);for(const Ie of[0,1])for(let Ye=0;Ye<=$;Ye++)for(const ct of[0,1])N.emplaceBack(Ie*c.$,Ye*X,ct);for(let Ie=0;Ie<2*$;Ie+=2)j.emplaceBack(Ee+Ie,Ee+Ie+1,Ee+Ie+3),j.emplaceBack(Ee+Ie,Ee+Ie+3,Ee+Ie+2),j.emplaceBack(ze+Ie,ze+Ie+3,ze+Ie+1),j.emplaceBack(ze+Ie,ze+Ie+2,ze+Ie+3);const Ve=new Ja(O.createVertexBuffer(N,uc.members),O.createIndexBuffer(j),c.aM.simpleSegment(0,0,N.length,j.length));return this._meshCache[I]=Ve,Ve}getMeshFrameDelta(n){return 2*Math.PI*c.bu/Math.pow(2,Math.max(n,0))/5}getMinTileElevationForLngLatZoom(n,u){var g;const{tileID:b}=this._getOverscaledTileIDFromLngLatZoom(n,u);return(g=this.getMinMaxElevation(b).minElevation)!==null&&g!==void 0?g:0}getMinMaxElevation(n){const u=this.getTerrainData(n).tile,g={minElevation:null,maxElevation:null};return u&&u.dem&&(g.minElevation=u.dem.min*this.exaggeration,g.maxElevation=u.dem.max*this.exaggeration),g}_getOverscaledTileIDFromLngLatZoom(n,u){const g=c.a1.fromLngLat(n.wrap()),b=(1<<u)*c.$,S=g.x*b,I=g.y*b,O=Math.floor(S/c.$),N=Math.floor(I/c.$);return{tileID:new c.Z(u,0,u,O,N),mercatorX:S,mercatorY:I}}}class ud{constructor(n,u,g){this._context=n,this._size=u,this._tileSize=g,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const n of this._objects)n.texture.destroy(),n.fbo.destroy()}_createObject(n){const u=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),g=new c.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return g.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),u.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),u.colorAttachment.set(g.texture),{id:n,fbo:u,texture:g,stamp:-1,inUse:!1}}getObjectForId(n){return this._objects[n]}useObject(n){n.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((u=>n.id!==u)),this._recentlyUsed.push(n.id)}stampObject(n){n.stamp=++this._stamp}getOrCreateFreeObject(){for(const u of this._recentlyUsed)if(!this._objects[u].inUse)return this._objects[u];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const n=this._createObject(this._objects.length);return this._objects.push(n),n}freeObject(n){n.inUse=!1}freeAllObjects(){for(const n of this._objects)this.freeObject(n)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((n=>!n.inUse))===!1}}const Fo={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class jc{constructor(n,u){this.painter=n,this.terrain=u,this.pool=new ud(n.context,30,u.sourceCache.tileSize*u.qualityFactor)}destruct(){this.pool.destruct()}getTexture(n){return this.pool.getObjectForId(n.rtt[this._stacks.length-1].id).texture}prepareForRender(n,u){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=n._order.filter((g=>!n._layers[g].isHidden(u))),this._coordsAscending={};for(const g in n.sourceCaches){this._coordsAscending[g]={};const b=n.sourceCaches[g].getVisibleCoordinates(),S=n.sourceCaches[g].getSource(),I=S instanceof Vi?S.terrainTileRanges:null;for(const O of b){const N=this.terrain.sourceCache.getTerrainCoords(O,I);for(const j in N)this._coordsAscending[g][j]||(this._coordsAscending[g][j]=[]),this._coordsAscending[g][j].push(N[j])}}this._coordsAscendingStr={};for(const g of n._order){const b=n._layers[g],S=b.source;if(Fo[b.type]&&!this._coordsAscendingStr[S]){this._coordsAscendingStr[S]={};for(const I in this._coordsAscending[S])this._coordsAscendingStr[S][I]=this._coordsAscending[S][I].map((O=>O.key)).sort().join()}}for(const g of this._renderableTiles)for(const b in this._coordsAscendingStr){const S=this._coordsAscendingStr[b][g.tileID.key];S&&S!==g.rttCoords[b]&&(g.rtt=[])}}renderLayer(n,u){if(n.isHidden(this.painter.transform.zoom))return!1;const g=Object.assign(Object.assign({},u),{isRenderingToTexture:!0}),b=n.type,S=this.painter,I=this._renderableLayerIds[this._renderableLayerIds.length-1]===n.id;if(Fo[b]&&(this._prevType&&Fo[this._prevType]||this._stacks.push([]),this._prevType=b,this._stacks[this._stacks.length-1].push(n.id),!I))return!0;if(Fo[this._prevType]||Fo[b]&&I){this._prevType=b;const O=this._stacks.length-1,N=this._stacks[O]||[];for(const j of this._renderableTiles){if(this.pool.isFull()&&(zo(this.painter,this.terrain,this._rttTiles,g),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(j),j.rtt[O]){const X=this.pool.getObjectForId(j.rtt[O].id);if(X.stamp===j.rtt[O].stamp){this.pool.useObject(X);continue}}const $=this.pool.getOrCreateFreeObject();this.pool.useObject($),this.pool.stampObject($),j.rtt[O]={id:$.id,stamp:$.stamp},S.context.bindFramebuffer.set($.fbo.framebuffer),S.context.clear({color:c.bf.transparent,stencil:0}),S.currentStencilSource=void 0;for(let X=0;X<N.length;X++){const H=S.style._layers[N[X]],J=H.source?this._coordsAscending[H.source][j.tileID.key]:[j.tileID];S.context.viewport.set([0,0,$.fbo.width,$.fbo.height]),S._renderTileClippingMasks(H,J,!0),S.renderLayer(S,S.style.sourceCaches[H.source],H,J,g),H.source&&(j.rttCoords[H.source]=this._coordsAscendingStr[H.source][j.tileID.key])}}return zo(this.painter,this.terrain,this._rttTiles,g),this._rttTiles=[],this.pool.freeAllObjects(),Fo[b]}return!1}}const As={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Qd=C,ho={hash:!1,interactive:!0,bearingSnap:7,attributionControl:tu,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},Vo={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Cs{constructor(n,u,g=!1){this.mousedown=S=>{this.startMove(S,Y.mousePos(this.element,S)),Y.addEventListener(window,"mousemove",this.mousemove),Y.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=S=>{this.move(S,Y.mousePos(this.element,S))},this.mouseup=S=>{this._rotatePitchHandler.dragEnd(S),this.offTemp()},this.touchstart=S=>{S.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Y.touchPos(this.element,S.targetTouches)[0],this.startMove(S,this._startPos),Y.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),Y.addEventListener(window,"touchend",this.touchend))},this.touchmove=S=>{S.targetTouches.length!==1?this.reset():(this._lastPos=Y.touchPos(this.element,S.targetTouches)[0],this.move(S,this._lastPos))},this.touchend=S=>{S.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=u;const b=new am;this._rotatePitchHandler=new Yl({clickTolerance:3,move:(S,I)=>{const O=u.getBoundingClientRect(),N=new c.P((O.bottom-O.top)/2,(O.right-O.left)/2);return{bearingDelta:c.cn(new c.P(S.x,I.y),I,N),pitchDelta:g?-.5*(I.y-S.y):void 0}},moveStateManager:b,enable:!0,assignEvents:()=>{}}),this.map=n,Y.addEventListener(u,"mousedown",this.mousedown),Y.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),Y.addEventListener(u,"touchcancel",this.reset)}startMove(n,u){this._rotatePitchHandler.dragStart(n,u),Y.disableDrag()}move(n,u){const g=this.map,{bearingDelta:b,pitchDelta:S}=this._rotatePitchHandler.dragMove(n,u)||{};b&&g.setBearing(g.getBearing()+b),S&&g.setPitch(g.getPitch()+S)}off(){const n=this.element;Y.removeEventListener(n,"mousedown",this.mousedown),Y.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),Y.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),Y.removeEventListener(window,"touchend",this.touchend),Y.removeEventListener(n,"touchcancel",this.reset),this.offTemp()}offTemp(){Y.enableDrag(),Y.removeEventListener(window,"mousemove",this.mousemove),Y.removeEventListener(window,"mouseup",this.mouseup),Y.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),Y.removeEventListener(window,"touchend",this.touchend)}}let gi;function Br(T,n,u,g=!1){if(g||!u.getCoveringTilesDetailsProvider().allowWorldCopies())return T==null?void 0:T.wrap();const b=new c.S(T.lng,T.lat);if(T=new c.S(T.lng,T.lat),n){const S=new c.S(T.lng-360,T.lat),I=new c.S(T.lng+360,T.lat),O=u.locationToScreenPoint(T).distSqr(n);u.locationToScreenPoint(S).distSqr(n)<O?T=S:u.locationToScreenPoint(I).distSqr(n)<O&&(T=I)}for(;Math.abs(T.lng-u.center.lng)>180;){const S=u.locationToScreenPoint(T);if(S.x>=0&&S.y>=0&&S.x<=u.width&&S.y<=u.height)break;T.lng>u.center.lng?T.lng-=360:T.lng+=360}return T.lng!==b.lng&&u.isPointOnMapSurface(u.locationToScreenPoint(T))?T:b}const cd={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Uo(T,n,u){const g=T.classList;for(const b in cd)g.remove(`maplibregl-${u}-anchor-${b}`);g.add(`maplibregl-${u}-anchor-${n}`)}class Wa extends c.E{constructor(n){if(super(),this._onKeyPress=u=>{const g=u.code,b=u.charCode||u.keyCode;g!=="Space"&&g!=="Enter"&&b!==32&&b!==13||this.togglePopup()},this._onMapClick=u=>{const g=u.originalEvent.target,b=this._element;this._popup&&(g===b||b.contains(g))&&this.togglePopup()},this._update=u=>{if(!this._map)return;const g=this._map.loaded()&&!this._map.isMoving();((u==null?void 0:u.type)==="terrain"||(u==null?void 0:u.type)==="render"&&!g)&&this._map.once("render",this._update),this._lngLat=Br(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let b="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?b=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(b=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let S="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?S="rotateX(0deg)":this._pitchAlignment==="map"&&(S=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||u&&u.type!=="moveend"||(this._pos=this._pos.round()),Y.setTransform(this._element,`${cd[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${S} ${b}`),ee.frameAsync(new AbortController).then((()=>{this._updateOpacity(u&&u.type==="moveend")})).catch((()=>{}))},this._onMove=u=>{if(!this._isDragging){const g=this._clickTolerance||this._map._clickTolerance;this._isDragging=u.point.dist(this._pointerdownPos)>=g}this._isDragging&&(this._pos=u.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.l("dragstart"))),this.fire(new c.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.l("dragend")),this._state="inactive"},this._addDragHandler=u=>{this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(this._pos).add(this._offset),this._pointerdownPos=u.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._subpixelPositioning=n&&n.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,this.setOpacity(n==null?void 0:n.opacity,n==null?void 0:n.opacityWhenCovered),n&&n.element)this._element=n.element,this._offset=c.P.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=Y.create("div");const u=Y.createNS("http://www.w3.org/2000/svg","svg"),g=41,b=27;u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height",`${g}px`),u.setAttributeNS(null,"width",`${b}px`),u.setAttributeNS(null,"viewBox",`0 0 ${b} ${g}`);const S=Y.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"stroke","none"),S.setAttributeNS(null,"stroke-width","1"),S.setAttributeNS(null,"fill","none"),S.setAttributeNS(null,"fill-rule","evenodd");const I=Y.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"fill-rule","nonzero");const O=Y.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"transform","translate(3.0, 29.0)"),O.setAttributeNS(null,"fill","#000000");const N=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ve of N){const we=Y.createNS("http://www.w3.org/2000/svg","ellipse");we.setAttributeNS(null,"opacity","0.04"),we.setAttributeNS(null,"cx","10.5"),we.setAttributeNS(null,"cy","5.80029008"),we.setAttributeNS(null,"rx",ve.rx),we.setAttributeNS(null,"ry",ve.ry),O.appendChild(we)}const j=Y.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"fill",this._color);const $=Y.createNS("http://www.w3.org/2000/svg","path");$.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),j.appendChild($);const X=Y.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"opacity","0.25"),X.setAttributeNS(null,"fill","#000000");const H=Y.createNS("http://www.w3.org/2000/svg","path");H.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),X.appendChild(H);const J=Y.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"transform","translate(6.0, 7.0)"),J.setAttributeNS(null,"fill","#FFFFFF");const ae=Y.createNS("http://www.w3.org/2000/svg","g");ae.setAttributeNS(null,"transform","translate(8.0, 8.0)");const _e=Y.createNS("http://www.w3.org/2000/svg","circle");_e.setAttributeNS(null,"fill","#000000"),_e.setAttributeNS(null,"opacity","0.25"),_e.setAttributeNS(null,"cx","5.5"),_e.setAttributeNS(null,"cy","5.5"),_e.setAttributeNS(null,"r","5.4999962");const me=Y.createNS("http://www.w3.org/2000/svg","circle");me.setAttributeNS(null,"fill","#FFFFFF"),me.setAttributeNS(null,"cx","5.5"),me.setAttributeNS(null,"cy","5.5"),me.setAttributeNS(null,"r","5.4999962"),ae.appendChild(_e),ae.appendChild(me),I.appendChild(O),I.appendChild(j),I.appendChild(X),I.appendChild(J),I.appendChild(ae),u.appendChild(I),u.setAttributeNS(null,"height",g*this._scale+"px"),u.setAttributeNS(null,"width",b*this._scale+"px"),this._element.appendChild(u),this._offset=c.P.convert(n&&n.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(u=>{u.preventDefault()})),this._element.addEventListener("mousedown",(u=>{u.preventDefault()})),Uo(this._element,this._anchor,"marker"),n&&n.className)for(const u of n.className.split(" "))this._element.classList.add(u);this._popup=null}addTo(n){return this.remove(),this._map=n,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",n._getUIString("Marker.Title")),n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),n.on("terrain",this._update),n.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),Y.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=c.S.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const b=Math.abs(13.5)/Math.SQRT2;n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[b,-1*(38.1-13.5+b)],"bottom-right":[-b,-1*(38.1-13.5+b)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(n){return this._subpixelPositioning=n,this}getPopup(){return this._popup}togglePopup(){const n=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:n?(n.isOpen()?n.remove():(n.setLngLat(this._lngLat),n.addTo(this._map)),this):this}_updateOpacity(n=!1){var u,g;const b=(u=this._map)===null||u===void 0?void 0:u.terrain,S=this._map.transform.isLocationOccluded(this._lngLat);if(!b||S){const J=S?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==J&&(this._element.style.opacity=J))}if(n)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const I=this._map,O=I.terrain.depthAtPoint(this._pos),N=I.terrain.getElevationForLngLatZoom(this._lngLat,I.transform.tileZoom);if(I.transform.lngLatToCameraDepth(this._lngLat,N)-O<.006)return void(this._element.style.opacity=this._opacity);const j=-this._offset.y/I.transform.pixelsPerMeter,$=Math.sin(I.getPitch()*Math.PI/180)*j,X=I.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),H=I.transform.lngLatToCameraDepth(this._lngLat,N+$)-X>.006;!((g=this._popup)===null||g===void 0)&&g.isOpen()&&H&&this._popup.remove(),this._element.style.opacity=H?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(n){return this._offset=c.P.convert(n),this._update(),this}addClassName(n){this._element.classList.add(n)}removeClassName(n){this._element.classList.remove(n)}toggleClassName(n){return this._element.classList.toggle(n)}setDraggable(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(n,u){return(this._opacity===void 0||n===void 0&&u===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),n!==void 0&&(this._opacity=n),u!==void 0&&(this._opacityWhenCovered=u),this._map&&this._updateOpacity(!0),this}}const Wr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Au=0,eo=!1;const Gn={maxWidth:100,unit:"metric"};function ji(T,n,u){const g=u&&u.maxWidth||100,b=T._container.clientHeight/2,S=T._container.clientWidth/2,I=T.unproject([S-g/2,b]),O=T.unproject([S+g/2,b]),N=Math.round(T.project(O).x-T.project(I).x),j=Math.min(g,N,T._container.clientWidth),$=I.distanceTo(O);if(u&&u.unit==="imperial"){const X=3.2808*$;X>5280?Tr(n,j,X/5280,T._getUIString("ScaleControl.Miles")):Tr(n,j,X,T._getUIString("ScaleControl.Feet"))}else u&&u.unit==="nautical"?Tr(n,j,$/1852,T._getUIString("ScaleControl.NauticalMiles")):$>=1e3?Tr(n,j,$/1e3,T._getUIString("ScaleControl.Kilometers")):Tr(n,j,$,T._getUIString("ScaleControl.Meters"))}function Tr(T,n,u,g){const b=(function(S){const I=Math.pow(10,`${Math.floor(S)}`.length-1);let O=S/I;return O=O>=10?10:O>=5?5:O>=3?3:O>=2?2:O>=1?1:(function(N){const j=Math.pow(10,Math.ceil(-Math.log(N)/Math.LN10));return Math.round(N*j)/j})(O),I*O})(u);T.style.width=n*(b/u)+"px",T.innerHTML=`${b}&nbsp;${g}`}const bh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},cc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function nu(T){if(T){if(typeof T=="number"){const n=Math.round(Math.abs(T)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,T),"top-left":new c.P(n,n),"top-right":new c.P(-n,n),bottom:new c.P(0,-T),"bottom-left":new c.P(n,-n),"bottom-right":new c.P(-n,-n),left:new c.P(T,0),right:new c.P(-T,0)}}if(T instanceof c.P||Array.isArray(T)){const n=c.P.convert(T);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:c.P.convert(T.center||[0,0]),top:c.P.convert(T.top||[0,0]),"top-left":c.P.convert(T["top-left"]||[0,0]),"top-right":c.P.convert(T["top-right"]||[0,0]),bottom:c.P.convert(T.bottom||[0,0]),"bottom-left":c.P.convert(T["bottom-left"]||[0,0]),"bottom-right":c.P.convert(T["bottom-right"]||[0,0]),left:c.P.convert(T.left||[0,0]),right:c.P.convert(T.right||[0,0])}}return nu(new c.P(0,0))}const xh=C;_.AJAXError=c.cz,_.Event=c.l,_.Evented=c.E,_.LngLat=c.S,_.MercatorCoordinate=c.a1,_.Point=c.P,_.addProtocol=c.cA,_.config=c.a,_.removeProtocol=c.cB,_.AttributionControl=Uc,_.BoxZoomHandler=Zf,_.CanvasSource=Ea,_.CooperativeGesturesHandler=oc,_.DoubleClickZoomHandler=sc,_.DragPanHandler=yh,_.DragRotateHandler=vh,_.EdgeInsets=ys,_.FullscreenControl=class extends c.E{constructor(T={}){super(),this._onFullscreenChange=()=>{var n;let u=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((n=u==null?void 0:u.shadowRoot)===null||n===void 0)&&n.fullscreenElement;)u=u.shadowRoot.fullscreenElement;u===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,T&&T.container&&(T.container instanceof HTMLElement?this._container=T.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(T){return this._map=T,this._container||(this._container=this._map.getContainer()),this._controlContainer=Y.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){Y.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const T=this._fullscreenButton=Y.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);Y.create("span","maplibregl-ctrl-icon",T).setAttribute("aria-hidden","true"),T.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const T=this._getTitle();this._fullscreenButton.setAttribute("aria-label",T),this._fullscreenButton.title=T}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},_.GeoJSONSource=Sa,_.GeolocateControl=class extends c.E{constructor(T){super(),this._onSuccess=n=>{if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new c.l("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.l("geolocate",n)),this._finish()}},this._updateCamera=n=>{const u=new c.S(n.coords.longitude,n.coords.latitude),g=n.coords.accuracy,b=this._map.getBearing(),S=c.e({bearing:b},this.options.fitBoundsOptions),I=Fi.fromLngLat(u,g);this._map.fitBounds(I,S,{geolocateSource:!0})},this._updateMarker=n=>{if(n){const u=new c.S(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=n=>{if(this._map){if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&eo)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.l("error",n)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(n=>n.preventDefault())),this._geolocateButton=Y.create("button","maplibregl-ctrl-geolocate",this._container),Y.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=n=>{if(this._map){if(n===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Y.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Wa({element:this._dotElement}),this._circleElement=Y.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Wa({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(u=>{const g=(u==null?void 0:u[0])instanceof ResizeObserverEntry;u.geolocateSource||this._watchState!=="ACTIVE_LOCK"||g||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.l("trackuserlocationend")),this.fire(new c.l("userlocationlostfocus")))}))}},this.options=c.e({},Wr,T)}onAdd(T){return this._map=T,this._container=Y.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return c._(this,arguments,void 0,(function*(n=!1){if(gi!==void 0&&!n)return gi;if(window.navigator.permissions===void 0)return gi=!!window.navigator.geolocation,gi;try{gi=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{gi=!!window.navigator.geolocation}return gi}))})().then((n=>this._finishSetupUI(n))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),Y.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Au=0,eo=!1}_isOutOfMapMaxBounds(T){const n=this._map.getMaxBounds(),u=T.coords;return n&&(u.longitude<n.getWest()||u.longitude>n.getEast()||u.latitude<n.getSouth()||u.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const T=this._map.getBounds(),n=T.getSouthEast(),u=T.getNorthEast(),g=n.distanceTo(u),b=Math.ceil(this._accuracy/(g/this._map._container.clientHeight)*2);this._circleElement.style.width=`${b}px`,this._circleElement.style.height=`${b}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Au--,eo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.l("trackuserlocationstart")),this.fire(new c.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let T;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Au++,Au>1?(T={maximumAge:6e5,timeout:0},eo=!0):(T=this.options.positionOptions,eo=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,T)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},_.GlobeControl=class{constructor(){this._toggleProjection=()=>{var T;const n=(T=this._map.getProjection())===null||T===void 0?void 0:T.type;this._map.setProjection(n!=="mercator"&&n?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var T;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((T=this._map.getProjection())===null||T===void 0?void 0:T.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(T){return this._map=T,this._container=Y.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=Y.create("button","maplibregl-ctrl-globe",this._container),Y.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){Y.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},_.Hash=fl,_.ImageSource=Vi,_.KeyboardHandler=sd,_.LngLatBounds=Fi,_.LogoControl=Yd,_.Map=class extends Eu{constructor(T){var n,u;c.cw.mark(c.cx.create);const g=Object.assign(Object.assign(Object.assign({},ho),T),{canvasContextAttributes:Object.assign(Object.assign({},ho.canvasContextAttributes),T.canvasContextAttributes)});if(g.minZoom!=null&&g.maxZoom!=null&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(g.minPitch!=null&&g.maxPitch!=null&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(g.minPitch!=null&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(g.maxPitch!=null&&g.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const b=new xn,S=new wr;if(g.minZoom!==void 0&&b.setMinZoom(g.minZoom),g.maxZoom!==void 0&&b.setMaxZoom(g.maxZoom),g.minPitch!==void 0&&b.setMinPitch(g.minPitch),g.maxPitch!==void 0&&b.setMaxPitch(g.maxPitch),g.renderWorldCopies!==void 0&&b.setRenderWorldCopies(g.renderWorldCopies),super(b,S,{bearingSnap:g.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new gl,this._controls=[],this._mapId=c.a7(),this._contextLost=O=>{O.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.l("webglcontextlost",{originalEvent:O}))},this._contextRestored=O=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.l("webglcontextrestored",{originalEvent:O}))},this._onMapScroll=O=>{if(O.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=g.interactive,this._maxTileCacheSize=g.maxTileCacheSize,this._maxTileCacheZoomLevels=g.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},g.canvasContextAttributes),this._trackResize=g.trackResize===!0,this._bearingSnap=g.bearingSnap,this._centerClampedToGround=g.centerClampedToGround,this._refreshExpiredTiles=g.refreshExpiredTiles===!0,this._fadeDuration=g.fadeDuration,this._crossSourceCollisions=g.crossSourceCollisions===!0,this._collectResourceTiming=g.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},As),g.locale),this._clickTolerance=g.clickTolerance,this._overridePixelRatio=g.pixelRatio,this._maxCanvasSize=g.maxCanvasSize,this.transformCameraUpdate=g.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=g.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=Ke.addThrottleControl((()=>this.isMoving())),this._requestManager=new Ge(g.transformRequest),typeof g.container=="string"){if(this._container=document.getElementById(g.container),!this._container)throw new Error(`Container '${g.container}' not found.`)}else{if(!(g.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(g.maxBounds&&this.setMaxBounds(g.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let O=!1;const N=rs((j=>{this._trackResize&&!this._removed&&(this.resize(j),this.redraw())}),50);this._resizeObserver=new ResizeObserver((j=>{O?N(j):O=!0})),this._resizeObserver.observe(this._container)}this.handlers=new ld(this,g),this._hash=g.hash&&new fl(typeof g.hash=="string"&&g.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:g.center,elevation:g.elevation,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch,roll:g.roll}),g.bounds&&(this.resize(),this.fitBounds(g.bounds,c.e({},g.fitBoundsOptions,{duration:0}))));const I=typeof g.style=="string"||((u=(n=g.style)===null||n===void 0?void 0:n.projection)===null||u===void 0?void 0:u.type)!=="globe";this.resize(null,I),this._localIdeographFontFamily=g.localIdeographFontFamily,this._validateStyle=g.validateStyle,g.style&&this.setStyle(g.style,{localIdeographFontFamily:g.localIdeographFontFamily}),g.attributionControl&&this.addControl(new Uc(typeof g.attributionControl=="boolean"?void 0:g.attributionControl)),g.maplibreLogo&&this.addControl(new Yd,g.logoPosition),this.on("style.load",(()=>{if(I||this._resizeTransform(),this.transform.unmodified){const O=c.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(O)}})),this.on("data",(O=>{this._update(O.dataType==="style"),this.fire(new c.l(`${O.dataType}data`,O))})),this.on("dataloading",(O=>{this.fire(new c.l(`${O.dataType}dataloading`,O))})),this.on("dataabort",(O=>{this.fire(new c.l("sourcedataabort",O))}))}_getMapId(){return this._mapId}setGlobalStateProperty(T,n){return this.style.setGlobalStateProperty(T,n),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(T,n){if(n===void 0&&(n=T.getDefaultPosition?T.getDefaultPosition():"top-right"),!T||!T.onAdd)return this.fire(new c.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=T.onAdd(this);this._controls.push(T);const g=this._controlPositions[n];return n.indexOf("bottom")!==-1?g.insertBefore(u,g.firstChild):g.appendChild(u),this}removeControl(T){if(!T||!T.onRemove)return this.fire(new c.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(T);return n>-1&&this._controls.splice(n,1),T.onRemove(this),this}hasControl(T){return this._controls.indexOf(T)>-1}calculateCameraOptionsFromTo(T,n,u,g){return g==null&&this.terrain&&(g=this.terrain.getElevationForLngLatZoom(u,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(T,n,u,g)}resize(T,n=!0){const[u,g]=this._containerDimensions(),b=this._getClampedPixelRatio(u,g);if(this._resizeCanvas(u,g,b),this.painter.resize(u,g,b),this.painter.overLimit()){const I=this.painter.context.gl;this._maxCanvasSize=[I.drawingBufferWidth,I.drawingBufferHeight];const O=this._getClampedPixelRatio(u,g);this._resizeCanvas(u,g,O),this.painter.resize(u,g,O)}this._resizeTransform(n);const S=!this._moving;return S&&(this.stop(),this.fire(new c.l("movestart",T)).fire(new c.l("move",T))),this.fire(new c.l("resize",T)),S&&this.fire(new c.l("moveend",T)),this}_resizeTransform(T=!0){var n;const[u,g]=this._containerDimensions();this.transform.resize(u,g,T),(n=this._requestedCameraState)===null||n===void 0||n.resize(u,g,T)}_getClampedPixelRatio(T,n){const{0:u,1:g}=this._maxCanvasSize,b=this.getPixelRatio(),S=T*b,I=n*b;return Math.min(S>u?u/S:1,I>g?g/I:1)*b}getPixelRatio(){var T;return(T=this._overridePixelRatio)!==null&&T!==void 0?T:devicePixelRatio}setPixelRatio(T){this._overridePixelRatio=T,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(T){return this.transform.setMaxBounds(Fi.convert(T)),this._update()}setMinZoom(T){if((T=T??-2)>=-2&&T<=this.transform.maxZoom)return this.transform.setMinZoom(T),this._update(),this.getZoom()<T&&this.setZoom(T),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(T){if((T=T??22)>=this.transform.minZoom)return this.transform.setMaxZoom(T),this._update(),this.getZoom()>T&&this.setZoom(T),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(T){if((T=T??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(T>=0&&T<=this.transform.maxPitch)return this.transform.setMinPitch(T),this._update(),this.getPitch()<T&&this.setPitch(T),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(T){if((T=T??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(T>=this.transform.minPitch)return this.transform.setMaxPitch(T),this._update(),this.getPitch()>T&&this.setPitch(T),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(T){return this.transform.setRenderWorldCopies(T),this._update()}project(T){return this.transform.locationToScreenPoint(c.S.convert(T),this.style&&this.terrain)}unproject(T){return this.transform.screenPointToLocation(c.P.convert(T),this.terrain)}isMoving(){var T;return this._moving||((T=this.handlers)===null||T===void 0?void 0:T.isMoving())}isZooming(){var T;return this._zooming||((T=this.handlers)===null||T===void 0?void 0:T.isZooming())}isRotating(){var T;return this._rotating||((T=this.handlers)===null||T===void 0?void 0:T.isRotating())}_createDelegatedListener(T,n,u){if(T==="mouseenter"||T==="mouseover"){let g=!1;return{layers:n,listener:u,delegates:{mousemove:S=>{const I=n.filter((N=>this.getLayer(N))),O=I.length!==0?this.queryRenderedFeatures(S.point,{layers:I}):[];O.length?g||(g=!0,u.call(this,new Ra(T,this,S.originalEvent,{features:O}))):g=!1},mouseout:()=>{g=!1}}}}if(T==="mouseleave"||T==="mouseout"){let g=!1;return{layers:n,listener:u,delegates:{mousemove:I=>{const O=n.filter((N=>this.getLayer(N)));(O.length!==0?this.queryRenderedFeatures(I.point,{layers:O}):[]).length?g=!0:g&&(g=!1,u.call(this,new Ra(T,this,I.originalEvent)))},mouseout:I=>{g&&(g=!1,u.call(this,new Ra(T,this,I.originalEvent)))}}}}{const g=b=>{const S=n.filter((O=>this.getLayer(O))),I=S.length!==0?this.queryRenderedFeatures(b.point,{layers:S}):[];I.length&&(b.features=I,u.call(this,b),delete b.features)};return{layers:n,listener:u,delegates:{[T]:g}}}}_saveDelegatedListener(T,n){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[T]=this._delegatedListeners[T]||[],this._delegatedListeners[T].push(n)}_removeDelegatedListener(T,n,u){if(!this._delegatedListeners||!this._delegatedListeners[T])return;const g=this._delegatedListeners[T];for(let b=0;b<g.length;b++){const S=g[b];if(S.listener===u&&S.layers.length===n.length&&S.layers.every((I=>n.includes(I)))){for(const I in S.delegates)this.off(I,S.delegates[I]);return void g.splice(b,1)}}}on(T,n,u){if(u===void 0)return super.on(T,n);const g=typeof n=="string"?[n]:n,b=this._createDelegatedListener(T,g,u);this._saveDelegatedListener(T,b);for(const S in b.delegates)this.on(S,b.delegates[S]);return{unsubscribe:()=>{this._removeDelegatedListener(T,g,u)}}}once(T,n,u){if(u===void 0)return super.once(T,n);const g=typeof n=="string"?[n]:n,b=this._createDelegatedListener(T,g,u);for(const S in b.delegates){const I=b.delegates[S];b.delegates[S]=(...O)=>{this._removeDelegatedListener(T,g,u),I(...O)}}this._saveDelegatedListener(T,b);for(const S in b.delegates)this.once(S,b.delegates[S]);return this}off(T,n,u){return u===void 0?super.off(T,n):(this._removeDelegatedListener(T,typeof n=="string"?[n]:n,u),this)}queryRenderedFeatures(T,n){if(!this.style)return[];let u;const g=T instanceof c.P||Array.isArray(T),b=g?T:[[0,0],[this.transform.width,this.transform.height]];if(n=n||(g?{}:T)||{},b instanceof c.P||typeof b[0]=="number")u=[c.P.convert(b)];else{const S=c.P.convert(b[0]),I=c.P.convert(b[1]);u=[S,new c.P(I.x,S.y),I,new c.P(S.x,I.y),S]}return this.style.queryRenderedFeatures(u,n,this.transform)}querySourceFeatures(T,n){return this.style.querySourceFeatures(T,n)}setStyle(T,n){return(n=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},n)).diff!==!1&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&T?(this._diffStyle(T,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(T,n))}setTransformRequest(T){return this._requestManager.setTransformRequest(T),this}_getUIString(T){const n=this._locale[T];if(n==null)throw new Error(`Missing UI string '${T}'`);return n}_updateStyle(T,n){var u,g;if(n.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(T,n)));const b=this.style&&n.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!T)),T?(this.style=new P(this,n||{}),this.style.setEventedParent(this,{style:this.style}),typeof T=="string"?this.style.loadURL(T,n,b):this.style.loadJSON(T,n,b),this):((g=(u=this.style)===null||u===void 0?void 0:u.projection)===null||g===void 0||g.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new P(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(T,n){if(typeof T=="string"){const u=this._requestManager.transformRequest(T,"Style");c.j(u,new AbortController).then((g=>{this._updateDiff(g.data,n)})).catch((g=>{g&&this.fire(new c.k(g))}))}else typeof T=="object"&&this._updateDiff(T,n)}_updateDiff(T,n){try{this.style.setState(T,n)&&this._update(!0)}catch(u){c.w(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(T,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(T,n){return this._lazyInitEmptyStyle(),this.style.addSource(T,n),this._update(!0)}isSourceLoaded(T){const n=this.style&&this.style.sourceCaches[T];if(n!==void 0)return n.loaded();this.fire(new c.k(new Error(`There is no source with ID '${T}'`)))}setTerrain(T){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),T){const n=this.style.sourceCaches[T.source];if(!n)throw new Error(`cannot load terrain, because there exists no source with ID: ${T.source}`);this.terrain===null&&n.reload();for(const u in this.style._layers){const g=this.style._layers[u];g.type==="hillshade"&&g.source===T.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),g.type==="color-relief"&&g.source===T.source&&c.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Tn(this.painter,n,T),this.painter.renderToTexture=new jc(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=u=>{var g;u.dataType==="style"?this.terrain.sourceCache.freeRtt():u.dataType==="source"&&u.tile&&(u.sourceId!==T.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((g=u.source)===null||g===void 0?void 0:g.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(u.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new c.l("terrain",{terrain:T})),this}getTerrain(){var T,n;return(n=(T=this.terrain)===null||T===void 0?void 0:T.options)!==null&&n!==void 0?n:null}areTilesLoaded(){const T=this.style&&this.style.sourceCaches;for(const n in T){const u=T[n]._tiles;for(const g in u){const b=u[g];if(b.state!=="loaded"&&b.state!=="errored")return!1}}return!0}removeSource(T){return this.style.removeSource(T),this._update(!0)}getSource(T){return this.style.getSource(T)}setSourceTileLodParams(T,n,u){if(u){const g=this.getSource(u);if(!g)throw new Error(`There is no source with ID "${u}", cannot set LOD parameters`);g.calculateTileZoom=Pt(Math.max(1,T),Math.max(1,n))}else for(const g in this.style.sourceCaches)this.style.sourceCaches[g].getSource().calculateTileZoom=Pt(Math.max(1,T),Math.max(1,n));return this._update(!0),this}refreshTiles(T,n){const u=this.style.sourceCaches[T];if(!u)throw new Error(`There is no source cache with ID "${T}", cannot refresh tile`);n===void 0?u.reload(!0):u.refreshTiles(n.map((g=>new c.a4(g.z,g.x,g.y))))}addImage(T,n,u={}){const{pixelRatio:g=1,sdf:b=!1,stretchX:S,stretchY:I,content:O,textFitWidth:N,textFitHeight:j}=u;if(this._lazyInitEmptyStyle(),!(n instanceof HTMLImageElement||c.b(n))){if(n.width===void 0||n.height===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:$,height:X,data:H}=n,J=n;return this.style.addImage(T,{data:new c.R({width:$,height:X},new Uint8Array(H)),pixelRatio:g,stretchX:S,stretchY:I,content:O,textFitWidth:N,textFitHeight:j,sdf:b,version:0,userImage:J}),J.onAdd&&J.onAdd(this,T),this}}{const{width:$,height:X,data:H}=ee.getImageData(n);this.style.addImage(T,{data:new c.R({width:$,height:X},H),pixelRatio:g,stretchX:S,stretchY:I,content:O,textFitWidth:N,textFitHeight:j,sdf:b,version:0})}}updateImage(T,n){const u=this.style.getImage(T);if(!u)return this.fire(new c.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const g=n instanceof HTMLImageElement||c.b(n)?ee.getImageData(n):n,{width:b,height:S,data:I}=g;if(b===void 0||S===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(b!==u.data.width||S!==u.data.height)return this.fire(new c.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const O=!(n instanceof HTMLImageElement||c.b(n));return u.data.replace(I,O),this.style.updateImage(T,u),this}getImage(T){return this.style.getImage(T)}hasImage(T){return T?!!this.style.getImage(T):(this.fire(new c.k(new Error("Missing required image id"))),!1)}removeImage(T){this.style.removeImage(T)}loadImage(T){return Ke.getImage(this._requestManager.transformRequest(T,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(T,n){return this._lazyInitEmptyStyle(),this.style.addLayer(T,n),this._update(!0)}moveLayer(T,n){return this.style.moveLayer(T,n),this._update(!0)}removeLayer(T){return this.style.removeLayer(T),this._update(!0)}getLayer(T){return this.style.getLayer(T)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(T,n,u){return this.style.setLayerZoomRange(T,n,u),this._update(!0)}setFilter(T,n,u={}){return this.style.setFilter(T,n,u),this._update(!0)}getFilter(T){return this.style.getFilter(T)}setPaintProperty(T,n,u,g={}){return this.style.setPaintProperty(T,n,u,g),this._update(!0)}getPaintProperty(T,n){return this.style.getPaintProperty(T,n)}setLayoutProperty(T,n,u,g={}){return this.style.setLayoutProperty(T,n,u,g),this._update(!0)}getLayoutProperty(T,n){return this.style.getLayoutProperty(T,n)}setGlyphs(T,n={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(T,n),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(T,n,u={}){return this._lazyInitEmptyStyle(),this.style.addSprite(T,n,u,(g=>{g||this._update(!0)})),this}removeSprite(T){return this._lazyInitEmptyStyle(),this.style.removeSprite(T),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(T,n={}){return this._lazyInitEmptyStyle(),this.style.setSprite(T,n,(u=>{u||this._update(!0)})),this}setLight(T,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(T,n),this._update(!0)}getLight(){return this.style.getLight()}setSky(T,n={}){return this._lazyInitEmptyStyle(),this.style.setSky(T,n),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(T,n){return this.style.setFeatureState(T,n),this._update()}removeFeatureState(T,n){return this.style.removeFeatureState(T,n),this._update()}getFeatureState(T){return this.style.getFeatureState(T)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let T=0,n=0;return this._container&&(T=this._container.clientWidth||400,n=this._container.clientHeight||300),[T,n]}_setupContainer(){const T=this._container;T.classList.add("maplibregl-map");const n=this._canvasContainer=Y.create("div","maplibregl-canvas-container",T);this._interactive&&n.classList.add("maplibregl-interactive"),this._canvas=Y.create("canvas","maplibregl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const u=this._containerDimensions(),g=this._getClampedPixelRatio(u[0],u[1]);this._resizeCanvas(u[0],u[1],g);const b=this._controlContainer=Y.create("div","maplibregl-control-container",T),S=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((I=>{S[I]=Y.create("div",`maplibregl-ctrl-${I} `,b)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(T,n,u){this._canvas.width=Math.floor(u*T),this._canvas.height=Math.floor(u*n),this._canvas.style.width=`${T}px`,this._canvas.style.height=`${n}px`}_setupPainter(){const T=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let n=null;this._canvas.addEventListener("webglcontextcreationerror",(g=>{n={requestedAttributes:T},g&&(n.statusMessage=g.statusMessage,n.type=g.type)}),{once:!0});let u=null;if(u=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,T):this._canvas.getContext("webgl2",T)||this._canvas.getContext("webgl",T),!u){const g="Failed to initialize WebGL";throw n?(n.message=g,new Error(JSON.stringify(n))):new Error(g)}this.painter=new Nr(u,this.transform),xe.testSupport(u)}migrateProjection(T,n){super.migrateProjection(T,n),this.painter.transform=T,this.fire(new c.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(T){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||T,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(T){return this._update(),this._renderTaskQueue.add(T)}_cancelRenderFrame(T){this._renderTaskQueue.remove(T)}_render(T){var n,u,g,b,S;const I=this._idleTriggered?this._fadeDuration:0,O=((n=this.style.projection)===null||n===void 0?void 0:n.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(T),this._removed)return;let N=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const X=this.transform.zoom,H=ee.now();this.style.zoomHistory.update(X,H);const J=new c.F(X,{now:H,fadeDuration:I,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),ae=J.crossFadingFactor();ae===1&&ae===this._crossFadingFactor||(N=!0,this._crossFadingFactor=ae),this.style.update(J)}const j=((u=this.style.projection)===null||u===void 0?void 0:u.transitionState)>0!==O;(g=this.style.projection)===null||g===void 0||g.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((b=this.style.projection)===null||b===void 0?void 0:b.transitionState,(S=this.style.projection)===null||S===void 0?void 0:S.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||j)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,I,this._crossSourceCollisions,j),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:I,showPadding:this.showPadding}),this.fire(new c.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.cw.mark(c.cx.load),this.fire(new c.l("load"))),this.style&&(this.style.hasTransitions()||N)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const $=this._sourcesDirty||this._styleDirty||this._placementDirty;return $||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.l("idle")),!this._loaded||this._fullyLoaded||$||(this._fullyLoaded=!0,c.cw.mark(c.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var T;this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Ke.removeThrottleControl(this._imageQueueHandle),(T=this._resizeObserver)===null||T===void 0||T.disconnect();const n=this.painter.context.gl.getExtension("WEBGL_lose_context");n!=null&&n.loseContext&&n.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),Y.remove(this._canvasContainer),Y.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),c.cw.clearMetrics(),this._removed=!0,this.fire(new c.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,ee.frame(this._frameRequest,(T=>{c.cw.frame(T),this._frameRequest=null;try{this._render(T)}catch(n){if(!c.cy(n)&&!(function(u){return u.message===Lo})(n))throw n}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(T){this._showTileBoundaries!==T&&(this._showTileBoundaries=T,this._update())}get showPadding(){return!!this._showPadding}set showPadding(T){this._showPadding!==T&&(this._showPadding=T,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(T){this._showCollisionBoxes!==T&&(this._showCollisionBoxes=T,T?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(T){this._showOverdrawInspector!==T&&(this._showOverdrawInspector=T,this._update())}get repaint(){return!!this._repaint}set repaint(T){this._repaint!==T&&(this._repaint=T,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(T){this._vertices=T,this._update()}get version(){return Qd}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(T){return this._lazyInitEmptyStyle(),this.style.setProjection(T),this._update(!0)}},_.MapMouseEvent=Ra,_.MapTouchEvent=Tu,_.MapWheelEvent=Su,_.Marker=Wa,_.NavigationControl=class{constructor(T){this._updateZoomButtons=()=>{const n=this._map.getZoom(),u=n===this._map.getMaxZoom(),g=n===this._map.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(n,u)=>{const g=this._map._getUIString(`NavigationControl.${u}`);n.title=g,n.setAttribute("aria-label",g)},this.options=c.e({},Vo,T),this._container=Y.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(n=>n.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(n=>this._map.zoomIn({},{originalEvent:n}))),Y.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(n=>this._map.zoomOut({},{originalEvent:n}))),Y.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(n=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})})),this._compassIcon=Y.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(T){return this._map=T,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Cs(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){Y.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(T,n){const u=Y.create("button",T,this._container);return u.type="button",u.addEventListener("click",n),u}},_.Popup=class extends c.E{constructor(T){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&Y.remove(this._content),this._container&&(Y.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.l("close"))),this),this._onMouseUp=n=>{this._update(n.point)},this._onMouseMove=n=>{this._update(n.point)},this._onDrag=n=>{this._update(n.point)},this._update=n=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=Y.create("div","maplibregl-popup",this._map.getContainer()),this._tip=Y.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const I of this.options.className.split(" "))this._container.classList.add(I);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Br(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!n)return;const u=this._flatPos=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&n?n:this._map.transform.locationToScreenPoint(this._lngLat));let g=this.options.anchor;const b=nu(this.options.offset);if(!g){const I=this._container.offsetWidth,O=this._container.offsetHeight;let N;N=u.y+b.bottom.y<O?["top"]:u.y>this._map.transform.height-O?["bottom"]:[],u.x<I/2?N.push("left"):u.x>this._map.transform.width-I/2&&N.push("right"),g=N.length===0?"bottom":N.join("-")}let S=u.add(b[g]);this.options.subpixelPositioning||(S=S.round()),Y.setTransform(this._container,`${cd[g]} translate(${S.x}px,${S.y}px)`),Uo(this._container,g,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(bh),T)}addTo(T){return this._map&&this.remove(),this._map=T,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(T){return this._lngLat=c.S.convert(T),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(T){return this.setDOMContent(document.createTextNode(T))}setHTML(T){const n=document.createDocumentFragment(),u=document.createElement("body");let g;for(u.innerHTML=T;g=u.firstChild,g;)n.appendChild(g);return this.setDOMContent(n)}getMaxWidth(){var T;return(T=this._container)===null||T===void 0?void 0:T.style.maxWidth}setMaxWidth(T){return this.options.maxWidth=T,this._update(),this}setDOMContent(T){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=Y.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(T),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(T){return this._container&&this._container.classList.add(T),this}removeClassName(T){return this._container&&this._container.classList.remove(T),this}setOffset(T){return this.options.offset=T,this._update(),this}toggleClassName(T){if(this._container)return this._container.classList.toggle(T)}setSubpixelPositioning(T){this.options.subpixelPositioning=T}_createCloseButton(){this.options.closeButton&&(this._closeButton=Y.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const T=this._container.querySelector(cc);T&&T.focus()}},_.RasterDEMTileSource=Bs,_.RasterTileSource=Ta,_.ScaleControl=class{constructor(T){this._onMove=()=>{ji(this._map,this._container,this.options)},this.setUnit=n=>{this.options.unit=n,ji(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Gn),T)}getDefaultPosition(){return"bottom-left"}onAdd(T){return this._map=T,this._container=Y.create("div","maplibregl-ctrl maplibregl-ctrl-scale",T.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){Y.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},_.ScrollZoomHandler=Hf,_.Style=P,_.TerrainControl=class{constructor(T){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=T}onAdd(T){return this._map=T,this._container=Y.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=Y.create("button","maplibregl-ctrl-terrain",this._container),Y.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){Y.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},_.TwoFingersTouchPitchHandler=Bc,_.TwoFingersTouchRotateHandler=ac,_.TwoFingersTouchZoomHandler=ad,_.TwoFingersTouchZoomRotateHandler=Wf,_.VectorTileSource=Va,_.VideoSource=pr,_.addSourceType=(T,n)=>c._(void 0,void 0,void 0,(function*(){if(ao(T))throw new Error(`A source type called "${T}" already exists.`);((u,g)=>{wo[u]=g})(T,n)})),_.clearPrewarmedResources=function(){const T=Ot;T&&(T.isPreloaded()&&T.numActive()===1?(T.release(Vt),Ot=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},_.createTileMesh=oo,_.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},_.getRTLTextPluginStatus=function(){return Fs().getRTLTextPluginStatus()},_.getVersion=function(){return xh},_.getWorkerCount=function(){return ke.workerCount},_.getWorkerUrl=function(){return c.a.WORKER_URL},_.importScriptInWorkers=function(T){return Fn().broadcast("IS",T)},_.prewarm=function(){Jt().acquire(Vt)},_.setMaxParallelImageRequests=function(T){c.a.MAX_PARALLEL_IMAGE_REQUESTS=T},_.setRTLTextPlugin=function(T,n){return Fs().setRTLTextPlugin(T,n)},_.setWorkerCount=function(T){ke.workerCount=T},_.setWorkerUrl=function(T){c.a.WORKER_URL=T}}));var m=t;return m}))})(r0)),r0.exports}var wN=xN();const wn=wy(wN);function TN(){return typeof self<"u"?fetch.bind(self):typeof global<"u"&&global.fetch?global.fetch:null}class SN{constructor(){this._apiKey="",this._fetch=TN(),this.tileCacheSize=200}set apiKey(e){this._apiKey=e}get apiKey(){return this._apiKey}set fetch(e){this._fetch=e}get fetch(){return this._fetch}}const sg=new SN,EN={AUTO:{code:null,flag:"auto",name:"Auto",latin:!1,isMode:!0,geocoding:!0},LATIN:{code:"latin",flag:"name:latin",name:"Latin",latin:!0,isMode:!1,geocoding:!1},NON_LATIN:{code:"nonlatin",flag:"name:nonlatin",name:"Non Latin",latin:!1,isMode:!1,geocoding:!1},LOCAL:{code:null,flag:"name",name:"Local",latin:!0,isMode:!1,geocoding:!1}},AN={ALBANIAN:{code:"sq",flag:"name:sq",name:"Albanian",latin:!0,isMode:!1,geocoding:!0},AMHARIC:{code:"am",flag:"name:am",name:"Amharic",latin:!1,isMode:!1,geocoding:!0},ARABIC:{code:"ar",flag:"name:ar",name:"Arabic",latin:!1,isMode:!1,geocoding:!0},ARMENIAN:{code:"hy",flag:"name:hy",name:"Armenian",latin:!1,isMode:!1,geocoding:!0},AZERBAIJANI:{code:"az",flag:"name:az",name:"Azerbaijani",latin:!0,isMode:!1,geocoding:!0},BASQUE:{code:"eu",flag:"name:eu",name:"Basque",latin:!0,isMode:!1,geocoding:!0},BELARUSIAN:{code:"be",flag:"name:be",name:"Belarusian",latin:!1,isMode:!1,geocoding:!0},BENGALI:{code:"bn",flag:"name:bn",name:"Bengali",latin:!0,isMode:!1,geocoding:!0},BOSNIAN:{code:"bs",flag:"name:bs",name:"Bosnian",latin:!0,isMode:!1,geocoding:!0},BRETON:{code:"br",flag:"name:br",name:"Breton",latin:!0,isMode:!1,geocoding:!0},BULGARIAN:{code:"bg",flag:"bg",name:"Bulgarian",latin:!1,isMode:!1,geocoding:!0},CATALAN:{code:"ca",flag:"name:ca",name:"Catalan",latin:!0,isMode:!1,geocoding:!0},CHINESE:{code:"zh",flag:"name:zh",name:"Chinese",latin:!1,isMode:!1,geocoding:!0},TRADITIONAL_CHINESE:{code:"zh-Hant",flag:"name:zh-Hant",name:"Chinese (traditional)",latin:!1,isMode:!1,geocoding:!1},SIMPLIFIED_CHINESE:{code:"zh-Hans",flag:"name:zh-Hans",name:"Chinese (simplified)",latin:!1,isMode:!1,geocoding:!1},CORSICAN:{code:"co",flag:"name:co",name:"Corsican",latin:!0,isMode:!1,geocoding:!0},CROATIAN:{code:"hr",flag:"name:hr",name:"Croatian",latin:!0,isMode:!1,geocoding:!0},CZECH:{code:"cs",flag:"name:cs",name:"Czech",latin:!0,isMode:!1,geocoding:!0},DANISH:{code:"da",flag:"name:da",name:"Danish",latin:!0,isMode:!1,geocoding:!0},DUTCH:{code:"nl",flag:"name:nl",name:"Dutch",latin:!0,isMode:!1,geocoding:!0},GERMAN:{code:"de",flag:"name:de",name:"German",latin:!0,isMode:!1,geocoding:!0},GREEK:{code:"el",flag:"name:el",name:"Greek",latin:!1,isMode:!1,geocoding:!0},ENGLISH:{code:"en",flag:"name:en",name:"English",latin:!0,isMode:!1,geocoding:!0},ESPERANTO:{code:"eo",flag:"name:eo",name:"Esperanto",latin:!0,isMode:!1,geocoding:!0},ESTONIAN:{code:"et",flag:"name:et",name:"Estonian",latin:!0,isMode:!1,geocoding:!0},FINNISH:{code:"fi",flag:"name:fi",name:"Finnish",latin:!0,isMode:!1,geocoding:!0},FRENCH:{code:"fr",flag:"name:fr",name:"French",latin:!0,isMode:!1,geocoding:!0},FRISIAN:{code:"fy",flag:"name:fy",name:"Frisian (West)",latin:!0,isMode:!1,geocoding:!0},GEORGIAN:{code:"ka",flag:"name:ka",name:"Georgian",latin:!1,isMode:!1,geocoding:!0},HEBREW:{code:"he",flag:"name:he",name:"Hebrew",latin:!1,isMode:!1,geocoding:!0},HINDI:{code:"hi",flag:"name:hi",name:"Hindi",latin:!1,isMode:!1,geocoding:!0},HUNGARIAN:{code:"hu",flag:"name:hu",name:"Hungarian",latin:!0,isMode:!1,geocoding:!0},ICELANDIC:{code:"is",flag:"name:is",name:"Icelandic",latin:!0,isMode:!1,geocoding:!0},INDONESIAN:{code:"id",flag:"name:id",name:"Indonesian",latin:!0,isMode:!1,geocoding:!0},IRISH:{code:"ga",flag:"name:ga",name:"Irish",latin:!0,isMode:!1,geocoding:!0},ITALIAN:{code:"it",flag:"name:it",name:"Italian",latin:!0,isMode:!1,geocoding:!0},JAPANESE:{code:"ja",flag:"name:ja",name:"Japanese",latin:!1,isMode:!1,geocoding:!0},JAPANESE_HIRAGANA:{code:"ja-Hira",flag:"name:ja-Hira",name:"Japanese Hiragana form",latin:!1,isMode:!1,geocoding:!1},JAPANESE_2018:{code:"ja-Latn",flag:"name:ja-Latn",name:"Japanese (Latin 2018)",latin:!0,isMode:!1,geocoding:!1},JAPANESE_KANA:{code:"ja_kana",flag:"name:ja_kana",name:"Japanese (Kana)",latin:!1,isMode:!1,geocoding:!1},JAPANESE_LATIN:{code:"ja_rm",flag:"name:ja_rm",name:"Japanese (Latin script)",latin:!0,isMode:!1,geocoding:!1},KANNADA:{code:"kn",flag:"name:kn",name:"Kannada",latin:!0,isMode:!1,geocoding:!0},KAZAKH:{code:"kk",flag:"name:kk",name:"Kazakh",latin:!1,isMode:!1,geocoding:!0},KOREAN:{code:"ko",flag:"name:ko",name:"Korean",latin:!1,isMode:!1,geocoding:!0},KOREAN_LATIN:{code:"ko-Latn",flag:"name:ko-Latn",name:"Korean (Latin script)",latin:!0,isMode:!1,geocoding:!1},KURDISH:{code:"ku",flag:"name:ku",name:"Kurdish",latin:!0,isMode:!1,geocoding:!0},CLASSICAL_LATIN:{code:"la",flag:"name:la",name:"Latin",latin:!0,isMode:!1,geocoding:!0},LATVIAN:{code:"lv",flag:"name:lv",name:"Latvian",latin:!0,isMode:!1,geocoding:!0},LITHUANIAN:{code:"lt",flag:"name:lt",name:"Lithuanian",latin:!0,isMode:!1,geocoding:!0},LUXEMBOURGISH:{code:"lb",flag:"name:lb",name:"Luxembourgish",latin:!0,isMode:!1,geocoding:!0},MACEDONIAN:{code:"mk",flag:"name:mk",name:"Macedonian",latin:!1,isMode:!1,geocoding:!0},MALAYALAM:{code:"ml",flag:"name:ml",name:"Malayalam",latin:!1,isMode:!1,geocoding:!0},MALTESE:{code:"mt",flag:"name:mt",name:"Maltese",latin:!0,isMode:!1,geocoding:!0},NORWEGIAN:{code:"no",flag:"name:no",name:"Norwegian",latin:!0,isMode:!1,geocoding:!0},OCCITAN:{code:"oc",flag:"name:oc",name:"Occitan",latin:!0,isMode:!1,geocoding:!0},PERSIAN:{code:"fa",flag:"name:fa",name:"Persian",latin:!1,isMode:!1,geocoding:!0},POLISH:{code:"pl",flag:"name:pl",name:"Polish",latin:!0,isMode:!1,geocoding:!0},PORTUGUESE:{code:"pt",flag:"name:pt",name:"Portuguese",latin:!0,isMode:!1,geocoding:!0},PUNJABI:{code:"pa",flag:"name:pa",name:"Punjabi",latin:!1,isMode:!1,geocoding:!0},WESTERN_PUNJABI:{code:"pnb",flag:"name:pnb",name:"Western Punjabi",latin:!1,isMode:!1,geocoding:!1},ROMANIAN:{code:"ro",flag:"name:ro",name:"Romanian",latin:!0,isMode:!1,geocoding:!0},ROMANSH:{code:"rm",flag:"name:rm",name:"Romansh",latin:!0,isMode:!1,geocoding:!0},RUSSIAN:{code:"ru",flag:"name:ru",name:"Russian",latin:!1,isMode:!1,geocoding:!0},SERBIAN_CYRILLIC:{code:"sr",flag:"name:sr",name:"Serbian (Cyrillic script)",latin:!1,isMode:!1,geocoding:!0},SERBIAN_LATIN:{code:"sr-Latn",flag:"name:sr-Latn",name:"Serbian (Latin script)",latin:!0,isMode:!1,geocoding:!1},SCOTTISH_GAELIC:{code:"gd",flag:"name:gd",name:"Scottish Gaelic",latin:!0,isMode:!1,geocoding:!0},SLOVAK:{code:"sk",flag:"name:sk",name:"Slovak",latin:!0,isMode:!1,geocoding:!0},SLOVENE:{code:"sl",flag:"name:sl",name:"Slovene",latin:!0,isMode:!1,geocoding:!0},SPANISH:{code:"es",flag:"name:es",name:"Spanish",latin:!0,isMode:!1,geocoding:!0},SWEDISH:{code:"sv",flag:"name:sv",name:"Swedish",latin:!0,isMode:!1,geocoding:!0},TAMIL:{code:"ta",flag:"name:ta",name:"Tamil",latin:!1,isMode:!1,geocoding:!0},TELUGU:{code:"te",flag:"name:te",name:"Telugu",latin:!1,isMode:!1,geocoding:!0},THAI:{code:"th",flag:"name:th",name:"Thai",latin:!1,isMode:!1,geocoding:!0},TURKISH:{code:"tr",flag:"name:tr",name:"Turkish",latin:!0,isMode:!1,geocoding:!0},UKRAINIAN:{code:"uk",flag:"name:uk",name:"Ukrainian",latin:!1,isMode:!1,geocoding:!0},VIETNAMESE:{code:"vi",flag:"name:vi",name:"Vietnamese (Latin script)",latin:!0,isMode:!1,geocoding:!0},WELSH:{code:"cy",flag:"name:cy",name:"Welsh",latin:!0,isMode:!1,geocoding:!0}},Oy={...EN,...AN};function CN(i,e=Oy){return i in e?i[i]:null}function n1(i,e=Oy){for(const t of Object.values(e))if(t.code===i)return t;return null}function i1(i,e=Oy){for(const t of Object.values(e))if(t.flag===i)return t;return null}function IN(i){return i!==null&&typeof i=="object"&&"code"in i&&"flag"in i&&"name"in i&&"latin"in i&&"isMode"in i&&"geocoding"in i&&(typeof i.code=="string"||i.code===null)&&typeof i.flag=="string"&&typeof i.name=="string"&&typeof i.latin=="boolean"&&typeof i.isMode=="boolean"&&typeof i.geocoding=="boolean"}function lS(i,e=Oy){return IN(i)?i1(i.flag,e):typeof i!="string"?null:CN(i,e)||n1(i,e)||i1(i,e)||null}async function MN(i,e={}){if(sg.fetch===null)throw new Error("The fetch function was not found. If on NodeJS < 18 please specify the fetch function with config.fetch");if(new URL(i).searchParams.get("key").trim()==="")throw new Error("The MapTiler Cloud API key is missing. Set it in `config.apiKey` or get one for free at https://maptiler.com");return sg.fetch(i,e)}const MI={maptilerApiURL:"https://api.maptiler.com/",mapStyle:"streets-v2"};Object.freeze(MI);class PN extends Error{constructor(e,t=""){super(`Call to enpoint ${e.url} failed with the status code ${e.status}. ${t}`),this.res=e}}const uS={403:"Key is missing, invalid or restricted"};async function RN(i={}){const e=new URL("geolocation/ip.json",MI.maptilerApiURL);e.searchParams.set("key",i.apiKey??sg.apiKey),"elevation"in i&&e.searchParams.set("elevation",i.elevation?"true":"false");const t=e.toString(),a=await MN(t);if(!a.ok)throw new PN(a,a.status in uS?uS[a.status]:"");return await a.json()}const cS={info:RN};function PI(i){const e=/^maptiler:\/\/(.*)/;let t;const a=i.trim();let d;return a.startsWith("http://")||a.startsWith("https://")?d=a:(t=e.exec(a))!==null?d=`https://api.maptiler.com/maps/${t[1]}/style.json`:d=`https://api.maptiler.com/maps/${a}/style.json`,d}class RI{constructor(e,t,a,d,m,_,c=!1){this.name=e,this.variantType=t,this.id=a,this.referenceStyle=d,this.description=m,this.imageURL=_,this.deprecated=c}getName(){return this.name}getFullName(){return`${this.referenceStyle.getName()} ${this.name}`}getType(){return this.variantType}getId(){return this.id}getDescription(){return this.description}getReferenceStyle(){return this.referenceStyle}hasVariant(e){return this.referenceStyle.hasVariant(e)}getVariant(e){const t=this.referenceStyle.getVariant(e);return this.warnIfDeprecated(t),t}getVariants(){return this.referenceStyle.getVariants().filter(e=>e!==this).map(e=>(this.warnIfDeprecated(e),e))}getImageURL(){return this.imageURL}getExpandedStyleURL(){return PI(this.getId())}warnIfDeprecated(e=this){if(!e.deprecated)return e;const t=e.getFullName();return console.warn(`Style "${t}" is deprecated and will be removed in a future version.`),e}}class LI{constructor(e,t){this.name=e,this.id=t,this.variants={},this.orderedVariants=[]}getName(){return this.name}getId(){return this.id}addVariant(e){this.variants[e.getType()]=e,this.orderedVariants.push(e)}hasVariant(e){return e in this.variants}getVariant(e){return e in this.variants?this.variants[e]:this.orderedVariants[0]}getVariants(){return Object.values(this.variants)}getDefaultVariant(){return this.orderedVariants[0].warnIfDeprecated()}}const Y_=[{referenceStyleID:"STREETS",name:"Streets",description:"",variants:[{id:"streets-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"streets-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"streets-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"streets-v2-night",name:"Night",variantType:"NIGHT",description:"",imageURL:""},{id:"streets-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OUTDOOR",name:"Outdoor",description:"",variants:[{id:"outdoor-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"outdoor-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"WINTER",name:"Winter",description:"",variants:[{id:"winter-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"winter-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"SATELLITE",name:"Satellite",description:"",variants:[{id:"satellite",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"HYBRID",name:"Hybrid",description:"",variants:[{id:"hybrid",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"BASIC",name:"Basic",description:"",variants:[{id:"basic-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"basic-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"basic-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BRIGHT",name:"Bright",description:"",variants:[{id:"bright-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"bright-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"bright-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"bright-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OPENSTREETMAP",name:"OpenStreetMap",description:"",variants:[{id:"openstreetmap",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"TOPO",name:"Topo",description:"",variants:[{id:"topo-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"topo-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"topo-v2-shiny",name:"Shiny",deprecated:!0,variantType:"SHINY",description:"",imageURL:""},{id:"topo-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""},{id:"topo-v2-topographique",name:"Topographique",variantType:"TOPOGRAPHIQUE",description:"",imageURL:""}]},{referenceStyleID:"VOYAGER",name:"Voyager",description:"",variants:[{id:"voyager-v2",name:"Default",deprecated:!0,variantType:"DEFAULT",description:"",imageURL:""},{id:"voyager-v2-darkmatter",name:"Darkmatter",deprecated:!0,variantType:"DARK",description:"",imageURL:""},{id:"voyager-v2-positron",name:"Positron",deprecated:!0,variantType:"LIGHT",description:"",imageURL:""},{id:"voyager-v2-vintage",name:"Vintage",deprecated:!0,variantType:"VINTAGE",description:"",imageURL:""}]},{referenceStyleID:"TONER",name:"Toner",description:"",variants:[{id:"toner-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"toner-v2-background",name:"Background",variantType:"BACKGROUND",deprecated:!0,description:"",imageURL:""},{id:"toner-v2-lite",name:"Lite",variantType:"LITE",description:"",imageURL:""},{id:"toner-v2-lines",name:"Lines",variantType:"LINES",deprecated:!0,description:"",imageURL:""}]},{referenceStyleID:"DATAVIZ",name:"Dataviz",description:"",variants:[{id:"dataviz",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"dataviz-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"dataviz-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BACKDROP",name:"Backdrop",description:"",variants:[{id:"backdrop",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"backdrop-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"backdrop-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"OCEAN",name:"Ocean",description:"",variants:[{id:"ocean",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"AQUARELLE",name:"Aquarelle",description:"Watercolor map for creative use",variants:[{id:"aquarelle",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"aquarelle-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"aquarelle-vivid",name:"Vivid",variantType:"VIVID",description:"",imageURL:""}]},{referenceStyleID:"LANDSCAPE",name:"Landscape",description:"Terrain map for data overlays and visualisations",variants:[{id:"landscape",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"landscape-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"landscape-vivid",name:"Vivid",variantType:"VIVID",description:"",imageURL:""}]}];function LN(i){return new Proxy(i,{get(e,t,a){return e.hasVariant(t)?e.getVariant(t):t.toString().toUpperCase()===t?i.getDefaultVariant():Reflect.get(e,t,a)}})}function kN(){const i={};for(let e=0;e<Y_.length;e+=1){const t=Y_[e],a=LN(new LI(t.name,t.referenceStyleID));for(let d=0;d<t.variants.length;d+=1){const m=t.variants[d],_=new RI(m.name,m.variantType,m.id,a,m.description,m.imageURL,m.deprecated);a.addVariant(_)}i[t.referenceStyleID]=a}return i}const Q_=kN();var Fv={exports:{}},hS;function DN(){if(hS)return Fv.exports;hS=1;var i=typeof Reflect=="object"?Reflect:null,e=i&&typeof i.apply=="function"?i.apply:function(Ge,Fe,de){return Function.prototype.apply.call(Ge,Fe,de)},t;i&&typeof i.ownKeys=="function"?t=i.ownKeys:Object.getOwnPropertySymbols?t=function(Ge){return Object.getOwnPropertyNames(Ge).concat(Object.getOwnPropertySymbols(Ge))}:t=function(Ge){return Object.getOwnPropertyNames(Ge)};function a(Ke){console&&console.warn&&console.warn(Ke)}var d=Number.isNaN||function(Ge){return Ge!==Ge};function m(){m.init.call(this)}Fv.exports=m,Fv.exports.once=tt,m.EventEmitter=m,m.prototype._events=void 0,m.prototype._eventsCount=0,m.prototype._maxListeners=void 0;var _=10;function c(Ke){if(typeof Ke!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof Ke)}Object.defineProperty(m,"defaultMaxListeners",{enumerable:!0,get:function(){return _},set:function(Ke){if(typeof Ke!="number"||Ke<0||d(Ke))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+Ke+".");_=Ke}}),m.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},m.prototype.setMaxListeners=function(Ge){if(typeof Ge!="number"||Ge<0||d(Ge))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+Ge+".");return this._maxListeners=Ge,this};function C(Ke){return Ke._maxListeners===void 0?m.defaultMaxListeners:Ke._maxListeners}m.prototype.getMaxListeners=function(){return C(this)},m.prototype.emit=function(Ge){for(var Fe=[],de=1;de<arguments.length;de++)Fe.push(arguments[de]);var ce=Ge==="error",ge=this._events;if(ge!==void 0)ce=ce&&ge.error===void 0;else if(!ce)return!1;if(ce){var Ae;if(Fe.length>0&&(Ae=Fe[0]),Ae instanceof Error)throw Ae;var Re=new Error("Unhandled error."+(Ae?" ("+Ae.message+")":""));throw Re.context=Ae,Re}var je=ge[Ge];if(je===void 0)return!1;if(typeof je=="function")e(je,this,Fe);else for(var Pe=je.length,Mn=xe(je,Pe),de=0;de<Pe;++de)e(Mn[de],this,Fe);return!0};function k(Ke,Ge,Fe,de){var ce,ge,Ae;if(c(Fe),ge=Ke._events,ge===void 0?(ge=Ke._events=Object.create(null),Ke._eventsCount=0):(ge.newListener!==void 0&&(Ke.emit("newListener",Ge,Fe.listener?Fe.listener:Fe),ge=Ke._events),Ae=ge[Ge]),Ae===void 0)Ae=ge[Ge]=Fe,++Ke._eventsCount;else if(typeof Ae=="function"?Ae=ge[Ge]=de?[Fe,Ae]:[Ae,Fe]:de?Ae.unshift(Fe):Ae.push(Fe),ce=C(Ke),ce>0&&Ae.length>ce&&!Ae.warned){Ae.warned=!0;var Re=new Error("Possible EventEmitter memory leak detected. "+Ae.length+" "+String(Ge)+" listeners added. Use emitter.setMaxListeners() to increase limit");Re.name="MaxListenersExceededWarning",Re.emitter=Ke,Re.type=Ge,Re.count=Ae.length,a(Re)}return Ke}m.prototype.addListener=function(Ge,Fe){return k(this,Ge,Fe,!1)},m.prototype.on=m.prototype.addListener,m.prototype.prependListener=function(Ge,Fe){return k(this,Ge,Fe,!0)};function V(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function G(Ke,Ge,Fe){var de={fired:!1,wrapFn:void 0,target:Ke,type:Ge,listener:Fe},ce=V.bind(de);return ce.listener=Fe,de.wrapFn=ce,ce}m.prototype.once=function(Ge,Fe){return c(Fe),this.on(Ge,G(this,Ge,Fe)),this},m.prototype.prependOnceListener=function(Ge,Fe){return c(Fe),this.prependListener(Ge,G(this,Ge,Fe)),this},m.prototype.removeListener=function(Ge,Fe){var de,ce,ge,Ae,Re;if(c(Fe),ce=this._events,ce===void 0)return this;if(de=ce[Ge],de===void 0)return this;if(de===Fe||de.listener===Fe)--this._eventsCount===0?this._events=Object.create(null):(delete ce[Ge],ce.removeListener&&this.emit("removeListener",Ge,de.listener||Fe));else if(typeof de!="function"){for(ge=-1,Ae=de.length-1;Ae>=0;Ae--)if(de[Ae]===Fe||de[Ae].listener===Fe){Re=de[Ae].listener,ge=Ae;break}if(ge<0)return this;ge===0?de.shift():be(de,ge),de.length===1&&(ce[Ge]=de[0]),ce.removeListener!==void 0&&this.emit("removeListener",Ge,Re||Fe)}return this},m.prototype.off=m.prototype.removeListener,m.prototype.removeAllListeners=function(Ge){var Fe,de,ce;if(de=this._events,de===void 0)return this;if(de.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):de[Ge]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete de[Ge]),this;if(arguments.length===0){var ge=Object.keys(de),Ae;for(ce=0;ce<ge.length;++ce)Ae=ge[ce],Ae!=="removeListener"&&this.removeAllListeners(Ae);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(Fe=de[Ge],typeof Fe=="function")this.removeListener(Ge,Fe);else if(Fe!==void 0)for(ce=Fe.length-1;ce>=0;ce--)this.removeListener(Ge,Fe[ce]);return this};function ee(Ke,Ge,Fe){var de=Ke._events;if(de===void 0)return[];var ce=de[Ge];return ce===void 0?[]:typeof ce=="function"?Fe?[ce.listener||ce]:[ce]:Fe?Ne(ce):xe(ce,ce.length)}m.prototype.listeners=function(Ge){return ee(this,Ge,!0)},m.prototype.rawListeners=function(Ge){return ee(this,Ge,!1)},m.listenerCount=function(Ke,Ge){return typeof Ke.listenerCount=="function"?Ke.listenerCount(Ge):Y.call(Ke,Ge)},m.prototype.listenerCount=Y;function Y(Ke){var Ge=this._events;if(Ge!==void 0){var Fe=Ge[Ke];if(typeof Fe=="function")return 1;if(Fe!==void 0)return Fe.length}return 0}m.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function xe(Ke,Ge){for(var Fe=new Array(Ge),de=0;de<Ge;++de)Fe[de]=Ke[de];return Fe}function be(Ke,Ge){for(;Ge+1<Ke.length;Ge++)Ke[Ge]=Ke[Ge+1];Ke.pop()}function Ne(Ke){for(var Ge=new Array(Ke.length),Fe=0;Fe<Ge.length;++Fe)Ge[Fe]=Ke[Fe].listener||Ke[Fe];return Ge}function tt(Ke,Ge){return new Promise(function(Fe,de){function ce(Ae){Ke.removeListener(Ge,ge),de(Ae)}function ge(){typeof Ke.removeListener=="function"&&Ke.removeListener("error",ce),Fe([].slice.call(arguments))}Xe(Ke,Ge,ge,{once:!0}),Ge!=="error"&&Je(Ke,ce,{once:!0})})}function Je(Ke,Ge,Fe){typeof Ke.on=="function"&&Xe(Ke,"error",Ge,Fe)}function Xe(Ke,Ge,Fe,de){if(typeof Ke.on=="function")de.once?Ke.once(Ge,Fe):Ke.on(Ge,Fe);else if(typeof Ke.addEventListener=="function")Ke.addEventListener(Ge,function ce(ge){de.once&&Ke.removeEventListener(Ge,ce),Fe(ge)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof Ke)}return Fv.exports}var zN=DN();const ON=wy(zN),Ko=[];for(let i=0;i<256;++i)Ko.push((i+256).toString(16).slice(1));function NN(i,e=0){return(Ko[i[e+0]]+Ko[i[e+1]]+Ko[i[e+2]]+Ko[i[e+3]]+"-"+Ko[i[e+4]]+Ko[i[e+5]]+"-"+Ko[i[e+6]]+Ko[i[e+7]]+"-"+Ko[i[e+8]]+Ko[i[e+9]]+"-"+Ko[i[e+10]]+Ko[i[e+11]]+Ko[i[e+12]]+Ko[i[e+13]]+Ko[i[e+14]]+Ko[i[e+15]]).toLowerCase()}let hx;const BN=new Uint8Array(16);function FN(){if(!hx){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");hx=crypto.getRandomValues.bind(crypto)}return hx(BN)}const VN=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),dS={randomUUID:VN};function UN(i,e,t){var d;if(dS.randomUUID&&!i)return dS.randomUUID();i=i||{};const a=i.random??((d=i.rng)==null?void 0:d.call(i))??FN();if(a.length<16)throw new Error("Random bytes length must be >= 16");return a[6]=a[6]&15|64,a[8]=a[8]&63|128,NN(a)}const kI="3.7.8",jN=kI,Ig=typeof Buffer=="function",fS=typeof TextDecoder=="function"?new TextDecoder:void 0,pS=typeof TextEncoder=="function"?new TextEncoder:void 0,qN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",V_=Array.prototype.slice.call(qN),Vv=(i=>{let e={};return i.forEach((t,a)=>e[t]=a),e})(V_),$N=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Yo=String.fromCharCode.bind(String),mS=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):i=>new Uint8Array(Array.prototype.slice.call(i,0)),DI=i=>i.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),zI=i=>i.replace(/[^A-Za-z0-9\+\/]/g,""),OI=i=>{let e,t,a,d,m="";const _=i.length%3;for(let c=0;c<i.length;){if((t=i.charCodeAt(c++))>255||(a=i.charCodeAt(c++))>255||(d=i.charCodeAt(c++))>255)throw new TypeError("invalid character found");e=t<<16|a<<8|d,m+=V_[e>>18&63]+V_[e>>12&63]+V_[e>>6&63]+V_[e&63]}return _?m.slice(0,_-3)+"===".substring(_):m},Iw=typeof btoa=="function"?i=>btoa(i):Ig?i=>Buffer.from(i,"binary").toString("base64"):OI,r1=Ig?i=>Buffer.from(i).toString("base64"):i=>{let t=[];for(let a=0,d=i.length;a<d;a+=4096)t.push(Yo.apply(null,i.subarray(a,a+4096)));return Iw(t.join(""))},a0=(i,e=!1)=>e?DI(r1(i)):r1(i),GN=i=>{if(i.length<2){var e=i.charCodeAt(0);return e<128?i:e<2048?Yo(192|e>>>6)+Yo(128|e&63):Yo(224|e>>>12&15)+Yo(128|e>>>6&63)+Yo(128|e&63)}else{var e=65536+(i.charCodeAt(0)-55296)*1024+(i.charCodeAt(1)-56320);return Yo(240|e>>>18&7)+Yo(128|e>>>12&63)+Yo(128|e>>>6&63)+Yo(128|e&63)}},ZN=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,NI=i=>i.replace(ZN,GN),gS=Ig?i=>Buffer.from(i,"utf8").toString("base64"):pS?i=>r1(pS.encode(i)):i=>Iw(NI(i)),og=(i,e=!1)=>e?DI(gS(i)):gS(i),_S=i=>og(i,!0),HN=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,WN=i=>{switch(i.length){case 4:var e=(7&i.charCodeAt(0))<<18|(63&i.charCodeAt(1))<<12|(63&i.charCodeAt(2))<<6|63&i.charCodeAt(3),t=e-65536;return Yo((t>>>10)+55296)+Yo((t&1023)+56320);case 3:return Yo((15&i.charCodeAt(0))<<12|(63&i.charCodeAt(1))<<6|63&i.charCodeAt(2));default:return Yo((31&i.charCodeAt(0))<<6|63&i.charCodeAt(1))}},BI=i=>i.replace(HN,WN),FI=i=>{if(i=i.replace(/\s+/g,""),!$N.test(i))throw new TypeError("malformed base64.");i+="==".slice(2-(i.length&3));let e,t,a,d=[];for(let m=0;m<i.length;)e=Vv[i.charAt(m++)]<<18|Vv[i.charAt(m++)]<<12|(t=Vv[i.charAt(m++)])<<6|(a=Vv[i.charAt(m++)]),t===64?d.push(Yo(e>>16&255)):a===64?d.push(Yo(e>>16&255,e>>8&255)):d.push(Yo(e>>16&255,e>>8&255,e&255));return d.join("")},Mw=typeof atob=="function"?i=>atob(zI(i)):Ig?i=>Buffer.from(i,"base64").toString("binary"):FI,VI=Ig?i=>mS(Buffer.from(i,"base64")):i=>mS(Mw(i).split("").map(e=>e.charCodeAt(0))),UI=i=>VI(jI(i)),XN=Ig?i=>Buffer.from(i,"base64").toString("utf8"):fS?i=>fS.decode(VI(i)):i=>BI(Mw(i)),jI=i=>zI(i.replace(/[-_]/g,e=>e=="-"?"+":"/")),a1=i=>XN(jI(i)),KN=i=>{if(typeof i!="string")return!1;const e=i.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(e)||!/[^\s0-9a-zA-Z\-_]/.test(e)},qI=i=>({value:i,enumerable:!1,writable:!0,configurable:!0}),$I=function(){const i=(e,t)=>Object.defineProperty(String.prototype,e,qI(t));i("fromBase64",function(){return a1(this)}),i("toBase64",function(e){return og(this,e)}),i("toBase64URI",function(){return og(this,!0)}),i("toBase64URL",function(){return og(this,!0)}),i("toUint8Array",function(){return UI(this)})},GI=function(){const i=(e,t)=>Object.defineProperty(Uint8Array.prototype,e,qI(t));i("toBase64",function(e){return a0(this,e)}),i("toBase64URI",function(){return a0(this,!0)}),i("toBase64URL",function(){return a0(this,!0)})},YN=()=>{$I(),GI()},QN={version:kI,VERSION:jN,atob:Mw,atobPolyfill:FI,btoa:Iw,btoaPolyfill:OI,fromBase64:a1,toBase64:og,encode:og,encodeURI:_S,encodeURL:_S,utob:NI,btou:BI,decode:a1,isValid:KN,fromUint8Array:a0,toUint8Array:UI,extendString:$I,extendUint8Array:GI,extendBuiltins:YN};var JN=Object.defineProperty,ZI=i=>{throw TypeError(i)},e6=(i,e,t)=>e in i?JN(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,rn=(i,e,t)=>e6(i,typeof e!="symbol"?e+"":e,t),Pw=(i,e,t)=>e.has(i)||ZI("Cannot "+t),An=(i,e,t)=>(Pw(i,e,"read from private field"),t?t.call(i):e.get(i)),lu=(i,e,t)=>e.has(i)?ZI("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),zu=(i,e,t,a)=>(Pw(i,e,"write to private field"),e.set(i,t),t),ku=(i,e,t)=>(Pw(i,e,"access private method"),t);const er={VISITOR:{code:null,flag:"visitor",name:"Visitor",latin:!0,isMode:!0,geocoding:!1},VISITOR_ENGLISH:{code:null,flag:"visitor_en",name:"Visitor English",latin:!0,isMode:!0,geocoding:!1},STYLE:{code:null,flag:"style",name:"Style",latin:!1,isMode:!0,geocoding:!1},STYLE_LOCK:{code:null,flag:"style_lock",name:"Style Lock",latin:!1,isMode:!0,geocoding:!1},...Oy};function yS(){if(typeof navigator>"u"){const i=Intl.DateTimeFormat().resolvedOptions().locale.split("-")[0];return n1(i)||er.ENGLISH}return Array.from(new Set(navigator.languages.map(i=>i.split("-")[0]))).map(i=>n1(i)).filter(i=>i)[0]??er.LOCAL}const Ul={maptilerLogoURL:"https://api.maptiler.com/resources/logo.svg",maptilerURL:"https://www.maptiler.com/",maptilerApiHost:"api.maptiler.com",telemetryURL:"https://api.maptiler.com/metrics",rtlPluginURL:"https://cdn.maptiler.com/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.min.js",primaryLanguage:er.STYLE,secondaryLanguage:er.LOCAL,terrainSourceURL:"https://api.maptiler.com/tiles/terrain-rgb-v2/tiles.json",terrainSourceId:"maptiler-terrain"};Object.freeze(Ul);const Rw=UN();class t6 extends ON{constructor(){super(...arguments),rn(this,"primaryLanguage",Ul.primaryLanguage),rn(this,"secondaryLanguage"),rn(this,"session",!0),rn(this,"caching",!0),rn(this,"telemetry",!0),rn(this,"_unit","metric"),rn(this,"_apiKey","")}set unit(e){this._unit=e,this.emit("unit",e)}get unit(){return this._unit}set apiKey(e){this._apiKey=e,sg.apiKey=e,this.emit("apiKey",e)}get apiKey(){return this._apiKey}set fetch(e){sg.fetch=e}get fetch(){return sg.fetch}}const Ka=new t6,s1="localcache_source",o1="localcache",n6="maptiler_sdk",i6=1e3,r6=100,l1=typeof caches<"u",{addProtocol:vS}=wn;function a6(i,e){if(l1&&Ka.caching&&Ka.session&&i.host===Ul.maptilerApiHost){if(e==="Source"&&i.href.includes("tiles.json"))return i.href.replace("https://",`${s1}://`);if(e==="Tile"||e==="Glyphs")return i.href.replace("https://",`${o1}://`)}return i.href}let dx;async function HI(){return dx||(dx=await caches.open(n6)),dx}let bS=0;async function s6(){const i=await HI(),e=await i.keys(),t=e.slice(0,Math.max(e.length-i6,0));for(const a of t)i.delete(a)}function o6(){vS(s1,async(i,e)=>{if(!i.url)throw new Error("");i.url=i.url.replace(`${s1}://`,"https://");const t=i;t.signal=e.signal;const a=await fetch(i.url,t),d=await a.json();return d.tiles&&d.tiles.length>0&&(d.tiles[0]+=`&last-modified=${a.headers.get("Last-Modified")}`),{data:d,cacheControl:a.headers.get("Cache-Control"),expires:a.headers.get("Expires")}}),vS(o1,async(i,e)=>{if(!i.url)throw new Error("");i.url=i.url.replace(`${o1}://`,"https://");const t=new URL(i.url),a=new URL(t);a.searchParams.delete("mtsid"),a.searchParams.delete("key");const d=a.toString(),m=new URL(t);m.searchParams.delete("last-modified");const _=m.toString(),c=async ee=>({data:await ee.arrayBuffer(),cacheControl:ee.headers.get("Cache-Control"),expires:ee.headers.get("Expires")}),C=await HI(),k=await C.match(d);if(k)return c(k);const V=i;V.signal=e.signal;const G=await fetch(_,V);return G.status>=200&&G.status<300&&(C.put(d,G.clone()).catch(()=>{}),++bS>r6&&(s6(),bS=0)),c(G)})}function l6(){if(typeof window>"u")return;const i=wn.getRTLTextPluginStatus();if(i==="unavailable"||i==="requested")try{wn.setRTLTextPlugin(Ul.rtlPluginURL,!0)}catch{}}function u6(i,e){for(const t of i)typeof e[t]=="function"&&(e[t]=e[t].bind(e))}function xS(i,e){let t=null;try{t=new URL(i)}catch{return{url:i}}return t.host===Ul.maptilerApiHost&&(t.searchParams.has("key")||t.searchParams.append("key",Ka.apiKey),Ka.session&&t.searchParams.append("mtsid",Rw)),{url:a6(t,e)}}function wS(i){return(e,t)=>{if(i!=null){const a=i(e,t),d=xS((a==null?void 0:a.url)??"",t);return{...a,...d}}return xS(e,t)}}function WI(){return Math.random().toString(36).substring(2)}function hb(i){return/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(i)}function c6(i){try{return JSON.parse(i)}catch{}return null}function h6(){return document.createElement("canvas").getContext("webgl2")?null:typeof WebGL2RenderingContext<"u"?"Graphic rendering with WebGL2 has been disabled or is not supported by your graphic card. The map cannot be displayed.":"Your browser does not support graphic rendering with WebGL2. The map cannot be displayed."}function d6(i){const e=h6();if(!e)return;let t=null;if(typeof i=="string"?t=document.getElementById(i):i instanceof HTMLElement&&(t=i),!t)throw new Error("The Map container must be provided.");const a=document.createElement("div");throw a.innerHTML=e,a.classList.add("webgl-warning-div"),t.appendChild(a),new Error(e)}function TS(i,e){return!(!Array.isArray(i)||i.length!==2||i[0]!=="get"||typeof i[1]!="string"||e&&!i[1].startsWith("name:")||!e&&i[1]!=="name")}function f6(i,e,t){const a=structuredClone(i),d=m=>{if(typeof m!="string")for(let _=0;_<m.length;_+=1)TS(m[_],t)?m[_]=structuredClone(e):d(m[_])};return TS(a,t)?e:(d(a),a)}function p6(i,e){const t=e?/\{name:\S+\}/:/\{name\}/;return{contains:t.test(i),exactMatch:new RegExp(`^${t.source}$`).test(i)}}function m6(i,e,t){const a=t?/\{name:\S+\}/:/\{name\}/,d=i.split(a);return["concat",...d.flatMap((m,_)=>_===d.length-1?[m]:[m,e])]}function g6(i){var e;const t=/\{name(?::(?<language>\S+))?\}/g,a=[];for(;;){const d=t.exec(i);if(!d)break;const m=((e=d.groups)==null?void 0:e.language)??null;a.push(m)}return a}function _6(i){return!Array.isArray(i)||i.length!==2||i[0]!=="get"||typeof i[1]!="string"?null:i[1].trim()==="name"?{isLanguage:!0,localization:null}:i[1].trim().startsWith("name:")?{isLanguage:!0,localization:i[1].trim().split(":").pop()}:null}function y6(i){const e=[],t=structuredClone(i),a=d=>{if(typeof d!="string")for(let m=0;m<d.length;m+=1){const _=_6(d[m]);_?e.push(_.localization):a(d[m])}};return a([t]),e}function v6(i,e){const t=[];for(const m of i){if(m.type!=="symbol")continue;const _=m,{id:c,layout:C}=_;if(!C||!("text-field"in C))continue;const k=e.getLayoutProperty(c,"text-field");if(k)if(typeof k=="string"){const V=g6(k);t.push(V)}else{const V=y6(k);t.push(V)}}const a=t.flat(),d={unlocalized:0,localized:{}};for(const m of a)m===null?d.unlocalized+=1:(m in d.localized||(d.localized[m]=0),d.localized[m]+=1);return d}(class extends wn.Marker{addTo(i){return super.addTo(i)}});class nU extends wn.Popup{addTo(e){return super.addTo(e)}}class iU extends wn.Style{constructor(e,t={}){super(e,t)}}class rU extends wn.CanvasSource{onAdd(e){super.onAdd(e)}}class aU extends wn.GeoJSONSource{onAdd(e){super.onAdd(e)}}class sU extends wn.ImageSource{onAdd(e){super.onAdd(e)}}class oU extends wn.RasterTileSource{onAdd(e){super.onAdd(e)}}class lU extends wn.RasterDEMTileSource{onAdd(e){super.onAdd(e)}}class uU extends wn.VectorTileSource{onAdd(e){super.onAdd(e)}}class cU extends wn.VideoSource{onAdd(e){super.onAdd(e)}}class b6 extends wn.NavigationControl{onAdd(e){return super.onAdd(e)}}class x6 extends wn.GeolocateControl{onAdd(e){return super.onAdd(e)}}class hU extends wn.AttributionControl{onAdd(e){return super.onAdd(e)}}class w6 extends wn.LogoControl{onAdd(e){return super.onAdd(e)}}class T6 extends wn.ScaleControl{onAdd(e){return super.onAdd(e)}}class S6 extends wn.FullscreenControl{onAdd(e){return super.onAdd(e)}}class dU extends wn.TerrainControl{onAdd(e){return super.onAdd(e)}}class fU extends wn.BoxZoomHandler{constructor(e,t){super(e,t)}}class pU extends wn.ScrollZoomHandler{constructor(e,t){super(e,t)}}class mU extends wn.CooperativeGesturesHandler{constructor(e,t){super(e,t)}}class gU extends wn.KeyboardHandler{constructor(e){super(e)}}class _U extends wn.TwoFingersTouchPitchHandler{constructor(e){super(e)}}class yU extends wn.MapWheelEvent{constructor(e,t,a){super(e,t,a)}}class vU extends wn.MapTouchEvent{constructor(e,t,a){super(e,t,a)}}class bU extends wn.MapMouseEvent{constructor(e,t,a,d={}){super(e,t,a,d)}}class SS extends w6{constructor(e={}){super(e),rn(this,"logoURL",""),rn(this,"linkURL",""),this.logoURL=e.logoURL??Ul.maptilerLogoURL,this.linkURL=e.linkURL??Ul.maptilerURL}onAdd(e){this._map=e,this._compact=this.options.compact??!1,this._container=window.document.createElement("div"),this._container.className="maplibregl-ctrl";const t=window.document.createElement("a");return t.style.backgroundRepeat="no-repeat",t.style.cursor="pointer",t.style.display="block",t.style.height="23px",t.style.margin="0 0 -4px -4px",t.style.overflow="hidden",t.style.width="88px",t.style.backgroundImage=`url(${this.logoURL})`,t.style.backgroundSize="100px 30px",t.style.width="100px",t.style.height="30px",t.target="_blank",t.rel="noopener",t.href=this.linkURL,t.setAttribute("aria-label","MapTiler logo"),t.setAttribute("rel","noopener"),this._container.appendChild(t),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}}var E6=8,A6={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},C6={"*":{type:"source"}},I6=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],M6={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},P6={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},R6={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},L6={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},k6={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},D6={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},z6={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},O6=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],N6={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},B6={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},F6={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},V6={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},U6={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},j6={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},q6={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},$6={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},G6={type:"array",value:"*"},Z6={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},H6={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},W6={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},X6={type:"array",value:"*",minimum:1},K6={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},Y6={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},Q6={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},J6={type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},eB=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],tB={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},nB={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},iB={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},rB={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},aB={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},sB={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},oB={"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},lB={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},uB={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},cB={"*":{type:"string"}},hB={$version:E6,$root:A6,sources:C6,source:I6,source_vector:M6,source_raster:P6,source_raster_dem:R6,source_geojson:L6,source_video:k6,source_image:D6,layer:z6,layout:O6,layout_background:N6,layout_fill:B6,layout_circle:F6,layout_heatmap:V6,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:U6,layout_symbol:j6,layout_raster:q6,layout_hillshade:$6,"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:G6,filter_operator:Z6,geometry_type:H6,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:W6,expression:X6,light:K6,sky:Y6,terrain:Q6,projection:J6,paint:eB,paint_fill:tB,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:nB,paint_circle:iB,paint_heatmap:rB,paint_symbol:aB,paint_raster:sB,paint_hillshade:oB,"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:lB,transition:uB,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:cB};class Ht{constructor(e,t,a,d){this.message=(e?`${e}: `:"")+a,d&&(this.identifier=d),t!=null&&t.__line__&&(this.line=t.__line__)}}function z0(i,...e){for(const t of e)for(const a in t)i[a]=t[a];return i}class Bh extends Error{constructor(e,t){super(t),this.message=t,this.key=e}}class Lw{constructor(e,t=[]){this.parent=e,this.bindings={};for(const[a,d]of t)this.bindings[a]=d}concat(e){return new Lw(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return this.bindings[e]?!0:this.parent?this.parent.has(e):!1}}const db={kind:"null"},Qt={kind:"number"},vi={kind:"string"},di={kind:"boolean"},Gh={kind:"color"},fb={kind:"projectionDefinition"},Np={kind:"object"},ci={kind:"value"},dB={kind:"error"},pb={kind:"collator"},mb={kind:"formatted"},gb={kind:"padding"},dy={kind:"colorArray"},_b={kind:"numberArray"},Ny={kind:"resolvedImage"},yb={kind:"variableAnchorOffsetCollection"};function Ou(i,e){return{kind:"array",itemType:i,N:e}}function wa(i){if(i.kind==="array"){const e=wa(i.itemType);return typeof i.N=="number"?`array<${e}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${e}>`}else return i.kind}const fB=[db,Qt,vi,di,Gh,fb,mb,Np,Ou(ci),gb,_b,dy,Ny,yb];function fy(i,e){if(e.kind==="error")return null;if(i.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!fy(i.itemType,e.itemType))&&(typeof i.N!="number"||i.N===e.N))return null}else{if(i.kind===e.kind)return null;if(i.kind==="value"){for(const t of fB)if(!fy(t,e))return null}}return`Expected ${wa(i)} but found ${wa(e)} instead.`}function kw(i,e){return e.some(t=>t.kind===i.kind)}function Bp(i,e){return e.some(t=>t==="null"?i===null:t==="array"?Array.isArray(i):t==="object"?i&&!Array.isArray(i)&&typeof i=="object":t===typeof i)}function Tf(i,e){return i.kind==="array"&&e.kind==="array"?i.itemType.kind===e.itemType.kind&&typeof i.N=="number":i.kind===e.kind}const XI=.96422,KI=1,YI=.82521,QI=4/29,lg=6/29,JI=3*lg*lg,pB=lg*lg*lg,mB=Math.PI/180,gB=180/Math.PI;function eM(i){return i=i%360,i<0&&(i+=360),i}function tM([i,e,t,a]){i=fx(i),e=fx(e),t=fx(t);let d,m;const _=px((.2225045*i+.7168786*e+.0606169*t)/KI);i===e&&e===t?d=m=_:(d=px((.4360747*i+.3850649*e+.1430804*t)/XI),m=px((.0139322*i+.0971045*e+.7141733*t)/YI));const c=116*_-16;return[c<0?0:c,500*(d-_),200*(_-m),a]}function fx(i){return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function px(i){return i>pB?Math.pow(i,1/3):i/JI+QI}function nM([i,e,t,a]){let d=(i+16)/116,m=isNaN(e)?d:d+e/500,_=isNaN(t)?d:d-t/200;return d=KI*gx(d),m=XI*gx(m),_=YI*gx(_),[mx(3.1338561*m-1.6168667*d-.4906146*_),mx(-.9787684*m+1.9161415*d+.033454*_),mx(.0719453*m-.2289914*d+1.4052427*_),a]}function mx(i){return i=i<=.00304?12.92*i:1.055*Math.pow(i,1/2.4)-.055,i<0?0:i>1?1:i}function gx(i){return i>lg?i*i*i:JI*(i-QI)}function _B(i){const[e,t,a,d]=tM(i),m=Math.sqrt(t*t+a*a);return[Math.round(m*1e4)?eM(Math.atan2(a,t)*gB):NaN,m,e,d]}function yB([i,e,t,a]){return i=isNaN(i)?0:i*mB,nM([t,Math.cos(i)*e,Math.sin(i)*e,a])}function vB([i,e,t,a]){i=eM(i),e/=100,t/=100;function d(m){const _=(m+i/30)%12,c=e*Math.min(t,1-t);return t-c*Math.max(-1,Math.min(_-3,9-_,1))}return[d(0),d(8),d(4),a]}const bB=Object.hasOwn||function(i,e){return Object.prototype.hasOwnProperty.call(i,e)};function J_(i,e){return bB(i,e)?i[e]:void 0}function xB(i){if(i=i.toLowerCase().trim(),i==="transparent")return[0,0,0,0];const e=J_(wB,i);if(e){const[d,m,_]=e;return[d/255,m/255,_/255,1]}if(i.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(i)){const d=i.length<6?1:2;let m=1;return[Uv(i.slice(m,m+=d)),Uv(i.slice(m,m+=d)),Uv(i.slice(m,m+=d)),Uv(i.slice(m,m+d)||"ff")]}if(i.startsWith("rgb")){const d=/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,m=i.match(d);if(m){const[_,c,C,k,V,G,ee,Y,xe,be,Ne,tt]=m,Je=[k||" ",ee||" ",be].join("");if(Je==="  "||Je==="  /"||Je===",,"||Je===",,,"){const Xe=[C,G,xe].join(""),Ke=Xe==="%%%"?100:Xe===""?255:0;if(Ke){const Ge=[Km(+c/Ke,0,1),Km(+V/Ke,0,1),Km(+Y/Ke,0,1),Ne?ES(+Ne,tt):1];if(AS(Ge))return Ge}}return}}const t=/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,a=i.match(t);if(a){const[d,m,_,c,C,k,V,G,ee]=a,Y=[_||" ",C||" ",V].join("");if(Y==="  "||Y==="  /"||Y===",,"||Y===",,,"){const xe=[+m,Km(+c,0,100),Km(+k,0,100),G?ES(+G,ee):1];if(AS(xe))return vB(xe)}}}function Uv(i){return parseInt(i.padEnd(2,i),16)/255}function ES(i,e){return Km(e?i/100:i,0,1)}function Km(i,e,t){return Math.min(Math.max(e,i),t)}function AS(i){return!i.some(Number.isNaN)}const wB={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Fp(i,e,t){return i+t*(e-i)}function py(i,e,t){return i.map((a,d)=>Fp(a,e[d],t))}class Ar{constructor(e,t,a,d=1,m=!0){this.r=e,this.g=t,this.b=a,this.a=d,m||(this.r*=d,this.g*=d,this.b*=d,d||this.overwriteGetter("rgb",[e,t,a,d]))}static parse(e){if(e instanceof Ar)return e;if(typeof e!="string")return;const t=xB(e);if(t)return new Ar(...t,!1)}get rgb(){const{r:e,g:t,b:a,a:d}=this,m=d||1/0;return this.overwriteGetter("rgb",[e/m,t/m,a/m,d])}get hcl(){return this.overwriteGetter("hcl",_B(this.rgb))}get lab(){return this.overwriteGetter("lab",tM(this.rgb))}overwriteGetter(e,t){return Object.defineProperty(this,e,{value:t}),t}toString(){const[e,t,a,d]=this.rgb;return`rgba(${[e,t,a].map(m=>Math.round(m*255)).join(",")},${d})`}static interpolate(e,t,a,d="rgb"){switch(d){case"rgb":{const[m,_,c,C]=py(e.rgb,t.rgb,a);return new Ar(m,_,c,C,!1)}case"hcl":{const[m,_,c,C]=e.hcl,[k,V,G,ee]=t.hcl;let Y,xe;if(!isNaN(m)&&!isNaN(k)){let Xe=k-m;k>m&&Xe>180?Xe-=360:k<m&&m-k>180&&(Xe+=360),Y=m+a*Xe}else isNaN(m)?isNaN(k)?Y=NaN:(Y=k,(c===1||c===0)&&(xe=V)):(Y=m,(G===1||G===0)&&(xe=_));const[be,Ne,tt,Je]=yB([Y,xe??Fp(_,V,a),Fp(c,G,a),Fp(C,ee,a)]);return new Ar(be,Ne,tt,Je,!1)}case"lab":{const[m,_,c,C]=nM(py(e.lab,t.lab,a));return new Ar(m,_,c,C,!1)}}}}Ar.black=new Ar(0,0,0,1);Ar.white=new Ar(1,1,1,1);Ar.transparent=new Ar(0,0,0,0);Ar.red=new Ar(1,0,0,1);class Dw{constructor(e,t,a){e?this.sensitivity=t?"variant":"case":this.sensitivity=t?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const TB=["bottom","center","top"];class u1{constructor(e,t,a,d,m,_){this.text=e,this.image=t,this.scale=a,this.fontStack=d,this.textColor=m,this.verticalAlign=_}}class Nd{constructor(e){this.sections=e}static fromString(e){return new Nd([new u1(e,null,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Nd?e:Nd.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}}class ih{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof ih)return e;if(typeof e=="number")return new ih([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const t of e)if(typeof t!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]];break}return new ih(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,a){return new ih(py(e.values,t.values,a))}}class rh{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof rh)return e;if(typeof e=="number")return new rh([e]);if(Array.isArray(e)){for(const t of e)if(typeof t!="number")return;return new rh(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,a){return new rh(py(e.values,t.values,a))}}class Nu{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Nu)return e;if(typeof e=="string"){const a=Ar.parse(e);return a?new Nu([a]):void 0}if(!Array.isArray(e))return;const t=[];for(const a of e){if(typeof a!="string")return;const d=Ar.parse(a);if(!d)return;t.push(d)}return new Nu(t)}toString(){return JSON.stringify(this.values)}static interpolate(e,t,a,d="rgb"){const m=[];if(e.values.length!=t.values.length)throw new Error(`colorArray: Arrays have mismatched length (${e.values.length} vs. ${t.values.length}), cannot interpolate.`);for(let _=0;_<e.values.length;_++)m.push(Ar.interpolate(e.values[_],t.values[_],a,d));return new Nu(m)}}class Na extends Error{constructor(e){super(e),this.name="RuntimeError"}toJSON(){return this.message}}const SB=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Zh{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Zh)return e;if(!(!Array.isArray(e)||e.length<1||e.length%2!==0)){for(let t=0;t<e.length;t+=2){const a=e[t],d=e[t+1];if(typeof a!="string"||!SB.has(a)||!Array.isArray(d)||d.length!==2||typeof d[0]!="number"||typeof d[1]!="number")return}return new Zh(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,a){const d=e.values,m=t.values;if(d.length!==m.length)throw new Na(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${t.toString()}`);const _=[];for(let c=0;c<d.length;c+=2){if(d[c]!==m[c])throw new Na(`Cannot interpolate values containing mismatched anchors. from[${c}]: ${d[c]}, to[${c}]: ${m[c]}`);_.push(d[c]);const[C,k]=d[c+1],[V,G]=m[c+1];_.push([Fp(C,V,a),Fp(k,G,a)])}return new Zh(_)}}class $f{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new $f({name:e,available:!1}):null}}class Jc{constructor(e,t,a){this.from=e,this.to=t,this.transition=a}static interpolate(e,t,a){return new Jc(e,t,a)}static parse(e){if(e instanceof Jc)return e;if(Array.isArray(e)&&e.length===3&&typeof e[0]=="string"&&typeof e[1]=="string"&&typeof e[2]=="number")return new Jc(e[0],e[1],e[2]);if(typeof e=="object"&&typeof e.from=="string"&&typeof e.to=="string"&&typeof e.transition=="number")return new Jc(e.from,e.to,e.transition);if(typeof e=="string")return new Jc(e,e,1)}}function iM(i,e,t,a){return typeof i=="number"&&i>=0&&i<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255?typeof a>"u"||typeof a=="number"&&a>=0&&a<=1?null:`Invalid rgba value [${[i,e,t,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof a=="number"?[i,e,t,a]:[i,e,t]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function my(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof Jc||i instanceof Ar||i instanceof Dw||i instanceof Nd||i instanceof ih||i instanceof rh||i instanceof Nu||i instanceof Zh||i instanceof $f)return!0;if(Array.isArray(i)){for(const e of i)if(!my(e))return!1;return!0}else if(typeof i=="object"){for(const e in i)if(!my(i[e]))return!1;return!0}else return!1}function Os(i){if(i===null)return db;if(typeof i=="string")return vi;if(typeof i=="boolean")return di;if(typeof i=="number")return Qt;if(i instanceof Ar)return Gh;if(i instanceof Jc)return fb;if(i instanceof Dw)return pb;if(i instanceof Nd)return mb;if(i instanceof ih)return gb;if(i instanceof rh)return _b;if(i instanceof Nu)return dy;if(i instanceof Zh)return yb;if(i instanceof $f)return Ny;if(Array.isArray(i)){const e=i.length;let t;for(const a of i){const d=Os(a);if(!t)t=d;else{if(t===d)continue;t=ci;break}}return Ou(t||ci,e)}else return Np}function ey(i){const e=typeof i;return i===null?"":e==="string"||e==="number"||e==="boolean"?String(i):i instanceof Ar||i instanceof Jc||i instanceof Nd||i instanceof ih||i instanceof rh||i instanceof Nu||i instanceof Zh||i instanceof $f?i.toString():JSON.stringify(i)}class gg{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(e.length!==2)return t.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!my(e[1]))return t.error("invalid value");const a=e[1];let d=Os(a);const m=t.expectedType;return d.kind==="array"&&d.N===0&&m&&m.kind==="array"&&(typeof m.N!="number"||m.N===0)&&(d=m),new gg(d,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const jv={string:vi,number:Qt,boolean:di,object:Np};class eh{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let a=1,d;const m=e[0];if(m==="array"){let c;if(e.length>2){const k=e[1];if(typeof k!="string"||!(k in jv)||k==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);c=jv[k],a++}else c=ci;let C;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);C=e[2],a++}d=Ou(c,C)}else{if(!jv[m])throw new Error(`Types doesn't contain name = ${m}`);d=jv[m]}const _=[];for(;a<e.length;a++){const c=t.parse(e[a],a,ci);if(!c)return null;_.push(c)}return new eh(d,_)}evaluate(e){for(let t=0;t<this.args.length;t++){const a=this.args[t].evaluate(e);if(fy(this.type,Os(a))){if(t===this.args.length-1)throw new Na(`Expected value to be of type ${wa(this.type)}, but found ${wa(Os(a))} instead.`)}else return a}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const CS={"to-boolean":di,"to-color":Gh,"to-number":Qt,"to-string":vi};class Mf{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const a=e[0];if(!CS[a])throw new Error(`Can't parse ${a} as it is not part of the known types`);if((a==="to-boolean"||a==="to-string")&&e.length!==2)return t.error("Expected one argument.");const d=CS[a],m=[];for(let _=1;_<e.length;_++){const c=t.parse(e[_],_,ci);if(!c)return null;m.push(c)}return new Mf(d,m)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let t,a;for(const d of this.args){if(t=d.evaluate(e),a=null,t instanceof Ar)return t;if(typeof t=="string"){const m=e.parseColor(t);if(m)return m}else if(Array.isArray(t)&&(t.length<3||t.length>4?a=`Invalid rgba value ${JSON.stringify(t)}: expected an array containing either three or four numeric values.`:a=iM(t[0],t[1],t[2],t[3]),!a))return new Ar(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Na(a||`Could not parse color from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"padding":{let t;for(const a of this.args){t=a.evaluate(e);const d=ih.parse(t);if(d)return d}throw new Na(`Could not parse padding from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"numberArray":{let t;for(const a of this.args){t=a.evaluate(e);const d=rh.parse(t);if(d)return d}throw new Na(`Could not parse numberArray from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"colorArray":{let t;for(const a of this.args){t=a.evaluate(e);const d=Nu.parse(t);if(d)return d}throw new Na(`Could not parse colorArray from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"variableAnchorOffsetCollection":{let t;for(const a of this.args){t=a.evaluate(e);const d=Zh.parse(t);if(d)return d}throw new Na(`Could not parse variableAnchorOffsetCollection from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"number":{let t=null;for(const a of this.args){if(t=a.evaluate(e),t===null)return 0;const d=Number(t);if(!isNaN(d))return d}throw new Na(`Could not convert ${JSON.stringify(t)} to number.`)}case"formatted":return Nd.fromString(ey(this.args[0].evaluate(e)));case"resolvedImage":return $f.fromString(ey(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return ey(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const EB=["Unknown","Point","LineString","Polygon"];class rM{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?EB[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let t=this._parseColorCache.get(e);return t||(t=Ar.parse(e),this._parseColorCache.set(e,t)),t}}class vb{constructor(e,t,a=[],d,m=new Lw,_=[]){this.registry=e,this.path=a,this.key=a.map(c=>`[${c}]`).join(""),this.scope=m,this.errors=_,this.expectedType=d,this._isConstant=t}parse(e,t,a,d,m={}){return t?this.concat(t,a,d)._parse(e,m):this._parse(e,m)}_parse(e,t){(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number")&&(e=["literal",e]);function a(d,m,_){return _==="assert"?new eh(m,[d]):_==="coerce"?new Mf(m,[d]):d}if(Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=e[0];if(typeof d!="string")return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[d];if(m){let _=m.parse(e,this);if(!_)return null;if(this.expectedType){const c=this.expectedType,C=_.type;if((c.kind==="string"||c.kind==="number"||c.kind==="boolean"||c.kind==="object"||c.kind==="array")&&C.kind==="value")_=a(_,c,t.typeAnnotation||"assert");else if(c.kind==="projectionDefinition"&&["string","array"].includes(C.kind)||["color","formatted","resolvedImage"].includes(c.kind)&&["value","string"].includes(C.kind)||["padding","numberArray"].includes(c.kind)&&["value","number","array"].includes(C.kind)||c.kind==="colorArray"&&["value","string","array"].includes(C.kind)||c.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(C.kind))_=a(_,c,t.typeAnnotation||"coerce");else if(this.checkSubtype(c,C))return null}if(!(_ instanceof gg)&&_.type.kind!=="resolvedImage"&&this._isConstant(_)){const c=new rM;try{_=new gg(_.type,_.evaluate(c))}catch(C){return this.error(C.message),null}}return _}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}else return typeof e>"u"?this.error("'undefined' value invalid. Use null instead."):typeof e=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof e} instead.`)}concat(e,t,a){const d=typeof e=="number"?this.path.concat(e):this.path,m=a?this.scope.concat(a):this.scope;return new vb(this.registry,this._isConstant,d,t||null,m,this.errors)}error(e,...t){const a=`${this.key}${t.map(d=>`[${d}]`).join("")}`;this.errors.push(new Bh(a,e))}checkSubtype(e,t){const a=fy(e,t);return a&&this.error(a),a}}class bb{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const a=[];for(let m=1;m<e.length-1;m+=2){const _=e[m];if(typeof _!="string")return t.error(`Expected string, but found ${typeof _} instead.`,m);if(/[^a-zA-Z0-9_]/.test(_))return t.error("Variable names must contain only alphanumeric characters or '_'.",m);const c=t.parse(e[m+1],m+1);if(!c)return null;a.push([_,c])}const d=t.parse(e[e.length-1],e.length-1,t.expectedType,a);return d?new bb(a,d):null}outputDefined(){return this.result.outputDefined()}}class xb{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");const a=e[1];return t.scope.has(a)?new xb(a,t.scope.get(a)):t.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class zw{constructor(e,t,a){this.type=e,this.index=t,this.input=a}static parse(e,t){if(e.length!==3)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=t.parse(e[1],1,Qt),d=t.parse(e[2],2,Ou(t.expectedType||ci));if(!a||!d)return null;const m=d.type;return new zw(m.itemType,a,d)}evaluate(e){const t=this.index.evaluate(e),a=this.input.evaluate(e);if(t<0)throw new Na(`Array index out of bounds: ${t} < 0.`);if(t>=a.length)throw new Na(`Array index out of bounds: ${t} > ${a.length-1}.`);if(t!==Math.floor(t))throw new Na(`Array index must be an integer, but found ${t} instead.`);return a[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class Ow{constructor(e,t){this.type=di,this.needle=e,this.haystack=t}static parse(e,t){if(e.length!==3)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=t.parse(e[1],1,ci),d=t.parse(e[2],2,ci);return!a||!d?null:kw(a.type,[di,vi,Qt,db,ci])?new Ow(a,d):t.error(`Expected first argument to be of type boolean, string, number or null, but found ${wa(a.type)} instead`)}evaluate(e){const t=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!a)return!1;if(!Bp(t,["boolean","string","number","null"]))throw new Na(`Expected first argument to be of type boolean, string, number or null, but found ${wa(Os(t))} instead.`);if(!Bp(a,["string","array"]))throw new Na(`Expected second argument to be of type array or string, but found ${wa(Os(a))} instead.`);return a.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class O0{constructor(e,t,a){this.type=Qt,this.needle=e,this.haystack=t,this.fromIndex=a}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=t.parse(e[1],1,ci),d=t.parse(e[2],2,ci);if(!a||!d)return null;if(!kw(a.type,[di,vi,Qt,db,ci]))return t.error(`Expected first argument to be of type boolean, string, number or null, but found ${wa(a.type)} instead`);if(e.length===4){const m=t.parse(e[3],3,Qt);return m?new O0(a,d,m):null}else return new O0(a,d)}evaluate(e){const t=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!Bp(t,["boolean","string","number","null"]))throw new Na(`Expected first argument to be of type boolean, string, number or null, but found ${wa(Os(t))} instead.`);let d;if(this.fromIndex&&(d=this.fromIndex.evaluate(e)),Bp(a,["string"])){const m=a.indexOf(t,d);return m===-1?-1:[...a.slice(0,m)].length}else{if(Bp(a,["array"]))return a.indexOf(t,d);throw new Na(`Expected second argument to be of type array or string, but found ${wa(Os(a))} instead.`)}}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class Nw{constructor(e,t,a,d,m,_){this.inputType=e,this.type=t,this.input=a,this.cases=d,this.outputs=m,this.otherwise=_}static parse(e,t){if(e.length<5)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!==1)return t.error("Expected an even number of arguments.");let a,d;t.expectedType&&t.expectedType.kind!=="value"&&(d=t.expectedType);const m={},_=[];for(let k=2;k<e.length-1;k+=2){let V=e[k];const G=e[k+1];Array.isArray(V)||(V=[V]);const ee=t.concat(k);if(V.length===0)return ee.error("Expected at least one branch label.");for(const xe of V){if(typeof xe!="number"&&typeof xe!="string")return ee.error("Branch labels must be numbers or strings.");if(typeof xe=="number"&&Math.abs(xe)>Number.MAX_SAFE_INTEGER)return ee.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof xe=="number"&&Math.floor(xe)!==xe)return ee.error("Numeric branch labels must be integer values.");if(!a)a=Os(xe);else if(ee.checkSubtype(a,Os(xe)))return null;if(typeof m[String(xe)]<"u")return ee.error("Branch labels must be unique.");m[String(xe)]=_.length}const Y=t.parse(G,k,d);if(!Y)return null;d=d||Y.type,_.push(Y)}const c=t.parse(e[1],1,ci);if(!c)return null;const C=t.parse(e[e.length-1],e.length-1,d);return!C||c.type.kind!=="value"&&t.concat(1).checkSubtype(a,c.type)?null:new Nw(a,d,c,m,_,C)}evaluate(e){const t=this.input.evaluate(e);return(Os(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class Bw{constructor(e,t,a){this.type=e,this.branches=t,this.otherwise=a}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!==0)return t.error("Expected an odd number of arguments.");let a;t.expectedType&&t.expectedType.kind!=="value"&&(a=t.expectedType);const d=[];for(let _=1;_<e.length-1;_+=2){const c=t.parse(e[_],_,di);if(!c)return null;const C=t.parse(e[_+1],_+1,a);if(!C)return null;d.push([c,C]),a=a||C.type}const m=t.parse(e[e.length-1],e.length-1,a);if(!m)return null;if(!a)throw new Error("Can't infer output type");return new Bw(a,d,m)}evaluate(e){for(const[t,a]of this.branches)if(t.evaluate(e))return a.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[t,a]of this.branches)e(t),e(a);e(this.otherwise)}outputDefined(){return this.branches.every(([e,t])=>t.outputDefined())&&this.otherwise.outputDefined()}}class N0{constructor(e,t,a,d){this.type=e,this.input=t,this.beginIndex=a,this.endIndex=d}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=t.parse(e[1],1,ci),d=t.parse(e[2],2,Qt);if(!a||!d)return null;if(!kw(a.type,[Ou(ci),vi,ci]))return t.error(`Expected first argument to be of type array or string, but found ${wa(a.type)} instead`);if(e.length===4){const m=t.parse(e[3],3,Qt);return m?new N0(a.type,a,d,m):null}else return new N0(a.type,a,d)}evaluate(e){const t=this.input.evaluate(e),a=this.beginIndex.evaluate(e);let d;if(this.endIndex&&(d=this.endIndex.evaluate(e)),Bp(t,["string"]))return[...t].slice(a,d).join("");if(Bp(t,["array"]))return t.slice(a,d);throw new Na(`Expected first argument to be of type array or string, but found ${wa(Os(t))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function aM(i,e){const t=i.length-1;let a=0,d=t,m=0,_,c;for(;a<=d;)if(m=Math.floor((a+d)/2),_=i[m],c=i[m+1],_<=e){if(m===t||e<c)return m;a=m+1}else if(_>e)d=m-1;else throw new Na("Input is not a number.");return 0}class wb{constructor(e,t,a){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(const[d,m]of a)this.labels.push(d),this.outputs.push(m)}static parse(e,t){if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!==0)return t.error("Expected an even number of arguments.");const a=t.parse(e[1],1,Qt);if(!a)return null;const d=[];let m=null;t.expectedType&&t.expectedType.kind!=="value"&&(m=t.expectedType);for(let _=1;_<e.length;_+=2){const c=_===1?-1/0:e[_],C=e[_+1],k=_,V=_+1;if(typeof c!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(d.length&&d[d.length-1][0]>=c)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const G=t.parse(C,V,m);if(!G)return null;m=m||G.type,d.push([c,G])}return new wb(m,a,d)}evaluate(e){const t=this.labels,a=this.outputs;if(t.length===1)return a[0].evaluate(e);const d=this.input.evaluate(e);if(d<=t[0])return a[0].evaluate(e);const m=t.length;if(d>=t[m-1])return a[m-1].evaluate(e);const _=aM(t,d);return a[_].evaluate(e)}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function AB(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var _x,IS;function CB(){if(IS)return _x;IS=1,_x=i;function i(e,t,a,d){this.cx=3*e,this.bx=3*(a-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(d-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=a,this.p2y=d}return i.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(t===void 0&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var a=e,d=0;d<8;d++){var m=this.sampleCurveX(a)-e;if(Math.abs(m)<t)return a;var _=this.sampleCurveDerivativeX(a);if(Math.abs(_)<1e-6)break;a=a-m/_}var c=0,C=1;for(a=e,d=0;d<20&&(m=this.sampleCurveX(a),!(Math.abs(m-e)<t));d++)e>m?c=a:C=a,a=(C-c)*.5+c;return a},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}},_x}var IB=CB(),MB=AB(IB);class Hh{constructor(e,t,a,d,m){this.type=e,this.operator=t,this.interpolation=a,this.input=d,this.labels=[],this.outputs=[];for(const[_,c]of m)this.labels.push(_),this.outputs.push(c)}static interpolationFactor(e,t,a,d){let m=0;if(e.name==="exponential")m=yx(t,e.base,a,d);else if(e.name==="linear")m=yx(t,1,a,d);else if(e.name==="cubic-bezier"){const _=e.controlPoints;m=new MB(_[0],_[1],_[2],_[3]).solve(yx(t,1,a,d))}return m}static parse(e,t){let[a,d,m,..._]=e;if(!Array.isArray(d)||d.length===0)return t.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){const k=d[1];if(typeof k!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:k}}else if(d[0]==="cubic-bezier"){const k=d.slice(1);if(k.length!==4||k.some(V=>typeof V!="number"||V<0||V>1))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:k}}else return t.error(`Unknown interpolation type ${String(d[0])}`,1,0);if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!==0)return t.error("Expected an even number of arguments.");if(m=t.parse(m,2,Qt),!m)return null;const c=[];let C=null;(a==="interpolate-hcl"||a==="interpolate-lab")&&t.expectedType!=dy?C=Gh:t.expectedType&&t.expectedType.kind!=="value"&&(C=t.expectedType);for(let k=0;k<_.length;k+=2){const V=_[k],G=_[k+1],ee=k+3,Y=k+4;if(typeof V!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ee);if(c.length&&c[c.length-1][0]>=V)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ee);const xe=t.parse(G,Y,C);if(!xe)return null;C=C||xe.type,c.push([V,xe])}return!Tf(C,Qt)&&!Tf(C,fb)&&!Tf(C,Gh)&&!Tf(C,gb)&&!Tf(C,_b)&&!Tf(C,dy)&&!Tf(C,yb)&&!Tf(C,Ou(Qt))?t.error(`Type ${wa(C)} is not interpolatable.`):new Hh(C,a,d,m,c)}evaluate(e){const t=this.labels,a=this.outputs;if(t.length===1)return a[0].evaluate(e);const d=this.input.evaluate(e);if(d<=t[0])return a[0].evaluate(e);const m=t.length;if(d>=t[m-1])return a[m-1].evaluate(e);const _=aM(t,d),c=t[_],C=t[_+1],k=Hh.interpolationFactor(this.interpolation,d,c,C),V=a[_].evaluate(e),G=a[_+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Fp(V,G,k);case"color":return Ar.interpolate(V,G,k);case"padding":return ih.interpolate(V,G,k);case"colorArray":return Nu.interpolate(V,G,k);case"numberArray":return rh.interpolate(V,G,k);case"variableAnchorOffsetCollection":return Zh.interpolate(V,G,k);case"array":return py(V,G,k);case"projectionDefinition":return Jc.interpolate(V,G,k)}case"interpolate-hcl":switch(this.type.kind){case"color":return Ar.interpolate(V,G,k,"hcl");case"colorArray":return Nu.interpolate(V,G,k,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Ar.interpolate(V,G,k,"lab");case"colorArray":return Nu.interpolate(V,G,k,"lab")}}}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function yx(i,e,t,a){const d=a-t,m=i-t;return d===0?0:e===1?m/d:(Math.pow(e,m)-1)/(Math.pow(e,d)-1)}class gy{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let a=null;const d=t.expectedType;d&&d.kind!=="value"&&(a=d);const m=[];for(const _ of e.slice(1)){const c=t.parse(_,1+m.length,a,void 0,{typeAnnotation:"omit"});if(!c)return null;a=a||c.type,m.push(c)}if(!a)throw new Error("No output type");return d&&m.some(_=>fy(d,_.type))?new gy(ci,m):new gy(a,m)}evaluate(e){let t=null,a=0,d;for(const m of this.args)if(a++,t=m.evaluate(e),t&&t instanceof $f&&!t.available&&(d||(d=t.name),t=null,a===this.args.length&&(t=d)),t!==null)break;return t}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}function MS(i,e){return i==="=="||i==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function PB(i,e,t){return e===t}function RB(i,e,t){return e!==t}function LB(i,e,t){return e<t}function kB(i,e,t){return e>t}function DB(i,e,t){return e<=t}function zB(i,e,t){return e>=t}function sM(i,e,t,a){return a.compare(e,t)===0}function OB(i,e,t,a){return!sM(i,e,t,a)}function NB(i,e,t,a){return a.compare(e,t)<0}function BB(i,e,t,a){return a.compare(e,t)>0}function FB(i,e,t,a){return a.compare(e,t)<=0}function VB(i,e,t,a){return a.compare(e,t)>=0}function Mg(i,e,t){const a=i!=="=="&&i!=="!=";return class oM{constructor(m,_,c){this.type=di,this.lhs=m,this.rhs=_,this.collator=c,this.hasUntypedArgument=m.type.kind==="value"||_.type.kind==="value"}static parse(m,_){if(m.length!==3&&m.length!==4)return _.error("Expected two or three arguments.");const c=m[0];let C=_.parse(m[1],1,ci);if(!C)return null;if(!MS(c,C.type))return _.concat(1).error(`"${c}" comparisons are not supported for type '${wa(C.type)}'.`);let k=_.parse(m[2],2,ci);if(!k)return null;if(!MS(c,k.type))return _.concat(2).error(`"${c}" comparisons are not supported for type '${wa(k.type)}'.`);if(C.type.kind!==k.type.kind&&C.type.kind!=="value"&&k.type.kind!=="value")return _.error(`Cannot compare types '${wa(C.type)}' and '${wa(k.type)}'.`);a&&(C.type.kind==="value"&&k.type.kind!=="value"?C=new eh(k.type,[C]):C.type.kind!=="value"&&k.type.kind==="value"&&(k=new eh(C.type,[k])));let V=null;if(m.length===4){if(C.type.kind!=="string"&&k.type.kind!=="string"&&C.type.kind!=="value"&&k.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(V=_.parse(m[3],3,pb),!V)return null}return new oM(C,k,V)}evaluate(m){const _=this.lhs.evaluate(m),c=this.rhs.evaluate(m);if(a&&this.hasUntypedArgument){const C=Os(_),k=Os(c);if(C.kind!==k.kind||!(C.kind==="string"||C.kind==="number"))throw new Na(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${C.kind}, ${k.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const C=Os(_),k=Os(c);if(C.kind!=="string"||k.kind!=="string")return e(m,_,c)}return this.collator?t(m,_,c,this.collator.evaluate(m)):e(m,_,c)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}}}const UB=Mg("==",PB,sM),jB=Mg("!=",RB,OB),qB=Mg("<",LB,NB),$B=Mg(">",kB,BB),GB=Mg("<=",DB,FB),ZB=Mg(">=",zB,VB);class Tb{constructor(e,t,a){this.type=pb,this.locale=a,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(e.length!==2)return t.error("Expected one argument.");const a=e[1];if(typeof a!="object"||Array.isArray(a))return t.error("Collator options argument must be an object.");const d=t.parse(a["case-sensitive"]===void 0?!1:a["case-sensitive"],1,di);if(!d)return null;const m=t.parse(a["diacritic-sensitive"]===void 0?!1:a["diacritic-sensitive"],1,di);if(!m)return null;let _=null;return a.locale&&(_=t.parse(a.locale,1,vi),!_)?null:new Tb(d,m,_)}evaluate(e){return new Dw(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class Fw{constructor(e,t,a,d,m){this.type=vi,this.number=e,this.locale=t,this.currency=a,this.minFractionDigits=d,this.maxFractionDigits=m}static parse(e,t){if(e.length!==3)return t.error("Expected two arguments.");const a=t.parse(e[1],1,Qt);if(!a)return null;const d=e[2];if(typeof d!="object"||Array.isArray(d))return t.error("NumberFormat options argument must be an object.");let m=null;if(d.locale&&(m=t.parse(d.locale,1,vi),!m))return null;let _=null;if(d.currency&&(_=t.parse(d.currency,1,vi),!_))return null;let c=null;if(d["min-fraction-digits"]&&(c=t.parse(d["min-fraction-digits"],1,Qt),!c))return null;let C=null;return d["max-fraction-digits"]&&(C=t.parse(d["max-fraction-digits"],1,Qt),!C)?null:new Fw(a,m,_,c,C)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Vw{constructor(e){this.type=mb,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const a=e[1];if(!Array.isArray(a)&&typeof a=="object")return t.error("First argument must be an image or text section.");const d=[];let m=!1;for(let _=1;_<=e.length-1;++_){const c=e[_];if(m&&typeof c=="object"&&!Array.isArray(c)){m=!1;let C=null;if(c["font-scale"]&&(C=t.parse(c["font-scale"],1,Qt),!C))return null;let k=null;if(c["text-font"]&&(k=t.parse(c["text-font"],1,Ou(vi)),!k))return null;let V=null;if(c["text-color"]&&(V=t.parse(c["text-color"],1,Gh),!V))return null;let G=null;if(c["vertical-align"]){if(typeof c["vertical-align"]=="string"&&!TB.includes(c["vertical-align"]))return t.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${c["vertical-align"]}' instead.`);if(G=t.parse(c["vertical-align"],1,vi),!G)return null}const ee=d[d.length-1];ee.scale=C,ee.font=k,ee.textColor=V,ee.verticalAlign=G}else{const C=t.parse(e[_],1,ci);if(!C)return null;const k=C.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,d.push({content:C,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Vw(d)}evaluate(e){const t=a=>{const d=a.content.evaluate(e);return Os(d)===Ny?new u1("",d,null,null,null,a.verticalAlign?a.verticalAlign.evaluate(e):null):new u1(ey(d),null,a.scale?a.scale.evaluate(e):null,a.font?a.font.evaluate(e).join(","):null,a.textColor?a.textColor.evaluate(e):null,a.verticalAlign?a.verticalAlign.evaluate(e):null)};return new Nd(this.sections.map(t))}eachChild(e){for(const t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor),t.verticalAlign&&e(t.verticalAlign)}outputDefined(){return!1}}class Uw{constructor(e){this.type=Ny,this.input=e}static parse(e,t){if(e.length!==2)return t.error("Expected two arguments.");const a=t.parse(e[1],1,vi);return a?new Uw(a):t.error("No image name provided.")}evaluate(e){const t=this.input.evaluate(e),a=$f.fromString(t);return a&&e.availableImages&&(a.available=e.availableImages.indexOf(t)>-1),a}eachChild(e){e(this.input)}outputDefined(){return!1}}class jw{constructor(e){this.type=Qt,this.input=e}static parse(e,t){if(e.length!==2)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const a=t.parse(e[1],1);return a?a.type.kind!=="array"&&a.type.kind!=="string"&&a.type.kind!=="value"?t.error(`Expected argument of type string or array, but found ${wa(a.type)} instead.`):new jw(a):null}evaluate(e){const t=this.input.evaluate(e);if(typeof t=="string")return[...t].length;if(Array.isArray(t))return t.length;throw new Na(`Expected value to be of type string or array, but found ${wa(Os(t))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const Wh=8192;function HB(i,e){const t=WB(i[0]),a=KB(i[1]),d=Math.pow(2,e.z);return[Math.round(t*d*Wh),Math.round(a*d*Wh)]}function qw(i,e){const t=Math.pow(2,e.z),a=(i[0]/Wh+e.x)/t,d=(i[1]/Wh+e.y)/t;return[XB(a),YB(d)]}function WB(i){return(180+i)/360}function XB(i){return i*360-180}function KB(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function YB(i){return 360/Math.PI*Math.atan(Math.exp((180-i*360)*Math.PI/180))-90}function By(i,e){i[0]=Math.min(i[0],e[0]),i[1]=Math.min(i[1],e[1]),i[2]=Math.max(i[2],e[0]),i[3]=Math.max(i[3],e[1])}function _y(i,e){return!(i[0]<=e[0]||i[2]>=e[2]||i[1]<=e[1]||i[3]>=e[3])}function QB(i,e,t){return e[1]>i[1]!=t[1]>i[1]&&i[0]<(t[0]-e[0])*(i[1]-e[1])/(t[1]-e[1])+e[0]}function JB(i,e,t){const a=i[0]-e[0],d=i[1]-e[1],m=i[0]-t[0],_=i[1]-t[1];return a*_-m*d===0&&a*m<=0&&d*_<=0}function Sb(i,e,t,a){const d=[e[0]-i[0],e[1]-i[1]],m=[a[0]-t[0],a[1]-t[1]];return iF(m,d)===0?!1:!!(PS(i,e,t,a)&&PS(t,a,i,e))}function eF(i,e,t){for(const a of t)for(let d=0;d<a.length-1;++d)if(Sb(i,e,a[d],a[d+1]))return!0;return!1}function Pg(i,e,t=!1){let a=!1;for(const d of e)for(let m=0;m<d.length-1;m++){if(JB(i,d[m],d[m+1]))return t;QB(i,d[m],d[m+1])&&(a=!a)}return a}function tF(i,e){for(const t of e)if(Pg(i,t))return!0;return!1}function lM(i,e){for(const t of i)if(!Pg(t,e))return!1;for(let t=0;t<i.length-1;++t)if(eF(i[t],i[t+1],e))return!1;return!0}function nF(i,e){for(const t of e)if(lM(i,t))return!0;return!1}function iF(i,e){return i[0]*e[1]-i[1]*e[0]}function PS(i,e,t,a){const d=i[0]-t[0],m=i[1]-t[1],_=e[0]-t[0],c=e[1]-t[1],C=a[0]-t[0],k=a[1]-t[1],V=d*k-C*m,G=_*k-C*c;return V>0&&G<0||V<0&&G>0}function $w(i,e,t){const a=[];for(let d=0;d<i.length;d++){const m=[];for(let _=0;_<i[d].length;_++){const c=HB(i[d][_],t);By(e,c),m.push(c)}a.push(m)}return a}function uM(i,e,t){const a=[];for(let d=0;d<i.length;d++){const m=$w(i[d],e,t);a.push(m)}return a}function cM(i,e,t,a){if(i[0]<t[0]||i[0]>t[2]){const d=a*.5;let m=i[0]-t[0]>d?-a:t[0]-i[0]>d?a:0;m===0&&(m=i[0]-t[2]>d?-a:t[2]-i[0]>d?a:0),i[0]+=m}By(e,i)}function rF(i){i[0]=i[1]=1/0,i[2]=i[3]=-1/0}function RS(i,e,t,a){const d=Math.pow(2,a.z)*Wh,m=[a.x*Wh,a.y*Wh],_=[];for(const c of i)for(const C of c){const k=[C.x+m[0],C.y+m[1]];cM(k,e,t,d),_.push(k)}return _}function LS(i,e,t,a){const d=Math.pow(2,a.z)*Wh,m=[a.x*Wh,a.y*Wh],_=[];for(const c of i){const C=[];for(const k of c){const V=[k.x+m[0],k.y+m[1]];By(e,V),C.push(V)}_.push(C)}if(e[2]-e[0]<=d/2){rF(e);for(const c of _)for(const C of c)cM(C,e,t,d)}return _}function aF(i,e){const t=[1/0,1/0,-1/0,-1/0],a=[1/0,1/0,-1/0,-1/0],d=i.canonicalID();if(e.type==="Polygon"){const m=$w(e.coordinates,a,d),_=RS(i.geometry(),t,a,d);if(!_y(t,a))return!1;for(const c of _)if(!Pg(c,m))return!1}if(e.type==="MultiPolygon"){const m=uM(e.coordinates,a,d),_=RS(i.geometry(),t,a,d);if(!_y(t,a))return!1;for(const c of _)if(!tF(c,m))return!1}return!0}function sF(i,e){const t=[1/0,1/0,-1/0,-1/0],a=[1/0,1/0,-1/0,-1/0],d=i.canonicalID();if(e.type==="Polygon"){const m=$w(e.coordinates,a,d),_=LS(i.geometry(),t,a,d);if(!_y(t,a))return!1;for(const c of _)if(!lM(c,m))return!1}if(e.type==="MultiPolygon"){const m=uM(e.coordinates,a,d),_=LS(i.geometry(),t,a,d);if(!_y(t,a))return!1;for(const c of _)if(!nF(c,m))return!1}return!0}class Vp{constructor(e,t){this.type=di,this.geojson=e,this.geometries=t}static parse(e,t){if(e.length!==2)return t.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(my(e[1])){const a=e[1];if(a.type==="FeatureCollection"){const d=[];for(const m of a.features){const{type:_,coordinates:c}=m.geometry;_==="Polygon"&&d.push(c),_==="MultiPolygon"&&d.push(...c)}if(d.length){const m={type:"MultiPolygon",coordinates:d};return new Vp(a,m)}}else if(a.type==="Feature"){const d=a.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new Vp(a,a.geometry)}else if(a.type==="Polygon"||a.type==="MultiPolygon")return new Vp(a,a)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return aF(e,this.geometries);if(e.geometryType()==="LineString")return sF(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class hM{constructor(e=[],t=(a,d)=>a<d?-1:a>d?1:0){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;const e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:a}=this,d=t[e];for(;e>0;){const m=e-1>>1,_=t[m];if(a(d,_)>=0)break;t[e]=_,e=m}t[e]=d}_down(e){const{data:t,compare:a}=this,d=this.length>>1,m=t[e];for(;e<d;){let _=(e<<1)+1;const c=_+1;if(c<this.length&&a(t[c],t[_])<0&&(_=c),a(t[_],m)>=0)break;t[e]=t[_],e=_}t[e]=m}}function oF(i,e){if(i.length<=1)return[i];const t=[];let a,d;for(const m of i){const _=lF(m);_!==0&&(m.area=Math.abs(_),d===void 0&&(d=_<0),d===_<0?(a&&t.push(a),a=[m]):a.push(m))}return a&&t.push(a),t}function lF(i){let e=0;for(let t=0,a=i.length,d=a-1,m,_;t<a;d=t++)m=i[t],_=i[d],e+=(_.x-m.x)*(m.y+_.y);return e}const uF=6378.137,kS=1/298.257223563,DS=kS*(2-kS),zS=Math.PI/180;class Gw{constructor(e){const t=zS*uF*1e3,a=Math.cos(e*zS),d=1/(1-DS*(1-a*a)),m=Math.sqrt(d);this.kx=t*m*a,this.ky=t*m*d*(1-DS)}distance(e,t){const a=this.wrap(e[0]-t[0])*this.kx,d=(e[1]-t[1])*this.ky;return Math.sqrt(a*a+d*d)}pointOnLine(e,t){let a=1/0,d,m,_,c;for(let C=0;C<e.length-1;C++){let k=e[C][0],V=e[C][1],G=this.wrap(e[C+1][0]-k)*this.kx,ee=(e[C+1][1]-V)*this.ky,Y=0;(G!==0||ee!==0)&&(Y=(this.wrap(t[0]-k)*this.kx*G+(t[1]-V)*this.ky*ee)/(G*G+ee*ee),Y>1?(k=e[C+1][0],V=e[C+1][1]):Y>0&&(k+=G/this.kx*Y,V+=ee/this.ky*Y)),G=this.wrap(t[0]-k)*this.kx,ee=(t[1]-V)*this.ky;const xe=G*G+ee*ee;xe<a&&(a=xe,d=k,m=V,_=C,c=Y)}return{point:[d,m],index:_,t:Math.max(0,Math.min(1,c))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}const c1=100,h1=50;function dM(i,e){return e[0]-i[0]}function B0(i){return i[1]-i[0]+1}function Gd(i,e){return i[1]>=i[0]&&i[1]<e}function d1(i,e){if(i[0]>i[1])return[null,null];const t=B0(i);if(e){if(t===2)return[i,null];const d=Math.floor(t/2);return[[i[0],i[0]+d],[i[0]+d,i[1]]]}if(t===1)return[i,null];const a=Math.floor(t/2)-1;return[[i[0],i[0]+a],[i[0]+a+1,i[1]]]}function f1(i,e){if(!Gd(e,i.length))return[1/0,1/0,-1/0,-1/0];const t=[1/0,1/0,-1/0,-1/0];for(let a=e[0];a<=e[1];++a)By(t,i[a]);return t}function p1(i){const e=[1/0,1/0,-1/0,-1/0];for(const t of i)for(const a of t)By(e,a);return e}function OS(i){return i[0]!==-1/0&&i[1]!==-1/0&&i[2]!==1/0&&i[3]!==1/0}function Zw(i,e,t){if(!OS(i)||!OS(e))return NaN;let a=0,d=0;return i[2]<e[0]&&(a=e[0]-i[2]),i[0]>e[2]&&(a=i[0]-e[2]),i[1]>e[3]&&(d=i[1]-e[3]),i[3]<e[1]&&(d=e[1]-i[3]),t.distance([0,0],[a,d])}function zp(i,e,t){const a=t.pointOnLine(e,i);return t.distance(i,a.point)}function Hw(i,e,t,a,d){const m=Math.min(zp(i,[t,a],d),zp(e,[t,a],d)),_=Math.min(zp(t,[i,e],d),zp(a,[i,e],d));return Math.min(m,_)}function cF(i,e,t,a,d){if(!(Gd(e,i.length)&&Gd(a,t.length)))return 1/0;let m=1/0;for(let _=e[0];_<e[1];++_){const c=i[_],C=i[_+1];for(let k=a[0];k<a[1];++k){const V=t[k],G=t[k+1];if(Sb(c,C,V,G))return 0;m=Math.min(m,Hw(c,C,V,G,d))}}return m}function hF(i,e,t,a,d){if(!(Gd(e,i.length)&&Gd(a,t.length)))return NaN;let m=1/0;for(let _=e[0];_<=e[1];++_)for(let c=a[0];c<=a[1];++c)if(m=Math.min(m,d.distance(i[_],t[c])),m===0)return m;return m}function dF(i,e,t){if(Pg(i,e,!0))return 0;let a=1/0;for(const d of e){const m=d[0],_=d[d.length-1];if(m!==_&&(a=Math.min(a,zp(i,[_,m],t)),a===0))return a;const c=t.pointOnLine(d,i);if(a=Math.min(a,t.distance(i,c.point)),a===0)return a}return a}function fF(i,e,t,a){if(!Gd(e,i.length))return NaN;for(let m=e[0];m<=e[1];++m)if(Pg(i[m],t,!0))return 0;let d=1/0;for(let m=e[0];m<e[1];++m){const _=i[m],c=i[m+1];for(const C of t)for(let k=0,V=C.length,G=V-1;k<V;G=k++){const ee=C[G],Y=C[k];if(Sb(_,c,ee,Y))return 0;d=Math.min(d,Hw(_,c,ee,Y,a))}}return d}function NS(i,e){for(const t of i)for(const a of t)if(Pg(a,e,!0))return!0;return!1}function pF(i,e,t,a=1/0){const d=p1(i),m=p1(e);if(a!==1/0&&Zw(d,m,t)>=a)return a;if(_y(d,m)){if(NS(i,e))return 0}else if(NS(e,i))return 0;let _=1/0;for(const c of i)for(let C=0,k=c.length,V=k-1;C<k;V=C++){const G=c[V],ee=c[C];for(const Y of e)for(let xe=0,be=Y.length,Ne=be-1;xe<be;Ne=xe++){const tt=Y[Ne],Je=Y[xe];if(Sb(G,ee,tt,Je))return 0;_=Math.min(_,Hw(G,ee,tt,Je,t))}}return _}function BS(i,e,t,a,d,m){if(!m)return;const _=Zw(f1(a,m),d,t);_<e&&i.push([_,m,[0,0]])}function qv(i,e,t,a,d,m,_){if(!m||!_)return;const c=Zw(f1(a,m),f1(d,_),t);c<e&&i.push([c,m,_])}function F0(i,e,t,a,d=1/0){let m=Math.min(a.distance(i[0],t[0][0]),d);if(m===0)return m;const _=new hM([[0,[0,i.length-1],[0,0]]],dM),c=p1(t);for(;_.length>0;){const C=_.pop();if(C[0]>=m)continue;const k=C[1],V=e?h1:c1;if(B0(k)<=V){if(!Gd(k,i.length))return NaN;if(e){const G=fF(i,k,t,a);if(isNaN(G)||G===0)return G;m=Math.min(m,G)}else for(let G=k[0];G<=k[1];++G){const ee=dF(i[G],t,a);if(m=Math.min(m,ee),m===0)return 0}}else{const G=d1(k,e);BS(_,m,a,i,c,G[0]),BS(_,m,a,i,c,G[1])}}return m}function V0(i,e,t,a,d,m=1/0){let _=Math.min(m,d.distance(i[0],t[0]));if(_===0)return _;const c=new hM([[0,[0,i.length-1],[0,t.length-1]]],dM);for(;c.length>0;){const C=c.pop();if(C[0]>=_)continue;const k=C[1],V=C[2],G=e?h1:c1,ee=a?h1:c1;if(B0(k)<=G&&B0(V)<=ee){if(!Gd(k,i.length)&&Gd(V,t.length))return NaN;let Y;if(e&&a)Y=cF(i,k,t,V,d),_=Math.min(_,Y);else if(e&&!a){const xe=i.slice(k[0],k[1]+1);for(let be=V[0];be<=V[1];++be)if(Y=zp(t[be],xe,d),_=Math.min(_,Y),_===0)return _}else if(!e&&a){const xe=t.slice(V[0],V[1]+1);for(let be=k[0];be<=k[1];++be)if(Y=zp(i[be],xe,d),_=Math.min(_,Y),_===0)return _}else Y=hF(i,k,t,V,d),_=Math.min(_,Y)}else{const Y=d1(k,e),xe=d1(V,a);qv(c,_,d,i,t,Y[0],xe[0]),qv(c,_,d,i,t,Y[0],xe[1]),qv(c,_,d,i,t,Y[1],xe[0]),qv(c,_,d,i,t,Y[1],xe[1])}}return _}function mF(i,e){const t=i.geometry(),a=t.flat().map(_=>qw([_.x,_.y],i.canonical));if(t.length===0)return NaN;const d=new Gw(a[0][1]);let m=1/0;for(const _ of e){switch(_.type){case"Point":m=Math.min(m,V0(a,!1,[_.coordinates],!1,d,m));break;case"LineString":m=Math.min(m,V0(a,!1,_.coordinates,!0,d,m));break;case"Polygon":m=Math.min(m,F0(a,!1,_.coordinates,d,m));break}if(m===0)return m}return m}function gF(i,e){const t=i.geometry(),a=t.flat().map(_=>qw([_.x,_.y],i.canonical));if(t.length===0)return NaN;const d=new Gw(a[0][1]);let m=1/0;for(const _ of e){switch(_.type){case"Point":m=Math.min(m,V0(a,!0,[_.coordinates],!1,d,m));break;case"LineString":m=Math.min(m,V0(a,!0,_.coordinates,!0,d,m));break;case"Polygon":m=Math.min(m,F0(a,!0,_.coordinates,d,m));break}if(m===0)return m}return m}function _F(i,e){const t=i.geometry();if(t.length===0||t[0].length===0)return NaN;const a=oF(t).map(_=>_.map(c=>c.map(C=>qw([C.x,C.y],i.canonical)))),d=new Gw(a[0][0][0][1]);let m=1/0;for(const _ of e)for(const c of a){switch(_.type){case"Point":m=Math.min(m,F0([_.coordinates],!1,c,d,m));break;case"LineString":m=Math.min(m,F0(_.coordinates,!0,c,d,m));break;case"Polygon":m=Math.min(m,pF(c,_.coordinates,d,m));break}if(m===0)return m}return m}function vx(i){return i.type==="MultiPolygon"?i.coordinates.map(e=>({type:"Polygon",coordinates:e})):i.type==="MultiLineString"?i.coordinates.map(e=>({type:"LineString",coordinates:e})):i.type==="MultiPoint"?i.coordinates.map(e=>({type:"Point",coordinates:e})):[i]}class Up{constructor(e,t){this.type=Qt,this.geojson=e,this.geometries=t}static parse(e,t){if(e.length!==2)return t.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(my(e[1])){const a=e[1];if(a.type==="FeatureCollection")return new Up(a,a.features.map(d=>vx(d.geometry)).flat());if(a.type==="Feature")return new Up(a,vx(a.geometry));if("type"in a&&"coordinates"in a)return new Up(a,vx(a))}return t.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return mF(e,this.geometries);if(e.geometryType()==="LineString")return gF(e,this.geometries);if(e.geometryType()==="Polygon")return _F(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Fy{constructor(e){this.type=ci,this.key=e}static parse(e,t){if(e.length!==2)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const a=e[1];return a==null?t.error("Global state property must be defined."):typeof a!="string"?t.error(`Global state property must be string, but found ${typeof e[1]} instead.`):new Fy(a)}evaluate(e){var t;const a=(t=e.globals)===null||t===void 0?void 0:t.globalState;return!a||Object.keys(a).length===0?null:J_(a,this.key)}eachChild(){}outputDefined(){return!1}}const Ww={"==":UB,"!=":jB,">":$B,"<":qB,">=":ZB,"<=":GB,array:eh,at:zw,boolean:eh,case:Bw,coalesce:gy,collator:Tb,format:Vw,image:Uw,in:Ow,"index-of":O0,interpolate:Hh,"interpolate-hcl":Hh,"interpolate-lab":Hh,length:jw,let:bb,literal:gg,match:Nw,number:eh,"number-format":Fw,object:eh,slice:N0,step:wb,string:eh,"to-boolean":Mf,"to-color":Mf,"to-number":Mf,"to-string":Mf,var:xb,within:Vp,distance:Up,"global-state":Fy};class ah{constructor(e,t,a,d){this.name=e,this.type=t,this._evaluate=a,this.args=d}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,t){const a=e[0],d=ah.definitions[a];if(!d)return t.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(d)?d[0]:d.type,_=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,c=_.filter(([k])=>!Array.isArray(k)||k.length===e.length-1);let C=null;for(const[k,V]of c){C=new vb(t.registry,U0,t.path,null,t.scope);const G=[];let ee=!1;for(let Y=1;Y<e.length;Y++){const xe=e[Y],be=Array.isArray(k)?k[Y-1]:k.type,Ne=C.parse(xe,1+G.length,be);if(!Ne){ee=!0;break}G.push(Ne)}if(!ee){if(Array.isArray(k)&&k.length!==G.length){C.error(`Expected ${k.length} arguments, but found ${G.length} instead.`);continue}for(let Y=0;Y<G.length;Y++){const xe=Array.isArray(k)?k[Y]:k.type,be=G[Y];C.concat(Y+1).checkSubtype(xe,be.type)}if(C.errors.length===0)return new ah(a,m,V,G)}}if(c.length===1)t.errors.push(...C.errors);else{const k=(c.length?c:_).map(([G])=>vF(G)).join(" | "),V=[];for(let G=1;G<e.length;G++){const ee=t.parse(e[G],1+V.length);if(!ee)return null;V.push(wa(ee.type))}t.error(`Expected arguments of type ${k}, but found (${V.join(", ")}) instead.`)}return null}static register(e,t){ah.definitions=t;for(const a in t)e[a]=ah}}function FS(i,[e,t,a,d]){e=e.evaluate(i),t=t.evaluate(i),a=a.evaluate(i);const m=d?d.evaluate(i):1,_=iM(e,t,a,m);if(_)throw new Na(_);return new Ar(e/255,t/255,a/255,m,!1)}function VS(i,e){return i in e}function bx(i,e){const t=e[i];return typeof t>"u"?null:t}function yF(i,e,t,a){for(;t<=a;){const d=t+a>>1;if(e[d]===i)return!0;e[d]>i?a=d-1:t=d+1}return!1}function Tp(i){return{type:i}}ah.register(Ww,{error:[dB,[vi],(i,[e])=>{throw new Na(e.evaluate(i))}],typeof:[vi,[ci],(i,[e])=>wa(Os(e.evaluate(i)))],"to-rgba":[Ou(Qt,4),[Gh],(i,[e])=>{const[t,a,d,m]=e.evaluate(i).rgb;return[t*255,a*255,d*255,m]}],rgb:[Gh,[Qt,Qt,Qt],FS],rgba:[Gh,[Qt,Qt,Qt,Qt],FS],has:{type:di,overloads:[[[vi],(i,[e])=>VS(e.evaluate(i),i.properties())],[[vi,Np],(i,[e,t])=>VS(e.evaluate(i),t.evaluate(i))]]},get:{type:ci,overloads:[[[vi],(i,[e])=>bx(e.evaluate(i),i.properties())],[[vi,Np],(i,[e,t])=>bx(e.evaluate(i),t.evaluate(i))]]},"feature-state":[ci,[vi],(i,[e])=>bx(e.evaluate(i),i.featureState||{})],properties:[Np,[],i=>i.properties()],"geometry-type":[vi,[],i=>i.geometryType()],id:[ci,[],i=>i.id()],zoom:[Qt,[],i=>i.globals.zoom],"heatmap-density":[Qt,[],i=>i.globals.heatmapDensity||0],elevation:[Qt,[],i=>i.globals.elevation||0],"line-progress":[Qt,[],i=>i.globals.lineProgress||0],accumulated:[ci,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[Qt,Tp(Qt),(i,e)=>{let t=0;for(const a of e)t+=a.evaluate(i);return t}],"*":[Qt,Tp(Qt),(i,e)=>{let t=1;for(const a of e)t*=a.evaluate(i);return t}],"-":{type:Qt,overloads:[[[Qt,Qt],(i,[e,t])=>e.evaluate(i)-t.evaluate(i)],[[Qt],(i,[e])=>-e.evaluate(i)]]},"/":[Qt,[Qt,Qt],(i,[e,t])=>e.evaluate(i)/t.evaluate(i)],"%":[Qt,[Qt,Qt],(i,[e,t])=>e.evaluate(i)%t.evaluate(i)],ln2:[Qt,[],()=>Math.LN2],pi:[Qt,[],()=>Math.PI],e:[Qt,[],()=>Math.E],"^":[Qt,[Qt,Qt],(i,[e,t])=>Math.pow(e.evaluate(i),t.evaluate(i))],sqrt:[Qt,[Qt],(i,[e])=>Math.sqrt(e.evaluate(i))],log10:[Qt,[Qt],(i,[e])=>Math.log(e.evaluate(i))/Math.LN10],ln:[Qt,[Qt],(i,[e])=>Math.log(e.evaluate(i))],log2:[Qt,[Qt],(i,[e])=>Math.log(e.evaluate(i))/Math.LN2],sin:[Qt,[Qt],(i,[e])=>Math.sin(e.evaluate(i))],cos:[Qt,[Qt],(i,[e])=>Math.cos(e.evaluate(i))],tan:[Qt,[Qt],(i,[e])=>Math.tan(e.evaluate(i))],asin:[Qt,[Qt],(i,[e])=>Math.asin(e.evaluate(i))],acos:[Qt,[Qt],(i,[e])=>Math.acos(e.evaluate(i))],atan:[Qt,[Qt],(i,[e])=>Math.atan(e.evaluate(i))],min:[Qt,Tp(Qt),(i,e)=>Math.min(...e.map(t=>t.evaluate(i)))],max:[Qt,Tp(Qt),(i,e)=>Math.max(...e.map(t=>t.evaluate(i)))],abs:[Qt,[Qt],(i,[e])=>Math.abs(e.evaluate(i))],round:[Qt,[Qt],(i,[e])=>{const t=e.evaluate(i);return t<0?-Math.round(-t):Math.round(t)}],floor:[Qt,[Qt],(i,[e])=>Math.floor(e.evaluate(i))],ceil:[Qt,[Qt],(i,[e])=>Math.ceil(e.evaluate(i))],"filter-==":[di,[vi,ci],(i,[e,t])=>i.properties()[e.value]===t.value],"filter-id-==":[di,[ci],(i,[e])=>i.id()===e.value],"filter-type-==":[di,[vi],(i,[e])=>i.geometryType()===e.value],"filter-<":[di,[vi,ci],(i,[e,t])=>{const a=i.properties()[e.value],d=t.value;return typeof a==typeof d&&a<d}],"filter-id-<":[di,[ci],(i,[e])=>{const t=i.id(),a=e.value;return typeof t==typeof a&&t<a}],"filter->":[di,[vi,ci],(i,[e,t])=>{const a=i.properties()[e.value],d=t.value;return typeof a==typeof d&&a>d}],"filter-id->":[di,[ci],(i,[e])=>{const t=i.id(),a=e.value;return typeof t==typeof a&&t>a}],"filter-<=":[di,[vi,ci],(i,[e,t])=>{const a=i.properties()[e.value],d=t.value;return typeof a==typeof d&&a<=d}],"filter-id-<=":[di,[ci],(i,[e])=>{const t=i.id(),a=e.value;return typeof t==typeof a&&t<=a}],"filter->=":[di,[vi,ci],(i,[e,t])=>{const a=i.properties()[e.value],d=t.value;return typeof a==typeof d&&a>=d}],"filter-id->=":[di,[ci],(i,[e])=>{const t=i.id(),a=e.value;return typeof t==typeof a&&t>=a}],"filter-has":[di,[ci],(i,[e])=>e.value in i.properties()],"filter-has-id":[di,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[di,[Ou(vi)],(i,[e])=>e.value.indexOf(i.geometryType())>=0],"filter-id-in":[di,[Ou(ci)],(i,[e])=>e.value.indexOf(i.id())>=0],"filter-in-small":[di,[vi,Ou(ci)],(i,[e,t])=>t.value.indexOf(i.properties()[e.value])>=0],"filter-in-large":[di,[vi,Ou(ci)],(i,[e,t])=>yF(i.properties()[e.value],t.value,0,t.value.length-1)],all:{type:di,overloads:[[[di,di],(i,[e,t])=>e.evaluate(i)&&t.evaluate(i)],[Tp(di),(i,e)=>{for(const t of e)if(!t.evaluate(i))return!1;return!0}]]},any:{type:di,overloads:[[[di,di],(i,[e,t])=>e.evaluate(i)||t.evaluate(i)],[Tp(di),(i,e)=>{for(const t of e)if(t.evaluate(i))return!0;return!1}]]},"!":[di,[di],(i,[e])=>!e.evaluate(i)],"is-supported-script":[di,[vi],(i,[e])=>{const t=i.globals&&i.globals.isSupportedScript;return t?t(e.evaluate(i)):!0}],upcase:[vi,[vi],(i,[e])=>e.evaluate(i).toUpperCase()],downcase:[vi,[vi],(i,[e])=>e.evaluate(i).toLowerCase()],concat:[vi,Tp(ci),(i,e)=>e.map(t=>ey(t.evaluate(i))).join("")],"resolved-locale":[vi,[pb],(i,[e])=>e.evaluate(i).resolvedLocale()]});function vF(i){return Array.isArray(i)?`(${i.map(wa).join(", ")})`:`(${wa(i.type)}...)`}function U0(i){if(i instanceof xb)return U0(i.boundExpression);if(i instanceof ah&&i.name==="error"||i instanceof Tb||i instanceof Vp||i instanceof Up||i instanceof Fy)return!1;const e=i instanceof Mf||i instanceof eh;let t=!0;return i.eachChild(a=>{e?t=t&&U0(a):t=t&&a instanceof gg}),t?Eb(i)&&Ab(i,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"]):!1}function Eb(i){if(i instanceof ah&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof Vp||i instanceof Up)return!1;let e=!0;return i.eachChild(t=>{e&&!Eb(t)&&(e=!1)}),e}function yy(i){if(i instanceof ah&&i.name==="feature-state")return!1;let e=!0;return i.eachChild(t=>{e&&!yy(t)&&(e=!1)}),e}function Ab(i,e){if(i instanceof ah&&e.indexOf(i.name)>=0)return!1;let t=!0;return i.eachChild(a=>{t&&!Ab(a,e)&&(t=!1)}),t}function m1(i){return{result:"success",value:i}}function Ym(i){return{result:"error",value:i}}function j0(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function fM(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function pM(i){return!!i.expression&&i.expression.interpolated}function Mi(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function Xw(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)&&Os(i)===Np}class bF{constructor(e,t){this.expression=e,this._warningHistory={},this._evaluator=new rM,this._defaultValue=t?TF(t):null,this._enumValues=t&&t.type==="enum"?t.values:null}evaluateWithoutErrorHandling(e,t,a,d,m,_){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=a,this._evaluator.canonical=d,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=_,this.expression.evaluate(this._evaluator)}evaluate(e,t,a,d,m,_){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=a||null,this._evaluator.canonical=d,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=_||null;try{const c=this.expression.evaluate(this._evaluator);if(c==null||typeof c=="number"&&c!==c)return this._defaultValue;if(this._enumValues&&!(c in this._enumValues))throw new Na(`Expected value to be one of ${Object.keys(this._enumValues).map(C=>JSON.stringify(C)).join(", ")}, but found ${JSON.stringify(c)} instead.`);return c}catch(c){return this._warningHistory[c.message]||(this._warningHistory[c.message]=!0,typeof console<"u"&&console.warn(c.message)),this._defaultValue}}}function mM(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in Ww}function gM(i,e){const t=new vb(Ww,U0,[],e?wF(e):void 0),a=t.parse(i,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?m1(new bF(a,e)):Ym(t.errors)}class US{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!yy(t.expression),this.globalStateRefs=Kw(t.expression)}evaluateWithoutErrorHandling(e,t,a,d,m,_){return this._styleExpression.evaluateWithoutErrorHandling(e,t,a,d,m,_)}evaluate(e,t,a,d,m,_){return this._styleExpression.evaluate(e,t,a,d,m,_)}}class jS{constructor(e,t,a,d){this.kind=e,this.zoomStops=a,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!yy(t.expression),this.globalStateRefs=Kw(t.expression),this.interpolationType=d}evaluateWithoutErrorHandling(e,t,a,d,m,_){return this._styleExpression.evaluateWithoutErrorHandling(e,t,a,d,m,_)}evaluate(e,t,a,d,m,_){return this._styleExpression.evaluate(e,t,a,d,m,_)}interpolationFactor(e,t,a){return this.interpolationType?Hh.interpolationFactor(this.interpolationType,e,t,a):0}}function xF(i,e){const t=gM(i,e);if(t.result==="error")return t;const a=t.value.expression,d=Eb(a);if(!d&&!j0(e))return Ym([new Bh("","data expressions not supported")]);const m=Ab(a,["zoom"]);if(!m&&!fM(e))return Ym([new Bh("","zoom expressions not supported")]);const _=s0(a);if(!_&&!m)return Ym([new Bh("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(_ instanceof Bh)return Ym([_]);if(_ instanceof Hh&&!pM(e))return Ym([new Bh("",'"interpolate" expressions cannot be used with this property')]);if(!_)return m1(d?new US("constant",t.value):new US("source",t.value));const c=_ instanceof Hh?_.interpolation:void 0;return m1(d?new jS("camera",t.value,_.labels,c):new jS("composite",t.value,_.labels,c))}function s0(i){let e=null;if(i instanceof bb)e=s0(i.result);else if(i instanceof gy){for(const t of i.args)if(e=s0(t),e)break}else(i instanceof wb||i instanceof Hh)&&i.input instanceof ah&&i.input.name==="zoom"&&(e=i);return e instanceof Bh||i.eachChild(t=>{const a=s0(t);a instanceof Bh?e=a:!e&&a?e=new Bh("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&a&&e!==a&&(e=new Bh("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function Kw(i,e=new Set){return i instanceof Fy&&e.add(i.key),i.eachChild(t=>{Kw(t,e)}),e}function wF(i){const e={color:Gh,string:vi,number:Qt,enum:vi,boolean:di,formatted:mb,padding:gb,numberArray:_b,colorArray:dy,projectionDefinition:fb,resolvedImage:Ny,variableAnchorOffsetCollection:yb};return i.type==="array"?Ou(e[i.value]||ci,i.length):e[i.type]}function TF(i){if(i.type==="color"&&Xw(i.default))return new Ar(0,0,0,0);switch(i.type){case"color":return Ar.parse(i.default)||null;case"padding":return ih.parse(i.default)||null;case"numberArray":return rh.parse(i.default)||null;case"colorArray":return Nu.parse(i.default)||null;case"variableAnchorOffsetCollection":return Zh.parse(i.default)||null;case"projectionDefinition":return Jc.parse(i.default)||null;default:return i.default===void 0?null:i.default}}function _M(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const e of i.slice(1))if(!_M(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function yM(i){const e=i.key,t=i.value;return t?[new Ht(e,t,"constants have been deprecated as of v8")]:[]}function Ya(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Xp(i){if(Array.isArray(i))return i.map(Xp);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const e={};for(const t in i)e[t]=Xp(i[t]);return e}return Ya(i)}function Cc(i){const e=i.key,t=i.value,a=i.valueSpec||{},d=i.objectElementValidators||{},m=i.style,_=i.styleSpec,c=i.validateSpec;let C=[];const k=Mi(t);if(k!=="object")return[new Ht(e,t,`object expected, ${k} found`)];for(const V in t){const G=V.split(".")[0],ee=J_(a,G)||a["*"];let Y;if(J_(d,G))Y=d[G];else if(J_(a,G))Y=c;else if(d["*"])Y=d["*"];else if(a["*"])Y=c;else{C.push(new Ht(e,t[V],`unknown property "${V}"`));continue}C=C.concat(Y({key:(e&&`${e}.`)+V,value:t[V],valueSpec:ee,style:m,styleSpec:_,object:t,objectKey:V,validateSpec:c},t))}for(const V in a)d[V]||a[V].required&&a[V].default===void 0&&t[V]===void 0&&C.push(new Ht(e,t,`missing required property "${V}"`));return C}function Yw(i){const e=i.value,t=i.valueSpec,a=i.validateSpec,d=i.style,m=i.styleSpec,_=i.key,c=i.arrayElementValidator||a;if(Mi(e)!=="array")return[new Ht(_,e,`array expected, ${Mi(e)} found`)];if(t.length&&e.length!==t.length)return[new Ht(_,e,`array length ${t.length} expected, length ${e.length} found`)];if(t["min-length"]&&e.length<t["min-length"])return[new Ht(_,e,`array length at least ${t["min-length"]} expected, length ${e.length} found`)];let C={type:t.value,values:t.values};m.$version<7&&(C.function=t.function),Mi(t.value)==="object"&&(C=t.value);let k=[];for(let V=0;V<e.length;V++)k=k.concat(c({array:e,arrayIndex:V,value:e[V],valueSpec:C,validateSpec:i.validateSpec,style:d,styleSpec:m,key:`${_}[${V}]`}));return k}function Cb(i){const e=i.key,t=i.value,a=i.valueSpec;let d=Mi(t);return d==="number"&&t!==t&&(d="NaN"),d!=="number"?[new Ht(e,t,`number expected, ${d} found`)]:"minimum"in a&&t<a.minimum?[new Ht(e,t,`${t} is less than the minimum value ${a.minimum}`)]:"maximum"in a&&t>a.maximum?[new Ht(e,t,`${t} is greater than the maximum value ${a.maximum}`)]:[]}function vM(i){const e=i.valueSpec,t=Ya(i.value.type);let a,d={},m,_;const c=t!=="categorical"&&i.value.property===void 0,C=!c,k=Mi(i.value.stops)==="array"&&Mi(i.value.stops[0])==="array"&&Mi(i.value.stops[0][0])==="object",V=Cc({key:i.key,value:i.value,valueSpec:i.styleSpec.function,validateSpec:i.validateSpec,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:G,default:xe}});return t==="identity"&&c&&V.push(new Ht(i.key,i.value,'missing required property "property"')),t!=="identity"&&!i.value.stops&&V.push(new Ht(i.key,i.value,'missing required property "stops"')),t==="exponential"&&i.valueSpec.expression&&!pM(i.valueSpec)&&V.push(new Ht(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(C&&!j0(i.valueSpec)?V.push(new Ht(i.key,i.value,"property functions not supported")):c&&!fM(i.valueSpec)&&V.push(new Ht(i.key,i.value,"zoom functions not supported"))),(t==="categorical"||k)&&i.value.property===void 0&&V.push(new Ht(i.key,i.value,'"property" property is required')),V;function G(be){if(t==="identity")return[new Ht(be.key,be.value,'identity function may not have a "stops" property')];let Ne=[];const tt=be.value;return Ne=Ne.concat(Yw({key:be.key,value:tt,valueSpec:be.valueSpec,validateSpec:be.validateSpec,style:be.style,styleSpec:be.styleSpec,arrayElementValidator:ee})),Mi(tt)==="array"&&tt.length===0&&Ne.push(new Ht(be.key,tt,"array must have at least one stop")),Ne}function ee(be){let Ne=[];const tt=be.value,Je=be.key;if(Mi(tt)!=="array")return[new Ht(Je,tt,`array expected, ${Mi(tt)} found`)];if(tt.length!==2)return[new Ht(Je,tt,`array length 2 expected, length ${tt.length} found`)];if(k){if(Mi(tt[0])!=="object")return[new Ht(Je,tt,`object expected, ${Mi(tt[0])} found`)];if(tt[0].zoom===void 0)return[new Ht(Je,tt,"object stop key must have zoom")];if(tt[0].value===void 0)return[new Ht(Je,tt,"object stop key must have value")];if(_&&_>Ya(tt[0].zoom))return[new Ht(Je,tt[0].zoom,"stop zoom values must appear in ascending order")];Ya(tt[0].zoom)!==_&&(_=Ya(tt[0].zoom),m=void 0,d={}),Ne=Ne.concat(Cc({key:`${Je}[0]`,value:tt[0],valueSpec:{zoom:{}},validateSpec:be.validateSpec,style:be.style,styleSpec:be.styleSpec,objectElementValidators:{zoom:Cb,value:Y}}))}else Ne=Ne.concat(Y({key:`${Je}[0]`,value:tt[0],validateSpec:be.validateSpec,style:be.style,styleSpec:be.styleSpec},tt));return mM(Xp(tt[1]))?Ne.concat([new Ht(`${Je}[1]`,tt[1],"expressions are not allowed in function stops.")]):Ne.concat(be.validateSpec({key:`${Je}[1]`,value:tt[1],valueSpec:e,validateSpec:be.validateSpec,style:be.style,styleSpec:be.styleSpec}))}function Y(be,Ne){const tt=Mi(be.value),Je=Ya(be.value),Xe=be.value!==null?be.value:Ne;if(!a)a=tt;else if(tt!==a)return[new Ht(be.key,Xe,`${tt} stop domain type must match previous stop domain type ${a}`)];if(tt!=="number"&&tt!=="string"&&tt!=="boolean")return[new Ht(be.key,Xe,"stop domain value must be a number, string, or boolean")];if(tt!=="number"&&t!=="categorical"){let Ke=`number expected, ${tt} found`;return j0(e)&&t===void 0&&(Ke+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ht(be.key,Xe,Ke)]}return t==="categorical"&&tt==="number"&&(!isFinite(Je)||Math.floor(Je)!==Je)?[new Ht(be.key,Xe,`integer expected, found ${Je}`)]:t!=="categorical"&&tt==="number"&&m!==void 0&&Je<m?[new Ht(be.key,Xe,"stop domain values must appear in ascending order")]:(m=Je,t==="categorical"&&Je in d?[new Ht(be.key,Xe,"stop domain values must be unique")]:(d[Je]=!0,[]))}function xe(be){return be.validateSpec({key:be.key,value:be.value,valueSpec:e,validateSpec:be.validateSpec,style:be.style,styleSpec:be.styleSpec})}}function _g(i){const e=(i.expressionContext==="property"?xF:gM)(Xp(i.value),i.valueSpec);if(e.result==="error")return e.value.map(a=>new Ht(`${i.key}${a.key}`,i.value,a.message));const t=e.value.expression||e.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!t.outputDefined())return[new Ht(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!yy(t))return[new Ht(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!yy(t))return[new Ht(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Ab(t,["zoom","feature-state"]))return[new Ht(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!Eb(t))return[new Ht(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function SF(i){const e=i.value,t=i.key,a=Mi(e);return a!=="boolean"?[new Ht(t,e,`boolean expected, ${a} found`)]:[]}function g1(i){const e=i.key,t=i.value,a=Mi(t);return a!=="string"?[new Ht(e,t,`color expected, ${a} found`)]:Ar.parse(String(t))?[]:[new Ht(e,t,`color expected, "${t}" found`)]}function vy(i){const e=i.key,t=i.value,a=i.valueSpec,d=[];return Array.isArray(a.values)?a.values.indexOf(Ya(t))===-1&&d.push(new Ht(e,t,`expected one of [${a.values.join(", ")}], ${JSON.stringify(t)} found`)):Object.keys(a.values).indexOf(Ya(t))===-1&&d.push(new Ht(e,t,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(t)} found`)),d}function Qw(i){return _M(Xp(i.value))?_g(z0({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):bM(i)}function bM(i){const e=i.value,t=i.key;if(Mi(e)!=="array")return[new Ht(t,e,`array expected, ${Mi(e)} found`)];const a=i.styleSpec;let d,m=[];if(e.length<1)return[new Ht(t,e,"filter array must have at least 1 element")];switch(m=m.concat(vy({key:`${t}[0]`,value:e[0],valueSpec:a.filter_operator,style:i.style,styleSpec:i.styleSpec})),Ya(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Ya(e[1])==="$type"&&m.push(new Ht(t,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&m.push(new Ht(t,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(d=Mi(e[1]),d!=="string"&&m.push(new Ht(`${t}[1]`,e[1],`string expected, ${d} found`)));for(let _=2;_<e.length;_++)d=Mi(e[_]),Ya(e[1])==="$type"?m=m.concat(vy({key:`${t}[${_}]`,value:e[_],valueSpec:a.geometry_type,style:i.style,styleSpec:i.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&m.push(new Ht(`${t}[${_}]`,e[_],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let _=1;_<e.length;_++)m=m.concat(bM({key:`${t}[${_}]`,value:e[_],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":d=Mi(e[1]),e.length!==2?m.push(new Ht(t,e,`filter array for "${e[0]}" operator must have 2 elements`)):d!=="string"&&m.push(new Ht(`${t}[1]`,e[1],`string expected, ${d} found`));break}return m}function xM(i,e){const t=i.key,a=i.validateSpec,d=i.style,m=i.styleSpec,_=i.value,c=i.objectKey,C=m[`${e}_${i.layerType}`];if(!C)return[];const k=c.match(/^(.*)-transition$/);if(e==="paint"&&k&&C[k[1]]&&C[k[1]].transition)return a({key:t,value:_,valueSpec:m.transition,style:d,styleSpec:m});const V=i.valueSpec||C[c];if(!V)return[new Ht(t,_,`unknown property "${c}"`)];let G;if(Mi(_)==="string"&&j0(V)&&!V.tokens&&(G=/^{([^}]+)}$/.exec(_)))return[new Ht(t,_,`"${c}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(G[1])} }\`.`)];const ee=[];return i.layerType==="symbol"&&(c==="text-field"&&d&&!d.glyphs&&ee.push(new Ht(t,_,'use of "text-field" requires a style "glyphs" property')),c==="text-font"&&Xw(Xp(_))&&Ya(_.type)==="identity"&&ee.push(new Ht(t,_,'"text-font" does not support identity functions'))),ee.concat(a({key:i.key,value:_,valueSpec:V,style:d,styleSpec:m,expressionContext:"property",propertyType:e,propertyKey:c}))}function wM(i){return xM(i,"paint")}function TM(i){return xM(i,"layout")}function SM(i){let e=[];const t=i.value,a=i.key,d=i.style,m=i.styleSpec;if(Mi(t)!=="object")return[new Ht(a,t,`object expected, ${Mi(t)} found`)];!t.type&&!t.ref&&e.push(new Ht(a,t,'either "type" or "ref" is required'));let _=Ya(t.type);const c=Ya(t.ref);if(t.id){const C=Ya(t.id);for(let k=0;k<i.arrayIndex;k++){const V=d.layers[k];Ya(V.id)===C&&e.push(new Ht(a,t.id,`duplicate layer id "${t.id}", previously used at line ${V.id.__line__}`))}}if("ref"in t){["type","source","source-layer","filter","layout"].forEach(k=>{k in t&&e.push(new Ht(a,t[k],`"${k}" is prohibited for ref layers`))});let C;d.layers.forEach(k=>{Ya(k.id)===c&&(C=k)}),C?C.ref?e.push(new Ht(a,t.ref,"ref cannot reference another ref layer")):_=Ya(C.type):e.push(new Ht(a,t.ref,`ref layer "${c}" not found`))}else if(_!=="background")if(!t.source)e.push(new Ht(a,t,'missing required property "source"'));else{const C=d.sources&&d.sources[t.source],k=C&&Ya(C.type);C?k==="vector"&&_==="raster"?e.push(new Ht(a,t.source,`layer "${t.id}" requires a raster source`)):k!=="raster-dem"&&_==="hillshade"?e.push(new Ht(a,t.source,`layer "${t.id}" requires a raster-dem source`)):k!=="raster-dem"&&_==="color-relief"?e.push(new Ht(a,t.source,`layer "${t.id}" requires a raster-dem source`)):k==="raster"&&_!=="raster"?e.push(new Ht(a,t.source,`layer "${t.id}" requires a vector source`)):k==="vector"&&!t["source-layer"]?e.push(new Ht(a,t,`layer "${t.id}" must specify a "source-layer"`)):k==="raster-dem"&&_!=="hillshade"&&_!=="color-relief"?e.push(new Ht(a,t.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):_==="line"&&t.paint&&t.paint["line-gradient"]&&(k!=="geojson"||!C.lineMetrics)&&e.push(new Ht(a,t,`layer "${t.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Ht(a,t.source,`source "${t.source}" not found`))}return e=e.concat(Cc({key:a,value:t,valueSpec:m.layer,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,objectElementValidators:{"*"(){return[]},type(){return i.validateSpec({key:`${a}.type`,value:t.type,valueSpec:m.layer.type,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,object:t,objectKey:"type"})},filter:Qw,layout(C){return Cc({layer:t,key:C.key,value:C.value,style:C.style,styleSpec:C.styleSpec,validateSpec:C.validateSpec,objectElementValidators:{"*"(k){return TM(z0({layerType:_},k))}}})},paint(C){return Cc({layer:t,key:C.key,value:C.value,style:C.style,styleSpec:C.styleSpec,validateSpec:C.validateSpec,objectElementValidators:{"*"(k){return wM(z0({layerType:_},k))}}})}}})),e}function Kp(i){const e=i.value,t=i.key,a=Mi(e);return a!=="string"?[new Ht(t,e,`string expected, ${a} found`)]:[]}function EF(i){var e;const t=(e=i.sourceName)!==null&&e!==void 0?e:"",a=i.value,d=i.styleSpec,m=d.source_raster_dem,_=i.style;let c=[];const C=Mi(a);if(a===void 0)return c;if(C!=="object")return c.push(new Ht("source_raster_dem",a,`object expected, ${C} found`)),c;const k=Ya(a.encoding)==="custom",V=["redFactor","greenFactor","blueFactor","baseShift"],G=i.value.encoding?`"${i.value.encoding}"`:"Default";for(const ee in a)!k&&V.includes(ee)?c.push(new Ht(ee,a[ee],`In "${t}": "${ee}" is only valid when "encoding" is set to "custom". ${G} encoding found`)):m[ee]?c=c.concat(i.validateSpec({key:ee,value:a[ee],valueSpec:m[ee],validateSpec:i.validateSpec,style:_,styleSpec:d})):c.push(new Ht(ee,a[ee],`unknown property "${ee}"`));return c}const qS={promoteId:AF};function EM(i){const e=i.value,t=i.key,a=i.styleSpec,d=i.style,m=i.validateSpec;if(!e.type)return[new Ht(t,e,'"type" is required')];const _=Ya(e.type);let c;switch(_){case"vector":case"raster":return c=Cc({key:t,value:e,valueSpec:a[`source_${_.replace("-","_")}`],style:i.style,styleSpec:a,objectElementValidators:qS,validateSpec:m}),c;case"raster-dem":return c=EF({sourceName:t,value:e,style:i.style,styleSpec:a,validateSpec:m}),c;case"geojson":if(c=Cc({key:t,value:e,valueSpec:a.source_geojson,style:d,styleSpec:a,validateSpec:m,objectElementValidators:qS}),e.cluster)for(const C in e.clusterProperties){const[k,V]=e.clusterProperties[C],G=typeof k=="string"?[k,["accumulated"],["get",C]]:k;c.push(..._g({key:`${t}.${C}.map`,value:V,expressionContext:"cluster-map"})),c.push(..._g({key:`${t}.${C}.reduce`,value:G,expressionContext:"cluster-reduce"}))}return c;case"video":return Cc({key:t,value:e,valueSpec:a.source_video,style:d,validateSpec:m,styleSpec:a});case"image":return Cc({key:t,value:e,valueSpec:a.source_image,style:d,validateSpec:m,styleSpec:a});case"canvas":return[new Ht(t,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return vy({key:`${t}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function AF({key:i,value:e}){if(Mi(e)==="string")return Kp({key:i,value:e});{const t=[];for(const a in e)t.push(...Kp({key:`${i}.${a}`,value:e[a]}));return t}}function AM(i){const e=i.value,t=i.styleSpec,a=t.light,d=i.style;let m=[];const _=Mi(e);if(e===void 0)return m;if(_!=="object")return m=m.concat([new Ht("light",e,`object expected, ${_} found`)]),m;for(const c in e){const C=c.match(/^(.*)-transition$/);C&&a[C[1]]&&a[C[1]].transition?m=m.concat(i.validateSpec({key:c,value:e[c],valueSpec:t.transition,validateSpec:i.validateSpec,style:d,styleSpec:t})):a[c]?m=m.concat(i.validateSpec({key:c,value:e[c],valueSpec:a[c],validateSpec:i.validateSpec,style:d,styleSpec:t})):m=m.concat([new Ht(c,e[c],`unknown property "${c}"`)])}return m}function CM(i){const e=i.value,t=i.styleSpec,a=t.sky,d=i.style,m=Mi(e);if(e===void 0)return[];if(m!=="object")return[new Ht("sky",e,`object expected, ${m} found`)];let _=[];for(const c in e)a[c]?_=_.concat(i.validateSpec({key:c,value:e[c],valueSpec:a[c],style:d,styleSpec:t})):_=_.concat([new Ht(c,e[c],`unknown property "${c}"`)]);return _}function IM(i){const e=i.value,t=i.styleSpec,a=t.terrain,d=i.style;let m=[];const _=Mi(e);if(e===void 0)return m;if(_!=="object")return m=m.concat([new Ht("terrain",e,`object expected, ${_} found`)]),m;for(const c in e)a[c]?m=m.concat(i.validateSpec({key:c,value:e[c],valueSpec:a[c],validateSpec:i.validateSpec,style:d,styleSpec:t})):m=m.concat([new Ht(c,e[c],`unknown property "${c}"`)]);return m}function CF(i){return Kp(i).length===0?[]:_g(i)}function IF(i){return Kp(i).length===0?[]:_g(i)}function MF(i){const e=i.key,t=i.value;if(Mi(t)==="array"){if(t.length<1||t.length>4)return[new Ht(e,t,`padding requires 1 to 4 values; ${t.length} values found`)];const a={type:"number"};let d=[];for(let m=0;m<t.length;m++)d=d.concat(i.validateSpec({key:`${e}[${m}]`,value:t[m],validateSpec:i.validateSpec,valueSpec:a}));return d}else return Cb({key:e,value:t,valueSpec:{}})}function PF(i){const e=i.key,t=i.value;if(Mi(t)==="array"){const a={type:"number"};if(t.length<1)return[new Ht(e,t,"array length at least 1 expected, length 0 found")];let d=[];for(let m=0;m<t.length;m++)d=d.concat(i.validateSpec({key:`${e}[${m}]`,value:t[m],validateSpec:i.validateSpec,valueSpec:a}));return d}else return Cb({key:e,value:t,valueSpec:{}})}function RF(i){const e=i.key,t=i.value;if(Mi(t)==="array"){if(t.length<1)return[new Ht(e,t,"array length at least 1 expected, length 0 found")];let a=[];for(let d=0;d<t.length;d++)a=a.concat(g1({key:`${e}[${d}]`,value:t[d]}));return a}else return g1({key:e,value:t})}function LF(i){const e=i.key,t=i.value,a=Mi(t),d=i.styleSpec;if(a!=="array"||t.length<1||t.length%2!==0)return[new Ht(e,t,"variableAnchorOffsetCollection requires a non-empty array of even length")];let m=[];for(let _=0;_<t.length;_+=2)m=m.concat(vy({key:`${e}[${_}]`,value:t[_],valueSpec:d.layout_symbol["text-anchor"]})),m=m.concat(Yw({key:`${e}[${_+1}]`,value:t[_+1],valueSpec:{length:2,value:"number"},validateSpec:i.validateSpec,style:i.style,styleSpec:d}));return m}function MM(i){let e=[];const t=i.value,a=i.key;if(Array.isArray(t)){const d=[],m=[];for(const _ in t){t[_].id&&d.includes(t[_].id)&&e.push(new Ht(a,t,`all the sprites' ids must be unique, but ${t[_].id} is duplicated`)),d.push(t[_].id),t[_].url&&m.includes(t[_].url)&&e.push(new Ht(a,t,`all the sprites' URLs must be unique, but ${t[_].url} is duplicated`)),m.push(t[_].url);const c={id:{type:"string",required:!0},url:{type:"string",required:!0}};e=e.concat(Cc({key:`${a}[${_}]`,value:t[_],valueSpec:c,validateSpec:i.validateSpec}))}return e}else return Kp({key:a,value:t})}function kF(i){const e=i.value,t=i.styleSpec,a=t.projection,d=i.style,m=Mi(e);if(e===void 0)return[];if(m!=="object")return[new Ht("projection",e,`object expected, ${m} found`)];let _=[];for(const c in e)a[c]?_=_.concat(i.validateSpec({key:c,value:e[c],valueSpec:a[c],style:d,styleSpec:t})):_=_.concat([new Ht(c,e[c],`unknown property "${c}"`)]);return _}function DF(i){const e=i.key;let t=i.value;t=t instanceof String?t.valueOf():t;const a=Mi(t);return a==="array"&&!OF(t)&&!zF(t)?[new Ht(e,t,`projection expected, invalid array ${JSON.stringify(t)} found`)]:["array","string"].includes(a)?[]:[new Ht(e,t,`projection expected, invalid type "${a}" found`)]}function zF(i){return!!["interpolate","step","literal"].includes(i[0])}function OF(i){return Array.isArray(i)&&i.length===3&&typeof i[0]=="string"&&typeof i[1]=="string"&&typeof i[2]=="number"}function NF(i){return!!i&&i.constructor===Object}function PM(i){return NF(i.value)?[]:[new Ht(i.key,i.value,`object expected, ${Mi(i.value)} found`)]}const $S={"*"(){return[]},array:Yw,boolean:SF,number:Cb,color:g1,constants:yM,enum:vy,filter:Qw,function:vM,layer:SM,object:Cc,source:EM,light:AM,sky:CM,terrain:IM,projection:kF,projectionDefinition:DF,string:Kp,formatted:CF,resolvedImage:IF,padding:MF,numberArray:PF,colorArray:RF,variableAnchorOffsetCollection:LF,sprite:MM,state:PM};function q0(i){const e=i.value,t=i.valueSpec,a=i.styleSpec;return i.validateSpec=q0,t.expression&&Xw(Ya(e))?vM(i):t.expression&&mM(Xp(e))?_g(i):t.type&&$S[t.type]?$S[t.type](i):Cc(z0({},i,{valueSpec:t.type?a[t.type]:t}))}function RM(i){const e=i.value,t=i.key,a=Kp(i);return a.length||(e.indexOf("{fontstack}")===-1&&a.push(new Ht(t,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&a.push(new Ht(t,e,'"glyphs" url must include a "{range}" token'))),a}function Fu(i,e=hB){let t=[];return t=t.concat(q0({key:"",value:i,valueSpec:e.$root,styleSpec:e,style:i,validateSpec:q0,objectElementValidators:{glyphs:RM,"*"(){return[]}}})),i.constants&&(t=t.concat(yM({key:"constants",value:i.constants}))),LM(t)}Fu.source=ch(uh(EM));Fu.sprite=ch(uh(MM));Fu.glyphs=ch(uh(RM));Fu.light=ch(uh(AM));Fu.sky=ch(uh(CM));Fu.terrain=ch(uh(IM));Fu.state=ch(uh(PM));Fu.layer=ch(uh(SM));Fu.filter=ch(uh(Qw));Fu.paintProperty=ch(uh(wM));Fu.layoutProperty=ch(uh(TM));function uh(i){return function(e){return i({...e,validateSpec:q0})}}function LM(i){return[].concat(i).sort((e,t)=>e.line-t.line)}function ch(i){return function(...e){return LM(i.apply(this,e))}}function GS(i){if(!i)return{style:Q_[Y_[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0};if(typeof i=="string"){const e=FF(i);return e.isValidStyle?{style:e.styleObject,requiresUrlMonitoring:!1,isFallback:!1}:e.isValidJSON?{style:Q_[Y_[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0}:i.startsWith("http")?{style:i,requiresUrlMonitoring:!0,isFallback:!1}:i.toLowerCase().includes(".json")?{style:BF(i),requiresUrlMonitoring:!0,isFallback:!1}:{style:PI(i),requiresUrlMonitoring:!0,isFallback:!1}}return i instanceof RI?{style:i.getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!1}:i instanceof LI?{style:i.getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!1}:Fu(i).length===0?{style:i,requiresUrlMonitoring:!1,isFallback:!1}:{style:Q_[Y_[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0}}function BF(i){try{return new URL(i).href}catch{}return new URL(i,location.origin).href}function FF(i){try{const e=JSON.parse(i),t=Fu(e);return{isValidJSON:!0,isValidStyle:t.length===0,styleObject:t.length===0?e:null}}catch{return{isValidJSON:!1,isValidStyle:!1,styleObject:null}}}function Bd(i,e,t){const a=window.document.createElement(i);return e!==void 0&&(a.className=e),t&&t.appendChild(a),a}function by(i){i.parentNode&&i.parentNode.removeChild(i)}class VF{constructor(){rn(this,"_map"),rn(this,"_container"),rn(this,"_terrainButton"),u6(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(e){return this._map=e,this._container=Bd("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=Bd("button","maplibregl-ctrl-terrain",this._container),Bd("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){by(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){kM(this._map),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.hasTerrain()?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))}}function kM(i){i.hasTerrain()?i.disableTerrain():i.enableTerrain()}class UF extends b6{constructor(e={}){super({showCompass:e.showCompass??!0,showZoom:e.showZoom??!0,visualizePitch:e.visualizePitch??!0}),rn(this,"_rotateCompassArrow",()=>{const t=this._map.getBearing(),a=this._map.getPitch(),d=this.options.visualizePitch?`scale(${Math.min(1.5,1/Math.cos(a*(Math.PI/180))**.5)}) rotateX(${Math.min(70,a)}deg) rotateZ(${-t}deg)`:`rotate(${-t}deg)`;this._compassIcon.style.transform=d}),this._compass&&(this._compass.removeEventListener("click",this._compass.clickFunction),this._compass.addEventListener("click",t=>{this._map.getPitch()===0?this._map.easeTo({pitch:Math.min(this._map.getMaxPitch(),80)}):this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}))}_createButton(e,t){const a=super._createButton(e,t);return a.clickFunction=t,a}}const ZS=wn.Marker,HS=wn.LngLat,jF=wn.LngLatBounds;class qF extends x6{constructor(){super(...arguments),rn(this,"lastUpdatedCenter",new HS(0,0)),rn(this,"_updateCamera",e=>{var t;const a=new HS(e.coords.longitude,e.coords.latitude),d=e.coords.accuracy,m={bearing:this._map.getBearing(),...this.options.fitBoundsOptions,linear:!0},_=this._map.getZoom();_>(((t=this.options.fitBoundsOptions)==null?void 0:t.maxZoom)??30)&&(m.zoom=_),this._map.fitBounds(jF.fromLngLat(a,d),m,{geolocateSource:!0});let c=!1;const C=()=>{c=!0};this._map.once("click",C),this._map.once("dblclick",C),this._map.once("dragstart",C),this._map.once("mousedown",C),this._map.once("touchstart",C),this._map.once("wheel",C),this._map.once("moveend",()=>{this._map.off("click",C),this._map.off("dblclick",C),this._map.off("dragstart",C),this._map.off("mousedown",C),this._map.off("touchstart",C),this._map.off("wheel",C),!c&&(this.lastUpdatedCenter=this._map.getCenter())})}),rn(this,"_finishSetupUI",e=>{if(this._map){if(e===!1){const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Bd("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new ZS({element:this._dotElement}),this._circleElement=Bd("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ZS({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("move",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("moveend",t=>{const a=t.originalEvent&&t.originalEvent.type==="resize",d=this.lastUpdatedCenter.distanceTo(this._map.getCenter());!t.geolocateSource&&this._watchState==="ACTIVE_LOCK"&&!a&&d>1&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new Event("trackuserlocationend")))})}}),rn(this,"_onZoom",()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()})}_updateCircleRadius(){if(this._watchState!=="BACKGROUND"&&this._watchState!=="ACTIVE_LOCK")return;const e=[this._lastKnownPosition.coords.longitude,this._lastKnownPosition.coords.latitude],t=this._map.project(e),a=this._map.unproject([t.x,t.y]),d=this._map.unproject([t.x+20,t.y]),m=a.distanceTo(d)/20,_=Math.ceil(2*this._accuracy/m);this._circleElement.style.width=`${_}px`,this._circleElement.style.height=`${_}px`}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;case"BACKGROUND_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}}var Cp,Lu,Ip,Mp,U_;class $F{constructor(e,t,a){if(lu(this,Cp),lu(this,Lu),lu(this,Ip),lu(this,Mp),lu(this,U_),typeof e=="string"){const d=document.querySelector(e);if(!d)throw new Error(`No element has been found with selector "${e}" when creating an external control.`);zu(this,Lu,d)}else zu(this,Lu,e);t&&zu(this,Ip,d=>{t(An(this,Cp),An(this,Lu),d)}),a&&zu(this,Mp,d=>{a(An(this,Cp),An(this,Lu),d)}),zu(this,U_,An(this,Lu).parentElement)}onAdd(e){return zu(this,Cp,e),An(this,Ip)&&An(this,Lu).addEventListener("click",An(this,Ip)),An(this,Mp)&&An(this,Cp).on("render",An(this,Mp)),by(An(this,Lu)),An(this,Lu)}onRemove(){An(this,Ip)&&An(this,Lu).removeEventListener("click",An(this,Ip)),An(this,Mp)&&An(this,Cp).off("render",An(this,Mp)),An(this,U_)?An(this,U_).appendChild(An(this,Lu)):by(An(this,Lu))}}Cp=new WeakMap,Lu=new WeakMap,Ip=new WeakMap,Mp=new WeakMap,U_=new WeakMap;class GF{constructor(){rn(this,"map"),rn(this,"container"),rn(this,"projectionButton")}onAdd(e){return this.map=e,this.container=Bd("div","maplibregl-ctrl maplibregl-ctrl-group"),this.projectionButton=Bd("button","maplibregl-ctrl-projection",this.container),Bd("span","maplibregl-ctrl-icon",this.projectionButton).setAttribute("aria-hidden","true"),this.projectionButton.type="button",this.projectionButton.addEventListener("click",this.toggleProjection.bind(this)),e.on("projectiontransition",this.updateProjectionIcon.bind(this)),this.updateProjectionIcon(),this.container}onRemove(){by(this.container),this.map.off("projectiontransition",this.updateProjectionIcon),this.map=void 0}toggleProjection(){DM(this.map),this.updateProjectionIcon()}updateProjectionIcon(){this.projectionButton.classList.remove("maplibregl-ctrl-projection-globe"),this.projectionButton.classList.remove("maplibregl-ctrl-projection-mercator"),this.map.isGlobeProjection()?(this.projectionButton.classList.add("maplibregl-ctrl-projection-mercator"),this.projectionButton.title="Enable Mercator projection"):(this.projectionButton.classList.add("maplibregl-ctrl-projection-globe"),this.projectionButton.title="Enable Globe projection")}}function DM(i){i.getProjection()===void 0&&i.setProjection({type:"mercator"}),i.isGlobeProjection()?i.enableMercatorProjection():i.enableGlobeProjection()}const j_={"zoom-in":i=>i.zoomIn(),"zoom-out":i=>i.zoomOut(),"toggle-projection":DM,"toggle-terrain":kM,"reset-view":i=>{i.getPitch()===0?i.easeTo({pitch:Math.min(i.getMaxPitch(),80)}):i.resetNorthPitch()},"reset-bearing":i=>{i.rotateTo(0)},"reset-pitch":i=>{i.setPitch(0)},"reset-roll":i=>{i.setRoll(0)}};var o0,q_;class _1 extends $F{constructor(e,t){if(t&&!(t in j_))throw new Error(`data-maptiler-control value "${t}" is invalid.`);super(e,t&&j_[t]),lu(this,o0),lu(this,q_,new Map)}onAdd(e){return zu(this,o0,e),super.onAdd(e)}onRemove(){for(const[e,t]of An(this,q_)){const a=e.deref();a&&a.removeEventListener("click",t)}An(this,q_).clear(),super.onRemove()}configureGroupItem(e,t){if(!t)return;if(!(t in j_))throw new Error(`data-maptiler-control value "${t}" is invalid.`);const a=d=>{j_[t](An(this,o0),e,d)};e.addEventListener("click",a),An(this,q_).set(new WeakRef(e),a)}}o0=new WeakMap,q_=new WeakMap,rn(_1,"controlCallbacks",j_);var Du,zh,Pp,Rp,Tc,l0,Vl,zM,Sc,OM;class xx{constructor(e,t){lu(this,Vl),lu(this,Du),rn(this,"map"),lu(this,zh),lu(this,Pp),lu(this,Rp),lu(this,Tc,!1),lu(this,l0),e.style!==void 0&&zu(this,Tc,!0),zu(this,Du,{zoomAdjust:-4,position:"top-right",...t,forceNoAttributionControl:!0,attributionControl:!1,navigationControl:!1,geolocateControl:!1,maptilerLogo:!1,minimap:!1,hash:!1,pitchAdjust:!1,...e,containerStyle:{border:"1px solid #000",width:"400px",height:"300px",...e.containerStyle??{}}}),e.lockZoom!==void 0&&(An(this,Du).minZoom=e.lockZoom,An(this,Du).maxZoom=e.lockZoom)}setStyle(e,t){An(this,Tc)||this.map.setStyle(e,t),ku(this,Vl,Sc).call(this)}addLayer(e,t){return An(this,Tc)||this.map.addLayer(e,t),ku(this,Vl,Sc).call(this),this.map}moveLayer(e,t){return An(this,Tc)||this.map.moveLayer(e,t),ku(this,Vl,Sc).call(this),this.map}removeLayer(e){return An(this,Tc)||this.map.removeLayer(e),ku(this,Vl,Sc).call(this),this}setLayerZoomRange(e,t,a){return An(this,Tc)||this.map.setLayerZoomRange(e,t,a),ku(this,Vl,Sc).call(this),this}setFilter(e,t,a){return An(this,Tc)||this.map.setFilter(e,t,a),ku(this,Vl,Sc).call(this),this}setPaintProperty(e,t,a,d){return An(this,Tc)||this.map.setPaintProperty(e,t,a,d),ku(this,Vl,Sc).call(this),this}setLayoutProperty(e,t,a,d){return An(this,Tc)||this.map.setLayoutProperty(e,t,a,d),ku(this,Vl,Sc).call(this),this}setGlyphs(e,t){return An(this,Tc)||this.map.setGlyphs(e,t),ku(this,Vl,Sc).call(this),this}onAdd(e){zu(this,zh,e),zu(this,Pp,Bd("div","maplibregl-ctrl maplibregl-ctrl-group"));for(const[t,a]of Object.entries(An(this,Du).containerStyle))An(this,Pp).style.setProperty(t,a);return An(this,Du).container=An(this,Pp),An(this,Du).zoom=e.getZoom()+An(this,Du).zoomAdjust,this.map=new VM(An(this,Du)),this.map.once("style.load",()=>{this.map.resize()}),this.map.once("load",()=>{ku(this,Vl,zM).call(this,An(this,Du).parentRect),zu(this,l0,ku(this,Vl,OM).call(this))}),An(this,Pp)}onRemove(){var e;(e=An(this,l0))==null||e.call(this),by(An(this,Pp))}}Du=new WeakMap,zh=new WeakMap,Pp=new WeakMap,Rp=new WeakMap,Tc=new WeakMap,l0=new WeakMap,Vl=new WeakSet,zM=function(i){i===void 0||i.linePaint===void 0&&i.fillPaint===void 0||(zu(this,Rp,{type:"Feature",properties:{name:"parentRect"},geometry:{type:"Polygon",coordinates:[[[],[],[],[],[]]]}}),this.map.addSource("parentRect",{type:"geojson",data:An(this,Rp)}),(i.lineLayout!==void 0||i.linePaint!==void 0)&&this.map.addLayer({id:"parentRectOutline",type:"line",source:"parentRect",layout:{...i.lineLayout},paint:{"line-color":"#FFF","line-width":1,"line-opacity":.85,...i.linePaint}}),i.fillPaint!==void 0&&this.map.addLayer({id:"parentRectFill",type:"fill",source:"parentRect",layout:{},paint:{"fill-color":"#08F","fill-opacity":.135,...i.fillPaint}}),ku(this,Vl,Sc).call(this))},Sc=function(){if(An(this,Rp)===void 0)return;const{devicePixelRatio:i}=window,e=An(this,zh).getCanvas(),t=e.width/i,a=e.height/i,d=An(this,zh).unproject.bind(An(this,zh)),m=d([0,0]),_=d([t,0]),c=d([0,a]),C=d([t,a]);An(this,Rp).geometry.coordinates=[[c.toArray(),C.toArray(),_.toArray(),m.toArray(),c.toArray()]];const k=this.map.getSource("parentRect");k!==void 0&&k.setData(An(this,Rp))},OM=function(){const{pitchAdjust:i}=An(this,Du),e=()=>{m("parent")},t=()=>{m("minimap")},a=()=>{An(this,zh).on("move",e),this.map.on("move",t)},d=()=>{An(this,zh).off("move",e),this.map.off("move",t)},m=_=>{d();const c=_==="parent"?An(this,zh):this.map,C=_==="parent"?this.map:An(this,zh),k=c.getCenter(),V=c.getZoom()+An(this,Du).zoomAdjust*(_==="parent"?1:-1),G=c.getBearing(),ee=c.getPitch();C.jumpTo({center:k,zoom:V,bearing:G,pitch:i?ee:0}),ku(this,Vl,Sc).call(this),a()};return a(),()=>{d()}};class ZF{constructor(e,t=2e3){rn(this,"map"),rn(this,"registeredModules",new Set),rn(this,"viewerType"),this.map=e,this.viewerType="Map",setTimeout(async()=>{if(!Ka.telemetry)return;const a=this.preparePayload();try{(await fetch(a,{method:"POST"})).ok||console.warn("The metrics could not be sent to MapTiler Cloud")}catch(d){console.warn("The metrics could not be sent to MapTiler Cloud",d)}},Math.max(1e3,t))}registerModule(e,t){this.registeredModules.add(`${e}:${t}`)}registerViewerType(e="Map"){this.viewerType=e}preparePayload(){const e=new URL(Ul.telemetryURL);return e.searchParams.append("sdk",WV()),e.searchParams.append("key",Ka.apiKey),e.searchParams.append("mtsid",Rw),e.searchParams.append("session",Ka.session?"1":"0"),e.searchParams.append("caching",Ka.caching?"1":"0"),e.searchParams.append("lang-updated",this.map.isLanguageUpdated()?"1":"0"),e.searchParams.append("terrain",this.map.getTerrain()?"1":"0"),e.searchParams.append("globe",this.map.isGlobeProjection()?"1":"0"),e.searchParams.append("viewerType",this.viewerType),this.registeredModules.size>0&&e.searchParams.append("modules",Array.from(this.registeredModules).join("|")),e.href}}var xy=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var i=0,e=arguments.length;e--;)i+=arguments[e]*arguments[e];return Math.sqrt(i)});function ty(){var i=new xy(16);return xy!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i}function HF(i,e,t,a,d,m,_,c,C,k,V,G,ee,Y,xe,be,Ne){return i[0]=e,i[1]=t,i[2]=a,i[3]=d,i[4]=m,i[5]=_,i[6]=c,i[7]=C,i[8]=k,i[9]=V,i[10]=G,i[11]=ee,i[12]=Y,i[13]=xe,i[14]=be,i[15]=Ne,i}function WF(i,e,t){var a=e[0],d=e[1],m=e[2],_=e[3],c=e[4],C=e[5],k=e[6],V=e[7],G=e[8],ee=e[9],Y=e[10],xe=e[11],be=e[12],Ne=e[13],tt=e[14],Je=e[15],Xe=t[0],Ke=t[1],Ge=t[2],Fe=t[3];return i[0]=Xe*a+Ke*c+Ge*G+Fe*be,i[1]=Xe*d+Ke*C+Ge*ee+Fe*Ne,i[2]=Xe*m+Ke*k+Ge*Y+Fe*tt,i[3]=Xe*_+Ke*V+Ge*xe+Fe*Je,Xe=t[4],Ke=t[5],Ge=t[6],Fe=t[7],i[4]=Xe*a+Ke*c+Ge*G+Fe*be,i[5]=Xe*d+Ke*C+Ge*ee+Fe*Ne,i[6]=Xe*m+Ke*k+Ge*Y+Fe*tt,i[7]=Xe*_+Ke*V+Ge*xe+Fe*Je,Xe=t[8],Ke=t[9],Ge=t[10],Fe=t[11],i[8]=Xe*a+Ke*c+Ge*G+Fe*be,i[9]=Xe*d+Ke*C+Ge*ee+Fe*Ne,i[10]=Xe*m+Ke*k+Ge*Y+Fe*tt,i[11]=Xe*_+Ke*V+Ge*xe+Fe*Je,Xe=t[12],Ke=t[13],Ge=t[14],Fe=t[15],i[12]=Xe*a+Ke*c+Ge*G+Fe*be,i[13]=Xe*d+Ke*C+Ge*ee+Fe*Ne,i[14]=Xe*m+Ke*k+Ge*Y+Fe*tt,i[15]=Xe*_+Ke*V+Ge*xe+Fe*Je,i}function XF(i,e,t){var a=t[0],d=t[1],m=t[2];return i[0]=e[0]*a,i[1]=e[1]*a,i[2]=e[2]*a,i[3]=e[3]*a,i[4]=e[4]*d,i[5]=e[5]*d,i[6]=e[6]*d,i[7]=e[7]*d,i[8]=e[8]*m,i[9]=e[9]*m,i[10]=e[10]*m,i[11]=e[11]*m,i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i}function WS(i,e,t){var a=Math.sin(t),d=Math.cos(t),m=e[4],_=e[5],c=e[6],C=e[7],k=e[8],V=e[9],G=e[10],ee=e[11];return e!==i&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[4]=m*d+k*a,i[5]=_*d+V*a,i[6]=c*d+G*a,i[7]=C*d+ee*a,i[8]=k*d-m*a,i[9]=V*d-_*a,i[10]=G*d-c*a,i[11]=ee*d-C*a,i}function KF(i,e,t){var a=Math.sin(t),d=Math.cos(t),m=e[0],_=e[1],c=e[2],C=e[3],k=e[8],V=e[9],G=e[10],ee=e[11];return e!==i&&(i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=m*d-k*a,i[1]=_*d-V*a,i[2]=c*d-G*a,i[3]=C*d-ee*a,i[8]=m*a+k*d,i[9]=_*a+V*d,i[10]=c*a+G*d,i[11]=C*a+ee*d,i}function XS(i,e,t){var a=Math.sin(t),d=Math.cos(t),m=e[0],_=e[1],c=e[2],C=e[3],k=e[4],V=e[5],G=e[6],ee=e[7];return e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=m*d+k*a,i[1]=_*d+V*a,i[2]=c*d+G*a,i[3]=C*d+ee*a,i[4]=k*d-m*a,i[5]=V*d-_*a,i[6]=G*d-c*a,i[7]=ee*d-C*a,i}function YF(i,e,t,a,d){var m=1/Math.tan(e/2),_;return i[0]=m/t,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=m,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,d!=null&&d!==1/0?(_=1/(a-d),i[10]=(d+a)*_,i[14]=2*d*a*_):(i[10]=-1,i[14]=-2*a),i}var QF=YF;function u0(){var i=new xy(3);return xy!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function JF(i,e,t){var a=new xy(3);return a[0]=i,a[1]=e,a[2]=t,a}function wx(i,e){var t=e[0],a=e[1],d=e[2],m=t*t+a*a+d*d;return m>0&&(m=1/Math.sqrt(m)),i[0]=e[0]*m,i[1]=e[1]*m,i[2]=e[2]*m,i}function KS(i,e,t){var a=e[0],d=e[1],m=e[2],_=t[0],c=t[1],C=t[2];return i[0]=d*C-m*c,i[1]=m*_-a*C,i[2]=a*c-d*_,i}(function(){var i=u0();return function(e,t,a,d,m,_){var c,C;for(t||(t=3),a||(a=0),d?C=Math.min(d*t+a,e.length):C=e.length,c=a;c<C;c+=t)i[0]=e[c],i[1]=e[c+1],i[2]=e[c+2],m(i,i,_),e[c]=i[0],e[c+1]=i[1],e[c+2]=i[2];return e}})();function eV(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var YS,QS;function tV(){return QS||(QS=1,YS={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),YS}var Tx,JS;function NM(){if(JS)return Tx;JS=1;const i=tV(),e={};for(const d of Object.keys(i))e[i[d]]=d;const t={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};Tx=t;for(const d of Object.keys(t)){if(!("channels"in t[d]))throw new Error("missing channels property: "+d);if(!("labels"in t[d]))throw new Error("missing channel labels property: "+d);if(t[d].labels.length!==t[d].channels)throw new Error("channel and label counts mismatch: "+d);const{channels:m,labels:_}=t[d];delete t[d].channels,delete t[d].labels,Object.defineProperty(t[d],"channels",{value:m}),Object.defineProperty(t[d],"labels",{value:_})}t.rgb.hsl=function(d){const m=d[0]/255,_=d[1]/255,c=d[2]/255,C=Math.min(m,_,c),k=Math.max(m,_,c),V=k-C;let G,ee;k===C?G=0:m===k?G=(_-c)/V:_===k?G=2+(c-m)/V:c===k&&(G=4+(m-_)/V),G=Math.min(G*60,360),G<0&&(G+=360);const Y=(C+k)/2;return k===C?ee=0:Y<=.5?ee=V/(k+C):ee=V/(2-k-C),[G,ee*100,Y*100]},t.rgb.hsv=function(d){let m,_,c,C,k;const V=d[0]/255,G=d[1]/255,ee=d[2]/255,Y=Math.max(V,G,ee),xe=Y-Math.min(V,G,ee),be=function(Ne){return(Y-Ne)/6/xe+1/2};return xe===0?(C=0,k=0):(k=xe/Y,m=be(V),_=be(G),c=be(ee),V===Y?C=c-_:G===Y?C=1/3+m-c:ee===Y&&(C=2/3+_-m),C<0?C+=1:C>1&&(C-=1)),[C*360,k*100,Y*100]},t.rgb.hwb=function(d){const m=d[0],_=d[1];let c=d[2];const C=t.rgb.hsl(d)[0],k=1/255*Math.min(m,Math.min(_,c));return c=1-1/255*Math.max(m,Math.max(_,c)),[C,k*100,c*100]},t.rgb.cmyk=function(d){const m=d[0]/255,_=d[1]/255,c=d[2]/255,C=Math.min(1-m,1-_,1-c),k=(1-m-C)/(1-C)||0,V=(1-_-C)/(1-C)||0,G=(1-c-C)/(1-C)||0;return[k*100,V*100,G*100,C*100]};function a(d,m){return(d[0]-m[0])**2+(d[1]-m[1])**2+(d[2]-m[2])**2}return t.rgb.keyword=function(d){const m=e[d];if(m)return m;let _=1/0,c;for(const C of Object.keys(i)){const k=i[C],V=a(d,k);V<_&&(_=V,c=C)}return c},t.keyword.rgb=function(d){return i[d]},t.rgb.xyz=function(d){let m=d[0]/255,_=d[1]/255,c=d[2]/255;m=m>.04045?((m+.055)/1.055)**2.4:m/12.92,_=_>.04045?((_+.055)/1.055)**2.4:_/12.92,c=c>.04045?((c+.055)/1.055)**2.4:c/12.92;const C=m*.4124+_*.3576+c*.1805,k=m*.2126+_*.7152+c*.0722,V=m*.0193+_*.1192+c*.9505;return[C*100,k*100,V*100]},t.rgb.lab=function(d){const m=t.rgb.xyz(d);let _=m[0],c=m[1],C=m[2];_/=95.047,c/=100,C/=108.883,_=_>.008856?_**(1/3):7.787*_+16/116,c=c>.008856?c**(1/3):7.787*c+16/116,C=C>.008856?C**(1/3):7.787*C+16/116;const k=116*c-16,V=500*(_-c),G=200*(c-C);return[k,V,G]},t.hsl.rgb=function(d){const m=d[0]/360,_=d[1]/100,c=d[2]/100;let C,k,V;if(_===0)return V=c*255,[V,V,V];c<.5?C=c*(1+_):C=c+_-c*_;const G=2*c-C,ee=[0,0,0];for(let Y=0;Y<3;Y++)k=m+1/3*-(Y-1),k<0&&k++,k>1&&k--,6*k<1?V=G+(C-G)*6*k:2*k<1?V=C:3*k<2?V=G+(C-G)*(2/3-k)*6:V=G,ee[Y]=V*255;return ee},t.hsl.hsv=function(d){const m=d[0];let _=d[1]/100,c=d[2]/100,C=_;const k=Math.max(c,.01);c*=2,_*=c<=1?c:2-c,C*=k<=1?k:2-k;const V=(c+_)/2,G=c===0?2*C/(k+C):2*_/(c+_);return[m,G*100,V*100]},t.hsv.rgb=function(d){const m=d[0]/60,_=d[1]/100;let c=d[2]/100;const C=Math.floor(m)%6,k=m-Math.floor(m),V=255*c*(1-_),G=255*c*(1-_*k),ee=255*c*(1-_*(1-k));switch(c*=255,C){case 0:return[c,ee,V];case 1:return[G,c,V];case 2:return[V,c,ee];case 3:return[V,G,c];case 4:return[ee,V,c];case 5:return[c,V,G]}},t.hsv.hsl=function(d){const m=d[0],_=d[1]/100,c=d[2]/100,C=Math.max(c,.01);let k,V;V=(2-_)*c;const G=(2-_)*C;return k=_*C,k/=G<=1?G:2-G,k=k||0,V/=2,[m,k*100,V*100]},t.hwb.rgb=function(d){const m=d[0]/360;let _=d[1]/100,c=d[2]/100;const C=_+c;let k;C>1&&(_/=C,c/=C);const V=Math.floor(6*m),G=1-c;k=6*m-V,V&1&&(k=1-k);const ee=_+k*(G-_);let Y,xe,be;switch(V){default:case 6:case 0:Y=G,xe=ee,be=_;break;case 1:Y=ee,xe=G,be=_;break;case 2:Y=_,xe=G,be=ee;break;case 3:Y=_,xe=ee,be=G;break;case 4:Y=ee,xe=_,be=G;break;case 5:Y=G,xe=_,be=ee;break}return[Y*255,xe*255,be*255]},t.cmyk.rgb=function(d){const m=d[0]/100,_=d[1]/100,c=d[2]/100,C=d[3]/100,k=1-Math.min(1,m*(1-C)+C),V=1-Math.min(1,_*(1-C)+C),G=1-Math.min(1,c*(1-C)+C);return[k*255,V*255,G*255]},t.xyz.rgb=function(d){const m=d[0]/100,_=d[1]/100,c=d[2]/100;let C,k,V;return C=m*3.2406+_*-1.5372+c*-.4986,k=m*-.9689+_*1.8758+c*.0415,V=m*.0557+_*-.204+c*1.057,C=C>.0031308?1.055*C**(1/2.4)-.055:C*12.92,k=k>.0031308?1.055*k**(1/2.4)-.055:k*12.92,V=V>.0031308?1.055*V**(1/2.4)-.055:V*12.92,C=Math.min(Math.max(0,C),1),k=Math.min(Math.max(0,k),1),V=Math.min(Math.max(0,V),1),[C*255,k*255,V*255]},t.xyz.lab=function(d){let m=d[0],_=d[1],c=d[2];m/=95.047,_/=100,c/=108.883,m=m>.008856?m**(1/3):7.787*m+16/116,_=_>.008856?_**(1/3):7.787*_+16/116,c=c>.008856?c**(1/3):7.787*c+16/116;const C=116*_-16,k=500*(m-_),V=200*(_-c);return[C,k,V]},t.lab.xyz=function(d){const m=d[0],_=d[1],c=d[2];let C,k,V;k=(m+16)/116,C=_/500+k,V=k-c/200;const G=k**3,ee=C**3,Y=V**3;return k=G>.008856?G:(k-16/116)/7.787,C=ee>.008856?ee:(C-16/116)/7.787,V=Y>.008856?Y:(V-16/116)/7.787,C*=95.047,k*=100,V*=108.883,[C,k,V]},t.lab.lch=function(d){const m=d[0],_=d[1],c=d[2];let C;C=Math.atan2(c,_)*360/2/Math.PI,C<0&&(C+=360);const k=Math.sqrt(_*_+c*c);return[m,k,C]},t.lch.lab=function(d){const m=d[0],_=d[1],c=d[2]/360*2*Math.PI,C=_*Math.cos(c),k=_*Math.sin(c);return[m,C,k]},t.rgb.ansi16=function(d,m=null){const[_,c,C]=d;let k=m===null?t.rgb.hsv(d)[2]:m;if(k=Math.round(k/50),k===0)return 30;let V=30+(Math.round(C/255)<<2|Math.round(c/255)<<1|Math.round(_/255));return k===2&&(V+=60),V},t.hsv.ansi16=function(d){return t.rgb.ansi16(t.hsv.rgb(d),d[2])},t.rgb.ansi256=function(d){const m=d[0],_=d[1],c=d[2];return m===_&&_===c?m<8?16:m>248?231:Math.round((m-8)/247*24)+232:16+36*Math.round(m/255*5)+6*Math.round(_/255*5)+Math.round(c/255*5)},t.ansi16.rgb=function(d){let m=d%10;if(m===0||m===7)return d>50&&(m+=3.5),m=m/10.5*255,[m,m,m];const _=(~~(d>50)+1)*.5,c=(m&1)*_*255,C=(m>>1&1)*_*255,k=(m>>2&1)*_*255;return[c,C,k]},t.ansi256.rgb=function(d){if(d>=232){const k=(d-232)*10+8;return[k,k,k]}d-=16;let m;const _=Math.floor(d/36)/5*255,c=Math.floor((m=d%36)/6)/5*255,C=m%6/5*255;return[_,c,C]},t.rgb.hex=function(d){const m=(((Math.round(d[0])&255)<<16)+((Math.round(d[1])&255)<<8)+(Math.round(d[2])&255)).toString(16).toUpperCase();return"000000".substring(m.length)+m},t.hex.rgb=function(d){const m=d.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!m)return[0,0,0];let _=m[0];m[0].length===3&&(_=_.split("").map(G=>G+G).join(""));const c=parseInt(_,16),C=c>>16&255,k=c>>8&255,V=c&255;return[C,k,V]},t.rgb.hcg=function(d){const m=d[0]/255,_=d[1]/255,c=d[2]/255,C=Math.max(Math.max(m,_),c),k=Math.min(Math.min(m,_),c),V=C-k;let G,ee;return V<1?G=k/(1-V):G=0,V<=0?ee=0:C===m?ee=(_-c)/V%6:C===_?ee=2+(c-m)/V:ee=4+(m-_)/V,ee/=6,ee%=1,[ee*360,V*100,G*100]},t.hsl.hcg=function(d){const m=d[1]/100,_=d[2]/100,c=_<.5?2*m*_:2*m*(1-_);let C=0;return c<1&&(C=(_-.5*c)/(1-c)),[d[0],c*100,C*100]},t.hsv.hcg=function(d){const m=d[1]/100,_=d[2]/100,c=m*_;let C=0;return c<1&&(C=(_-c)/(1-c)),[d[0],c*100,C*100]},t.hcg.rgb=function(d){const m=d[0]/360,_=d[1]/100,c=d[2]/100;if(_===0)return[c*255,c*255,c*255];const C=[0,0,0],k=m%1*6,V=k%1,G=1-V;let ee=0;switch(Math.floor(k)){case 0:C[0]=1,C[1]=V,C[2]=0;break;case 1:C[0]=G,C[1]=1,C[2]=0;break;case 2:C[0]=0,C[1]=1,C[2]=V;break;case 3:C[0]=0,C[1]=G,C[2]=1;break;case 4:C[0]=V,C[1]=0,C[2]=1;break;default:C[0]=1,C[1]=0,C[2]=G}return ee=(1-_)*c,[(_*C[0]+ee)*255,(_*C[1]+ee)*255,(_*C[2]+ee)*255]},t.hcg.hsv=function(d){const m=d[1]/100,_=d[2]/100,c=m+_*(1-m);let C=0;return c>0&&(C=m/c),[d[0],C*100,c*100]},t.hcg.hsl=function(d){const m=d[1]/100,_=d[2]/100*(1-m)+.5*m;let c=0;return _>0&&_<.5?c=m/(2*_):_>=.5&&_<1&&(c=m/(2*(1-_))),[d[0],c*100,_*100]},t.hcg.hwb=function(d){const m=d[1]/100,_=d[2]/100,c=m+_*(1-m);return[d[0],(c-m)*100,(1-c)*100]},t.hwb.hcg=function(d){const m=d[1]/100,_=1-d[2]/100,c=_-m;let C=0;return c<1&&(C=(_-c)/(1-c)),[d[0],c*100,C*100]},t.apple.rgb=function(d){return[d[0]/65535*255,d[1]/65535*255,d[2]/65535*255]},t.rgb.apple=function(d){return[d[0]/255*65535,d[1]/255*65535,d[2]/255*65535]},t.gray.rgb=function(d){return[d[0]/100*255,d[0]/100*255,d[0]/100*255]},t.gray.hsl=function(d){return[0,0,d[0]]},t.gray.hsv=t.gray.hsl,t.gray.hwb=function(d){return[0,100,d[0]]},t.gray.cmyk=function(d){return[0,0,0,d[0]]},t.gray.lab=function(d){return[d[0],0,0]},t.gray.hex=function(d){const m=Math.round(d[0]/100*255)&255,_=((m<<16)+(m<<8)+m).toString(16).toUpperCase();return"000000".substring(_.length)+_},t.rgb.gray=function(d){return[(d[0]+d[1]+d[2])/3/255*100]},Tx}var Sx,eE;function nV(){if(eE)return Sx;eE=1;const i=NM();function e(){const m={},_=Object.keys(i);for(let c=_.length,C=0;C<c;C++)m[_[C]]={distance:-1,parent:null};return m}function t(m){const _=e(),c=[m];for(_[m].distance=0;c.length;){const C=c.pop(),k=Object.keys(i[C]);for(let V=k.length,G=0;G<V;G++){const ee=k[G],Y=_[ee];Y.distance===-1&&(Y.distance=_[C].distance+1,Y.parent=C,c.unshift(ee))}}return _}function a(m,_){return function(c){return _(m(c))}}function d(m,_){const c=[_[m].parent,m];let C=i[_[m].parent][m],k=_[m].parent;for(;_[k].parent;)c.unshift(_[k].parent),C=a(i[_[k].parent][k],C),k=_[k].parent;return C.conversion=c,C}return Sx=function(m){const _=t(m),c={},C=Object.keys(_);for(let k=C.length,V=0;V<k;V++){const G=C[V];_[G].parent!==null&&(c[G]=d(G,_))}return c},Sx}var Ex,tE;function iV(){if(tE)return Ex;tE=1;const i=NM(),e=nV(),t={},a=Object.keys(i);function d(_){const c=function(...C){const k=C[0];return k==null?k:(k.length>1&&(C=k),_(C))};return"conversion"in _&&(c.conversion=_.conversion),c}function m(_){const c=function(...C){const k=C[0];if(k==null)return k;k.length>1&&(C=k);const V=_(C);if(typeof V=="object")for(let G=V.length,ee=0;ee<G;ee++)V[ee]=Math.round(V[ee]);return V};return"conversion"in _&&(c.conversion=_.conversion),c}return a.forEach(_=>{t[_]={},Object.defineProperty(t[_],"channels",{value:i[_].channels}),Object.defineProperty(t[_],"labels",{value:i[_].labels});const c=e(_);Object.keys(c).forEach(C=>{const k=c[C];t[_][C]=m(k),t[_][C].raw=d(k)})}),Ex=t,Ex}var rV=iV();const aV=eV(rV);function nE({gl:i,type:e,source:t}){const a=i.createShader(e);if(a===null)throw new Error("Cannot create shader");if(i.shaderSource(a,t),i.compileShader(a),!i.getShaderParameter(a,i.COMPILE_STATUS))throw console.error("Shader compilation error:",i.getShaderInfoLog(a)),i.deleteShader(a),new Error("Cannot compile shader");return a}function sV({gl:i,vertexShaderSource:e,fragmentShaderSource:t}){const a=nE({gl:i,type:i.VERTEX_SHADER,source:e}),d=nE({gl:i,type:i.FRAGMENT_SHADER,source:t}),m=i.createProgram();if(i.attachShader(m,a),i.attachShader(m,d),i.linkProgram(m),!i.getProgramParameter(m,i.LINK_STATUS))throw console.error("Error: ",i.getProgramInfoLog(m)),new Error("Cannot link shader program");return m}function oV(i,e,t){const a=i.getUniformLocation(e,t);if(a===null)throw new Error(`Cannot get uniform location for ${t}`);return a}function BM({gl:i,vertexShaderSource:e,fragmentShaderSource:t,attributesKeys:a,uniformsKeys:d,vertices:m,indices:_}){const c=sV({gl:i,vertexShaderSource:e,fragmentShaderSource:t}),C=a.reduce((Y,xe)=>(Y[xe]=i.getAttribLocation(c,`a_${xe}`),Y),{}),k=d.reduce((Y,xe)=>(Y[xe]=oV(i,c,`u_${xe}`),Y),{}),V=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,V),i.bufferData(i.ARRAY_BUFFER,new Float32Array(m),i.STATIC_DRAW);let G,ee;return _!==void 0&&(G=i.createBuffer(),ee=_.length,i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,G),i.bufferData(i.ELEMENT_ARRAY_BUFFER,new Uint16Array(_),i.STATIC_DRAW)),{shaderProgram:c,programInfo:{attributesLocations:C,uniformsLocations:k},positionBuffer:V,indexBuffer:G,indexBufferLength:ee}}function c0(i){if(!i)return[1,1,1,0];if(i==="transparent")return[1,1,1,0];try{const e=lV(i),t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i.exec(e);if(t!=null&&t.length){const d=!!t[4];return[...aV.hex.rgb(e).map(m=>m/255),d?parseInt(t[4],16)/255:1]}const a=e.match(/(\d\.\d(\d+)?|\d{3}|\d{2}|\d{1})/gi)??["0","0","0"];if(e.includes("rgb")){const d=e.includes("rgba"),m=[...a.map(_=>parseFloat(_)).map((_,c)=>c<3?_/255:_)];return d||m.push(1),m}}catch{}return console.warn([`[parseColorStringToVec4]: Color ${i} is either not a valid color or its type is not supported, defaulting to black`]),[0,0,0,1]}let D_;function lV(i){return D_=D_??document.createElement("canvas").getContext("2d"),D_?(D_.fillStyle=i,D_.fillStyle):"#000000"}const Jw=1,Ic=Jw/2,Mc=Jw/2,Pc=Jw/2,uV=[-.5,-.5,Pc,Ic,-.5,Pc,Ic,Mc,Pc,-.5,Mc,Pc],cV=[-.5,-.5,-.5,-.5,Mc,-.5,Ic,Mc,-.5,Ic,-.5,-.5],hV=[-.5,Mc,-.5,-.5,Mc,Pc,Ic,Mc,Pc,Ic,Mc,-.5],dV=[-.5,-.5,-.5,Ic,-.5,-.5,Ic,-.5,Pc,-.5,-.5,Pc],fV=[Ic,-.5,-.5,Ic,Mc,-.5,Ic,Mc,Pc,Ic,-.5,Pc],pV=[-.5,-.5,-.5,-.5,-.5,Pc,-.5,Mc,Pc,-.5,Mc,-.5],mV=[...uV,...cV,...hV,...dV,...fV,...pV],gV=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],_V=`attribute vec3 a_vertexPosition;
varying vec3 vTextureCoord;

uniform mat4 u_projectionMatrix;
uniform mat4 u_modelViewMatrix;
  
void main(void) {
  vTextureCoord = vec3(-a_vertexPosition.x, a_vertexPosition.y, a_vertexPosition.z);
  gl_Position = u_projectionMatrix * u_modelViewMatrix * vec4(a_vertexPosition, 1.0);
}
`,iE=`precision mediump float;

varying vec3 vTextureCoord;

%USE_TEXTURE_MACRO_MARKER%

# ifdef USE_TEXTURE
uniform samplerCube u_cubeSampler;
uniform float u_fadeOpacity;
# endif

uniform vec4 u_bgColor;

void main(void) {
  #ifdef USE_TEXTURE
  vec4 texColor = textureCube(u_cubeSampler, vTextureCoord);

    gl_FragColor = mix(
      u_bgColor,
      texColor,
      min(texColor.a, u_fadeOpacity)
    );

    gl_FragColor.a = max(gl_FragColor.a, u_fadeOpacity);

  #else
  gl_FragColor = u_bgColor;
  #endif
}
`,jp={stars:{color:"hsl(233,100%,92%)",preset:"stars"},space:{color:"hsl(210, 100%, 4%)",preset:"space"},milkyway:{color:"hsl(233,100%,92%)",preset:"milkyway"},"milkyway-subtle":{color:"hsl(233,100%,92%)",preset:"milkyway-subtle"},"milkyway-bright":{color:"hsl(233,100%,92%)",preset:"milkyway-bright"},"milkyway-colored":{color:"black",preset:"milkyway-colored"}};var Lp=(i=>(i.POSITIVE_X="pX",i.NEGATIVE_X="nX",i.POSITIVE_Y="pY",i.NEGATIVE_Y="nY",i.POSITIVE_Z="pZ",i.NEGATIVE_Z="nZ",i))(Lp||{});let $v,rE,aE;function yV({gl:i,faces:e,onReady:t,forceRefresh:a}){$v&&!a&&aE===JSON.stringify(e)&&t($v,rE),aE=JSON.stringify(e);const d=$v??i.createTexture();if(i.bindTexture(i.TEXTURE_CUBE_MAP,d),!e){console.warn("[CubemapLayer][loadCubemapTexture]: Faces are null");return}const m=Object.keys(e).length;if(m!==6){console.warn(`[CubemapLayer][loadCubemapTexture]: Faces should contain exactly 6 images, but found ${m}`);return}const _=Object.entries(e).map(([c,C])=>new Promise((k,V)=>{const G=c;if(C===void 0){V(new Error(`[CubemapLayer][loadCubemapTexture]: Face ${c} is undefined`));return}const ee=new Image;ee.crossOrigin="anonymous";const Y=()=>{k({image:ee,key:G})};ee.src=C,ee.complete&&ee.naturalWidth>0?Y():ee.onload=Y,ee.onerror=()=>{V(new Error(`[CubemapLayer][loadCubemapTexture]: Error loading image ${C}`))}}));Promise.all(_).then(c=>{for(let k=0;k<c.length;k++){const V=i.RGBA,G=i.RGBA,ee=i.UNSIGNED_BYTE,{image:Y,key:xe}=c[k]??{};if(!Y||!xe){console.warn("[CubemapLayer][loadCubemapTexture]: Image or key is null");continue}const be=vV(i,xe);i.bindTexture(i.TEXTURE_CUBE_MAP,d),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texImage2D(be,0,V,G,ee,Y)}i.bindTexture(i.TEXTURE_CUBE_MAP,d),i.generateMipmap(i.TEXTURE_CUBE_MAP),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_MIN_FILTER,i.LINEAR_MIPMAP_LINEAR),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_MAG_FILTER,i.LINEAR);const C=c.map(k=>k.image);t(d,C),rE=C,$v=d}).catch(c=>{console.error("[CubemapLayer][loadCubemapTexture]: Error loading cubemap texture",c)})}function vV(i,e){if(e===Lp.POSITIVE_X)return i.TEXTURE_CUBE_MAP_POSITIVE_X;if(e===Lp.NEGATIVE_X)return i.TEXTURE_CUBE_MAP_NEGATIVE_X;if(e===Lp.POSITIVE_Y)return i.TEXTURE_CUBE_MAP_POSITIVE_Y;if(e===Lp.NEGATIVE_Y)return i.TEXTURE_CUBE_MAP_NEGATIVE_Y;if(e===Lp.POSITIVE_Z)return i.TEXTURE_CUBE_MAP_POSITIVE_Z;if(e===Lp.NEGATIVE_Z)return i.TEXTURE_CUBE_MAP_NEGATIVE_Z;throw new Error(`[CubemapLayer][loadCubemapTexture]: Invalid key ${e}`)}function bV(i,e,t){return[Pf(i[0],e[0],t),Pf(i[1],e[1],t),Pf(i[2],e[2],t),Pf(i[3],e[3],t)]}function Pf(i,e,t){return i+(e-i)*t}const Gm="https://api.maptiler.com/resources/space",xV=["vertexPosition"],wV=["projectionMatrix","modelViewMatrix","cubeSampler","bgColor","fadeOpacity"],sE="%USE_TEXTURE_MACRO_MARKER%",TV="#define USE_TEXTURE",oE=jp.stars;function SV(i,e){if(!FM(i))return{color:"transparent"};if(i===!0)return e;const t={...i};if(i.faces||i.path)return delete t.preset,t;const a=i.preset;if(a!==void 0&&!(a in jp))throw new Error(`[CubemapLayer]: Invalid preset "${a}". Available presets: ${Object.keys(jp).join(", ")}`);return{...t,color:t.color??jp[a].color??"hsl(233,100%,92%)"}}class Ax{constructor(e){rn(this,"id","Cubemap Layer"),rn(this,"type","custom"),rn(this,"renderingMode","3d"),rn(this,"map"),rn(this,"faces"),rn(this,"useCubemapTexture",!0),rn(this,"currentFadeOpacity",0),rn(this,"cubeMapNeedsUpdate",!1),rn(this,"bgColor"),rn(this,"previousBgColor",[0,0,0,0]),rn(this,"targetBgColor",[0,0,0,0]),rn(this,"transitionDelta",0),rn(this,"gl"),rn(this,"cubemap"),rn(this,"texture"),rn(this,"currentFacesDefinitionKey",""),rn(this,"options"),rn(this,"animationActive",!0),rn(this,"imageIsAnimating",!1),rn(this,"imageFadeInDelta",0);const t=SV(e,oE);this.options=t,this.currentFacesDefinitionKey=JSON.stringify(t.faces??t.preset??t.path),this.bgColor=[0,0,0,0],this.targetBgColor=c0(t.color),this.faces=lE(t),this.useCubemapTexture=this.faces!==null}updateCubemap({facesNeedUpdate:e}={facesNeedUpdate:!0}){this.useCubemapTexture=this.faces!==null;const t=wV.filter(a=>a==="cubeSampler"||a==="fadeOpacity"?this.useCubemapTexture:!0);this.cubemap=BM({gl:this.gl,vertexShaderSource:_V,fragmentShaderSource:this.useCubemapTexture?iE.replace(sE,TV):iE.replace(sE,""),attributesKeys:xV,uniformsKeys:t,vertices:mV,indices:gV}),this.cubeMapNeedsUpdate=e,this.useCubemapTexture&&this.updateTexture(this.gl,this.faces),this.animateColorChange()}onAdd(e,t){this.map=e,this.gl=t,this.updateCubemap()}onRemove(e,t){this.cubemap&&(t.deleteProgram(this.cubemap.shaderProgram),t.deleteBuffer(this.cubemap.positionBuffer))}updateTexture(e,t){if(this.cubeMapNeedsUpdate===!0&&!this.imageIsAnimating){if(this.cubeMapNeedsUpdate=!1,!this.useCubemapTexture)return;yV({gl:e,faces:t,onReady:a=>{this.texture=a,this.animateIn()}})}}prerender(e,t){this.faces&&this.updateTexture(this.gl,this.faces)}animateColorChange(){const e=()=>{this.transitionDelta<1&&(requestAnimationFrame(e),this.bgColor=bV(this.previousBgColor,this.targetBgColor,this.transitionDelta),this.transitionDelta+=.075,this.map.triggerRepaint())};requestAnimationFrame(e)}async animateIn(){if(!this.imageIsAnimating){if(!this.animationActive){this.currentFadeOpacity=1,this.imageFadeInDelta=1,this.map.triggerRepaint();return}return new Promise(e=>{this.imageIsAnimating=!0;const t=()=>{if(this.imageFadeInDelta=Math.min(this.imageFadeInDelta+.05,1),this.currentFadeOpacity=Pf(0,1,this.imageFadeInDelta),this.map.triggerRepaint(),this.imageFadeInDelta<1){requestAnimationFrame(t);return}this.imageIsAnimating=!1,this.imageFadeInDelta=0,e()};requestAnimationFrame(t)})}}async animateOut(){if(!(this.imageIsAnimating||!this.animationActive))return new Promise(e=>{const t=()=>{if(this.imageFadeInDelta=Math.min(this.imageFadeInDelta+.05,1),this.currentFadeOpacity=Pf(1,0,this.imageFadeInDelta),this.map.triggerRepaint(),this.imageFadeInDelta>=1){this.imageIsAnimating=!1,this.imageFadeInDelta=0,e();return}requestAnimationFrame(t)};requestAnimationFrame(t)})}setAnimationActive(e){this.animationActive=e}render(e,t){if(!this.map.isGlobeProjection())return;if(this.map===void 0)throw new Error("[CubemapLayer]: Map is undefined");if(this.cubemap===void 0)throw new Error("[CubemapLayer]: Cubemap is undefined");this.texture,e.disable(e.DEPTH_TEST),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.DST_ALPHA),e.useProgram(this.cubemap.shaderProgram),e.bindBuffer(e.ARRAY_BUFFER,this.cubemap.positionBuffer),e.vertexAttribPointer(this.cubemap.programInfo.attributesLocations.vertexPosition,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(this.cubemap.programInfo.attributesLocations.vertexPosition);const a=.1,d=1e4,m=e.canvas,_=m.clientWidth/m.clientHeight,c=this.map.transform,C=c.fov*(Math.PI/180),k=ty();QF(k,C,_,a,d),XS(k,k,c.rollInRadians),WS(k,k,-c.pitchInRadians),XS(k,k,c.bearingInRadians);const V=c.center.lat*Math.PI/180,G=c.center.lng*Math.PI/180;WS(k,k,V),KF(k,k,-G),e.uniformMatrix4fv(this.cubemap.programInfo.uniformsLocations.projectionMatrix,!1,k);const ee=ty();if(e.uniformMatrix4fv(this.cubemap.programInfo.uniformsLocations.modelViewMatrix,!1,ee),e.uniform4fv(this.cubemap.programInfo.uniformsLocations.bgColor,new Float32Array(this.bgColor)),e.uniform1f(this.cubemap.programInfo.uniformsLocations.fadeOpacity,this.currentFadeOpacity),this.useCubemapTexture&&this.texture&&(e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_CUBE_MAP,this.texture),e.uniform1i(this.cubemap.programInfo.uniformsLocations.cubeSampler,0)),this.cubemap.indexBuffer===void 0)throw new Error("Index buffer is undefined");if(this.cubemap.indexBufferLength===void 0)throw new Error("Index buffer length is undefined");e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.cubemap.indexBuffer),e.drawElements(e.TRIANGLES,this.cubemap.indexBufferLength,e.UNSIGNED_SHORT,0)}setBgColor(e){this.targetBgColor=e,this.previousBgColor=this.bgColor,this.transitionDelta=0}getConfig(){return this.options}async setCubemapFaces(e){if(await this.animateOut(),!e.faces&&!e.preset&&!e.path){this.faces=null,this.useCubemapTexture=!1,this.currentFacesDefinitionKey="empty",await this.animateIn();return}this.faces=lE(e),this.currentFacesDefinitionKey=JSON.stringify(e.faces??e.preset??e.path)}async setCubemap(e){const t=typeof e=="boolean"?oE:e;this.options=t;const a=JSON.stringify(t.faces??t.preset??t.path),d=this.currentFacesDefinitionKey!==a;d&&(await this.setCubemapFaces(t),this.cubeMapNeedsUpdate=!0);const m=c0(t.color);if(t.color&&this.targetBgColor.toString()!==m.toString())this.setBgColor(m);else if(!t.color&&t.preset&&t.preset in jp){const _=jp[t.preset];this.setBgColor(c0(_.color))}this.updateCubemap({facesNeedUpdate:d})}show(){this.map.setLayoutProperty(this.id,"visibility","visible")}hide(){this.map.setLayoutProperty(this.id,"visibility","none")}}function FM(i){return i?typeof i=="boolean"?!0:!(!i.path&&!i.preset&&!i.faces&&!i.color||i.preset&&!(i.preset in jp)||i.faces&&(!i.faces.pX||!i.faces.nX||!i.faces.pY||!i.faces.nY||!i.faces.pZ||!i.faces.nZ)):!1}function lE(i){if(i.faces)return i.faces;if(i.preset)return{pX:`${Gm}/${i.preset}/px.webp`,nX:`${Gm}/${i.preset}/nx.webp`,pY:`${Gm}/${i.preset}/py.webp`,nY:`${Gm}/${i.preset}/ny.webp`,pZ:`${Gm}/${i.preset}/pz.webp`,nZ:`${Gm}/${i.preset}/nz.webp`};if(i.path){const e=i.path.baseUrl,t=i.path.format??"png";return{pX:`${e}/px.${t}`,nX:`${e}/nx.${t}`,pY:`${e}/py.${t}`,nY:`${e}/ny.${t}`,pZ:`${e}/pz.${t}`,nZ:`${e}/nz.${t}`}}return null}const EV=`attribute vec3 a_position;

uniform mat4 u_matrix;
uniform mat4 u_rotationMatrix;

uniform float u_scale;

varying vec2 v_pos;
varying float v_scale;

void main() {
  v_scale = u_scale;
  v_pos = a_position.xy * u_scale;
  gl_Position = u_matrix * u_rotationMatrix * vec4(a_position, 1.0);
}
`,AV=`precision mediump float;
varying vec2 v_pos;
      
uniform int u_stopsNumber;
uniform float u_stops[100];
uniform vec4 u_colors[100];
uniform float u_maxDistance;

varying float v_scale;

const float EPSILON = 0.000001;

vec2 center = vec2(0.0, 0.0);
void main() {
  float rawDistance = distance(center, v_pos);
  float distanceFromGlobeEdge = rawDistance - 1.0;

    vec4 color = u_colors[0];

  // if we're further than the max distance, we should not render anything.
  // This is to always render a circle, otherwise we end up rendering
  // to the corners of the plane.
  if (distance(center, v_pos) > u_maxDistance * v_scale) {
    discard;
  }

  for (int i = 1; i < 100; i++) {
    // if we're past the last stop
    // we should fill to the end with the last stop color
    if (i >= u_stopsNumber) {
      color = u_colors[i - 1];
      break;
    }

    float scaledStopPosition = u_stops[i] * pow(v_scale, 1.6);
    float lastStopValue = u_stops[i - 1];
    float thisStopValue = u_stops[i];

    // this is to avoid blending errors when the stops are the same
    // eg when you would want a sharp edge between two stops.
    // \`numbersAreEqual\` will be 1.0 if the numbers are equal, 0.0 if they are not.
    // We then subtract EPSILON from the last stop making the stop value _almost_ equal
    // to the next stop but not enough to cause blending issues.
    // It's more efficient to do this than an if / else statement.
    float numbersAreEqual = 1.0 - step(EPSILON, abs(lastStopValue - thisStopValue));
    lastStopValue = lastStopValue - numbersAreEqual * EPSILON;

    float lastScaledStopPosition = lastStopValue * pow(v_scale, 1.6);

    if (distanceFromGlobeEdge <= scaledStopPosition) {
      float stopBlendFactor = (distanceFromGlobeEdge - lastScaledStopPosition) / (scaledStopPosition - lastScaledStopPosition);
      color = mix(u_colors[i - 1], u_colors[i], stopBlendFactor);
      break;
    }
  }
  
  // gl_FragColor = color;
  gl_FragColor = vec4(color.rgb * color.a, color.a);
}
`,$_=2,CV=["position"],IV=["matrix","rotationMatrix","stopsNumber","stops","colors","maxDistance","scale"],MV=[-2,-2,0,$_,-2,0,-2,$_,0,$_,$_,0],Sp={scale:.9,stops:[[0,"rgba(176, 208, 240, 1)"],[.1,"rgba(98, 168, 229, 0.3)"],[.2,"rgba(98, 168, 229, 0.0)"]]},uE=.06;class Cx{constructor(e){if(rn(this,"id","Halo Layer"),rn(this,"type","custom"),rn(this,"renderingMode","3d"),rn(this,"gradient"),rn(this,"scale",0),rn(this,"animationDelta",0),rn(this,"map"),rn(this,"plane"),rn(this,"animationActive",!0),typeof e=="boolean"){this.gradient=Sp;return}this.gradient={...Sp,...e}}onAdd(e,t){this.map=e,this.plane=BM({gl:t,vertexShaderSource:EV,fragmentShaderSource:AV,attributesKeys:CV,uniformsKeys:IV,vertices:MV}),this.animateIn()}getConfig(){return this.gradient}async animateIn(){if(!this.animationActive){this.scale=this.gradient.scale,this.animationDelta=1,this.map.triggerRepaint();return}return new Promise(e=>{this.animationDelta=0;const t=()=>{if(this.animationDelta<1){this.scale=Pf(0,this.gradient.scale,this.animationDelta),this.animationDelta+=uE,this.map.triggerRepaint(),requestAnimationFrame(t);return}e()};requestAnimationFrame(t)})}async animateOut(){if(this.animationActive)return this.animationDelta=0,new Promise(e=>{const t=()=>{if(this.animationDelta<1){this.scale=Pf(this.gradient.scale,0,this.animationDelta),this.animationDelta+=uE,this.map.triggerRepaint(),requestAnimationFrame(t);return}e()};t()})}onRemove(e,t){this.plane!==void 0&&(t.deleteProgram(this.plane.shaderProgram),t.deleteBuffer(this.plane.positionBuffer))}prerender(e,t){}render(e,t){if(this.map===void 0)throw new Error("[RadialGradientLayer]: Map is undefined");if(!this.map.isGlobeProjection())return;if(this.plane===void 0)throw new Error("[RadialGradientLayer]: Plane is undefined");e.disable(e.DEPTH_TEST),e.enable(e.BLEND),e.useProgram(this.plane.shaderProgram),e.bindBuffer(e.ARRAY_BUFFER,this.plane.positionBuffer);const a=this.plane.programInfo.attributesLocations.position;e.enableVertexAttribArray(a),e.vertexAttribPointer(a,3,e.FLOAT,!1,0,0);const d=ty(),m=this.scale;XF(d,d,[m,m,m]);const _=ty();WF(_,t.defaultProjectionData.mainMatrix,d);const c=this.plane.programInfo.uniformsLocations.matrix;e.uniformMatrix4fv(c,!1,_);const C=ty(),k=this.map.transform.cameraPosition,V=wx(u0(),k),G=JF(0,1,0),ee=u0();KS(ee,G,V),wx(ee,ee);const Y=u0();KS(Y,V,ee),wx(Y,Y),HF(C,ee[0],ee[1],ee[2],0,Y[0],Y[1],Y[2],0,V[0],V[1],V[2],0,0,0,0,1);const xe=this.plane.programInfo.uniformsLocations.rotationMatrix;e.uniformMatrix4fv(xe,!1,C);const be=this.gradient.stops.length,Ne=[],tt=[];for(let Je=0;Je<=be;Je++)if(Je<be){Ne[Je]=this.gradient.stops[Je][0];const Xe=c0(this.gradient.stops[Je][1]);tt.push(...Xe)}e.uniform1i(this.plane.programInfo.uniformsLocations.stopsNumber,be),e.uniform1fv(this.plane.programInfo.uniformsLocations.stops,new Float32Array(Ne)),e.uniform4fv(this.plane.programInfo.uniformsLocations.colors,new Float32Array(tt)),e.uniform1f(this.plane.programInfo.uniformsLocations.maxDistance,$_),e.uniform1f(this.plane.programInfo.uniformsLocations.scale,m),e.drawArrays(e.TRIANGLE_STRIP,0,4)}async setGradient(e){if(e===!1){await this.animateOut();return}if(await this.animateOut(),!PV(e)){this.gradient.scale=Sp.scale,this.gradient.stops=[[0,"transparent"],[1,"transparent"]];return}e===!0?(this.gradient.scale=Sp.scale,this.gradient.stops=Sp.stops):(this.gradient.scale=e.scale??Sp.scale,this.gradient.stops=e.stops??Sp.stops),await this.animateIn()}setAnimationActive(e){this.animationActive=e}show(){this.map.setLayoutProperty(this.id,"visibility","visible")}hide(){this.map.setLayoutProperty(this.id,"visibility","none")}}function PV(i){return typeof i=="boolean"?!0:!(typeof i.scale!="number"||!i.stops||i.stops.length===0||i.stops.some(e=>typeof e[0]!="number"||typeof e[1]!="string"))}const RV={POINT:"POINT",COUNTRY:"COUNTRY"};let VM=class UM extends wn.Map{constructor(e){d6(e.container),e.apiKey&&(Ka.apiKey=e.apiKey);const{style:t,requiresUrlMonitoring:a,isFallback:d}=GS(e.style);d&&console.warn("Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Fallback to default MapTiler style."),Ka.apiKey||console.warn("MapTiler Cloud API key is not set. Visit https://maptiler.com and try Cloud for free!");const m=location.hash;let _={compact:!1};e.customAttribution?_.customAttribution=e.customAttribution:e.attributionControl&&typeof e.attributionControl=="object"&&(_={..._,...e.attributionControl});const c={...e,style:t,maplibreLogo:!1,transformRequest:wS(e.transformRequest),attributionControl:e.forceNoAttributionControl===!0?!1:_};delete c.style,super(c),rn(this,"telemetry"),rn(this,"space"),rn(this,"halo"),rn(this,"options"),rn(this,"isTerrainEnabled",!1),rn(this,"terrainExaggeration",1),rn(this,"primaryLanguage"),rn(this,"terrainGrowing",!1),rn(this,"terrainFlattening",!1),rn(this,"minimap"),rn(this,"forceLanguageUpdate"),rn(this,"languageAlwaysBeenStyle"),rn(this,"isReady",!1),rn(this,"terrainAnimationDuration",1e3),rn(this,"monitoredStyleUrls"),rn(this,"styleInProcess",!1),rn(this,"curentProjection"),rn(this,"originalLabelStyle",new window.Map),rn(this,"isStyleLocalized",!1),rn(this,"languageIsUpdated",!1),rn(this,"spaceboxLoadingState",{styleLoadCallbackSet:!1}),this.options=e,this.setStyle(t),a&&this.monitorStyleUrl(t);const C=()=>{let Y="The distant style could not be loaded.";this.getStyle()?Y+="Leaving the style as is.":(this.setStyle(Q_.STREETS),Y+=`Loading default MapTiler Cloud style "${Q_.STREETS.getDefaultVariant().getId()}" as a fallback.`),console.warn(Y)};if(this.on("style.load",()=>{this.styleInProcess=!1}),this.on("error",Y=>{if(Y.error instanceof wn.AJAXError){const xe=Y.error.url,be=new URL(xe);be.search="";const Ne=be.href;this.monitoredStyleUrls&&this.monitoredStyleUrls.has(Ne)&&(this.monitoredStyleUrls.delete(Ne),C());return}if(this.styleInProcess){C();return}}),Ka.caching&&!l1&&console.warn("The cache API is only available in secure contexts. More info at https://developer.mozilla.org/en-US/docs/Web/API/Cache"),Ka.caching&&l1&&o6(),typeof e.language>"u")this.primaryLanguage=Ka.primaryLanguage;else{const Y=lS(e.language,er);this.primaryLanguage=Y??Ka.primaryLanguage}this.forceLanguageUpdate=!(this.primaryLanguage===er.STYLE||this.primaryLanguage===er.STYLE_LOCK),this.languageAlwaysBeenStyle=this.primaryLanguage===er.STYLE,this.terrainExaggeration=e.terrainExaggeration??this.terrainExaggeration,this.curentProjection=e.projection,this.on("styledata",()=>{this.curentProjection==="mercator"?this.setProjection({type:"mercator"}):this.curentProjection==="globe"&&this.setProjection({type:"globe"})}),this.once("styledata",async()=>{if(!e.geolocate||e.center||e.hash&&m)return;try{if(e.geolocate===RV.COUNTRY){await this.fitToIpBounds();return}}catch(xe){console.warn(xe.message)}let Y;try{await this.centerOnIpPoint(e.zoom),Y=this.getCameraHash()}catch(xe){console.warn(xe.message)}(await navigator.permissions.query({name:"geolocation"})).state==="granted"&&navigator.geolocation.getCurrentPosition(xe=>{Y===this.getCameraHash()&&(this.terrain?this.easeTo({center:[xe.coords.longitude,xe.coords.latitude],zoom:e.zoom||12,duration:2e3}):this.once("terrain",()=>{this.easeTo({center:[xe.coords.longitude,xe.coords.latitude],zoom:e.zoom||12,duration:2e3})}))},null,{maximumAge:24*3600*1e3,timeout:5e3,enableHighAccuracy:!1})}),this.on("styledata",()=>{this.setPrimaryLanguage(this.primaryLanguage)}),this.on("styledata",()=>{this.getTerrain()===null&&this.isTerrainEnabled&&this.enableTerrain(this.terrainExaggeration)}),this.once("load",async()=>{let Y={logo:null};try{const xe=Object.keys(this.style.sourceCaches).map(Ne=>this.getSource(Ne)).filter(Ne=>Ne&&"url"in Ne&&typeof Ne.url=="string"&&Ne.url.includes("tiles.json")),be=new URL(xe[0].url);be.searchParams.has("key")||be.searchParams.append("key",Ka.apiKey),Y=await(await fetch(be.href)).json()}catch{}if(e.customControls){const xe="[data-maptiler-control-group]",be="[data-maptiler-control]",Ne=Ge=>{let Fe=Ge.dataset.maptilerControl;return(Fe==="true"||Fe==="")&&(Fe=void 0),Fe},tt=Ge=>Ge.dataset.maptilerPosition;let Je=[...this._container.ownerDocument.querySelectorAll(xe)],Xe=[...this._container.ownerDocument.querySelectorAll(be)].filter(Ge=>Ge.closest(xe)===null);if(typeof e.customControls=="string"){const Ge=e.customControls;Je=Je.filter(Fe=>Fe.matches(Ge)||Fe.closest(Ge)!==null),Xe=Xe.filter(Fe=>Fe.matches(Ge)||Fe.closest(Ge)!==null)}for(const Ge of Je){const Fe=new _1(Ge);this.addControl(Fe,tt(Ge));for(const de of Ge.querySelectorAll(be))Fe.configureGroupItem(de,Ne(de))}for(const Ge of Xe)this.addControl(new _1(Ge,Ne(Ge)),tt(Ge));const Ke=()=>{const{lng:Ge,lat:Fe}=this.getCenter();this._container.style.setProperty("--maptiler-center-lng",String(Ge)),this._container.style.setProperty("--maptiler-center-lat",String(Fe)),this._container.style.setProperty("--maptiler-zoom",String(this.getZoom())),this._container.style.setProperty("--maptiler-bearing",String(this.getBearing())),this._container.style.setProperty("--maptiler-pitch",String(this.getPitch())),this._container.style.setProperty("--maptiler-roll",String(this.getRoll())),this._container.style.setProperty("--maptiler-is-globe-projection",String(this.isGlobeProjection())),this._container.style.setProperty("--maptiler-has-terrain",String(this.hasTerrain()))};Ke(),this.on("render",Ke)}if(e.forceNoAttributionControl!==!0)if("logo"in Y&&Y.logo){const xe=Y.logo;this.addControl(new SS({logoURL:xe}),e.logoPosition)}else e.maptilerLogo&&this.addControl(new SS,e.logoPosition);if(e.scaleControl){const xe=e.scaleControl===!0||e.scaleControl===void 0?"bottom-right":e.scaleControl,be=new T6({unit:Ka.unit});this.addControl(be,xe),Ka.on("unit",Ne=>{be.setUnit(Ne)})}if(e.navigationControl!==!1){const xe=e.navigationControl===!0||e.navigationControl===void 0?"top-right":e.navigationControl;this.addControl(new UF,xe)}if(e.geolocateControl!==!1){const xe=e.geolocateControl===!0||e.geolocateControl===void 0?"top-right":e.geolocateControl;this.addControl(new qF({positionOptions:{enableHighAccuracy:!0,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!0,showAccuracyCircle:!0,showUserLocation:!0}),xe)}if(e.terrainControl){const xe=e.terrainControl===!0||e.terrainControl===void 0?"top-right":e.terrainControl;this.addControl(new VF,xe)}if(e.projectionControl){const xe=e.projectionControl===!0||e.projectionControl===void 0?"top-right":e.projectionControl;this.addControl(new GF,xe)}if(e.fullscreenControl){const xe=e.fullscreenControl===!0||e.fullscreenControl===void 0?"top-right":e.fullscreenControl;this.addControl(new S6({}),xe)}this.isReady=!0,this.fire("ready",{target:this})});let k=!1,V=!1,G;this.once("ready",()=>{k=!0,V&&this.fire("loadWithTerrain",G)}),this.once("style.load",()=>{const{minimap:Y}=e;if(typeof Y=="object"){const{zoom:xe,center:be,style:Ne,language:tt,apiKey:Je,maptilerLogo:Xe,canvasContextAttributes:Ke,refreshExpiredTiles:Ge,maxBounds:Fe,scrollZoom:de,minZoom:ce,maxZoom:ge,boxZoom:Ae,locale:Re,fadeDuration:je,crossSourceCollisions:Pe,clickTolerance:Mn,bounds:ni,fitBoundsOptions:mt,pixelRatio:At,validateStyle:bt}=e;this.minimap=new xx(Y,{zoom:xe,center:be,style:Ne,language:tt,apiKey:Je,container:"null",maptilerLogo:Xe,canvasContextAttributes:Ke,refreshExpiredTiles:Ge,maxBounds:Fe,scrollZoom:de,minZoom:ce,maxZoom:ge,boxZoom:Ae,locale:Re,fadeDuration:je,crossSourceCollisions:Pe,clickTolerance:Mn,bounds:ni,fitBoundsOptions:mt,pixelRatio:At,validateStyle:bt}),this.addControl(this.minimap,Y.position??"bottom-left")}else Y===!0?(this.minimap=new xx({},e),this.addControl(this.minimap,"bottom-left")):Y!==void 0&&Y!==!1&&(this.minimap=new xx({},e),this.addControl(this.minimap,Y))});const ee=Y=>{Y.terrain&&(V=!0,G={type:"loadWithTerrain",target:this,terrain:Y.terrain},this.off("terrain",ee),k&&this.fire("loadWithTerrain",G))};this.on("terrain",ee),e.terrain&&this.enableTerrain(e.terrainExaggeration??this.terrainExaggeration),this.once("load",()=>{this.getCanvas().addEventListener("webglcontextlost",xe=>{if(this._removed===!0){console.warn("[webglcontextlost]","WebGL context lost after map removal. This is harmless.");return}console.warn("[webglcontextlost]","Unexpected loss of WebGL context!"),this.fire("webglContextLost",xe)});const Y=this.getLayersOrder()[0];e.space&&this.initSpace({options:e,before:Y}),e.halo&&this.initHalo({options:e,before:Y})}),this.telemetry=new ZF(this)}getSpace(){return this.space}setSpace(e){if(e===!1){this.space=void 0;return}if(this.isGlobeProjection()){if(this.space){this.space.setCubemap(e),this.getLayer(this.space.id)||this.addLayer(this.space,this.getLayersOrder()[0]);return}this.space=new Ax(e),this.once("load",()=>{const t=this.getLayersOrder()[0];this.space&&this.addLayer(this.space,t)})}}enableSpaceAnimations(){this.setSpaceAnimationActive(!0)}disableSpaceAnimations(){this.setSpaceAnimationActive(!1)}enableHaloAnimations(){this.setHaloAnimationActive(!0)}disableHaloAnimations(){this.setHaloAnimationActive(!1)}setHaloAnimationActive(e){this.halo?this.halo.setAnimationActive(e):this.once("load",()=>{var t;(t=this.halo)==null||t.setAnimationActive(e)})}setSpaceAnimationActive(e){this.space?this.space.setAnimationActive(e):this.once("load",()=>{var t;(t=this.space)==null||t.setAnimationActive(e)})}setSpaceFromStyle({style:e}){var t,a,d;if(this.options.space){this.setSpace(this.options.space);return}const m=(a=(t=e.metadata)==null?void 0:t.maptiler)==null?void 0:a.space;if(!m){this.setSpace({color:"transparent"});return}if(!FM(m)){this.setSpace({color:"transparent"});return}if(JSON.stringify((d=this.space)==null?void 0:d.getConfig())===JSON.stringify(m)){if(this.space&&!this.getLayer(this.space.id)){const _=this.getLayersOrder()[0];this.addLayer(this.space,_)}return}(()=>{if(this.space&&this.isGlobeProjection()){if(!this.getLayer(this.space.id)){const _=this.getLayersOrder()[0];this.addLayer(this.space,_)}this.space.setCubemap(m)}})()}setHaloFromStyle({style:e}){var t,a,d;const m=(t=e.metadata)==null?void 0:t.maptiler;if(JSON.stringify((a=this.halo)==null?void 0:a.getConfig())===JSON.stringify(m==null?void 0:m.halo)){if(this.halo&&!this.getLayer(this.halo.id)){const _=this.getLayersOrder().indexOf(((d=this.space)==null?void 0:d.id)??"")+1,c=this.getLayersOrder()[_];this.addLayer(this.halo,c)}return}if(!(m!=null&&m.halo)&&!this.options.halo){this.setHalo({stops:[[0,"transparent"],[1,"transparent"]],scale:1});return}(()=>{var _;if(this.halo){if(!this.getLayer(this.halo.id)){const C=this.getLayersOrder().indexOf(((_=this.space)==null?void 0:_.id)??"")+1,k=this.getLayersOrder()[C];this.addLayer(this.halo,k)}const c=(m==null?void 0:m.halo)??this.options.halo;c&&this.halo.setGradient(c)}})()}initSpace({options:e=this.options,before:t,spec:a}){if(this.space){this.getLayer(this.space.id)||this.addLayer(this.space,t);return}if(e.space===!1)return;const d=a;if(e.space){this.space=new Ax(e.space),this.addLayer(this.space,t);return}d&&(this.space=new Ax(d),this.addLayer(this.space,t))}initHalo({options:e=this.options,before:t,spec:a}){if(this.halo&&this.getLayer(this.halo.id)||e.halo===!1)return;const d=a;if(e.halo){this.halo=new Cx(e.halo),this.addLayer(this.halo,t);return}d&&(this.halo=new Cx(d),this.addLayer(this.halo,t))}getHalo(){return this.halo}setHalo(e){if(this.isGlobeProjection()){if(this.halo){this.halo.setGradient(e);return}this.halo=new Cx(e),this.once("load",()=>{var t;const a=this.getLayersOrder(),d=a[0],m=a.indexOf(((t=this.space)==null?void 0:t.id)??"")+2,_=a[m];this.halo&&this.addLayer(this.halo,this.space?_:d)})}}recreate(){const e={center:this.getCenter(),zoom:this.getZoom(),bearing:this.getBearing(),pitch:this.getPitch()};this.remove(),Object.assign(this,new UM({...this.options})),this.once("load",()=>{this.jumpTo(e)})}setTerrainAnimationDuration(e){this.terrainAnimationDuration=Math.max(e,0)}async onLoadAsync(){return new Promise(e=>{if(this.loaded()){e(this);return}this.once("load",()=>{e(this)})})}async onReadyAsync(){return new Promise(e=>{if(this.isReady){e(this);return}this.once("ready",()=>{e(this)})})}async onLoadWithTerrainAsync(){return new Promise(e=>{if(this.isReady&&this.terrain){e(this);return}this.once("loadWithTerrain",()=>{e(this)})})}monitorStyleUrl(e){typeof this.monitoredStyleUrls>"u"&&(this.monitoredStyleUrls=new Set);const t=new URL(e);t.search="",this.monitoredStyleUrls.add(t.href)}setStyle(e,t){var a,d,m,_,c;this.originalLabelStyle.clear(),(a=this.minimap)==null||a.setStyle(e),this.forceLanguageUpdate=!0,this.once("idle",()=>{this.forceLanguageUpdate=!1});const C=GS(e);if(C.requiresUrlMonitoring&&this.monitorStyleUrl(C.style),C.isFallback){if(this.getStyle())return console.warn("[Map.setStyle]: Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Keeping the curent style instead."),this;console.warn("[Map.setStyle]: Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Fallback to default MapTiler style.")}const k=this.getStyle(),V=C.style;try{super.setStyle(C.style,t),this.styleInProcess=!0}catch(Y){this.styleInProcess=!1,console.error("[Map.setStyle]: Error while setting style:",Y)}const G=()=>{const Y=C.style;if(!Y.projection||Y.projection.type==="mercator"){console.warn("[Map.setStyle]: Neither space nor halo is supported for mercator projection. Ignoring...");return}this.setSpaceFromStyle({style:C.style}),this.setHaloFromStyle({style:C.style})},ee=Y=>{var xe,be,Ne,tt;const Je=(Y==null?void 0:Y.target.getStyle())??C.style,Xe=this.getLayersOrder()[0];this.space?this.setSpaceFromStyle({style:Je}):this.initSpace({before:Xe,spec:(be=(xe=Je.metadata)==null?void 0:xe.maptiler)==null?void 0:be.space}),this.halo?this.setHaloFromStyle({style:Je}):this.initHalo({before:Xe,spec:(tt=(Ne=Je.metadata)==null?void 0:Ne.maptiler)==null?void 0:tt.halo})};if(typeof C.style=="string"||C.requiresUrlMonitoring)return this.on("styledata",ee),this;if(this.styleInProcess&&!this.spaceboxLoadingState.styleLoadCallbackSet)return this.once("style.load",ee),this.once("styledata",ee),this.spaceboxLoadingState.styleLoadCallbackSet=!0,this;if(((d=k==null?void 0:k.terrain)==null?void 0:d.source)!==((m=V==null?void 0:V.terrain)==null?void 0:m.source)||((_=k==null?void 0:k.terrain)==null?void 0:_.exaggeration)!==((c=V==null?void 0:V.terrain)==null?void 0:c.exaggeration))return this.once("terrain",G),this;try{ee()}catch{}return this}addLayer(e,t){var a;return(a=this.minimap)==null||a.addLayer(e,t),super.addLayer(e,t)}moveLayer(e,t){var a;return(a=this.minimap)==null||a.moveLayer(e,t),super.moveLayer(e,t)}removeLayer(e){var t;return(t=this.minimap)==null||t.removeLayer(e),super.removeLayer(e)}setLayerZoomRange(e,t,a){var d;return(d=this.minimap)==null||d.setLayerZoomRange(e,t,a),super.setLayerZoomRange(e,t,a)}setFilter(e,t,a){var d;return(d=this.minimap)==null||d.setFilter(e,t,a),super.setFilter(e,t,a)}setPaintProperty(e,t,a,d){var m;return(m=this.minimap)==null||m.setPaintProperty(e,t,a,d),super.setPaintProperty(e,t,a,d)}setLayoutProperty(e,t,a,d){var m;return(m=this.minimap)==null||m.setLayoutProperty(e,t,a,d),super.setLayoutProperty(e,t,a,d)}setGlyphs(e,t){var a;return(a=this.minimap)==null||a.setGlyphs(e,t),super.setGlyphs(e,t)}getStyleLanguage(){return!this.style||!this.style.stylesheet||!this.style.stylesheet.metadata||typeof this.style.stylesheet.metadata!="object"?null:"maptiler:language"in this.style.stylesheet.metadata&&typeof this.style.stylesheet.metadata["maptiler:language"]=="string"?i1(this.style.stylesheet.metadata["maptiler:language"]):null}setLanguage(e){var t;(t=this.minimap)==null||t.map.setLanguage(e),this.onStyleReady(()=>{this.setPrimaryLanguage(e)})}setPrimaryLanguage(e){const t=this.getStyleLanguage(),a=lS(e,er);if(!a){console.warn(`The language "${a}" is not supported.`);return}if(!(a.flag===er.STYLE.flag&&t&&(t.flag===er.AUTO.flag||t.flag===er.VISITOR.flag))&&(a.flag!==er.STYLE.flag&&(this.languageAlwaysBeenStyle=!1),this.languageAlwaysBeenStyle||this.primaryLanguage===a&&!this.forceLanguageUpdate))return;if(this.primaryLanguage.flag===er.STYLE_LOCK.flag){console.warn("The language cannot be changed because this map has been instantiated with the STYLE_LOCK language flag.");return}this.primaryLanguage=a;let d=a;if(a.flag===er.STYLE.flag){if(!t){console.warn("The style has no default languages or has an invalid one.");return}d=t}let m=er.LOCAL.flag,_=["get",m];d.flag===er.VISITOR.flag?(m=yS().flag,_=["case",["all",["has",m],["has",er.LOCAL.flag]],["case",["==",["get",m],["get",er.LOCAL.flag]],["get",er.LOCAL.flag],["format",["get",m],{"font-scale":.8},`
`,["get",er.LOCAL.flag],{"font-scale":1.1}]],["get",er.LOCAL.flag]]):d.flag===er.VISITOR_ENGLISH.flag?(m=er.ENGLISH.flag,_=["case",["all",["has",m],["has",er.LOCAL.flag]],["case",["==",["get",m],["get",er.LOCAL.flag]],["get",er.LOCAL.flag],["format",["get",m],{"font-scale":.8},`
`,["get",er.LOCAL.flag],{"font-scale":1.1}]],["get",er.LOCAL.flag]]):d.flag===er.AUTO.flag?(m=yS().flag,_=["coalesce",["get",m],["get",er.LOCAL.flag]]):d===er.LOCAL?(m=er.LOCAL.flag,_=["get",m]):(m=d.flag,_=["coalesce",["get",m],["get",er.LOCAL.flag]]);const{layers:c}=this.getStyle(),C=this.originalLabelStyle.size===0;if(C){const k=v6(c,this);this.isStyleLocalized=Object.keys(k.localized).length>0}for(const k of c){if(k.type!=="symbol")continue;const V=k,G=this.getSource(V.source);if(!G||!("url"in G&&typeof G.url=="string")||new URL(G.url).host!==Ul.maptilerApiHost)continue;const{id:ee,layout:Y}=V;if(!Y||!("text-field"in Y))continue;let xe;if(C?(xe=this.getLayoutProperty(ee,"text-field"),this.originalLabelStyle.set(ee,xe)):xe=this.originalLabelStyle.get(ee),typeof xe=="string"){const{contains:be,exactMatch:Ne}=p6(xe,this.isStyleLocalized);if(!be)continue;if(Ne)this.setLayoutProperty(ee,"text-field",_);else{const tt=m6(xe,_,this.isStyleLocalized);this.setLayoutProperty(ee,"text-field",tt)}}else{const be=f6(xe,_,this.isStyleLocalized);this.setLayoutProperty(ee,"text-field",be)}}this.languageIsUpdated=!0}getPrimaryLanguage(){return this.primaryLanguage}getTerrainExaggeration(){return this.terrainExaggeration}hasTerrain(){return this.isTerrainEnabled}growTerrain(e){if(!this.terrain)return;const t=performance.now(),a=this.terrain.exaggeration,d=e-a,m=()=>{if(!this.terrain||this.terrainFlattening)return;const _=(performance.now()-t)/this.terrainAnimationDuration;if(_<.99){const c=1-(1-_)**4,C=a+c*d;this.terrain.exaggeration=C,requestAnimationFrame(m)}else this.terrainGrowing=!1,this.terrainFlattening=!1,this.terrain.exaggeration=e,this.fire("terrainAnimationStop",{terrain:this.terrain});this._elevationFreeze=!1,this.triggerRepaint()};!this.terrainGrowing&&!this.terrainFlattening&&this.fire("terrainAnimationStart",{terrain:this.terrain}),this.terrainGrowing=!0,this.terrainFlattening=!1,requestAnimationFrame(m)}enableTerrain(e=this.terrainExaggeration){if(e<0){console.warn("Terrain exaggeration cannot be negative.");return}const t=d=>{!this.terrain||d.type!=="data"||d.dataType!=="source"||!("source"in d)||d.sourceId!=="maptiler-terrain"||d.source.type!=="raster-dem"||d.isSourceLoaded&&(this.off("data",t),this.growTerrain(e))},a=()=>{this.isTerrainEnabled=!0,this.terrainExaggeration=e,this.on("data",t),this.addSource(Ul.terrainSourceId,{type:"raster-dem",url:Ul.terrainSourceURL}),this.setTerrain({source:Ul.terrainSourceId,exaggeration:0})};if(this.getTerrain()){this.isTerrainEnabled=!0,this.growTerrain(e);return}if(this.loaded()||this.isTerrainEnabled)a();else{const d=()=>{this.getTerrain()&&this.getSource(Ul.terrainSourceId)||a()};this.once("load",()=>{d()}),this.once("moveend",()=>{d()})}}disableTerrain(){if(!this.terrain)return;this.isTerrainEnabled=!1;const e=performance.now(),t=this.terrain.exaggeration,a=()=>{if(!this.terrain||this.terrainGrowing)return;const d=(performance.now()-e)/this.terrainAnimationDuration;if(this._elevationFreeze=!1,d<.99){const m=(1-d)**4,_=t*m;this.terrain.exaggeration=_,requestAnimationFrame(a)}else this.terrain.exaggeration=0,this.terrainGrowing=!1,this.terrainFlattening=!1,this.setTerrain(),this.getSource(Ul.terrainSourceId)&&this.removeSource(Ul.terrainSourceId),this.fire("terrainAnimationStop",{terrain:null});this.triggerRepaint()};!this.terrainGrowing&&!this.terrainFlattening&&this.fire("terrainAnimationStart",{terrain:this.terrain}),this.terrainGrowing=!1,this.terrainFlattening=!0,requestAnimationFrame(a)}setTerrainExaggeration(e,t=!0){!t&&this.terrain?(this.terrainExaggeration=e,this.terrain.exaggeration=e,this.triggerRepaint()):this.enableTerrain(e)}onStyleReady(e){this.isStyleLoaded()?e():this.once("styledata",()=>{e()})}async fitToIpBounds(){const e=await cS.info();this.fitBounds(e.country_bounds,{duration:0,padding:100})}async centerOnIpPoint(e){const t=await cS.info();this.jumpTo({center:[t.longitude??0,t.latitude??0],zoom:e||11})}getCameraHash(){const e=new Float32Array(5),t=this.getCenter();return e[0]=t.lng,e[1]=t.lat,e[2]=this.getZoom(),e[3]=this.getPitch(),e[4]=this.getBearing(),QN.fromUint8Array(new Uint8Array(e.buffer))}getSdkConfig(){return Ka}getMaptilerSessionId(){return Rw}setTransformRequest(e){return super.setTransformRequest(wS(e)),this}isGlobeProjection(){const e=this.getProjection();return e?e.type==="globe":!1}enableGlobeProjection(){this.isGlobeProjection()!==!0&&(this.setProjection({type:"globe"}),this.curentProjection="globe")}enableMercatorProjection(){this.isGlobeProjection()!==!1&&(this.setProjection({type:"mercator"}),this.curentProjection="mercator")}isLanguageUpdated(){return this.languageIsUpdated}};wn.Evented;function e2(i){if(typeof DOMParser<"u"){const e=new DOMParser().parseFromString(i,"application/xml");if(e.querySelector("parsererror"))throw new Error("The provided string is not valid XML");return e}throw new Error("No XML parser found")}function jM(i,e){if(!i.hasChildNodes())return!1;for(const t of Array.from(i.childNodes)){const a=t.nodeName;if(typeof a=="string"&&a.trim().toLowerCase()===e.toLowerCase())return!0}return!1}function cE(i){if(typeof XMLSerializer<"u")return new XMLSerializer().serializeToString(i);throw new Error("No XML serializer found")}function qM(i){const e=typeof i=="string"?e2(i):i;if(!jM(e,"gpx"))throw new Error("The XML document is not valid GPX");const t=xo(e,"trk"),a=xo(e,"rte"),d=xo(e,"wpt"),m={type:"FeatureCollection",features:[]};for(const _ of Array.from(t)){const c=zV(_);c&&m.features.push(c)}for(const _ of Array.from(a)){const c=OV(_);c&&m.features.push(c)}for(const _ of Array.from(d))m.features.push(NV(_));return m}function $M(i,e){let t=i;if(typeof t=="string"&&(t=e2(t)),!jM(t,"kml"))throw new Error("The XML document is not valid KML");const a={type:"FeatureCollection",features:[]},d={},m={},_={},c=xo(t,"Placemark"),C=xo(t,"Style"),k=xo(t,"StyleMap");for(const V of Array.from(C)){const G=dE(cE(V)).toString(16);d[`#${qp(V,"id")}`]=G,m[G]=V}for(const V of Array.from(k)){d[`#${qp(V,"id")}`]=dE(cE(V)).toString(16);const G=xo(V,"Pair"),ee={};for(const Y of Array.from(G))ee[Er(ei(Y,"key"))??""]=Er(ei(Y,"styleUrl"));_[`#${qp(V,"id")}`]=ee}for(const V of Array.from(c))a.features=a.features.concat(DV(V,d,m,_));return a}function hE(i){if(i===null)return["#000000",1];let e="",t=1,a=i;return a.startsWith("#")&&(a=a.substring(1)),(a.length===6||a.length===3)&&(e=a),a.length===8&&(t=Number.parseInt(a.substring(0,2),16)/255,e=`#${a.substring(6,8)}${a.substring(4,6)}${a.substring(2,4)}`),[e??"#000000",t??1]}function LV(i){return HM(i.split(" "))}function kV(i){let e=xo(i,"coord");const t=[],a=[];e.length===0&&(e=xo(i,"gx:coord"));for(const m of Array.from(e))t.push(LV(Er(m)??""));const d=xo(i,"when");for(const m of Array.from(d))a.push(Er(m));return{coords:t,times:a}}function h0(i){const e=["Polygon","LineString","Point","Track","gx:Track"];let t,a,d,m,_;const c=[],C=[];if(ei(i,"MultiGeometry")!==null)return h0(ei(i,"MultiGeometry"));if(ei(i,"MultiTrack")!==null)return h0(ei(i,"MultiTrack"));if(ei(i,"gx:MultiTrack")!==null)return h0(ei(i,"gx:MultiTrack"));for(d=0;d<e.length;d++)if(a=xo(i,e[d]),a){for(m=0;m<a.length;m++)if(t=a[m],e[d]==="Point")c.push({type:"Point",coordinates:WM(Er(ei(t,"coordinates"))??"")});else if(e[d]==="LineString")c.push({type:"LineString",coordinates:pE(Er(ei(t,"coordinates"))??"")});else if(e[d]==="Polygon"){const k=xo(t,"LinearRing"),V=[];for(_=0;_<k.length;_++)V.push(pE(Er(ei(k[_],"coordinates"))??""));c.push({type:"Polygon",coordinates:V})}else if(e[d]==="Track"||e[d]==="gx:Track"){const k=kV(t);c.push({type:"LineString",coordinates:k.coords}),k.times.length&&C.push(k.times)}}return{geoms:c,coordTimes:C}}function DV(i,e,t,a){const d=h0(i),m={},_=Er(ei(i,"name")),c=Er(ei(i,"address")),C=Er(ei(i,"description")),k=ei(i,"TimeSpan"),V=ei(i,"TimeStamp"),G=ei(i,"ExtendedData"),ee=ei(i,"visibility");let Y,xe=Er(ei(i,"styleUrl")),be=ei(i,"LineStyle"),Ne=ei(i,"PolyStyle");if(!d.geoms.length)return[];if(_&&(m.name=_),c&&(m.address=c),xe){xe.startsWith("#")||(xe=`#${xe}`),m.styleUrl=xe,e[xe]&&(m.styleHash=e[xe]),a[xe]&&(m.styleMapHash=a[xe],m.styleHash=e[a[xe].normal??""]);const Je=t[m.styleHash??""];if(Je){be||(be=ei(Je,"LineStyle")),Ne||(Ne=ei(Je,"PolyStyle"));const Xe=ei(Je,"IconStyle");if(Xe){const Ke=ei(Xe,"Icon");if(Ke){const Ge=Er(ei(Ke,"href"));Ge&&(m.icon=Ge)}}}}if(C&&(m.description=C),k){const Je=Er(ei(k,"begin")),Xe=Er(ei(k,"end"));Je&&Xe&&(m.timespan={begin:Je,end:Xe})}if(V!==null&&(m.timestamp=Er(ei(V,"when"))??new Date().toISOString()),be!==null){const Je=hE(Er(ei(be,"color"))),Xe=Je[0],Ke=Je[1],Ge=Number.parseFloat(Er(ei(be,"width"))??"");Xe&&(m.stroke=Xe),Number.isNaN(Ke)||(m["stroke-opacity"]=Ke),Number.isNaN(Ge)||(m["stroke-width"]=Ge)}if(Ne){const Je=hE(Er(ei(Ne,"color"))),Xe=Je[0],Ke=Je[1],Ge=Er(ei(Ne,"fill")),Fe=Er(ei(Ne,"outline"));Xe&&(m.fill=Xe),Number.isNaN(Ke)||(m["fill-opacity"]=Ke),Ge&&(m["fill-opacity"]=Ge==="1"?m["fill-opacity"]||1:0),Fe&&(m["stroke-opacity"]=Fe==="1"?m["stroke-opacity"]||1:0)}if(G){const Je=xo(G,"Data"),Xe=xo(G,"SimpleData");for(Y=0;Y<Je.length;Y++)m[Je[Y].getAttribute("name")??""]=Er(ei(Je[Y],"value"))??"";for(Y=0;Y<Xe.length;Y++)m[Xe[Y].getAttribute("name")??""]=Er(Xe[Y])??""}ee!==null&&(m.visibility=Er(ee)??""),d.coordTimes.length!==0&&(m.coordTimes=d.coordTimes.length===1?d.coordTimes[0]:d.coordTimes);const tt={type:"Feature",geometry:d.geoms.length===1?d.geoms[0]:{type:"GeometryCollection",geometries:d.geoms},properties:m};return qp(i,"id")&&(tt.id=qp(i,"id")??void 0),[tt]}function GM(i,e){const t=xo(i,e),a=[],d=[];let m=[];const _=t.length;if(!(_<2)){for(let c=0;c<_;c++){const C=XM(t[c]);a.push(C.coordinates),C.time&&d.push(C.time),(C.heartRate||m.length)&&(m.length===0&&(m=new Array(c).fill(null)),m.push(C.heartRate))}return{line:a,times:d,heartRates:m}}}function zV(i){const e=xo(i,"trkseg"),t=[],a=[],d=[];let m;for(let c=0;c<e.length;c++)if(m=GM(e[c],"trkpt"),m!==void 0&&(m.line&&t.push(m.line),m.times&&m.times.length&&a.push(m.times),d.length||m.heartRates&&m.heartRates.length)){if(!d.length)for(let C=0;C<c;C++)d.push(new Array(t[C].length).fill(null));m.heartRates&&m.heartRates.length?d.push(m.heartRates):d.push(new Array(m.line.length).fill(null))}if(t.length===0)return;const _={...t2(i),...ZM(ei(i,"extensions"))};return a.length!==0&&(_.coordTimes=t.length===1?a[0]:a),d.length!==0&&(_.heartRates=t.length===1?d[0]:d),t.length===1?{type:"Feature",properties:_,geometry:{type:"LineString",coordinates:t[0]}}:{type:"Feature",properties:_,geometry:{type:"MultiLineString",coordinates:t}}}function OV(i){const e=GM(i,"rtept");return e===void 0?void 0:{type:"Feature",properties:{...t2(i),...ZM(ei(i,"extensions"))},geometry:{type:"LineString",coordinates:e.line}}}function NV(i){return{type:"Feature",properties:{...t2(i),...y1(i,["sym"])},geometry:{type:"Point",coordinates:XM(i).coordinates}}}function ZM(i){const e={};if(i){const t=ei(i,"line");if(t){const a=Er(ei(t,"color")),d=Number.parseFloat(Er(ei(t,"opacity"))??"0"),m=Number.parseFloat(Er(ei(t,"width"))??"0");a&&(e.stroke=a),Number.isNaN(d)||(e["stroke-opacity"]=d),Number.isNaN(m)||(e["stroke-width"]=m*96/25.4)}}return e}function t2(i){const e=y1(i,["name","cmt","desc","type","time","keywords"]),t=xo(i,"link");if(t.length!==0){e.links=[];for(const a of Array.from(t)){const d={href:qp(a,"href"),...y1(a,["text","type"])};e.links.push(d)}}return e}function dE(i){let e=0;if(!i||!i.length)return e;for(let t=0;t<i.length;t++)e=(e<<5)-e+i.charCodeAt(t)|0;return e}function xo(i,e){return i.getElementsByTagName(e)}function qp(i,e){return i.getAttribute(e)}function fE(i,e){return Number.parseFloat(qp(i,e)??"0")}function ei(i,e){const t=xo(i,e);return t.length?t[0]:null}function BV(i){return i.normalize&&i.normalize(),i}function HM(i){return i.map(Number.parseFloat).map(e=>Number.isNaN(e)?null:e)}function Er(i){return i&&BV(i),i&&i.textContent}function y1(i,e){const t={};let a,d;for(d=0;d<e.length;d++)a=ei(i,e[d]),a&&(t[e[d]]=Er(a)??"");return t}function WM(i){return HM(i.replace(/\s*/g,"").split(","))}function pE(i){const e=i.replace(/^\s*|\s*$/g,"").split(/\s+/),t=[];for(const a of e)t.push(WM(a));return t}function XM(i){const e=[fE(i,"lon"),fE(i,"lat")],t=ei(i,"ele"),a=ei(i,"gpxtpx:hr")||ei(i,"hr"),d=ei(i,"time");let m;return t&&(m=Number.parseFloat(Er(t)??"0"),Number.isNaN(m)||e.push(m)),{coordinates:e,time:d?Er(d):null,heartRate:a!==null?Number.parseFloat(Er(a)??"0"):null}}function FV(i){let e=i;try{typeof e=="string"&&(e=e2(e))}catch{return null}try{return qM(e)}catch{}try{return $M(e)}catch{}return null}async function VV(i,e={}){const t=e.download??!1,a=await UV(i);if(t){const d=e.filename??"maptiler_screenshot.png",m=document.createElement("a");m.style.display="none",document.body.appendChild(m),m.href=URL.createObjectURL(a),m.download=d,m.click(),setTimeout(()=>{document.body.removeChild(m),URL.revokeObjectURL(m.href)},0)}return a}function UV(i){return new Promise((e,t)=>{i.redraw(),i.once("idle",()=>{i.getCanvas().toBlob(a=>{if(!a){t(Error("Screenshot could not be created."));return}e(a)},"image/png")})})}const v1=[["#1D5B79","#468B97","#EF6262","#F3AA60"],["#614BC3","#33BBC5","#85E6C5","#C8FFE0"],["#461959","#7A316F","#CD6688","#AED8CC"],["#0079FF","#00DFA2","#F6FA70","#FF0060"],["#39B5E0","#A31ACB","#FF78F0","#F5EA5A"],["#37E2D5","#590696","#C70A80","#FBCB0A"],["#FFD36E","#FFF56D","#99FFCD","#9FB4FF"],["#00EAD3","#FFF5B7","#FF449F","#005F99"],["#10A19D","#540375","#FF7000","#FFBF00"]];function Ib(){return v1[~~(Math.random()*v1.length)][~~(Math.random()*4)]}function Vy(){return`maptiler_source_${WI()}`}function Uy(){return`maptiler_layer_${WI()}`}function b1(i,e){if(e<=i[0].zoom)return i[0].value;if(e>=i[i.length-1].zoom)return i[i.length-1].value;for(let t=0;t<i.length-1;t+=1)if(e>=i[t].zoom&&e<i[t+1].zoom){const a=i[t+1].zoom-i[t].zoom,d=(e-i[t].zoom)/a;return d*i[t+1].value+(1-d)*i[t].value}return 0}function Of(i){return["interpolate",["linear"],["zoom"],...i.flatMap(e=>[e.zoom,e.value])]}function vr(i){return["interpolate",["linear"],["zoom"],...i.flatMap(e=>[e.zoom,e.value])]}function KM(i,e){if(typeof e=="number"&&typeof i=="number")return 2*e+i;if(typeof e=="number"&&Array.isArray(i))return["interpolate",["linear"],["zoom"],...i.flatMap(t=>[t.zoom,2*e+t.value])];if(typeof i=="number"&&Array.isArray(e))return["interpolate",["linear"],["zoom"],...e.flatMap(t=>[t.zoom,2*t.value+i])];if(Array.isArray(i)&&Array.isArray(e)){const t=Array.from(new Set([...i.map(a=>a.zoom),...e.map(a=>a.zoom)])).sort((a,d)=>a<d?-1:1);return["interpolate",["linear"],["zoom"],...t.flatMap(a=>[a,2*b1(e,a)+b1(i,a)])]}return 0}function YM(i,e){return["interpolate",["linear"],["get",e],...i.flatMap(t=>[t.propertyValue,t.value])]}function n2(i){const e=i.trimStart(),t=`${e}${" ".repeat(i.length-e.length)}`,a=Array.from(t);if(!a.every(m=>m===" "||m==="_"))throw new Error("A dash pattern must be composed only of whitespace and underscore characters.");if(!(a.some(m=>m==="_")&&a.some(m=>m===" ")))throw new Error("A dash pattern must contain at least one underscore and one whitespace character");const d=[1];for(let m=1;m<a.length;m+=1){const _=a[m-1],c=a[m];_===c?d[d.length-1]+=1:d.push(1)}return d}function x1(i,e){return["interpolate",["linear"],["get",e],...i.flatMap(t=>[t.value,t.color])]}function w1(i,e,t=!0){return t?["interpolate",["linear"],["zoom"],0,["interpolate",["linear"],["get",e],...i.flatMap(a=>[a.value,a.pointRadius*.025])],2,["interpolate",["linear"],["get",e],...i.flatMap(a=>[a.value,a.pointRadius*.05])],4,["interpolate",["linear"],["get",e],...i.flatMap(a=>[a.value,a.pointRadius*.1])],8,["interpolate",["linear"],["get",e],...i.flatMap(a=>[a.value,a.pointRadius*.25])],16,["interpolate",["linear"],["get",e],...i.flatMap(a=>[a.value,a.pointRadius])]]:["interpolate",["linear"],["get",e],...i.flatMap(a=>[a.value,a.pointRadius])]}function QM(i,e,t=!0){return t?["interpolate",["linear"],["zoom"],0,["interpolate",["linear"],["get",e],...i.flatMap(a=>[a.propertyValue,a.value*.025])],2,["interpolate",["linear"],["get",e],...i.flatMap(a=>[a.propertyValue,a.value*.05])],4,["interpolate",["linear"],["get",e],...i.flatMap(a=>[a.propertyValue,a.value*.1])],8,["interpolate",["linear"],["get",e],...i.flatMap(a=>[a.propertyValue,a.value*.25])],16,["interpolate",["linear"],["get",e],...i.flatMap(a=>[a.propertyValue,a.value])]]:["interpolate",["linear"],["get",e],...i.flatMap(a=>[a.propertyValue,a.value])]}function T1(i,e){return i.every(t=>t.color[3]===i[0].color[3])?i[0].color[3]?i[0].color[3]/255:1:["interpolate",["linear"],["get",e],...i.getRawColorStops().flatMap(t=>{const a=t.value,d=t.color;return[a,d.length===4?d[3]/255:1]})]}function JM(i,e=10){return["interpolate",["linear"],["heatmap-density"],...Array.from({length:e+1},(t,a)=>{const d=a/e;return[d,i.getColorHex(d)]}).flat()]}function Gv(i){const e=i.toString(16);return e.length===1?`0${e}`:e}function jV(i){return`#${Gv(i[0])}${Gv(i[1])}${Gv(i[2])}${i.length===4?Gv(i[3]):""}`}class zn extends Array{constructor(e={}){super(),rn(this,"min",0),rn(this,"max",1),"min"in e&&(this.min=e.min),"max"in e&&(this.max=e.max),"stops"in e&&this.setStops(e.stops,{clone:!1})}static fromArrayDefinition(e){return new zn({stops:e.map(t=>({value:t[0],color:t[1]}))})}setStops(e,t={clone:!0}){const a=t.clone?this.clone():this;a.length=0;let d=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY;for(let _=0;_<e.length;_+=1)d=Math.min(d,e[_].value),m=Math.max(m,e[_].value),a.push({value:e[_].value,color:e[_].color.slice()});return a.sort((_,c)=>_.value<c.value?-1:1),this.min=d,this.max=m,a}scale(e,t,a={clone:!0}){const d=a.clone,m=this[0].value,_=this.at(-1).value-m,c=t-e,C=[];for(let k=0;k<this.length;k+=1){const V=(this[k].value-m)/_*c+e;d?C.push({value:V,color:this[k].color.slice()}):this[k].value=V}return d?new zn({stops:C}):this}at(e){return e<0?this[this.length+e]:this[e]}clone(){return new zn({stops:this.getRawColorStops()})}getRawColorStops(){const e=[];for(let t=0;t<this.length;t+=1)e.push({value:this[t].value,color:this[t].color});return e}reverse(e={clone:!0}){const t=e.clone?this.clone():this;for(let a=0;a<~~(t.length/2);a+=1){const d=t[a].color;t[a].color=t.at(-(a+1)).color,t.at(-(a+1)).color=d}return t}getBounds(){return{min:this.min,max:this.max}}getColor(e,t={smooth:!0}){if(e<=this[0].value)return this[0].color;if(e>=this.at(-1).value)return this.at(-1).color;for(let a=0;a<this.length-1;a+=1){if(e>this[a+1].value)continue;const d=this[a].color;if(!t.smooth)return d.slice();const m=this[a].value,_=this[a+1].value,c=this[a+1].color,C=(_-e)/(_-m);return d.map((k,V)=>Math.round(k*C+c[V]*(1-C)))}return[0,0,0]}getColorHex(e,t={smooth:!0,withAlpha:!1}){return jV(this.getColor(e,t))}getColorRelative(e,t={smooth:!0}){const a=this.getBounds();return this.getColor(a.min+e*(a.max-a.min),t)}getCanvasStrip(e={horizontal:!0,size:512,smooth:!0}){const t=document.createElement("canvas");t.width=e.horizontal?e.size:1,t.height=e.horizontal?1:e.size;const a=t.getContext("2d");if(!a)throw new Error("Canvs context is missing");const d=a.getImageData(0,0,t.width,t.height),m=d.data,_=e.size,c=this[0].value,C=(this.at(-1).value-c)/_;for(let k=0;k<_;k+=1){const V=this.getColor(c+k*C,{smooth:e.smooth});m[k*4]=V[0],m[k*4+1]=V[1],m[k*4+2]=V[2],m[k*4+3]=V.length>3?V[3]:255}return a.putImageData(d,0,0),t}resample(e,t=15){const a=this.getBounds(),d=this.scale(0,1),m=1/(t-1);let _;if(e==="ease-in-square")_=Array.from({length:t},(c,C)=>{const k=C*m,V=k**2,G=d.getColor(V);return{value:k,color:G}});else if(e==="ease-out-square")_=Array.from({length:t},(c,C)=>{const k=C*m,V=1-(1-k)**2,G=d.getColor(V);return{value:k,color:G}});else if(e==="ease-out-sqrt")_=Array.from({length:t},(c,C)=>{const k=C*m,V=k**.5,G=d.getColor(V);return{value:k,color:G}});else if(e==="ease-in-sqrt")_=Array.from({length:t},(c,C)=>{const k=C*m,V=1-(1-k)**.5,G=d.getColor(V);return{value:k,color:G}});else if(e==="ease-out-exp")_=Array.from({length:t},(c,C)=>{const k=C*m,V=1-2**(-10*k),G=d.getColor(V);return{value:k,color:G}});else if(e==="ease-in-exp")_=Array.from({length:t},(c,C)=>{const k=C*m,V=2**(10*k-10),G=d.getColor(V);return{value:k,color:G}});else throw new Error("Invalid ressampling method.");return new zn({stops:_}).scale(a.min,a.max)}transparentStart(){const e=this.getRawColorStops();e.unshift({value:e[0].value,color:e[0].color.slice()}),e[1].value+=.001;for(const t of e)t.color.length===3&&t.color.push(255);return e[0].color[3]=0,new zn({stops:e})}hasTransparentStart(){return this[0].color.length===4&&this[0].color[3]===0}}const eP={NULL:new zn({stops:[{value:0,color:[0,0,0,0]},{value:1,color:[0,0,0,0]}]}),GRAY:new zn({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),JET:new zn({stops:[{value:0,color:[0,0,131]},{value:.125,color:[0,60,170]},{value:.375,color:[5,255,255]},{value:.625,color:[255,255,0]},{value:.875,color:[250,0,0]},{value:1,color:[128,0,0]}]}),HSV:new zn({stops:[{value:0,color:[255,0,0]},{value:.169,color:[253,255,2]},{value:.173,color:[247,255,2]},{value:.337,color:[0,252,4]},{value:.341,color:[0,252,10]},{value:.506,color:[1,249,255]},{value:.671,color:[2,0,253]},{value:.675,color:[8,0,253]},{value:.839,color:[255,0,251]},{value:.843,color:[255,0,245]},{value:1,color:[255,0,6]}]}),HOT:new zn({stops:[{value:0,color:[0,0,0]},{value:.3,color:[230,0,0]},{value:.6,color:[255,210,0]},{value:1,color:[255,255,255]}]}),SPRING:new zn({stops:[{value:0,color:[255,0,255]},{value:1,color:[255,255,0]}]}),SUMMER:new zn({stops:[{value:0,color:[0,128,102]},{value:1,color:[255,255,102]}]}),AUTOMN:new zn({stops:[{value:0,color:[255,0,0]},{value:1,color:[255,255,0]}]}),WINTER:new zn({stops:[{value:0,color:[0,0,255]},{value:1,color:[0,255,128]}]}),BONE:new zn({stops:[{value:0,color:[0,0,0]},{value:.376,color:[84,84,116]},{value:.753,color:[169,200,200]},{value:1,color:[255,255,255]}]}),COPPER:new zn({stops:[{value:0,color:[0,0,0]},{value:.804,color:[255,160,102]},{value:1,color:[255,199,127]}]}),GREYS:new zn({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),YIGNBU:new zn({stops:[{value:0,color:[8,29,88]},{value:.125,color:[37,52,148]},{value:.25,color:[34,94,168]},{value:.375,color:[29,145,192]},{value:.5,color:[65,182,196]},{value:.625,color:[127,205,187]},{value:.75,color:[199,233,180]},{value:.875,color:[237,248,217]},{value:1,color:[255,255,217]}]}),GREENS:new zn({stops:[{value:0,color:[0,68,27]},{value:.125,color:[0,109,44]},{value:.25,color:[35,139,69]},{value:.375,color:[65,171,93]},{value:.5,color:[116,196,118]},{value:.625,color:[161,217,155]},{value:.75,color:[199,233,192]},{value:.875,color:[229,245,224]},{value:1,color:[247,252,245]}]}),YIORRD:new zn({stops:[{value:0,color:[128,0,38]},{value:.125,color:[189,0,38]},{value:.25,color:[227,26,28]},{value:.375,color:[252,78,42]},{value:.5,color:[253,141,60]},{value:.625,color:[254,178,76]},{value:.75,color:[254,217,118]},{value:.875,color:[255,237,160]},{value:1,color:[255,255,204]}]}),BLUERED:new zn({stops:[{value:0,color:[0,0,255]},{value:1,color:[255,0,0]}]}),RDBU:new zn({stops:[{value:0,color:[5,10,172]},{value:.35,color:[106,137,247]},{value:.5,color:[190,190,190]},{value:.6,color:[220,170,132]},{value:.7,color:[230,145,90]},{value:1,color:[178,10,28]}]}),PICNIC:new zn({stops:[{value:0,color:[0,0,255]},{value:.1,color:[51,153,255]},{value:.2,color:[102,204,255]},{value:.3,color:[153,204,255]},{value:.4,color:[204,204,255]},{value:.5,color:[255,255,255]},{value:.6,color:[255,204,255]},{value:.7,color:[255,153,255]},{value:.8,color:[255,102,204]},{value:.9,color:[255,102,102]},{value:1,color:[255,0,0]}]}),RAINBOW:new zn({stops:[{value:0,color:[150,0,90]},{value:.125,color:[0,0,200]},{value:.25,color:[0,25,255]},{value:.375,color:[0,152,255]},{value:.5,color:[44,255,150]},{value:.625,color:[151,255,0]},{value:.75,color:[255,234,0]},{value:.875,color:[255,111,0]},{value:1,color:[255,0,0]}]}),PORTLAND:new zn({stops:[{value:0,color:[12,51,131]},{value:.25,color:[10,136,186]},{value:.5,color:[242,211,56]},{value:.75,color:[242,143,56]},{value:1,color:[217,30,30]}]}),BLACKBODY:new zn({stops:[{value:0,color:[0,0,0]},{value:.2,color:[230,0,0]},{value:.4,color:[230,210,0]},{value:.7,color:[255,255,255]},{value:1,color:[160,200,255]}]}),EARTH:new zn({stops:[{value:0,color:[0,0,130]},{value:.1,color:[0,180,180]},{value:.2,color:[40,210,40]},{value:.4,color:[230,230,50]},{value:.6,color:[120,70,20]},{value:1,color:[255,255,255]}]}),ELECTRIC:new zn({stops:[{value:0,color:[0,0,0]},{value:.15,color:[30,0,100]},{value:.4,color:[120,0,100]},{value:.6,color:[160,90,0]},{value:.8,color:[230,200,0]},{value:1,color:[255,250,220]}]}),VIRIDIS:new zn({stops:[{value:0,color:[68,1,84]},{value:.13,color:[71,44,122]},{value:.25,color:[59,81,139]},{value:.38,color:[44,113,142]},{value:.5,color:[33,144,141]},{value:.63,color:[39,173,129]},{value:.75,color:[92,200,99]},{value:.88,color:[170,220,50]},{value:1,color:[253,231,37]}]}),INFERNO:new zn({stops:[{value:0,color:[0,0,4]},{value:.13,color:[31,12,72]},{value:.25,color:[85,15,109]},{value:.38,color:[136,34,106]},{value:.5,color:[186,54,85]},{value:.63,color:[227,89,51]},{value:.75,color:[249,140,10]},{value:.88,color:[249,201,50]},{value:1,color:[252,255,164]}]}),MAGMA:new zn({stops:[{value:0,color:[0,0,4]},{value:.13,color:[28,16,68]},{value:.25,color:[79,18,123]},{value:.38,color:[129,37,129]},{value:.5,color:[181,54,122]},{value:.63,color:[229,80,100]},{value:.75,color:[251,135,97]},{value:.88,color:[254,194,135]},{value:1,color:[252,253,191]}]}),PLASMA:new zn({stops:[{value:0,color:[13,8,135]},{value:.13,color:[75,3,161]},{value:.25,color:[125,3,168]},{value:.38,color:[168,34,150]},{value:.5,color:[203,70,121]},{value:.63,color:[229,107,93]},{value:.75,color:[248,148,65]},{value:.88,color:[253,195,40]},{value:1,color:[240,249,33]}]}),WARM:new zn({stops:[{value:0,color:[125,0,179]},{value:.13,color:[172,0,187]},{value:.25,color:[219,0,170]},{value:.38,color:[255,0,130]},{value:.5,color:[255,63,74]},{value:.63,color:[255,123,0]},{value:.75,color:[234,176,0]},{value:.88,color:[190,228,0]},{value:1,color:[147,255,0]}]}),COOL:new zn({stops:[{value:0,color:[125,0,179]},{value:.13,color:[116,0,218]},{value:.25,color:[98,74,237]},{value:.38,color:[68,146,231]},{value:.5,color:[0,204,197]},{value:.63,color:[0,247,146]},{value:.75,color:[0,255,88]},{value:.88,color:[40,255,8]},{value:1,color:[147,255,0]}]}),RAINBOW_SOFT:new zn({stops:[{value:0,color:[125,0,179]},{value:.1,color:[199,0,180]},{value:.2,color:[255,0,121]},{value:.3,color:[255,108,0]},{value:.4,color:[222,194,0]},{value:.5,color:[150,255,0]},{value:.6,color:[0,255,55]},{value:.7,color:[0,246,150]},{value:.8,color:[50,167,222]},{value:.9,color:[103,51,235]},{value:1,color:[124,0,186]}]}),BATHYMETRY:new zn({stops:[{value:0,color:[40,26,44]},{value:.13,color:[59,49,90]},{value:.25,color:[64,76,139]},{value:.38,color:[63,110,151]},{value:.5,color:[72,142,158]},{value:.63,color:[85,174,163]},{value:.75,color:[120,206,163]},{value:.88,color:[187,230,172]},{value:1,color:[253,254,204]}]}),CDOM:new zn({stops:[{value:0,color:[47,15,62]},{value:.13,color:[87,23,86]},{value:.25,color:[130,28,99]},{value:.38,color:[171,41,96]},{value:.5,color:[206,67,86]},{value:.63,color:[230,106,84]},{value:.75,color:[242,149,103]},{value:.88,color:[249,193,135]},{value:1,color:[254,237,176]}]}),CHLOROPHYLL:new zn({stops:[{value:0,color:[18,36,20]},{value:.13,color:[25,63,41]},{value:.25,color:[24,91,59]},{value:.38,color:[13,119,72]},{value:.5,color:[18,148,80]},{value:.63,color:[80,173,89]},{value:.75,color:[132,196,122]},{value:.88,color:[175,221,162]},{value:1,color:[215,249,208]}]}),DENSITY:new zn({stops:[{value:0,color:[54,14,36]},{value:.13,color:[89,23,80]},{value:.25,color:[110,45,132]},{value:.38,color:[120,77,178]},{value:.5,color:[120,113,213]},{value:.63,color:[115,151,228]},{value:.75,color:[134,185,227]},{value:.88,color:[177,214,227]},{value:1,color:[230,241,241]}]}),FREESURFACE_BLUE:new zn({stops:[{value:0,color:[30,4,110]},{value:.13,color:[47,14,176]},{value:.25,color:[41,45,236]},{value:.38,color:[25,99,212]},{value:.5,color:[68,131,200]},{value:.63,color:[114,156,197]},{value:.75,color:[157,181,203]},{value:.88,color:[200,208,216]},{value:1,color:[241,237,236]}]}),FREESURFACE_RED:new zn({stops:[{value:0,color:[60,9,18]},{value:.13,color:[100,17,27]},{value:.25,color:[142,20,29]},{value:.38,color:[177,43,27]},{value:.5,color:[192,87,63]},{value:.63,color:[205,125,105]},{value:.75,color:[216,162,148]},{value:.88,color:[227,199,193]},{value:1,color:[241,237,236]}]}),OXYGEN:new zn({stops:[{value:0,color:[64,5,5]},{value:.13,color:[106,6,15]},{value:.25,color:[144,26,7]},{value:.38,color:[168,64,3]},{value:.5,color:[188,100,4]},{value:.63,color:[206,136,11]},{value:.75,color:[220,174,25]},{value:.88,color:[231,215,44]},{value:1,color:[248,254,105]}]}),PAR:new zn({stops:[{value:0,color:[51,20,24]},{value:.13,color:[90,32,35]},{value:.25,color:[129,44,34]},{value:.38,color:[159,68,25]},{value:.5,color:[182,99,19]},{value:.63,color:[199,134,22]},{value:.75,color:[212,171,35]},{value:.88,color:[221,210,54]},{value:1,color:[225,253,75]}]}),PHASE:new zn({stops:[{value:0,color:[145,105,18]},{value:.13,color:[184,71,38]},{value:.25,color:[186,58,115]},{value:.38,color:[160,71,185]},{value:.5,color:[110,97,218]},{value:.63,color:[50,123,164]},{value:.75,color:[31,131,110]},{value:.88,color:[77,129,34]},{value:1,color:[145,105,18]}]}),SALINITY:new zn({stops:[{value:0,color:[42,24,108]},{value:.13,color:[33,50,162]},{value:.25,color:[15,90,145]},{value:.38,color:[40,118,137]},{value:.5,color:[59,146,135]},{value:.63,color:[79,175,126]},{value:.75,color:[120,203,104]},{value:.88,color:[193,221,100]},{value:1,color:[253,239,154]}]}),TEMPERATURE:new zn({stops:[{value:0,color:[4,35,51]},{value:.13,color:[23,51,122]},{value:.25,color:[85,59,157]},{value:.38,color:[129,79,143]},{value:.5,color:[175,95,130]},{value:.63,color:[222,112,101]},{value:.75,color:[249,146,66]},{value:.88,color:[249,196,65]},{value:1,color:[232,250,91]}]}),TURBIDITY:new zn({stops:[{value:0,color:[34,31,27]},{value:.13,color:[65,50,41]},{value:.25,color:[98,69,52]},{value:.38,color:[131,89,57]},{value:.5,color:[161,112,59]},{value:.63,color:[185,140,66]},{value:.75,color:[202,174,88]},{value:.88,color:[216,209,126]},{value:1,color:[233,246,171]}]}),VELOCITY_BLUE:new zn({stops:[{value:0,color:[17,32,64]},{value:.13,color:[35,52,116]},{value:.25,color:[29,81,156]},{value:.38,color:[31,113,162]},{value:.5,color:[50,144,169]},{value:.63,color:[87,173,176]},{value:.75,color:[149,196,189]},{value:.88,color:[203,221,211]},{value:1,color:[254,251,230]}]}),VELOCITY_GREEN:new zn({stops:[{value:0,color:[23,35,19]},{value:.13,color:[24,64,38]},{value:.25,color:[11,95,45]},{value:.38,color:[39,123,35]},{value:.5,color:[95,146,12]},{value:.63,color:[152,165,18]},{value:.75,color:[201,186,69]},{value:.88,color:[233,216,137]},{value:1,color:[255,253,205]}]}),CUBEHELIX:new zn({stops:[{value:0,color:[0,0,0]},{value:.07,color:[22,5,59]},{value:.13,color:[60,4,105]},{value:.2,color:[109,1,135]},{value:.27,color:[161,0,147]},{value:.33,color:[210,2,142]},{value:.4,color:[251,11,123]},{value:.47,color:[255,29,97]},{value:.53,color:[255,54,69]},{value:.6,color:[255,85,46]},{value:.67,color:[255,120,34]},{value:.73,color:[255,157,37]},{value:.8,color:[241,191,57]},{value:.87,color:[224,220,93]},{value:.93,color:[218,241,142]},{value:1,color:[227,253,198]}]}),CIVIDIS:new zn({stops:[{value:0,color:[0,32,77,255]},{value:.125,color:[5,54,110,255]},{value:.25,color:[65,77,108,255]},{value:.375,color:[97,100,111,255]},{value:.5,color:[125,124,121,255]},{value:.625,color:[156,149,120,255]},{value:.75,color:[190,175,111,255]},{value:.875,color:[225,204,94,255]},{value:1,color:[255,235,70,255]}]}),TURBO:new zn({stops:[{value:0,color:[48,18,59,255]},{value:.125,color:[70,107,227,255]},{value:.25,color:[40,187,236,255]},{value:.375,color:[49,242,153,255]},{value:.5,color:[162,252,60,255]},{value:.625,color:[237,208,58,255]},{value:.75,color:[251,128,34,255]},{value:.875,color:[210,49,5,255]},{value:1,color:[122,4,3,255]}]}),ROCKET:new zn({stops:[{value:0,color:[250,235,221,0]},{value:.133,color:[250,235,221,255]},{value:.266,color:[246,170,130,255]},{value:.4,color:[240,96,67,255]},{value:.533,color:[203,27,79,255]},{value:.666,color:[132,30,90,255]},{value:.8,color:[63,27,68,255]},{value:1,color:[3,5,26,255]}]}),MAKO:new zn({stops:[{value:0,color:[11,4,5,255]},{value:.125,color:[43,28,53,255]},{value:.25,color:[62,53,107,255]},{value:.375,color:[59,86,152,255]},{value:.5,color:[53,123,162,255]},{value:.625,color:[53,158,170,255]},{value:.75,color:[73,193,173,255]},{value:.875,color:[150,221,181,255]},{value:1,color:[222,245,229,255]}]})};async function qV(i,e,t={}){var a,d;if(!e.sourceId&&!e.data)throw new Error("Creating a polyline layer requires an existing .sourceId or a valid .data property");let m=e.data;if(typeof m=="string"){if(hb(m))m=`https://api.maptiler.com/data/${e.data}/features.json?key=${Ka.apiKey}`;else if(((a=m.split(".").pop())==null?void 0:a.toLowerCase().trim())==="gpx"){const _=await(await fetch(m,t)).text();m=qM(_)}else if(((d=m.split(".").pop())==null?void 0:d.toLowerCase().trim())==="kml"){const _=await(await fetch(m,t)).text();m=$M(_)}else{const _=c6(m)??FV(m);_&&(m=_)}if(!m)throw new Error("Polyline data was provided as string but is incompatible with valid formats.")}return $V(i,{...e,data:m})}function $V(i,e){if(e.layerId&&i.getLayer(e.layerId))throw new Error(`A layer already exists with the layer id: ${e.layerId}`);const t=e.sourceId??Vy(),a=e.layerId??Uy(),d={polylineLayerId:a,polylineOutlineLayerId:"",polylineSourceId:t};e.data&&!i.getSource(t)&&i.addSource(t,{type:"geojson",data:e.data});const m=e.lineWidth??3,_=e.lineColor??Ib(),c=e.lineOpacity??1,C=e.lineBlur??0,k=e.lineGapWidth??0;let V=e.lineDashArray??null;const G=e.outlineWidth??1,ee=e.outlineColor??"#FFFFFF",Y=e.outlineOpacity??1,xe=e.outlineBlur??0;if(typeof V=="string"&&(V=n2(V)),e.outline===!0){const be=`${a}_outline`;d.polylineOutlineLayerId=be,i.addLayer({id:be,type:"line",source:t,layout:{"line-join":e.lineJoin??"round","line-cap":e.lineCap??"round"},minzoom:e.minzoom??0,maxzoom:e.maxzoom??23,paint:{"line-opacity":typeof Y=="number"?Y:vr(Y),"line-color":typeof ee=="string"?ee:Of(ee),"line-width":KM(m,G),"line-blur":typeof xe=="number"?xe:vr(xe)}},e.beforeId)}return i.addLayer({id:a,type:"line",source:t,layout:{"line-join":e.lineJoin??"round","line-cap":e.lineCap??"round"},minzoom:e.minzoom??0,maxzoom:e.maxzoom??23,paint:{"line-opacity":typeof c=="number"?c:vr(c),"line-color":typeof _=="string"?_:Of(_),"line-width":typeof m=="number"?m:vr(m),"line-blur":typeof C=="number"?C:vr(C),"line-gap-width":typeof k=="number"?k:vr(k),...V&&{"line-dasharray":V}}},e.beforeId),d}function GV(i,e){if(e.layerId&&i.getLayer(e.layerId))throw new Error(`A layer already exists with the layer id: ${e.layerId}`);const t=e.sourceId??Vy(),a=e.layerId??Uy(),d={polygonLayerId:a,polygonOutlineLayerId:e.outline?`${a}_outline`:"",polygonSourceId:t};if(e.data&&!i.getSource(t)){let be=e.data;typeof be=="string"&&hb(be)&&(be=`https://api.maptiler.com/data/${be}/features.json?key=${Ka.apiKey}`),i.addSource(t,{type:"geojson",data:be})}let m=e.outlineDashArray??null;const _=e.outlineWidth??1,c=e.outlineColor??"#FFFFFF",C=e.outlineOpacity??1,k=e.outlineBlur??0,V=e.fillColor??Ib(),G=e.fillOpacity??1,ee=e.outlinePosition??"center",Y=e.pattern??null;typeof m=="string"&&(m=n2(m));const xe=(be=null)=>{if(i.addLayer({id:a,type:"fill",source:t,minzoom:e.minzoom??0,maxzoom:e.maxzoom??23,paint:{"fill-color":typeof V=="string"?V:Of(V),"fill-opacity":typeof G=="number"?G:vr(G),...be&&{"fill-pattern":be}}},e.beforeId),e.outline===!0){let Ne;ee==="inside"?typeof _=="number"?Ne=.5*_:Ne=vr(_.map(({zoom:tt,value:Je})=>({zoom:tt,value:.5*Je}))):ee==="outside"?typeof _=="number"?Ne=-.5*_:Ne=vr(_.map(tt=>({zoom:tt.zoom,value:-.5*tt.value}))):Ne=0,i.addLayer({id:d.polygonOutlineLayerId,type:"line",source:t,layout:{"line-join":e.outlineJoin??"round","line-cap":e.outlineCap??"butt"},minzoom:e.minzoom??0,maxzoom:e.maxzoom??23,paint:{"line-opacity":typeof C=="number"?C:vr(C),"line-color":typeof c=="string"?c:Of(c),"line-width":typeof _=="number"?_:vr(_),"line-blur":typeof k=="number"?k:vr(k),"line-offset":Ne,...m&&{"line-dasharray":m}}},e.beforeId)}};return Y?i.hasImage(Y)?xe(Y):i.loadImage(Y).then(be=>{i.addImage(Y,be.data),xe(Y)}).catch(be=>{console.error("Could not load the pattern image.",be.message),xe()}):xe(),d}function ZV(i,e){if(e.layerId&&i.getLayer(e.layerId))throw new Error(`A layer already exists with the layer id: ${e.layerId}`);const t=e.minPointRadius??10,a=e.maxPointRadius??50,d=e.cluster??!1,m=20,_=Array.isArray(e.pointColor)?e.pointColor:eP.TURBO.scale(10,e.cluster?1e4:1e3).resample("ease-out-square"),c=_.getBounds(),C=e.sourceId??Vy(),k=e.layerId??Uy(),V=e.showLabel??d,G=e.alignOnViewport??!0,ee=e.outline??!1,Y=e.outlineOpacity??1,xe=e.outlineWidth??1,be=e.outlineColor??"#FFFFFF";let Ne;const tt=e.zoomCompensation??!0,Je=e.minzoom??0,Xe=e.maxzoom??23;typeof e.pointOpacity=="number"?Ne=e.pointOpacity:Array.isArray(e.pointOpacity)?Ne=vr(e.pointOpacity):e.cluster?Ne=T1(_,"point_count"):e.property?Ne=T1(_,e.property):Ne=vr([{zoom:Je,value:0},{zoom:Je+.25,value:1},{zoom:Xe-.25,value:1},{zoom:Xe,value:0}]);const Ke={pointLayerId:k,clusterLayerId:"",labelLayerId:"",pointSourceId:C};if(e.data&&!i.getSource(C)){let Ge=e.data;typeof Ge=="string"&&hb(Ge)&&(Ge=`https://api.maptiler.com/data/${Ge}/features.json?key=${Ka.apiKey}`),i.addSource(C,{type:"geojson",data:Ge,cluster:d})}if(d){Ke.clusterLayerId=`${k}_cluster`;const Ge=Array.from({length:m},(Fe,de)=>{const ce=c.min+de*(c.max-c.min)/(m-1);return{value:ce,pointRadius:t+(a-t)*(de/(m-1))**.5,color:_.getColorHex(ce)}});i.addLayer({id:Ke.clusterLayerId,type:"circle",source:C,filter:["has","point_count"],paint:{"circle-color":typeof e.pointColor=="string"?e.pointColor:x1(Ge,"point_count"),"circle-radius":typeof e.pointRadius=="number"?e.pointRadius:Array.isArray(e.pointRadius)?vr(e.pointRadius):w1(Ge,"point_count",!1),"circle-pitch-alignment":G?"viewport":"map","circle-pitch-scale":"map","circle-opacity":Ne,...ee&&{"circle-stroke-opacity":typeof Y=="number"?Y:vr(Y),"circle-stroke-width":typeof xe=="number"?xe:vr(xe),"circle-stroke-color":typeof be=="string"?be:Of(be)}},minzoom:Je,maxzoom:Xe},e.beforeId),i.addLayer({id:Ke.pointLayerId,type:"circle",source:C,filter:["!",["has","point_count"]],paint:{"circle-pitch-alignment":G?"viewport":"map","circle-pitch-scale":"map","circle-color":typeof e.pointColor=="string"?e.pointColor:_.getColorHex(_.getBounds().min),"circle-radius":typeof e.pointRadius=="number"?e.pointRadius:Array.isArray(e.pointRadius)?vr(e.pointRadius):Ge[0].pointRadius*.75,"circle-opacity":Ne,...ee&&{"circle-stroke-opacity":typeof Y=="number"?Y:vr(Y),"circle-stroke-width":typeof xe=="number"?xe:vr(xe),"circle-stroke-color":typeof be=="string"?be:Of(be)}},minzoom:Je,maxzoom:Xe},e.beforeId)}else{let Ge=typeof e.pointColor=="string"?e.pointColor:Array.isArray(e.pointColor)?e.pointColor.getColorHex(e.pointColor.getBounds().min):Ib(),Fe=typeof e.pointRadius=="number"?tt?vr([{zoom:0,value:e.pointRadius*.025},{zoom:2,value:e.pointRadius*.05},{zoom:4,value:e.pointRadius*.1},{zoom:8,value:e.pointRadius*.25},{zoom:16,value:e.pointRadius*1}]):e.pointRadius:Array.isArray(e.pointRadius)?vr(e.pointRadius):tt?vr([{zoom:0,value:t*.05},{zoom:2,value:t*.1},{zoom:4,value:t*.2},{zoom:8,value:t*.5},{zoom:16,value:t*1}]):t;if(e.property&&Array.isArray(e.pointColor)){const de=Array.from({length:m},(ce,ge)=>{const Ae=c.min+ge*(c.max-c.min)/(m-1);return{value:Ae,pointRadius:typeof e.pointRadius=="number"?e.pointRadius:t+(a-t)*(ge/(m-1))**.5,color:typeof e.pointColor=="string"?e.pointColor:_.getColorHex(Ae)}});Ge=x1(de,e.property),Fe=w1(de,e.property,tt)}i.addLayer({id:Ke.pointLayerId,type:"circle",source:C,layout:{"circle-sort-key":e.property?["/",1,["get",e.property]]:0},paint:{"circle-pitch-alignment":G?"viewport":"map","circle-pitch-scale":"map","circle-color":Ge,"circle-opacity":Ne,"circle-radius":Fe,...ee&&{"circle-stroke-opacity":typeof Y=="number"?Y:vr(Y),"circle-stroke-width":typeof xe=="number"?xe:vr(xe),"circle-stroke-color":typeof be=="string"?be:Of(be)}},minzoom:Je,maxzoom:Xe},e.beforeId)}if(V!==!1&&(e.cluster||e.property)){Ke.labelLayerId=`${k}_label`;const Ge=e.labelColor??"#fff",Fe=e.labelSize??12;i.addLayer({id:Ke.labelLayerId,type:"symbol",source:C,filter:["has",e.cluster?"point_count":e.property],layout:{"text-field":e.cluster?"{point_count_abbreviated}":`{${e.property}}`,"text-font":["Noto Sans Regular"],"text-size":Fe,"text-pitch-alignment":G?"viewport":"map","symbol-sort-key":["/",1,["get",e.cluster?"point_count":e.property]]},paint:{"text-color":Ge,"text-opacity":Ne},minzoom:Je,maxzoom:Xe},e.beforeId)}return Ke}function HV(i,e){if(e.layerId&&i.getLayer(e.layerId))throw new Error(`A layer already exists with the layer id: ${e.layerId}`);const t=e.sourceId??Vy(),a=e.layerId??Uy(),d=e.minzoom??0,m=e.maxzoom??23,_=e.zoomCompensation??!0,c=e.opacity??[{zoom:d,value:0},{zoom:d+.25,value:1},{zoom:m-.25,value:1},{zoom:m,value:0}];let C=Array.isArray(e.colorRamp)?e.colorRamp:eP.TURBO.transparentStart();const k=C.getBounds();(k.min!==0||k.max!==1)&&(C=C.scale(0,1)),C.hasTransparentStart()||(C=C.transparentStart());const V=e.intensity??[{zoom:0,value:.01},{zoom:4,value:.2},{zoom:16,value:1}],G=e.property??null,ee=e.weight??1;let Y=1;G?typeof ee=="number"?(Y=ee,typeof e.weight=="number"&&console.warn("The option `.property` is ignored when `.propertyValueWeights` is not of type `PropertyValueWeights`")):Array.isArray(ee)?Y=YM(ee,G):console.warn("The option `.property` is ignored when `.propertyValueWeights` is not of type `PropertyValueWeights`"):typeof ee=="number"?Y=ee:Array.isArray(ee)&&console.warn("The options `.propertyValueWeights` can only be used when `.property` is provided.");const xe=[{zoom:0,value:50*.025},{zoom:2,value:50*.05},{zoom:4,value:50*.1},{zoom:8,value:50*.25},{zoom:16,value:50}],be=e.radius??(_?xe:10);let Ne=1;typeof be=="number"?Ne=be:Array.isArray(be)&&"zoom"in be[0]?Ne=vr(be):G&&Array.isArray(be)&&"propertyValue"in be[0]?Ne=QM(be,G,_):!G&&Array.isArray(be)&&"propertyValue"in be[0]?(Ne=vr(xe),console.warn("The option `.radius` can only be property-driven if the option `.property` is provided.")):Ne=vr(xe);const tt={heatmapLayerId:a,heatmapSourceId:t};if(e.data&&!i.getSource(t)){let Je=e.data;typeof Je=="string"&&hb(Je)&&(Je=`https://api.maptiler.com/data/${Je}/features.json?key=${Ka.apiKey}`),i.addSource(t,{type:"geojson",data:Je})}return i.addLayer({id:a,type:"heatmap",source:t,minzoom:d,maxzoom:m,paint:{"heatmap-weight":Y,"heatmap-intensity":typeof V=="number"?V:vr(V),"heatmap-color":JM(C),"heatmap-radius":Ne,"heatmap-opacity":typeof c=="number"?c:vr(c)}},e.beforeId),tt}const z_=Object.freeze(Object.defineProperty({__proto__:null,addHeatmap:HV,addPoint:ZV,addPolygon:GV,addPolyline:qV,colorDrivenByProperty:x1,colorPalettes:v1,computeRampedOutlineWidth:KM,dashArrayMaker:n2,generateRandomLayerName:Uy,generateRandomSourceName:Vy,getRandomColor:Ib,heatmapIntensityFromColorRamp:JM,lerpZoomNumberValues:b1,opacityDrivenByProperty:T1,paintColorOptionsToPaintSpec:Of,radiusDrivenByProperty:w1,radiusDrivenByPropertyHeatmap:QM,rampedOptionsToLayerPaintSpec:vr,rampedPropertyValueWeight:YM,takeScreenshot:VV},Symbol.toStringTag,{value:"Module"}));l6();function WV(){return"3.8.0"}wn.Map;wn.Marker;wn.Popup;wn.Style;wn.CanvasSource;wn.GeoJSONSource;wn.ImageSource;wn.RasterTileSource;wn.RasterDEMTileSource;wn.VectorTileSource;wn.VideoSource;wn.NavigationControl;wn.GeolocateControl;wn.AttributionControl;wn.LogoControl;wn.ScaleControl;wn.FullscreenControl;wn.TerrainControl;wn.BoxZoomHandler;wn.ScrollZoomHandler;wn.CooperativeGesturesHandler;wn.KeyboardHandler;wn.TwoFingersTouchPitchHandler;wn.MapWheelEvent;wn.MapTouchEvent;wn.MapMouseEvent;wn.config;wn.getVersion;const{setRTLTextPlugin:xU,getRTLTextPluginStatus:wU,LngLat:TU,LngLatBounds:SU,MercatorCoordinate:EU,Evented:AU,AJAXError:CU,prewarm:IU,clearPrewarmedResources:MU,Hash:PU,Point:RU,EdgeInsets:LU,DragRotateHandler:kU,DragPanHandler:DU,TwoFingersTouchZoomRotateHandler:zU,DoubleClickZoomHandler:OU,TwoFingersTouchZoomHandler:NU,TwoFingersTouchRotateHandler:BU,getWorkerCount:FU,setWorkerCount:VU,getMaxParallelImageRequests:UU,setMaxParallelImageRequests:jU,getWorkerUrl:qU,setWorkerUrl:$U,addSourceType:GU,importScriptInWorkers:ZU,addProtocol:HU,removeProtocol:WU}=wn,XV="@maptiler/leaflet-maptilersdk",KV="4.1.1",YV=kr.Layer.extend({options:{updateInterval:32,padding:.1,interactive:!1,pane:"tilePane"},map:null,initialize:function(i){kr.setOptions(this,i),this._throttledUpdate=kr.Util.throttle(this._update,this.options.updateInterval,this)},onAdd:function(i){var e;this._container||this._initContainer();const t=this.getPaneName();(e=i.getPane(t))==null||e.appendChild(this._container),this._initMaptilerSDK(),this._offset=this._map.containerPointToLayerPoint([0,0]),i.options.zoomAnimation&&kr.DomEvent.on(i._proxy,kr.DomUtil.TRANSITION_END,this._transitionEnd,this),i.attributionControl.addAttribution('<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>')},onRemove:function(i){var e;this._map._proxy&&this._map.options.zoomAnimation&&kr.DomEvent.off(this._map._proxy,kr.DomUtil.TRANSITION_END,this._transitionEnd,this);const t=this.getPaneName();(e=i.getPane(t))==null||e.removeChild(this._container),this._maptilerMap.remove(),this._maptilerMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd,resize:this._resize}},getMaptilerSDKMap:function(){return this._maptilerMap},getCanvas:function(){return this._maptilerMap.getCanvas()},getSize:function(){return this._map.getSize().multiplyBy(1+this.options.padding*2)},getBounds:function(){const i=this.getSize().multiplyBy(.5),e=this._map.latLngToContainerPoint(this._map.getCenter());return kr.latLngBounds(this._map.containerPointToLatLng(e.subtract(i)),this._map.containerPointToLatLng(e.add(i)))},getContainer:function(){return this._container},getPaneName:function(){return this._map.getPane(this.options.pane)?this.options.pane:"tilePane"},setStyle:function(i){this._maptilerMap.setStyle(i)},setLanguage:function(i){this._maptilerMap.setLanguage(i)},_roundPoint:i=>({x:Math.round(i.x),y:Math.round(i.y)}),_initContainer:function(){this._container=kr.DomUtil.create("div","leaflet-gl-layer");const i=this.getSize(),e=this._map.getSize().multiplyBy(this.options.padding);this._container.style.width=`${i.x}px`,this._container.style.height=`${i.y}px`;const t=this._map.containerPointToLayerPoint([0,0]).subtract(e);kr.DomUtil.setPosition(this._container,this._roundPoint(t))},_initMaptilerSDK:function(){const i=this._map.getCenter(),e=this.options.maxBounds?this.options.maxBounds:[[Number.NEGATIVE_INFINITY,-90],[Number.POSITIVE_INFINITY,90]];this._map.setMaxBounds(kr.latLngBounds(kr.latLng(e[0][1],e[0][0]),kr.latLng(e[1][1],e[1][0])));const t={maxBounds:e,...this.options,projection:"mercator",container:this._container,center:[i.lng,i.lat],zoom:this._map.getZoom()-1,attributionControl:!1};this.options.geolocate&&(t.center=void 0,t.zoom=void 0),this._maptilerMap=new VM(t),this._maptilerMap.telemetry.registerModule(XV,KV),this._maptilerMap.once("load",()=>{this.fire("ready")}),this._maptilerMap.once("load",async()=>{let d={logo:null};try{const m=Object.keys(this._maptilerMap.style.sourceCaches).map(c=>this._maptilerMap.getSource(c)).filter(c=>c&&"url"in c&&typeof c.url=="string"&&(c==null?void 0:c.url.includes("tiles.json"))),_=new URL(m[0].url);_.searchParams.has("key")||_.searchParams.append("key",t.apiKey),d=await(await fetch(_.href)).json()}catch{}if(d.logo||t.maptilerLogo){const m=d.logo??"https://api.maptiler.com/resources/logo.svg",_=document.createElement("a");_.href="https://www.maptiler.com",_.style.setProperty("position","absolute"),_.style.setProperty("left","10px"),_.style.setProperty("bottom","2px"),_.style.setProperty("z-index","999");const c=document.createElement("img");c.src=m,c.alt="MapTiler logo",c.width=100,c.height=30,_.appendChild(c),this._map.getContainer().appendChild(_)}}),this._maptilerMap.transform.freezeElevation=!0,this.options.geolocate&&this._maptilerMap.on("load",()=>{this._map.setView(this._maptilerMap.getCenter(),this._maptilerMap.getZoom()+1)}),this._transformGL(),this._maptilerMap._actualCanvas=this._maptilerMap._canvas;const a=this._maptilerMap._actualCanvas;kr.DomUtil.addClass(a,"leaflet-image-layer"),kr.DomUtil.addClass(a,"leaflet-zoom-animated"),this.options.interactive&&kr.DomUtil.addClass(a,"leaflet-interactive"),this.options.className&&kr.DomUtil.addClass(a,this.options.className),this.addHeatmap=d=>z_.addHeatmap(this._maptilerMap,d),this.addPolygon=d=>z_.addPolygon(this._maptilerMap,d),this.addPoint=d=>z_.addPoint(this._maptilerMap,d),this.addPolyline=d=>z_.addPolyline(this._maptilerMap,d),this.takeScreenshot=d=>z_.takeScreenshot(this._maptilerMap,d)},_update:function(){if(this._offset=this._map.containerPointToLayerPoint([0,0]),this._zooming)return;const i=this.getSize(),e=this._map.getSize().multiplyBy(this.options.padding),t=this._map.containerPointToLayerPoint([0,0]).subtract(e);kr.DomUtil.setPosition(this._container,this._roundPoint(t)),this._transformGL(),this._maptilerMap.transform.width!==i.x||this._maptilerMap.transform.height!==i.y?(this._container.style.width=`${i.x}px`,this._container.style.height=`${i.y}px`,this._maptilerMap._resize!==null&&this._maptilerMap._resize!==void 0?this._maptilerMap._resize():this._maptilerMap.resize()):this._maptilerMap._update!==null&&this._maptilerMap._update!==void 0?this._maptilerMap._update():this._maptilerMap.update()},_transformGL:function(){this._maptilerMap.setCenter(this._map.getCenter()),this._maptilerMap.setZoom(this._map.getZoom()-1)},_pinchZoom:function(){this._maptilerMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(i){const e=this._map.getZoomScale(i.zoom),t=this._map.getSize().multiplyBy(this.options.padding*e),a=this.getSize()._divideBy(2),d=this._map.project(i.center,i.zoom)._subtract(a)._add(this._map._getMapPanePos().add(t))._round(),m=this._map.project(this._map.getBounds().getNorthWest(),i.zoom)._subtract(d);kr.DomUtil.setTransform(this._maptilerMap.getCanvas(),m.subtract(this._offset),e)},_zoomStart:function(){this._zooming=!0},_zoomEnd:function(){const i=this._map.getZoomScale(this._map.getZoom());kr.DomUtil.setTransform(this._maptilerMap.getCanvas(),new kr.Point(0,0),i),this._zooming=!1,this._update()},_transitionEnd:function(){kr.Util.requestAnimFrame(()=>{const i=this._map.getZoom(),e=this._map.getCenter(),t=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());kr.DomUtil.setTransform(this._maptilerMap._actualCanvas,t,1),this._maptilerMap.once("moveend",kr.Util.bind(()=>{this._zoomEnd()},this)),this._maptilerMap.jumpTo({center:e,zoom:i-1})},this)},_resize:function(i){this._transitionEnd(i)}}),mE=[{id:0,name:"uncomfortable-situation",color:"#de9e36"},{id:1,name:"sexual-misconduct",color:"#ca3c25"},{id:2,name:"physical-aggression",color:"#701d52"},{id:3,name:"verbal-aggression",color:"#212475"},{id:4,name:"discrimination",color:"#1d1a05"}];function gE(){const[i,e]=Tt.useState([]),[t,a]=Tt.useState({}),[d,m]=Tt.useState(!0),[_,c]=Tt.useState(null),[C,k]=Tt.useState({selectedCampus:"All",selectedMonth:"All",selectedTypes:[],showMenu:!1}),V=Tt.useRef(null),G=Tt.useRef(null);Tt.useEffect(()=>{(async()=>{try{const de=yC(CI,"reports"),ce=Fz(de),ge=await $z(ce);console.log("Firebase Points: ",ge.docs.map(Ae=>Ae.data())),e(ge.docs.map(Ae=>Ae.data())),m(!1)}catch(de){console.error("Error fetching incidents:",de),c("Failed to fetch incident data"),m(!1)}})(),V.current||(V.current=kr.map("map",{maxZoom:19}).setView([41.7002,-86.2379],15).setMinZoom(15).setMaxBounds([[41.7852,-86.1779],[41.5852,-86.2879]]),new YV({style:"streets-v2",apiKey:"0UGrg19TXtYRROinsJ9a"}).addTo(V.current),G.current=kr.layerGroup().addTo(V.current))},[]),Tt.useEffect(()=>{Y()},[i,C]);const ee=()=>{const Fe={};return tt(i).forEach(ce=>{var bt;const ge=rS.find(Zt=>Zt.name===ce.specificLocation),Ae={"uncomfortable-situation":0,"sexual-misconduct":0,"physical-aggression":0,"verbal-aggression":0,discrimination:0},Re=(bt=Fe[ce.specificLocation])!=null&&bt.totalIncidents?Fe[ce.specificLocation].totalIncidents+1:1,je={...Ae};ce.offenseTypes&&ce.offenseTypes.forEach(Zt=>{je[Zt]!==void 0?je[Zt]+=1:je[Zt]=1});const Pe=ce.specificLocation||(ge==null?void 0:ge.name)||"Unknown Location",Mn=ge&&typeof ge.latitude=="number"&&typeof ge.longitude=="number"?[ge.latitude,ge.longitude]:[0,0],ni=ce.campus||(ge==null?void 0:ge.campus)||"Unknown Campus",mt=(ge==null?void 0:ge.type)||(ge==null?void 0:ge.buildingType)||"Unknown Type",At=[ce];console.log("Individual TempMapPoint: ",Fe[Pe]={buildingName:Pe,coordinates:Mn,totalIncidents:Re,incidentCounts:je,campus:ni,buildingType:mt,recentIncidents:At}),Fe[Pe]={buildingName:Pe,coordinates:Mn,totalIncidents:Re,incidentCounts:je,campus:ni,buildingType:mt,recentIncidents:At}}),console.log("TempMapPoints: ",Fe),a(Fe),Fe},Y=()=>{var de;const Fe=ee();G.current&&((de=G.current)==null||de.clearLayers()),Object.values(Fe).forEach(ce=>{if(ce.totalIncidents>0){const ge=Math.min(ce.totalIncidents*10+15,100),Ae=Object.entries(ce.incidentCounts).sort(([,ni],[,mt])=>mt-ni)[0][0],je={"uncomfortable-situation":"#de9e36","sexual-misconduct":"#ca3c25","physical-aggression":"#701d52","verbal-aggression":"#212475",discrimination:"#1d1a05"}[Ae]||"#666666";kr.circle(ce.coordinates,{color:je,fillColor:je,fillOpacity:.7,radius:ge,weight:2}).addTo(G.current);const Pe=Ge(ce);let Mn="black";ce.campus=="Notre-Dame"?Mn="#FFD700":ce.campus=="Holy-Cross"?Mn="#fff":ce.campus=="Saint-Marys"&&(Mn="#87CEEB"),kr.circle(ce.coordinates,{fillColor:Mn,fillOpacity:.5,color:Mn,stroke:!1,radius:15}).addTo(G.current).bindPopup(Pe,{maxWidth:400,className:"enhanced-popup"})}})},xe=()=>{const Fe=new Set;return i.forEach(de=>{const ce=new Date(de.createdAt.toMillis()),ge=`${ce.getFullYear()}-${String(ce.getMonth()+1).padStart(2,"0")}`;Fe.add(ge)}),["All",...Array.from(Fe).sort().reverse()]};function be(Fe){const de=Fe.createdAt.toMillis(),ce=Date.now(),ge=1440*60*1e3;let Ae=0,Re=ce-de;switch(Fe.time){case"within-24-hours":Ae=(Re+ge/2)/ge;break;case"within-week":Ae=(Re+ge*3.5)/ge;break;case"within-month":Ae=(Re+ge*15)/ge;break;case"longer-ago":Ae=(Re+ge*45)/ge;break}return Ae}function Ne(Fe){let de=0,ce=0;const ge=12;for(const Re of Fe){const je=be(Re);je<7&&ce++;const Pe=Math.min(3/je*2,2);de+=Pe}if(de===0)return[1,0];let Ae=10+de/ge*40;return Ae=Math.min(Ae,50),[Math.round(Ae)/10,ce]}const tt=Fe=>Fe.filter(de=>{if(C.selectedCampus!=="All"){const ce=nS.find(ge=>ge===de.campus);if(!ce||ce!==C.selectedCampus)return!1}if(C.selectedMonth!=="All"){const ce=new Date(de.createdAt.toMillis());if(`${ce.getFullYear()}-${String(ce.getMonth()+1).padStart(2,"0")}`!==C.selectedMonth)return!1}return!(C.selectedTypes.length>0&&!C.selectedTypes.some(ce=>de.offenseTypes.includes(ce)))}),Je=(Fe,de)=>{k(ce=>({...ce,[Fe]:de}))},Xe=Fe=>{k(de=>({...de,selectedTypes:de.selectedTypes.includes(Fe)?de.selectedTypes.filter(ce=>ce!==Fe):[...de.selectedTypes,Fe]}))},Ke=Fe=>{if(V.current)if(Fe==="All")V.current.setView([41.7002,-86.2379],15);else{const de=rS.filter(ce=>ce.location===Fe);if(de.length>0){const ce=kr.latLngBounds(de.map(ge=>[ge.latitude,ge.longitude]));V.current.fitBounds(ce,{padding:[50,50]})}}},Ge=Fe=>{const[de,ce]=Ne(Fe.recentIncidents),ge=de>=4?"#ca3c25":de>=3?"#de9e36":de>=2?"#212475":"#28a745",Ae=[{name:"uncomfortable-situation",color:"#de9e36"},{name:"sexual-misconduct",color:"#ca3c25"},{name:"physical-aggression",color:"#701d52"},{name:"verbal-aggression",color:"#212475"},{name:"discrimination",color:"#1d1a05"}];return`
      <div class="enhanced-popup-content">
        <h3 style="margin: 0 0 10px 0; color: #333;">${Fe.buildingName}</h3>
        
        <div style="margin-bottom: 10px;">
          <span style="font-weight: bold; color: #666;">Campus:</span> ${Fe.campus}<br>
          <span style="font-weight: bold; color: #666;">Building Type:</span> ${Fe.buildingType}
        </div>
        
        <div style="margin-bottom: 10px;">
          <span style="font-weight: bold; color: #666;">Total Cases:</span> ${Fe.totalIncidents}
        </div>
        
        <div style="margin-bottom: 10px;">
          <span style="font-weight: bold; color: #666;">Types of Aggressions:</span><br>
          ${Object.entries(Fe.incidentCounts).filter(([,Re])=>Re>0).map(([Re,je])=>{const Pe=Ae.find(ni=>ni.name===Re);if(!Pe)return"";const Mn=Pe.name.replace(/-/g," ").replace(/\b\w/g,ni=>ni.toUpperCase());return`<div style="margin: 2px 0; font-size: 12px;">
                <span style="color: ${Pe.color}; font-weight: bold;"></span>
                ${Mn}: ${je}
              </div>`}).join("")}
        </div>
        
        <div style="margin-bottom: 10px;">
          <span style="font-weight: bold; color: #666;">Risk Score:</span> 
          <span style="color: ${ge}; font-weight: bold; font-size: 16px;">
            ${de}/5
          </span>
          ${ce>0?`<br><span style="font-size: 12px; color: #666;">
              (${ce} recent case${ce>1?"s":""} in last 7 days)
            </span>`:'<br><span style="font-size: 12px; color: #28a745;">(No recent activity)</span>'}
        </div>
      </div>
    `};return Ce.jsxs("div",{className:"fullscreen-map-container",children:[Ce.jsxs("div",{className:"map-filter z-front",children:[Ce.jsx("div",{className:`map-filter-menu m-1${C.showMenu?" open":""}`,style:{zIndex:C.showMenu?1001:-1,opacity:C.showMenu?1:0},children:Ce.jsxs("div",{className:"filter-content",children:[Ce.jsx("h3",{children:"Map Filters"}),Ce.jsxs("div",{className:"filter-section",children:[Ce.jsx("label",{children:"Campus:"}),Ce.jsx("select",{value:C.selectedCampus,onChange:Fe=>{Je("selectedCampus",Fe.target.value),Ke(Fe.target.value)},className:"form-select",children:nS.map(Fe=>Ce.jsx("option",{value:Fe.toString(),children:Fe.toString()},Fe.toString()))})]}),Ce.jsxs("div",{className:"filter-section",children:[Ce.jsx("label",{children:"Month:"}),Ce.jsx("select",{value:C.selectedMonth,onChange:Fe=>Je("selectedMonth",Fe.target.value),className:"form-select",children:xe().map(Fe=>Ce.jsx("option",{value:Fe,children:Fe==="All"?"All Time":Fe},Fe))})]}),Ce.jsxs("div",{className:"filter-section",children:[Ce.jsx("label",{children:"Incident Types:"}),Ce.jsx("div",{className:"type-filters",children:mE.map(Fe=>Ce.jsxs("label",{className:"type-checkbox custom-circle-checkbox",style:{cursor:"pointer"},children:[Ce.jsx("input",{type:"checkbox",checked:C.selectedTypes.includes(Fe.name),onChange:()=>Xe(Fe.name),style:{display:"none"}}),Ce.jsx("span",{className:`type-color-dot-circle ${C.selectedTypes.includes(Fe.name)?"selected":""}`,style:{backgroundColor:Fe.color,borderColor:Fe.color},children:C.selectedTypes.includes(Fe.name)&&Ce.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",style:{display:"block",margin:"auto"},children:Ce.jsx("circle",{cx:"13",cy:"13",r:"10",fill:"#fff",opacity:"0.8"})})}),Ce.jsx("span",{style:{marginLeft:8},children:Fe.name})]},Fe.name))})]}),Ce.jsx("button",{className:"clear-filters-btn",onClick:()=>k({selectedCampus:"All",selectedMonth:"All",selectedTypes:[],showMenu:C.showMenu}),children:"Clear All Filters"}),Ce.jsxs("div",{className:"results-summary",children:[Ce.jsxs("p",{children:["Showing ",Object.values(t).length," incidents"]}),C.selectedCampus!=="All"&&Ce.jsxs("p",{children:["Campus: ",C.selectedCampus]}),C.selectedMonth!=="All"&&Ce.jsxs("p",{children:["Period: ",C.selectedMonth]}),C.selectedTypes.length>0&&Ce.jsxs("p",{children:["Types:"," ",C.selectedTypes.map(Fe=>{var de;return(de=mE.find(ce=>ce.name===Fe))==null?void 0:de.name}).join(", ")]})]})]})}),Ce.jsx("button",{className:"menu-toggle-btn",onClick:()=>Je("showMenu",!C.showMenu),children:C.showMenu?"":""})]}),Ce.jsxs("div",{className:"form-group abs right ",children:[Ce.jsx("a",{href:"../",className:"back-button form-btn",children:Ce.jsx("button",{className:" small",children:"Back"})}),Ce.jsx("a",{"data-az-l":"1e9e1abc-2335-4838-949d-8ab8af0dd8c9",className:"back-button form-btn mt-4",children:Ce.jsx("button",{className:" small",children:"Leave Feedback"})})]}),d&&Ce.jsx("div",{className:"loading-overlay",children:Ce.jsx("div",{className:"loading-content",children:"Loading incident data..."})}),_&&Ce.jsx("div",{className:"error-overlay",children:_}),Ce.jsx("div",{id:"map",className:"fullscreen-map"})]})}function QV(i){try{(function(e,t,a,d,m,_,c){t.getElementById("clarity-script")||(e[a]=e[a]||function(){(e[a].q=e[a].q||[]).push(arguments)},_=t.createElement(d),_.async=1,_.src="https://www.clarity.ms/tag/"+m+"?ref=npm",_.id="clarity-script",c=t.getElementsByTagName(d)[0],c.parentNode.insertBefore(_,c))})(window,document,"clarity","script",i);return}catch{return}}const JV={init(i){QV(i)},setTag(i,e){window.clarity("set",i,e)},identify(i,e,t,a){window.clarity("identify",i,e,t,a)},consent(i=!0){window.clarity("consent",i)},upgrade(i){window.clarity("upgrade",i)},event(i){window.clarity("event",i)}},eU="somgjzobm3";JV.init(eU);fP.createRoot(document.getElementById("root")).render(Ce.jsx(aP.StrictMode,{children:Ce.jsx(CR,{children:Ce.jsxs(rR,{children:[Ce.jsx(Ep,{path:"/",element:Ce.jsx(y2,{})}),Ce.jsx(Ep,{path:"/client/",element:Ce.jsx(y2,{})}),Ce.jsx(Ep,{path:"/report",element:Ce.jsx(aS,{})}),Ce.jsx(Ep,{path:"/client/report",element:Ce.jsx(aS,{})}),Ce.jsx(Ep,{path:"/map",element:Ce.jsx(gE,{})}),Ce.jsx(Ep,{path:"/client/map",element:Ce.jsx(gE,{})})]})})}));
